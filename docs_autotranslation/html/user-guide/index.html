<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OpenDaylight User Guide &mdash; OpenDaylight Documentation Boron documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.6/united/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Boron',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="OpenDaylight Documentation Boron documentation" href="../index.html" />
    <link rel="next" title="OpenDaylight Developer Guide" href="../developer-guide/index.html" />
    <link rel="prev" title="OpenDaylight and OpenStack" href="../howto-openstack/index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/odl_small.png"></span>
          OpenDaylight Documentation</a>
        <span class="navbar-text navbar-version pull-left"><b>Boron</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started-guide/index.html">OpenDaylight Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto-openstack/index.html">OpenDaylight and OpenStack</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OpenDaylight User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer-guide/index.html">OpenDaylight Developer Guide</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">OpenDaylight User Guide</a><ul>
<li><a class="reference internal" href="#opendaylight-controller-overview">OpenDaylight Controller Overview</a></li>
<li><a class="reference internal" href="#using-the-opendaylight-user-interface-dlux">Using the OpenDaylight User Interface (DLUX)</a><ul>
<li><a class="reference internal" href="#getting-started-with-dlux">Getting Started with DLUX</a></li>
<li><a class="reference internal" href="#logging-in">Logging In</a></li>
<li><a class="reference internal" href="#working-with-dlux">Working with DLUX</a></li>
<li><a class="reference internal" href="#viewing-network-statistics">Viewing Network Statistics</a></li>
<li><a class="reference internal" href="#viewing-network-topology">Viewing Network Topology</a></li>
<li><a class="reference internal" href="#interacting-with-the-yang-based-md-sal-datastore">Interacting with the YANG-based MD-SAL datastore</a><ul>
<li><a class="reference internal" href="#displaying-topology-on-the-yang-ui">Displaying Topology on the <strong>Yang UI</strong></a></li>
<li><a class="reference internal" href="#configuring-list-elements-on-the-yang-ui">Configuring List Elements on the <strong>Yang UI</strong></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#running-xsql-console-commands-and-queries">Running XSQL Console Commands and Queries</a><ul>
<li><a class="reference internal" href="#xsql-overview">XSQL Overview</a></li>
<li><a class="reference internal" href="#installing-xsql">Installing XSQL</a></li>
<li><a class="reference internal" href="#xsql-console-commands">XSQL Console Commands</a></li>
<li><a class="reference internal" href="#xsql-queries">XSQL Queries</a><ul>
<li><a class="reference internal" href="#example-skip-criteria-operator">Example: Skip Criteria Operator</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#setting-up-clustering">Setting Up Clustering</a><ul>
<li><a class="reference internal" href="#clustering-overview">Clustering Overview</a></li>
<li><a class="reference internal" href="#single-node-clustering">Single Node Clustering</a></li>
<li><a class="reference internal" href="#multiple-node-clustering">Multiple Node Clustering</a><ul>
<li><a class="reference internal" href="#deployment-considerations">Deployment Considerations</a></li>
<li><a class="reference internal" href="#setting-up-a-multiple-node-cluster">Setting Up a Multiple Node Cluster</a><ul>
<li><a class="reference internal" href="#sample-config-files">Sample Config Files</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#alto-user-guide">ALTO User Guide</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#alto-architecture">ALTO Architecture</a></li>
<li><a class="reference internal" href="#configuring-alto">Configuring ALTO</a></li>
<li><a class="reference internal" href="#administering-or-managing-alto">Administering or Managing ALTO</a><ul>
<li><a class="reference internal" href="#managing-data-with-restconf">Managing Data with RESTCONF</a></li>
<li><a class="reference internal" href="#using-alto-manager">Using <code class="docutils literal"><span class="pre">alto-manager</span></code></a></li>
<li><a class="reference internal" href="#using-alto-hosttracker">Using <code class="docutils literal"><span class="pre">alto-hosttracker</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#authentication-and-authorization-services">Authentication and Authorization Services</a><ul>
<li><a class="reference internal" href="#authentication-service">Authentication Service</a><ul>
<li><a class="reference internal" href="#authentication-data-model">Authentication data model</a><ul>
<li><a class="reference internal" href="#terms-and-definitions-in-the-model">Terms and definitions in the model</a></li>
<li><a class="reference internal" href="#authentication-methods">Authentication methods</a><ul>
<li><a class="reference internal" href="#example-with-token-authentication-using-curl">Example with token authentication using curl:</a></li>
<li><a class="reference internal" href="#example-with-basic-http-auth-using-curl">Example with basic HTTP auth using curl:</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#how-the-opendaylight-authentication-service-works">How the OpenDaylight Authentication Service works</a></li>
<li><a class="reference internal" href="#configuring-authentication-service">Configuring Authentication service</a><ul>
<li><a class="reference internal" href="#configuring-authentication">Configuring Authentication</a></li>
<li><a class="reference internal" href="#configuring-the-token-store">Configuring the token store</a></li>
<li><a class="reference internal" href="#configuring-aaa-federation">Configuring AAA federation</a><ul>
<li><a class="reference internal" href="#configuring-federated-authentication">Configuring federated authentication</a></li>
<li><a class="reference internal" href="#mapping-users-to-roles-and-domains">Mapping users to roles and domains</a></li>
<li><a class="reference internal" href="#operational-model">Operational model</a></li>
<li><a class="reference internal" href="#operational-model-sample-code">Operational Model: Sample code</a></li>
<li><a class="reference internal" href="#mapping-users">Mapping Users</a></li>
<li><a class="reference internal" href="#example-splitting-a-fully-qualified-username-into-user-and-realm-components">Example: Splitting a fully qualified username into user and realm components</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#administering-opendaylight-authentication-services">Administering OpenDaylight Authentication Services</a><ul>
<li><a class="reference internal" href="#actors-in-the-system">Actors in the System</a></li>
<li><a class="reference internal" href="#system-components">System Components</a><ul>
<li><a class="reference internal" href="#idmlight-identity-manager">IdmLight Identity manager</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#opendaylight-authorization-service">OpenDaylight Authorization Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#armoury">Armoury</a><ul>
<li><a class="reference internal" href="#id1">Overview</a></li>
<li><a class="reference internal" href="#armoury-architecture">Armoury Architecture</a></li>
<li><a class="reference internal" href="#armoury-catalog">Armoury Catalog</a><ul>
<li><a class="reference internal" href="#configuring-armoury-catalog">Configuring Armoury Catalog</a></li>
<li><a class="reference internal" href="#administering-armoury-catalog">Administering Armoury Catalog</a></li>
</ul>
</li>
<li><a class="reference internal" href="#armoury-workload-manager">Armoury Workload Manager</a><ul>
<li><a class="reference internal" href="#configuring-armoury-workload-manager">Configuring Armoury Workload Manager</a></li>
<li><a class="reference internal" href="#administering-armoury-workload-manager">Administering Armoury Workload Manager</a></li>
</ul>
</li>
<li><a class="reference internal" href="#armoury-driver-registry">Armoury Driver Registry</a><ul>
<li><a class="reference internal" href="#configuring-armoury-driver-registry">Configuring Armoury Driver Registry</a></li>
<li><a class="reference internal" href="#administering-armoury-driver-registry">Administering Armoury Driver Registry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutorials">Tutorials</a><ul>
<li><a class="reference internal" href="#using-armoury-catalog">Using Armoury Catalog</a><ul>
<li><a class="reference internal" href="#id2">Overview</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#target-environment">Target Environment</a></li>
<li><a class="reference internal" href="#instructions">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-armoury-workload-manager">Using Armoury Workload Manager</a><ul>
<li><a class="reference internal" href="#id3">Overview</a></li>
<li><a class="reference internal" href="#id4">Prerequisites</a></li>
<li><a class="reference internal" href="#id5">Target Environment</a></li>
<li><a class="reference internal" href="#id6">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-armoury-driver-registry">Using Armoury Driver Registry</a><ul>
<li><a class="reference internal" href="#id7">Overview</a></li>
<li><a class="reference internal" href="#id8">Prerequisites</a></li>
<li><a class="reference internal" href="#id9">Target Environment</a></li>
<li><a class="reference internal" href="#id10">Instructions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#bgp-user-guide">BGP User Guide</a><ul>
<li><a class="reference internal" href="#id11">Overview</a></li>
<li><a class="reference internal" href="#configuring-bgp">Configuring BGP</a><ul>
<li><a class="reference internal" href="#rib">RIB</a></li>
<li><a class="reference internal" href="#bgp-peer">BGP Peer</a></li>
<li><a class="reference internal" href="#configure-connection-attributes-optional">Configure Connection Attributes - OPTIONAL</a></li>
<li><a class="reference internal" href="#bgp-speaker-configuration">BGP Speaker Configuration</a></li>
<li><a class="reference internal" href="#incomming-bgp-connections">Incomming BGP Connections</a></li>
<li><a class="reference internal" href="#bgp-application-peer">BGP Application Peer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration-through-restconf">Configuration through RESTCONF</a><ul>
<li><a class="reference internal" href="#id12">RIB</a></li>
<li><a class="reference internal" href="#id13">BGP Peer</a></li>
<li><a class="reference internal" href="#id14">BGP Application Peer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id15">Tutorials</a><ul>
<li><a class="reference internal" href="#viewing-bgp-topology">Viewing BGP Topology</a><ul>
<li><a class="reference internal" href="#network-topology-view">Network Topology View</a></li>
<li><a class="reference internal" href="#route-information-base-rib-view">Route Information Base (RIB) View</a></li>
</ul>
</li>
<li><a class="reference internal" href="#populate-rib">Populate RIB</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#capwap-user-guide">CAPWAP User Guide</a><ul>
<li><a class="reference internal" href="#id16">Overview</a></li>
<li><a class="reference internal" href="#capwap-architecture">CAPWAP Architecture</a></li>
<li><a class="reference internal" href="#scope-of-capwap-project">Scope of CAPWAP Project</a></li>
<li><a class="reference internal" href="#installing-capwap">Installing CAPWAP</a></li>
<li><a class="reference internal" href="#configuring-capwap">Configuring CAPWAP</a></li>
<li><a class="reference internal" href="#administering-or-managing-capwap">Administering or Managing CAPWAP</a></li>
<li><a class="reference internal" href="#id17">Tutorials</a><ul>
<li><a class="reference internal" href="#viewing-discovered-wtps">Viewing Discovered WTPs</a><ul>
<li><a class="reference internal" href="#id18">Overview</a></li>
<li><a class="reference internal" href="#id19">Prerequisites</a></li>
<li><a class="reference internal" href="#id20">Instructions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#didm-user-guide">DIDM User Guide</a><ul>
<li><a class="reference internal" href="#id21">Overview</a></li>
<li><a class="reference internal" href="#didm-architecture">DIDM Architecture</a></li>
</ul>
</li>
<li><a class="reference internal" href="#group-based-policy-user-guide">Group Based Policy User Guide</a><ul>
<li><a class="reference internal" href="#id22">Overview</a></li>
<li><a class="reference internal" href="#gbp-base-architecture-and-value-proposition">GBP Base Architecture and Value Proposition</a><ul>
<li><a class="reference internal" href="#terminology">Terminology</a></li>
<li><a class="reference internal" href="#architecture-and-value-proposition">Architecture and Value Proposition</a><ul>
<li><a class="reference internal" href="#high-level-implementation-architecture">High-level implementation Architecture</a></li>
</ul>
</li>
<li><a class="reference internal" href="#policy-resolution">Policy Resolution</a><ul>
<li><a class="reference internal" href="#contract-selection">Contract Selection</a></li>
<li><a class="reference internal" href="#subject-selection">Subject Selection</a></li>
<li><a class="reference internal" href="#requirements-and-capabilities">Requirements and Capabilities</a></li>
<li><a class="reference internal" href="#conditions">Conditions</a></li>
<li><a class="reference internal" href="#clauses">Clauses</a></li>
<li><a class="reference internal" href="#rule-application">Rule Application</a><ul>
<li><a class="reference internal" href="#matchers">Matchers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inheritance">Inheritance</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-gbp-ux-interface">Using the GBP UX interface</a><ul>
<li><a class="reference internal" href="#id23">Overview</a></li>
<li><a class="reference internal" href="#basic-view">Basic view</a></li>
<li><a class="reference internal" href="#governance-view">Governance view</a></li>
<li><a class="reference internal" href="#policy-expression-view">Policy expression view</a></li>
<li><a class="reference internal" href="#tenants">Tenants</a></li>
<li><a class="reference internal" href="#wizard">Wizard</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-gbp-api">Using the GBP API</a></li>
<li><a class="reference internal" href="#using-openstack-with-gbp">Using OpenStack with GBP</a><ul>
<li><a class="reference internal" href="#id24">Overview</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#configuring-gbp-neutron">Configuring GBP Neutron</a></li>
<li><a class="reference internal" href="#administering-or-managing-gbp-neutron">Administering or Managing GBP Neutron</a></li>
<li><a class="reference internal" href="#id25">Tutorials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-gbp-openflow-overlay-ofoverlay-renderer">Using the GBP OpenFlow Overlay (OfOverlay) renderer</a><ul>
<li><a class="reference internal" href="#id26">Overview</a><ul>
<li><a class="reference internal" href="#installing-and-pre-requisites">Installing and Pre-requisites</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-overlay-architecture">OpenFlow Overlay Architecture</a></li>
<li><a class="reference internal" href="#configuring-openflow-overlay-via-rest">Configuring OpenFlow Overlay via REST</a></li>
<li><a class="reference internal" href="#id27">Tutorials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-gbp-ebpf-io-visor-agent-renderer">Using the GBP eBPF IO Visor Agent renderer</a><ul>
<li><a class="reference internal" href="#id28">Overview</a><ul>
<li><a class="reference internal" href="#id29">Installing and Pre-requisites</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-gbp-faas-renderer">Using the GBP FaaS renderer</a><ul>
<li><a class="reference internal" href="#id30">Overview</a><ul>
<li><a class="reference internal" href="#id31">Installing and Pre-requisites</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#using-service-function-chaining-sfc-with-gbp-neutron-mapper-and-ofoverlay">Using Service Function Chaining (SFC) with GBP Neutron Mapper and OfOverlay</a><ul>
<li><a class="reference internal" href="#id32">Overview</a></li>
</ul>
</li>
<li><a class="reference internal" href="#demo-development-environment">Demo/Development environment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#l2switch-user-guide">L2Switch User Guide</a><ul>
<li><a class="reference internal" href="#id33">Overview</a></li>
<li><a class="reference internal" href="#l2switch-architecture">L2Switch Architecture</a></li>
<li><a class="reference internal" href="#configuring-l2switch">Configuring L2Switch</a></li>
<li><a class="reference internal" href="#configuring-loop-remover">Configuring Loop Remover</a></li>
<li><a class="reference internal" href="#configuring-arp-handler">Configuring Arp Handler</a></li>
<li><a class="reference internal" href="#configuring-address-tracker">Configuring Address Tracker</a></li>
<li><a class="reference internal" href="#configuring-l2switch-main">Configuring L2Switch Main</a></li>
<li><a class="reference internal" href="#running-the-l2switch-project">Running the L2Switch project</a></li>
<li><a class="reference internal" href="#create-a-network-using-mininet">Create a network using mininet</a></li>
<li><a class="reference internal" href="#generating-network-traffic-using-mininet">Generating network traffic using mininet</a></li>
<li><a class="reference internal" href="#checking-address-observations">Checking Address Observations</a></li>
<li><a class="reference internal" href="#checking-hosts">Checking Hosts</a></li>
<li><a class="reference internal" href="#checking-stp-status-of-each-link">Checking STP status of each link</a></li>
<li><a class="reference internal" href="#miscellaneous-mininet-commands">Miscellaneous mininet commands</a></li>
</ul>
</li>
<li><a class="reference internal" href="#l3vpn-service-user-guide">L3VPN Service: User Guide</a><ul>
<li><a class="reference internal" href="#id34">Overview</a></li>
<li><a class="reference internal" href="#modules-interfaces">Modules &amp; Interfaces</a><ul>
<li><a class="reference internal" href="#vpn-service-modules">VPN Service Modules</a></li>
<li><a class="reference internal" href="#configuration-interfaces">Configuration Interfaces</a><ul>
<li><a class="reference internal" href="#configuration-interface-details">Configuration Interface Details</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#provisioning-sequence-sample-configurations">Provisioning Sequence &amp; Sample Configurations</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#pre-requisites">Pre-requisites:</a></li>
<li><a class="reference internal" href="#step-1-configure-bgp">Step 1 : Configure BGP</a><ul>
<li><a class="reference internal" href="#configure-bgp-router">1. Configure BGP Router</a></li>
<li><a class="reference internal" href="#configure-bgp-neighbors">2. Configure BGP Neighbors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-2-create-tunnel-interfaces">Step 2 : Create Tunnel Interfaces</a><ul>
<li><a class="reference internal" href="#following-is-expected-as-a-result-of-these-configurations">Following is expected as a result of these configurations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-3-os-create-neutron-ports-and-attach-vms">Step 3 : OS Create Neutron Ports and attach VMs</a></li>
<li><a class="reference internal" href="#step-4-create-vm-interfaces">Step 4 : Create VM Interfaces</a></li>
<li><a class="reference internal" href="#step-5-create-vpn-instance">Step 5: Create VPN Instance</a><ul>
<li><a class="reference internal" href="#id35">Following is expected as a result of these configurations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-5-create-vpn-interface-and-local-adjacency">Step 5 : Create VPN-Interface and Local Adjacency</a><ul>
<li><a class="reference internal" href="#create-vpn-interface">1. Create vpn-interface</a></li>
<li><a class="reference internal" href="#add-adjacencies-on-vpn-interafce">2. Add Adjacencies on vpn-interafce</a></li>
<li><a class="reference internal" href="#id36">Following is expected as a result of these configurations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#link-aggregation-control-protocol-user-guide">Link Aggregation Control Protocol User Guide</a><ul>
<li><a class="reference internal" href="#id37">Overview</a></li>
<li><a class="reference internal" href="#link-aggregation-control-protocol-architecture">Link Aggregation Control Protocol Architecture</a></li>
<li><a class="reference internal" href="#configuring-link-aggregation-control-protocol">Configuring Link Aggregation Control Protocol</a></li>
<li><a class="reference internal" href="#administering-or-managing-link-aggregation-control-protocol">Administering or Managing Link Aggregation Control Protocol</a></li>
<li><a class="reference internal" href="#id38">Tutorials</a><ul>
<li><a class="reference internal" href="#sample-lacp-topology-creation-on-mininet">Sample LACP Topology creation on Mininet</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#lisp-flow-mapping-user-guide">LISP Flow Mapping User Guide</a><ul>
<li><a class="reference internal" href="#id39">Overview</a><ul>
<li><a class="reference internal" href="#locator-id-separation-protocol">Locator/ID Separation Protocol</a></li>
<li><a class="reference internal" href="#lisp-flow-mapping-service">LISP Flow Mapping Service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lisp-flow-mapping-architecture">LISP Flow Mapping Architecture</a></li>
<li><a class="reference internal" href="#configuring-lisp-flow-mapping">Configuring LISP Flow Mapping</a></li>
<li><a class="reference internal" href="#textual-conventions-for-lisp-address-formats">Textual Conventions for LISP Address Formats</a></li>
<li><a class="reference internal" href="#karaf-commands">Karaf commands</a><ul>
<li><a class="reference internal" href="#useful-built-in-commands">Useful built-in commands</a></li>
<li><a class="reference internal" href="#lisp-specific-commands">LISP specific commands</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lisp-flow-mapping-karaf-features">LISP Flow Mapping Karaf Features</a></li>
<li><a class="reference internal" href="#id40">Tutorials</a><ul>
<li><a class="reference internal" href="#creating-a-lisp-overlay">Creating a LISP overlay</a><ul>
<li><a class="reference internal" href="#id41">Overview</a></li>
<li><a class="reference internal" href="#id42">Prerequisites</a></li>
<li><a class="reference internal" href="#id43">Target Environment</a></li>
<li><a class="reference internal" href="#id44">Instructions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#lisp-flow-mapping-support">LISP Flow Mapping Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#messaging4transport-user-guide">Messaging4Transport User Guide</a><ul>
<li><a class="reference internal" href="#id45">Overview</a></li>
<li><a class="reference internal" href="#architecture">Architecture</a><ul>
<li><a class="reference internal" href="#installing-karaf-features">Installing Karaf Features</a></li>
<li><a class="reference internal" href="#activemq-integration-with-karaf">ActiveMQ Integration with Karaf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#administering-or-managing-messaging4transport">Administering or Managing Messaging4Transport</a></li>
</ul>
</li>
<li><a class="reference internal" href="#network-modeling-nemo">NEtwork MOdeling (NEMO)</a><ul>
<li><a class="reference internal" href="#id46">Overview</a></li>
<li><a class="reference internal" href="#nemo-engine-architecture">NEMO Engine Architecture</a></li>
<li><a class="reference internal" href="#configuring-nemo-engine">Configuring NEMO Engine</a></li>
<li><a class="reference internal" href="#administering-or-managing-nemo-engine">Administering or Managing NEMO Engine</a></li>
<li><a class="reference internal" href="#id47">Tutorials</a><ul>
<li><a class="reference internal" href="#using-nemo-engine">Using NEMO Engine</a><ul>
<li><a class="reference internal" href="#id48">Overview</a></li>
<li><a class="reference internal" href="#id49">Prerequisites</a></li>
<li><a class="reference internal" href="#id50">Target Environment</a></li>
<li><a class="reference internal" href="#id51">Instructions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#netide-user-guide">NetIDE User Guide</a><ul>
<li><a class="reference internal" href="#id52">Overview</a></li>
<li><a class="reference internal" href="#netide-api">NetIDE API</a><ul>
<li><a class="reference internal" href="#architecture-and-design">Architecture and Design</a></li>
<li><a class="reference internal" href="#core">Core</a></li>
<li><a class="reference internal" href="#handling-reply-messages-correctly">Handling reply messages correctly</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#network-intent-composition-nic-user-guide">Network Intent Composition (NIC) User Guide</a><ul>
<li><a class="reference internal" href="#id53">Overview</a></li>
<li><a class="reference internal" href="#network-intent-composition-nic-architecture">Network Intent Composition (NIC) Architecture</a></li>
<li><a class="reference internal" href="#configuring-network-intent-composition-nic">Configuring Network Intent Composition (NIC)</a></li>
<li><a class="reference internal" href="#administering-or-managing-network-intent-composition-nic">Administering or Managing Network Intent Composition (NIC)</a></li>
<li><a class="reference internal" href="#interactions">Interactions</a><ul>
<li><a class="reference internal" href="#rest">REST</a><ul>
<li><a class="reference internal" href="#id54">Configuration</a></li>
<li><a class="reference internal" href="#operational">Operational</a></li>
</ul>
</li>
<li><a class="reference internal" href="#karaf-console-cli">Karaf Console CLI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nic-usage-examples">NIC Usage Examples</a><ul>
<li><a class="reference internal" href="#how-to-configure-vtn-renderer">How to configure VTN Renderer</a><ul>
<li><a class="reference internal" href="#requirement">Requirement</a></li>
<li><a class="reference internal" href="#downloading-and-deploy-karaf-distribution">Downloading and deploy Karaf distribution</a></li>
<li><a class="reference internal" href="#id55">Configuration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#odl-sdni-user-guide">ODL-SDNi User Guide</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#components">Components</a></li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-plugin-project-user-guide">OpenFlow Plugin Project User Guide</a><ul>
<li><a class="reference internal" href="#overview-and-architecture">Overview and Architecture</a><ul>
<li><a class="reference internal" href="#id56">Overview and Architecture</a><ul>
<li><a class="reference internal" href="#id57">Overview</a></li>
<li><a class="reference internal" href="#scope">Scope</a></li>
<li><a class="reference internal" href="#id58">Architecture and Design</a><ul>
<li><a class="reference internal" href="#functionality">Functionality</a></li>
<li><a class="reference internal" href="#design">Design</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#coverage">Coverage</a><ul>
<li><a class="reference internal" href="#intro">Intro</a></li>
<li><a class="reference internal" href="#id59">Coverage</a></li>
<li><a class="reference internal" href="#of-1-3-considerations">OF 1.3 Considerations</a></li>
<li><a class="reference internal" href="#of-1-0-considerations">OF 1.0 Considerations</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial-how-to">Tutorial / How-To</a><ul>
<li><a class="reference internal" href="#running-the-controller-with-the-new-openflow-plugin">Running the controller with the new OpenFlow Plugin</a><ul>
<li><a class="reference internal" href="#opendaylight-controller-plugin-options">Opendaylight Controller Plugin Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-1-3-enabled-software-switches-environment">OpenFlow 1.3 Enabled Software Switches / Environment</a><ul>
<li><a class="reference internal" href="#getting-mininet-with-of-1-3">Getting Mininet with OF 1.3</a><ul>
<li><a class="reference internal" href="#installing-under-virtualbox">Installing under VirtualBox</a></li>
<li><a class="reference internal" href="#your-simplest-choice-use-vagrant">Your simplest choice: Use Vagrant</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setup-cpqd-openflow-1-3-soft-switch">Setup CPqD Openflow 1.3 Soft Switch</a><ul>
<li><a class="reference internal" href="#commands-to-add-entries-to-various-tables-of-the-switch">Commands to add entries to various tables of the switch</a></li>
<li><a class="reference internal" href="#using-the-built-in-wireshark">Using the built-in Wireshark</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-mininet-with-of-1-3">Running Mininet with OF 1.3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#end-to-end-inventory">End to End Inventory</a><ul>
<li><a class="reference internal" href="#id60">Introduction</a></li>
<li><a class="reference internal" href="#restconf-for-inventory">Restconf for Inventory</a><ul>
<li><a class="reference internal" href="#how-to-hit-restconf-with-postman">How to hit RestConf with Postman</a></li>
</ul>
</li>
<li><a class="reference internal" href="#known-bug">Known Bug</a></li>
</ul>
</li>
<li><a class="reference internal" href="#end-to-end-flows">End to End Flows</a><ul>
<li><a class="reference internal" href="#id61">Instructions</a><ul>
<li><a class="reference internal" href="#learn-end-to-end-for-inventory">Learn End to End for Inventory</a></li>
<li><a class="reference internal" href="#check-inventory">Check inventory</a></li>
<li><a class="reference internal" href="#flow-strategy">Flow Strategy</a></li>
<li><a class="reference internal" href="#push-your-flow">Push your flow</a></li>
<li><a class="reference internal" href="#check-for-your-flow-on-the-switch">Check for your flow on the switch</a></li>
<li><a class="reference internal" href="#check-for-your-flow-in-the-controller-config-via-restconf">Check for your flow in the controller config via RESTCONF</a></li>
<li><a class="reference internal" href="#look-for-your-flow-stats-in-the-controller-operational-data-via">Look for your flow stats in the controller operational data via</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discovering-and-testing-new-flow-types">Discovering and testing new Flow Types</a><ul>
<li><a class="reference internal" href="#using-addmdflow">Using addMDFlow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-flows">Example Flows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#end-to-end-topology">End to End Topology</a><ul>
<li><a class="reference internal" href="#id62">Introduction</a></li>
<li><a class="reference internal" href="#restconf-for-topology">Restconf for Topology</a><ul>
<li><a class="reference internal" href="#id63">How to hit RestConf with Postman</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#end-to-end-groups">End to End Groups</a><ul>
<li><a class="reference internal" href="#note">NOTE</a></li>
<li><a class="reference internal" href="#id64">Instructions</a><ul>
<li><a class="reference internal" href="#id65">Learn End to End for Inventory</a></li>
<li><a class="reference internal" href="#id66">Check inventory</a></li>
<li><a class="reference internal" href="#group-strategy">Group Strategy</a></li>
<li><a class="reference internal" href="#push-your-group">Push your Group</a></li>
<li><a class="reference internal" href="#check-for-your-group-on-the-switch">Check for your group on the switch</a></li>
<li><a class="reference internal" href="#check-for-your-group-in-the-controller-config-via-restconf">Check for your group in the controller config via RESTCONF</a></li>
<li><a class="reference internal" href="#look-for-your-group-stats-in-the-controller-operational-data-via-restconf">Look for your group stats in the controller operational data via RESTCONF</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discovering-and-testing-group-types">Discovering and testing Group Types</a></li>
<li><a class="reference internal" href="#using-addgroup">Using addGroup</a></li>
<li><a class="reference internal" href="#example-group">Example Group</a></li>
</ul>
</li>
<li><a class="reference internal" href="#end-to-end-meters">End to End Meters</a><ul>
<li><a class="reference internal" href="#id67">Instructions</a><ul>
<li><a class="reference internal" href="#id68">Learn End to End for Inventory</a></li>
<li><a class="reference internal" href="#id69">Check inventory</a></li>
<li><a class="reference internal" href="#meter-strategy">Meter Strategy</a></li>
<li><a class="reference internal" href="#push-your-meter">Push your Meter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#check-for-your-meter-on-the-switch">Check for your meter on the switch</a><ul>
<li><a class="reference internal" href="#check-for-your-meter-in-the-controller-config-via-restconf">Check for your meter in the controller config via RESTCONF</a></li>
<li><a class="reference internal" href="#look-for-your-meter-stats-in-the-controller-operational-data-via-restconf">Look for your meter stats in the controller operational data via RESTCONF</a></li>
<li><a class="reference internal" href="#discovering-and-testing-meter-types">Discovering and testing Meter Types</a><ul>
<li><a class="reference internal" href="#using-addmeter">Using addMeter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-meter">Example Meter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#statistics">Statistics</a><ul>
<li><a class="reference internal" href="#id70">Overview</a><ul>
<li><a class="reference internal" href="#statistics-collection-in-new-openflow-plugin">Statistics collection in new OpenFlow plugin</a></li>
<li><a class="reference internal" href="#details-of-statistics-collection">Details of statistics collection</a></li>
<li><a class="reference internal" href="#restconf-uris-to-access-statistics-of-various-node-elements">RESTCONF Uris to access statistics of various node elements</a></li>
<li><a class="reference internal" href="#bugs">Bugs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#web-graphical-interface">Web / Graphical Interface</a></li>
<li><a class="reference internal" href="#command-line-interface">Command Line Interface</a><ul>
<li><a class="reference internal" href="#flows-test-provider">Flows : Test Provider</a><ul>
<li><a class="reference internal" href="#addflow-addmdflow">AddFlow : addMDFlow</a></li>
<li><a class="reference internal" href="#removeflow-removemdflow">RemoveFlow : removeMDFlow</a></li>
<li><a class="reference internal" href="#modifyflow-modifymdflow">ModifyFlow : modifyMDFlow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#group-test-provider">Group : Test Provider</a><ul>
<li><a class="reference internal" href="#addgroup-addgroup">AddGroup : addGroup</a></li>
<li><a class="reference internal" href="#removegroup-removegroup">RemoveGroup : removeGroup</a></li>
<li><a class="reference internal" href="#modifygroup-modifygroup">ModifyGroup : modifyGroup</a></li>
</ul>
</li>
<li><a class="reference internal" href="#meters-test-provider">Meters : Test Provider</a><ul>
<li><a class="reference internal" href="#addmeter-addmeter">AddMeter : addMeter</a></li>
<li><a class="reference internal" href="#removemeter-removemeter">RemoveMeter : removeMeter</a></li>
<li><a class="reference internal" href="#modifymeter-modifymeter">ModifyMeter : modifyMeter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#topology-notification">Topology : Notification</a><ul>
<li><a class="reference internal" href="#link-discovered-event-testing">Link Discovered Event : Testing</a></li>
<li><a class="reference internal" href="#link-removed-event-testing">Link Removed Event : Testing</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#programmatic-interface">Programmatic Interface</a></li>
<li><a class="reference internal" href="#id71">Example flows</a><ul>
<li><a class="reference internal" href="#id72">Overview</a></li>
<li><a class="reference internal" href="#match-examples">Match Examples</a><ul>
<li><a class="reference internal" href="#ipv4-dest-address">IPv4 Dest Address</a></li>
<li><a class="reference internal" href="#ethernet-src-address">Ethernet Src Address</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ethernet-type">Ethernet Src &amp; Dest Addresses, Ethernet Type</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-input-port">Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, Input Port</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-ip">Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, IP</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-tcp-src">Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, TCP Src &amp;</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-udp-src">Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, UDP Src &amp;</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-icmpv4">Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, ICMPv4</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-arp-operation-arp-src-target">Ethernet Src &amp; Dest Addresses, ARP Operation, ARP Src &amp; Target</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-ethernet-type-vlan-id-vlan-pcp">Ethernet Src &amp; Dest Addresses, Ethernet Type, VLAN ID, VLAN PCP</a></li>
<li><a class="reference internal" href="#ethernet-src-dest-addresses-mpls-label-mpls-tc-mpls-bos">Ethernet Src &amp; Dest Addresses, MPLS Label, MPLS TC, MPLS BoS</a></li>
<li><a class="reference internal" href="#ipv6-src-dest-addresses">IPv6 Src &amp; Dest Addresses</a></li>
<li><a class="reference internal" href="#metadata">Metadata</a></li>
<li><a class="reference internal" href="#metadata-metadata-mask">Metadata, Metadata Mask</a></li>
<li><a class="reference internal" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-udp-src-dest-ports">IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, UDP Src &amp; Dest Ports</a></li>
<li><a class="reference internal" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dest-ports">IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, TCP Src &amp; Dest Ports</a></li>
<li><a class="reference internal" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dest-ports-ipv6-label">IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, TCP Src &amp; Dest Ports, IPv6 Label</a></li>
<li><a class="reference internal" href="#tunnel-id">Tunnel ID</a></li>
<li><a class="reference internal" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-icmpv6-type-code-ipv6-label">IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, ICMPv6 Type &amp; Code, IPv6 Label</a></li>
<li><a class="reference internal" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dst-ports-ipv6-label-ipv6-ext-header">IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, TCP Src &amp; Dst Ports, IPv6 Label, IPv6 Ext Header</a></li>
</ul>
</li>
<li><a class="reference internal" href="#actions">Actions</a><ul>
<li><a class="reference internal" href="#apply-actions">Apply Actions</a><ul>
<li><a class="reference internal" href="#output-to-table">Output to TABLE</a></li>
<li><a class="reference internal" href="#output-to-inport">Output to INPORT</a></li>
<li><a class="reference internal" href="#output-to-physical-port">Output to Physical Port</a></li>
<li><a class="reference internal" href="#output-to-local">Output to LOCAL</a></li>
<li><a class="reference internal" href="#output-to-normal">Output to NORMAL</a></li>
<li><a class="reference internal" href="#output-to-flood">Output to FLOOD</a></li>
<li><a class="reference internal" href="#output-to-all">Output to ALL</a></li>
<li><a class="reference internal" href="#output-to-controller">Output to CONTROLLER</a></li>
<li><a class="reference internal" href="#output-to-any">Output to ANY</a></li>
<li><a class="reference internal" href="#push-vlan">Push VLAN</a></li>
<li><a class="reference internal" href="#push-mpls">Push MPLS</a></li>
<li><a class="reference internal" href="#swap-mpls">Swap MPLS</a></li>
<li><a class="reference internal" href="#pop-mpls">Pop MPLS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#opendaylight-openflow-plugin-troubleshooting">Opendaylight OpenFlow Plugin: Troubleshooting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opflex-agent-ovs-user-guide">OpFlex agent-ovs User Guide</a><ul>
<li><a class="reference internal" href="#id73">Introduction</a></li>
<li><a class="reference internal" href="#agent-configuration">Agent Configuration</a></li>
<li><a class="reference internal" href="#endpoint-registration">Endpoint Registration</a></li>
<li><a class="reference internal" href="#inspector">Inspector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pcep-user-guide">PCEP User Guide</a><ul>
<li><a class="reference internal" href="#id74">Overview</a></li>
<li><a class="reference internal" href="#configuring-pcep">Configuring PCEP</a><ul>
<li><a class="reference internal" href="#pcep-segment-routing">PCEP Segment Routing</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#packetcable-user-guide">PacketCable User Guide</a><ul>
<li><a class="reference internal" href="#id75">Overview</a></li>
<li><a class="reference internal" href="#packetcable-components">PacketCable Components</a></li>
<li><a class="reference internal" href="#installing-packetcable">Installing PacketCable</a></li>
<li><a class="reference internal" href="#explore-and-exercise-the-packetcable-rest-api">Explore and exercise the PacketCable REST API</a></li>
<li><a class="reference internal" href="#postman">Postman</a></li>
</ul>
</li>
<li><a class="reference internal" href="#service-function-chaining">Service Function Chaining</a><ul>
<li><a class="reference internal" href="#opendaylight-service-function-chaining-sfc-overiew">OpenDaylight Service Function Chaining (SFC) Overiew</a></li>
<li><a class="reference internal" href="#sfc-user-interface">SFC User Interface</a><ul>
<li><a class="reference internal" href="#id76">Overview</a></li>
<li><a class="reference internal" href="#sfc-ui-architecture">SFC-UI Architecture</a></li>
<li><a class="reference internal" href="#configuring-sfc-ui">Configuring SFC-UI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sfc-southbound-rest-plugin">SFC Southbound REST Plugin</a><ul>
<li><a class="reference internal" href="#id77">Overview</a></li>
<li><a class="reference internal" href="#southbound-rest-plugin-architecture">Southbound REST Plugin Architecture</a></li>
<li><a class="reference internal" href="#configuring-southbound-rest-plugin">Configuring Southbound REST Plugin</a></li>
<li><a class="reference internal" href="#tutorial">Tutorial</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sfc-ovs-integration">SFC-OVS integration</a><ul>
<li><a class="reference internal" href="#id78">Overview</a></li>
<li><a class="reference internal" href="#sfc-ovs-architecture">SFC-OVS Architecture</a></li>
<li><a class="reference internal" href="#configuring-sfc-ovs">Configuring SFC-OVS</a></li>
<li><a class="reference internal" href="#id79">Tutorials</a><ul>
<li><a class="reference internal" href="#verifying-mapping-from-ovs-to-sff">Verifying mapping from OVS to SFF</a><ul>
<li><a class="reference internal" href="#id80">Overview</a></li>
<li><a class="reference internal" href="#prerequisities">Prerequisities</a></li>
<li><a class="reference internal" href="#id81">Instructions</a></li>
<li><a class="reference internal" href="#verification">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#verifying-mapping-from-sff-to-ovs">Verifying mapping from SFF to OVS</a><ul>
<li><a class="reference internal" href="#id82">Overview</a></li>
<li><a class="reference internal" href="#id83">Prerequisities</a></li>
<li><a class="reference internal" href="#id84">Instructions</a></li>
<li><a class="reference internal" href="#id85">Verification</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sfc-classifier-user-guide">SFC Classifier User Guide</a><ul>
<li><a class="reference internal" href="#id86">Overview</a></li>
<li><a class="reference internal" href="#openflow-classifier">OpenFlow Classifier</a><ul>
<li><a class="reference internal" href="#classifier-architecture">Classifier Architecture</a></li>
<li><a class="reference internal" href="#configuring-classifier">Configuring Classifier</a></li>
<li><a class="reference internal" href="#administering-or-managing-classifier">Administering or Managing Classifier</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iptables-classifier">Iptables Classifier</a><ul>
<li><a class="reference internal" href="#id87">Classifier Architecture</a></li>
<li><a class="reference internal" href="#id88">Configuring Classifier</a></li>
<li><a class="reference internal" href="#id89">Administering or Managing Classifier</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sfc-openflow-layer-2-renderer-user-guide">SFC OpenFlow Layer 2 Renderer User Guide</a><ul>
<li><a class="reference internal" href="#id90">Overview</a></li>
<li><a class="reference internal" href="#sfc-openflow-renderer-architecture">SFC OpenFlow Renderer Architecture</a></li>
<li><a class="reference internal" href="#sfc-openflow-switch-flow-pipeline">SFC OpenFlow Switch Flow pipeline</a><ul>
<li><a class="reference internal" href="#transport-ingress-table-detailed">Transport Ingress Table detailed</a></li>
<li><a class="reference internal" href="#path-mapper-table-detailed">Path Mapper Table detailed</a></li>
<li><a class="reference internal" href="#next-hop-table-detailed">Next Hop Table detailed</a></li>
<li><a class="reference internal" href="#transport-egress-table-detailed">Transport Egress Table detailed</a></li>
</ul>
</li>
<li><a class="reference internal" href="#administering-sfcofl2">Administering SFCOFL2</a></li>
<li><a class="reference internal" href="#sfcofl2-tutorial">SFCOFL2 Tutorial</a><ul>
<li><a class="reference internal" href="#id91">Overview</a></li>
<li><a class="reference internal" href="#id92">Prerequisites</a></li>
<li><a class="reference internal" href="#id93">Target Environment</a></li>
<li><a class="reference internal" href="#id94">Instructions</a><ul>
<li><a class="reference internal" href="#service-function-configuration">Service Function configuration</a></li>
<li><a class="reference internal" href="#service-function-forwarder-configuration">Service Function Forwarder configuration</a></li>
<li><a class="reference internal" href="#service-function-chain-configuration">Service Function Chain configuration</a></li>
<li><a class="reference internal" href="#service-function-path-configuration">Service Function Path configuration</a></li>
<li><a class="reference internal" href="#rendered-service-path-creation">Rendered Service Path creation</a></li>
<li><a class="reference internal" href="#rendered-service-path-removal">Rendered Service Path removal</a></li>
<li><a class="reference internal" href="#rendered-service-path-query">Rendered Service Path Query</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#service-function-scheduling-algorithms">Service Function Scheduling Algorithms</a><ul>
<li><a class="reference internal" href="#id95">Overview</a></li>
<li><a class="reference internal" href="#id96">Architecture</a></li>
<li><a class="reference internal" href="#select-sfs-with-scheduler">Select SFs with Scheduler</a><ul>
<li><a class="reference internal" href="#random">Random</a><ul>
<li><a class="reference internal" href="#id97">Overview</a></li>
<li><a class="reference internal" href="#id98">Prerequisites</a></li>
<li><a class="reference internal" href="#id99">Target Environment</a></li>
<li><a class="reference internal" href="#id100">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#round-robin">Round Robin</a><ul>
<li><a class="reference internal" href="#id101">Overview</a></li>
<li><a class="reference internal" href="#id102">Prerequisites</a></li>
<li><a class="reference internal" href="#id103">Target Environment</a></li>
<li><a class="reference internal" href="#id104">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-balance-algorithm">Load Balance Algorithm</a><ul>
<li><a class="reference internal" href="#id105">Overview</a></li>
<li><a class="reference internal" href="#id106">Prerequisites</a></li>
<li><a class="reference internal" href="#id107">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shortest-path-algorithm">Shortest Path Algorithm</a><ul>
<li><a class="reference internal" href="#id108">Overview</a></li>
<li><a class="reference internal" href="#id109">Prerequisites</a></li>
<li><a class="reference internal" href="#id110">Instructions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#service-function-load-balancing-user-guide">Service Function Load Balancing User Guide</a><ul>
<li><a class="reference internal" href="#id111">Overview</a></li>
<li><a class="reference internal" href="#load-balancing-architecture">Load Balancing Architecture</a></li>
<li><a class="reference internal" href="#id112">Tutorials</a><ul>
<li><a class="reference internal" href="#setup-sfc">Setup SFC</a></li>
<li><a class="reference internal" href="#create-an-algorithm">Create an algorithm</a></li>
<li><a class="reference internal" href="#verify-get-all-algorithms">Verify: get all algorithms</a></li>
<li><a class="reference internal" href="#create-a-group">Create a group</a></li>
<li><a class="reference internal" href="#verify-get-all-sfgs">Verify: get all SFG’s</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#snmp-plugin-user-guide">SNMP Plugin User Guide</a><ul>
<li><a class="reference internal" href="#installing-feature">Installing Feature</a></li>
<li><a class="reference internal" href="#northbound-apis">Northbound APIs</a><ul>
<li><a class="reference internal" href="#snmp-get">SNMP GET</a><ul>
<li><a class="reference internal" href="#post-input">POST Input</a></li>
<li><a class="reference internal" href="#post-output">POST Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#snmp-set">SNMP SET</a><ul>
<li><a class="reference internal" href="#id113">POST Input</a></li>
<li><a class="reference internal" href="#id114">POST Output</a></li>
<li><a class="reference internal" href="#errors">Errors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sxp-user-guide">SXP User Guide</a><ul>
<li><a class="reference internal" href="#id115">Overview</a></li>
<li><a class="reference internal" href="#sxp-architecture">SXP Architecture</a></li>
<li><a class="reference internal" href="#configuring-sxp">Configuring SXP</a></li>
<li><a class="reference internal" href="#administering-or-managing-sxp">Administering or Managing SXP</a><ul>
<li><a class="reference internal" href="#use-cases-for-sxp">Use cases for SXP</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tcpmd5-user-guide">TCPMD5 User Guide</a><ul>
<li><a class="reference internal" href="#id116">Overview</a></li>
<li><a class="reference internal" href="#configuring-tcpmd5-manually">Configuring TCPMD5 manually</a><ul>
<li><a class="reference internal" href="#bgp">BGP</a></li>
<li><a class="reference internal" href="#pcep">PCEP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-tcpmd5-through-restconf">Configuring TCPMD5 through RESTCONF</a><ul>
<li><a class="reference internal" href="#id117">BGP</a></li>
<li><a class="reference internal" href="#id118">PCEP</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tsdr-user-guide">TSDR User Guide</a><ul>
<li><a class="reference internal" href="#id119">Overview</a></li>
<li><a class="reference internal" href="#tsdr-architecture">TSDR Architecture</a></li>
<li><a class="reference internal" href="#configuring-tsdr-data-stores">Configuring TSDR Data Stores</a><ul>
<li><a class="reference internal" href="#to-configure-hsqldb-data-store">To Configure HSQLDB Data Store</a></li>
<li><a class="reference internal" href="#to-configure-hbase-data-store">To Configure HBase Data Store</a></li>
<li><a class="reference internal" href="#to-configure-cassandra-data-store">To Configure Cassandra Data Store</a></li>
</ul>
</li>
<li><a class="reference internal" href="#administering-or-managing-tsdr-data-stores">Administering or Managing TSDR Data Stores</a><ul>
<li><a class="reference internal" href="#to-administer-hsqldb-data-store">To Administer HSQLDB Data Store</a></li>
<li><a class="reference internal" href="#to-administer-hbase-data-store">To Administer HBase Data Store</a></li>
<li><a class="reference internal" href="#to-administer-cassandra-data-store">To Administer Cassandra Data Store</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-tsdr-data-collectors">Installing TSDR Data Collectors</a></li>
<li><a class="reference internal" href="#configuring-tsdr-data-collectors">Configuring TSDR Data Collectors</a><ul>
<li><a class="reference internal" href="#polling-interval-configuration-for-snmp-collector-and-openflow-stats-collector">Polling interval configuration for SNMP Collector and OpenFlow Stats Collector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#querying-tsdr-from-rest-apis">Querying TSDR from REST APIs</a></li>
<li><a class="reference internal" href="#grafana-integration-with-tsdr">Grafana integration with TSDR</a></li>
<li><a class="reference internal" href="#purging-service-configuration">Purging Service configuration</a></li>
<li><a class="reference internal" href="#how-to-use-tsdr-to-collect-store-and-view-openflow-interface-statistics">How to use TSDR to collect, store, and view OpenFlow Interface Statistics</a><ul>
<li><a class="reference internal" href="#id120">Overview</a></li>
<li><a class="reference internal" href="#id121">Prerequisites</a></li>
<li><a class="reference internal" href="#id122">Target Environment</a></li>
<li><a class="reference internal" href="#id123">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id124">Troubleshooting</a><ul>
<li><a class="reference internal" href="#karaf-logs">Karaf logs</a></li>
<li><a class="reference internal" href="#hbase-and-cassandra-logs">HBase and Cassandra logs</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ttp-cli-tools-user-guide">TTP CLI Tools User Guide</a><ul>
<li><a class="reference internal" href="#id125">Overview</a></li>
<li><a class="reference internal" href="#ttp-cli-tools-architecture">TTP CLI Tools Architecture</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unified-secure-channel">Unified Secure Channel</a><ul>
<li><a class="reference internal" href="#id126">Overview</a></li>
<li><a class="reference internal" href="#usc-channel-architecture">USC Channel Architecture</a></li>
<li><a class="reference internal" href="#installing-usc-channel">Installing USC Channel</a></li>
<li><a class="reference internal" href="#configuring-usc-channel">Configuring USC Channel</a></li>
<li><a class="reference internal" href="#administering-or-managing-usc-channel">Administering or Managing USC Channel</a></li>
<li><a class="reference internal" href="#id127">Tutorials</a><ul>
<li><a class="reference internal" href="#viewing-usc-channel">Viewing USC Channel</a><ul>
<li><a class="reference internal" href="#id128">Overview</a></li>
<li><a class="reference internal" href="#id129">Prerequisites</a></li>
<li><a class="reference internal" href="#id130">Instructions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#virtual-tenant-network-vtn">Virtual Tenant Network (VTN)</a><ul>
<li><a class="reference internal" href="#vtn-overview">VTN Overview</a><ul>
<li><a class="reference internal" href="#vtn-manager">VTN Manager</a><ul>
<li><a class="reference internal" href="#features-overview">Features Overview</a></li>
<li><a class="reference internal" href="#rest-api">REST API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vtn-coordinator">VTN Coordinator</a></li>
<li><a class="reference internal" href="#network-virtualization-function">Network Virtualization Function</a></li>
<li><a class="reference internal" href="#virtual-network-construction">Virtual Network Construction</a></li>
<li><a class="reference internal" href="#mapping-of-physical-network-resources">Mapping of Physical Network Resources</a></li>
<li><a class="reference internal" href="#vbridge-functions">vBridge Functions</a></li>
<li><a class="reference internal" href="#vrouter-functions">vRouter Functions</a></li>
<li><a class="reference internal" href="#flow-filter-functions">Flow Filter Functions</a></li>
<li><a class="reference internal" href="#multiple-sdn-controller-coordination">Multiple SDN Controller Coordination</a></li>
<li><a class="reference internal" href="#coordination-between-openflow-network-and-l2-l3-network">Coordination between OpenFlow Network and L2/L3 Network</a></li>
<li><a class="reference internal" href="#virtual-tenant-network-vtn-api">Virtual Tenant Network (VTN) API</a><ul>
<li><a class="reference internal" href="#function-outline">Function Outline</a></li>
<li><a class="reference internal" href="#example-usage">Example usage</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#vtn-openstack-configuration">VTN OpenStack Configuration</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#id131">Components</a></li>
<li><a class="reference internal" href="#id132">Configuration</a></li>
<li><a class="reference internal" href="#opendaylight-settings-and-execution">OpenDaylight Settings and Execution</a><ul>
<li><a class="reference internal" href="#vtn-ini">vtn.ini</a></li>
</ul>
</li>
<li><a class="reference internal" href="#start-opendaylight">Start OpenDaylight</a></li>
<li><a class="reference internal" href="#devstack-setup">Devstack Setup</a><ul>
<li><a class="reference internal" href="#vtn-devstack-script">VTN Devstack Script</a><ul>
<li><a class="reference internal" href="#devstack-control">DevStack Control</a></li>
<li><a class="reference internal" href="#devstack-compute">DevStack Compute</a></li>
<li><a class="reference internal" href="#devstack-kilo-liberty-control-node">Devstack Kilo_Liberty Control Node</a></li>
<li><a class="reference internal" href="#devstack-kilo-liberty-compute-node">Devstack Kilo_Liberty Compute Node</a></li>
</ul>
</li>
<li><a class="reference internal" href="#get-devstack-all-nodes">Get Devstack (All nodes)</a></li>
<li><a class="reference internal" href="#stack-control-node">Stack Control Node</a><ul>
<li><a class="reference internal" href="#verify-control-node-stacking">Verify Control Node stacking</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stack-compute-node">Stack Compute Node</a><ul>
<li><a class="reference internal" href="#verify-compute-node-stacking">Verify Compute Node Stacking</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-verifications">Additional Verifications</a></li>
<li><a class="reference internal" href="#create-vm-from-devstack-horizon-gui">Create VM from Devstack Horizon GUI</a></li>
<li><a class="reference internal" href="#verification-of-control-and-compute-node-after-vm-creation">Verification of Control and Compute Node after VM creation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-dlux-gui">Using the DLUX GUI</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#vtn-usage-examples">VTN Usage Examples</a><ul>
<li><a class="reference internal" href="#how-to-configure-l2-network-with-single-controller">How to configure L2 Network with Single Controller</a><ul>
<li><a class="reference internal" href="#id133">Overview</a></li>
<li><a class="reference internal" href="#id134">Requirements</a></li>
<li><a class="reference internal" href="#id135">Configuration</a></li>
<li><a class="reference internal" href="#id136">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-configure-l2-network-with-multiple-controllers">How to configure L2 Network with Multiple Controllers</a><ul>
<li><a class="reference internal" href="#id137">Requirements</a></li>
<li><a class="reference internal" href="#id138">Configuration</a></li>
<li><a class="reference internal" href="#id139">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-test-vlan-map-in-mininet-environment">How To Test Vlan-Map In Mininet Environment</a><ul>
<li><a class="reference internal" href="#id140">Overview</a></li>
<li><a class="reference internal" href="#id141">Requirements</a></li>
<li><a class="reference internal" href="#mininet-script">Mininet Script</a></li>
<li><a class="reference internal" href="#id142">Configuration</a></li>
<li><a class="reference internal" href="#id143">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-view-specific-vtn-station-information">How To View Specific VTN Station Information.</a><ul>
<li><a class="reference internal" href="#id144">Requirement</a></li>
<li><a class="reference internal" href="#id145">Configuration</a></li>
<li><a class="reference internal" href="#id146">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-view-dataflows-in-vtn">How To View Dataflows in VTN</a><ul>
<li><a class="reference internal" href="#id147">Configuration</a></li>
<li><a class="reference internal" href="#id148">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-configure-flow-filters-using-vtn">How To Configure Flow Filters Using VTN</a><ul>
<li><a class="reference internal" href="#id149">Overview</a></li>
<li><a class="reference internal" href="#id150">Requirements</a></li>
<li><a class="reference internal" href="#id151">Configuration</a></li>
<li><a class="reference internal" href="#flow-filter-demonstration-with-drop-action-type">Flow filter demonstration with DROP action-type</a></li>
<li><a class="reference internal" href="#id152">Verification</a></li>
<li><a class="reference internal" href="#flow-filter-demonstration-with-pass-action-type">Flow filter demonstration with PASS action-type</a></li>
<li><a class="reference internal" href="#id153">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use-vtn-to-make-packets-take-different-paths">How To Use VTN To Make Packets Take Different Paths</a><ul>
<li><a class="reference internal" href="#id154">Requirement</a></li>
<li><a class="reference internal" href="#id155">Configuration</a></li>
<li><a class="reference internal" href="#id156">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vtn-coordinator-troubleshooting-howto">VTN Coordinator(Troubleshooting HowTo)</a><ul>
<li><a class="reference internal" href="#id157">Overview</a></li>
<li><a class="reference internal" href="#list-of-installation-troubleshooting-how-tos">List of installation Troubleshooting How to’s</a><ul>
<li><a class="reference internal" href="#after-setting-up-the-apache-tomcat-server-what-are-the-aspects-that-should-be-checked">After setting up the apache tomcat server, what are the aspects that should be checked.</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#support-for-microsoft-scvmm-2012-r2-with-odl-vtn">Support for Microsoft SCVMM 2012 R2 with ODL VTN</a><ul>
<li><a class="reference internal" href="#id158">Introduction</a></li>
<li><a class="reference internal" href="#id159">VTN Coordinator</a><ul>
<li><a class="reference internal" href="#installing-https-in-vtn-coordinator">Installing HTTPS in VTN Coordinator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prerequisites-to-create-network-service-in-scvmm-machine-please-follow-the-below-steps">Prerequisites to create Network Service in SCVMM machine, Please follow the below steps</a></li>
<li><a class="reference internal" href="#system-center-virtual-machine-manager-scvmm">System Center Virtual Machine Manager (SCVMM)</a><ul>
<li><a class="reference internal" href="#failover-clustering">Failover Clustering</a></li>
<li><a class="reference internal" href="#live-migration">Live Migration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scvmm-user-guide">SCVMM User Guide</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#netconf-user-guide">NETCONF User Guide</a><ul>
<li><a class="reference internal" href="#id160">Overview</a></li>
<li><a class="reference internal" href="#southbound-netconf-connector">Southbound (netconf-connector)</a><ul>
<li><a class="reference internal" href="#netconf-connector-configuration">Netconf-connector configuration</a><ul>
<li><a class="reference internal" href="#default-configuration">Default configuration</a></li>
<li><a class="reference internal" href="#spawning-additional-netconf-connectors-while-the-controller-is-running">Spawning additional netconf-connectors while the controller is running</a></li>
<li><a class="reference internal" href="#connecting-to-a-device-not-supporting-netconf-monitoring">Connecting to a device not supporting NETCONF monitoring</a></li>
<li><a class="reference internal" href="#reconfiguring-netconf-connector-while-the-controller-is-running">Reconfiguring Netconf-Connector While the Controller is Running</a></li>
<li><a class="reference internal" href="#destroying-netconf-connector-while-the-controller-is-running">Destroying Netconf-Connector While the Controller is Running</a></li>
</ul>
</li>
<li><a class="reference internal" href="#netconf-connector-utilisation">Netconf-connector utilisation</a><ul>
<li><a class="reference internal" href="#reading-data-from-the-device">Reading data from the device</a></li>
<li><a class="reference internal" href="#writing-configuration-data-to-the-device">Writing configuration data to the device</a></li>
<li><a class="reference internal" href="#invoking-custom-rpc">Invoking custom RPC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#netconf-connector-netopeer">Netconf-connector + Netopeer</a><ul>
<li><a class="reference internal" href="#netopeer-installation">Netopeer installation</a></li>
<li><a class="reference internal" href="#mounting-netopeer-netconf-server">Mounting netopeer NETCONF server</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#northbound-netconf-servers">Northbound (NETCONF servers)</a><ul>
<li><a class="reference internal" href="#netconf-server-for-config-subsystem">NETCONF server for config-subsystem</a></li>
<li><a class="reference internal" href="#netconf-server-for-md-sal">NETCONF server for MD-SAL</a><ul>
<li><a class="reference internal" href="#id161">Configuration</a></li>
<li><a class="reference internal" href="#verifying-md-sals-netconf-server">Verifying MD-SAL’s NETCONF server</a></li>
<li><a class="reference internal" href="#mounting-the-md-sals-netconf-server">Mounting the MD-SAL’s NETCONF server</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#netconf-testtool">NETCONF testtool</a><ul>
<li><a class="reference internal" href="#netconf-device-simulator">NETCONF device simulator</a></li>
<li><a class="reference internal" href="#netconf-stress-performance-measuring-tool">NETCONF stress/performance measuring tool</a></li>
<li><a class="reference internal" href="#restconf-stress-performance-measuring-tool">RESTCONF stress-performance measuring tool</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#yang-push">YANG-PUSH</a><ul>
<li><a class="reference internal" href="#id162">Overview</a><ul>
<li><a class="reference internal" href="#yang-push-capabilities-available">YANG-PUSH capabilities available</a></li>
<li><a class="reference internal" href="#future-yang-push-capabilities">Future YANG-PUSH capabilities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#yang-push-architecture">YANG-PUSH Architecture</a></li>
<li><a class="reference internal" href="#yang-push-catalog">YANG-PUSH Catalog</a><ul>
<li><a class="reference internal" href="#configuring-yang-push-catalog">Configuring YANG-PUSH Catalog</a></li>
<li><a class="reference internal" href="#administering-yang-push-catalog">Administering YANG-PUSH Catalog</a></li>
</ul>
</li>
<li><a class="reference internal" href="#yang-push-workload-manager">YANG-PUSH Workload Manager</a></li>
<li><a class="reference internal" href="#configuring-yang-push-workload-manager">Configuring YANG-PUSH Workload Manager</a></li>
<li><a class="reference internal" href="#administering-yang-push-workload-manager">Administering YANG-PUSH Workload Manager</a></li>
<li><a class="reference internal" href="#id163">Tutorials</a><ul>
<li><a class="reference internal" href="#using-yang-push-catalog">Using YANG-PUSH Catalog</a><ul>
<li><a class="reference internal" href="#id164">Overview</a></li>
<li><a class="reference internal" href="#id165">Prerequisites</a></li>
<li><a class="reference internal" href="#id166">Target Environment</a></li>
<li><a class="reference internal" href="#id167">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-yang-push-workload-manager">Using YANG-PUSH Workload Manager</a><ul>
<li><a class="reference internal" href="#id168">Overview</a></li>
<li><a class="reference internal" href="#id169">Prerequisites</a></li>
<li><a class="reference internal" href="#id170">Target Environment</a></li>
<li><a class="reference internal" href="#id171">Instructions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../howto-openstack/index.html" title="Previous Chapter: OpenDaylight and OpenStack"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; OpenDaylight ...</span>
    </a>
  </li>
  <li>
    <a href="../developer-guide/index.html" title="Next Chapter: OpenDaylight Developer Guide"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">OpenDaylight ... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/user-guide/index.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="opendaylight-user-guide">
<h1>OpenDaylight User Guide<a class="headerlink" href="#opendaylight-user-guide" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">OpenDaylight Community <a class="reference external" href="mailto:documentation&#37;&#52;&#48;opendaylight&#46;org">documentation<span>&#64;</span>opendaylight<span>&#46;</span>org</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Date:</th><td class="field-body">2014-07-16</td>
</tr>
</tbody>
</table>
<p>This first part of the user guide covers the basic user operations of
the OpenDaylight Release using the generic base functionality.</p>
<div class="section" id="opendaylight-controller-overview">
<h2>OpenDaylight Controller Overview<a class="headerlink" href="#opendaylight-controller-overview" title="Permalink to this headline">¶</a></h2>
<p>The OpenDaylight controller is JVM software and can be run from any
operating system and hardware as long as it supports Java. The
controller is an implementation of the Software Defined Network (SDN)
concept and makes use of the following tools:</p>
<ul class="simple">
<li><strong>Maven</strong>: OpenDaylight uses Maven for easier build automation. Maven
uses pom.xml (Project Object Model) to script the dependencies
between bundle and also to describe what bundles to load and start.</li>
<li><strong>OSGi</strong>: This framework is the back-end of OpenDaylight as it allows
dynamically loading bundles and packages JAR files, and binding
bundles together for exchanging information.</li>
<li><strong>JAVA interfaces</strong>: Java interfaces are used for event listening,
specifications, and forming patterns. This is the main way in which
specific bundles implement call-back functions for events and also to
indicate awareness of specific state.</li>
<li><strong>REST APIs</strong>: These are northbound APIs such as topology manager,
host tracker, flow programmer, static routing, and so on.</li>
</ul>
<p>The controller exposes open northbound APIs which are used by
applications. The OSGi framework and bidirectional REST are supported
for the northbound APIs. The OSGi framework is used for applications
that run in the same address space as the controller while the REST
(web-based) API is used for applications that do not run in the same
address space (or even the same system) as the controller. The business
logic and algorithms reside in the applications. These applications use
the controller to gather network intelligence, run its algorithm to do
analytics, and then orchestrate the new rules throughout the network. On
the southbound, multiple protocols are supported as plugins, e.g.
OpenFlow 1.0, OpenFlow 1.3, BGP-LS, and so on. The OpenDaylight
controller starts with an OpenFlow 1.0 southbound plugin. Other
OpenDaylight contributors begin adding to the controller code. These
modules are linked dynamically into a <strong>Service Abstraction Layer</strong>
(SAL).</p>
<p>The SAL exposes services to which the modules north of it are written.
The SAL figures out how to fulfill the requested service irrespective of
the underlying protocol used between the controller and the network
devices. This provides investment protection to the applications as
OpenFlow and other protocols evolve over time. For the controller to
control devices in its domain, it needs to know about the devices, their
capabilities, reachability, and so on. This information is stored and
managed by the <strong>Topology Manager</strong>. The other components like ARP
handler, Host Tracker, Device Manager, and Switch Manager help in
generating the topology database for the Topology Manager.</p>
<p>For a more detailed overview of the OpenDaylight controller, see the
<em>OpenDaylight Developer Guide</em>.</p>
</div>
<div class="section" id="using-the-opendaylight-user-interface-dlux">
<h2>Using the OpenDaylight User Interface (DLUX)<a class="headerlink" href="#using-the-opendaylight-user-interface-dlux" title="Permalink to this headline">¶</a></h2>
<p>This section introduces you to the OpenDaylight User Experience (DLUX)
application.</p>
<div class="section" id="getting-started-with-dlux">
<h3>Getting Started with DLUX<a class="headerlink" href="#getting-started-with-dlux" title="Permalink to this headline">¶</a></h3>
<p>DLUX provides a number of different Karaf features, which you can enable
and disable separately. In Beryllum they are: . odl-dlux-core .
odl-dlux-node . odl-dlux-yangui . odl-dlux-yangvisualizer</p>
</div>
<div class="section" id="logging-in">
<h3>Logging In<a class="headerlink" href="#logging-in" title="Permalink to this headline">¶</a></h3>
<p>To log in to DLUX, after installing the application:</p>
<ol class="arabic">
<li><p class="first">Open a browser and enter the login URL
<a href="#id260"><span class="problematic" id="id261">`http://&lt;your-karaf-ip&gt;:8181/index.html &lt;http://&lt;your-karaf-ip&gt;:8181/index.html&gt;`__</span></a>
in your browser (Chrome is recommended).</p>
</li>
<li><p class="first">Login to the application with your username and password credentials.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>OpenDaylight’s default credentials are <em>admin</em> for both the username
and password.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="working-with-dlux">
<h3>Working with DLUX<a class="headerlink" href="#working-with-dlux" title="Permalink to this headline">¶</a></h3>
<p>After you login to DLUX, if you enable only odl-dlux-core feature, you
will see only topology application available in the left pane.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>To make sure topology displays all the details, enable the
odl-l2switch-switch feature in Karaf.</p>
</div></blockquote>
<p>DLUX has other applications such as node, yang UI and those apps won’t
show up, until you enable their features odl-dlux-node and
odl-dlux-yangui respectively in the Karaf distribution.</p>
<div class="figure" id="id172">
<img alt="DLUX Modules" src="../_images/dlux-login1.png" />
<p class="caption"><span class="caption-text">DLUX Modules</span></p>
<div class="legend">
<blockquote>
<div><p><strong>Note</strong></p>
<p>If you install your application in dlux, they will also show up on
the left hand navigation after browser page refresh.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="viewing-network-statistics">
<h3>Viewing Network Statistics<a class="headerlink" href="#viewing-network-statistics" title="Permalink to this headline">¶</a></h3>
<p>The <strong>Nodes</strong> module on the left pane enables you to view the network
statistics and port information for the switches in the network.</p>
<p>To use the <strong>Nodes</strong> module:</p>
<ol class="arabic simple">
<li>Select <strong>Nodes</strong> on the left pane. The right pane displays atable
that lists all the nodes, node connectors and the statistics.</li>
<li>Enter a node ID in the <strong>Search Nodes</strong> tab to search by node
connectors.</li>
<li>Click on the <strong>Node Connector</strong> number to view details such as port
ID, port name, number of ports per switch, MAC Address, and so on.</li>
<li>Click <strong>Flows</strong> in the Statistics column to view Flow Table
Statistics for the particular node like table ID, packet match,
active flows and so on.</li>
<li>Click <strong>Node Connectors</strong> to view Node Connector Statistics for the
particular node ID.</li>
</ol>
</div>
<div class="section" id="viewing-network-topology">
<h3>Viewing Network Topology<a class="headerlink" href="#viewing-network-topology" title="Permalink to this headline">¶</a></h3>
<p>The Topology tab displays a graphical representation of network topology
created.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>DLUX does not allow for editing or adding topology information. The
topology is generated and edited in other modules, e.g., the
OpenFlow plugin. OpenDaylight stores this information in the MD-SAL
datastore where DLUX can read and display it.</p>
</div></blockquote>
<p>To view network topology:</p>
<ol class="arabic simple">
<li>Select <strong>Topology</strong> on the left pane. You will view the graphical
representation on the right pane. In the diagram blue boxes represent
the switches, the black represents the hosts available, and lines
represents how the switches and hosts are connected.</li>
<li>Hover your mouse on hosts, links, or switches to view source and
destination ports.</li>
<li>Zoom in and zoom out using mouse scroll to verify topology for larger
topologies.</li>
</ol>
<div class="figure" id="id173">
<img alt="Topology Module" src="../_images/dlux-topology1.png" />
<p class="caption"><span class="caption-text">Topology Module</span></p>
</div>
</div>
<div class="section" id="interacting-with-the-yang-based-md-sal-datastore">
<h3>Interacting with the YANG-based MD-SAL datastore<a class="headerlink" href="#interacting-with-the-yang-based-md-sal-datastore" title="Permalink to this headline">¶</a></h3>
<p>The <strong>Yang UI</strong> module enables you to interact with the YANG-based
MD-SAL datastore. For more information about YANG and how it interacts
with the MD-SAL datastore, see the <em>Controller</em> and <em>YANG Tools</em> section
of the <em>OpenDaylight Developer Guide</em>.</p>
<div class="figure" id="id174">
<img alt="Yang UI" src="../_images/dlux-yang-ui-screen1.png" />
<p class="caption"><span class="caption-text">Yang UI</span></p>
</div>
<p>To use Yang UI:</p>
<ol class="arabic">
<li><p class="first">Select <strong>Yang UI</strong> on the left pane. The right pane is divided in two
parts.</p>
</li>
<li><p class="first">The top part displays a tree of APIs, subAPIs, and buttons to call
possible functions (GET, POST, PUT, and DELETE).</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Not every subAPI can call every function. For example, subAPIs in
the <em>operational</em> store have GET functionality only.</p>
</div></blockquote>
<p>Inputs can be filled from OpenDaylight when existing data from
OpenDaylight is displayed or can be filled by user on the page and
sent to OpenDaylight.</p>
<p>Buttons under the API tree are variable. It depends on subAPI
specifications. Common buttons are:</p>
<ul>
<li><p class="first">GET to get data from OpenDaylight,</p>
</li>
<li><p class="first">PUT and POST for sending data to OpenDaylight for saving</p>
</li>
<li><p class="first">DELETE for sending data to OpenDaylight for deleting.</p>
<p>You must specify the xpath for all these operations. This path is
displayed in the same row before buttons and it may include text
inputs for specific path element identifiers.</p>
<div class="figure" id="id175">
<img alt="Yang API Specification" src="../_images/dlux-yang-api-specification1.png" />
<p class="caption"><span class="caption-text">Yang API Specification</span></p>
</div>
</li>
</ul>
</li>
<li><p class="first">The bottom part of the right pane displays inputs according to the
chosen subAPI.</p>
<ul>
<li><p class="first">Lists are handled as a special case. For example, a device can
store multiple flows. In this case &#8220;flow&#8221; is name of the list and
every list element is identified by a unique key value. Elements
of a list can, in turn, contain other lists.</p>
</li>
<li><p class="first">In Yang UI, each list element is rendered with the name of the
list it belongs to, its key, its value, and a button for removing
it from the list.</p>
<div class="figure" id="id176">
<img alt="Yang UI API Specification" src="../_images/dlux-yang-sub-api-screen1.png" />
<p class="caption"><span class="caption-text">Yang UI API Specification</span></p>
</div>
</li>
</ul>
</li>
<li><p class="first">After filling in the relevant inputs, click the <strong>Show Preview</strong>
button under the API tree to display request that will be sent to
OpenDaylight. A pane is displayed on the right side with text of
request when some input is filled.</p>
</li>
</ol>
<div class="section" id="displaying-topology-on-the-yang-ui">
<h4>Displaying Topology on the <strong>Yang UI</strong><a class="headerlink" href="#displaying-topology-on-the-yang-ui" title="Permalink to this headline">¶</a></h4>
<p>To display topology:</p>
<ol class="arabic simple">
<li>Select subAPI network-topology &lt;topology revision number&gt; == &gt;
operational == &gt; network-topology.</li>
<li>Get data from OpenDaylight by clicking on the &#8220;GET&#8221; button.</li>
<li>Click <strong>Display Topology</strong>.</li>
</ol>
<div class="figure" id="id177">
<img alt="DLUX Yang Topology" src="../_images/dlux-yang-topology1.png" />
<p class="caption"><span class="caption-text">DLUX Yang Topology</span></p>
</div>
</div>
<div class="section" id="configuring-list-elements-on-the-yang-ui">
<h4>Configuring List Elements on the <strong>Yang UI</strong><a class="headerlink" href="#configuring-list-elements-on-the-yang-ui" title="Permalink to this headline">¶</a></h4>
<p>Lists in Yang UI are displayed as trees. To expand or collapse a list,
click the arrow before name of the list. To configure list elements in
Yang UI:</p>
<ol class="arabic">
<li><p class="first">To add a new list element with empty inputs use the plus icon-button
<strong>+</strong> that is provided after list name.</p>
</li>
<li><p class="first">To remove several list elements, use the <strong>X</strong> button that is
provided after every list element.</p>
<div class="figure" id="id178">
<img alt="DLUX List Elements" src="../_images/dlux-yang-list-elements1.png" />
<p class="caption"><span class="caption-text">DLUX List Elements</span></p>
</div>
</li>
<li><p class="first">In the YANG-based data store all elements of a list must have a
unique key. If you try to assign two or more elements the same key, a
warning icon <strong>!</strong> is displayed near their name buttons.</p>
<div class="figure" id="id179">
<img alt="DLUX List Warnings" src="../_images/dlux-yang-list-warning1.png" />
<p class="caption"><span class="caption-text">DLUX List Warnings</span></p>
</div>
</li>
<li><p class="first">When the list contains at least one list element, after the <strong>+</strong>
icon, there are buttons to select each individual list element. You
can choose one of them by clicking on it. In addition, to the right
of the list name, there is a button which will display a vertically
scrollable pane with all the list elements.</p>
<div class="figure" id="id180">
<img alt="DLUX List Button1" src="../_images/dlux-yang-list-button11.png" />
<p class="caption"><span class="caption-text">DLUX List Button1</span></p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="running-xsql-console-commands-and-queries">
<h2>Running XSQL Console Commands and Queries<a class="headerlink" href="#running-xsql-console-commands-and-queries" title="Permalink to this headline">¶</a></h2>
<div class="section" id="xsql-overview">
<h3>XSQL Overview<a class="headerlink" href="#xsql-overview" title="Permalink to this headline">¶</a></h3>
<p>XSQL is an XML-based query language that describes simple stored
procedures which parse XML data, query or update database tables, and
compose XML output. XSQL allows you to query tree models like a
sequential database. For example, you could run a query that lists all
of the ports configured on a particular module and their attributes.</p>
<p>The following sections cover the XSQL installation process, supported
XSQL commands, and the way to structure queries.</p>
</div>
<div class="section" id="installing-xsql">
<h3>Installing XSQL<a class="headerlink" href="#installing-xsql" title="Permalink to this headline">¶</a></h3>
<p>To run commands from the XSQL console, you must first install XSQL on
your system:</p>
<ol class="arabic">
<li><p class="first">Navigate to the directory in which you unzipped OpenDaylight</p>
</li>
<li><p class="first">Start Karaf:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="nb">bin</span><span class="o">/</span><span class="n">karaf</span>
</pre></div>
</div>
</li>
<li><p class="first">Install XSQL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">mdsal</span><span class="o">-</span><span class="n">xsql</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="xsql-console-commands">
<h3>XSQL Console Commands<a class="headerlink" href="#xsql-console-commands" title="Permalink to this headline">¶</a></h3>
<p>To enter a command in the XSQL console, structure the command as
follows: <strong>odl:xsql</strong> <em>&lt;XSQL command&gt;</em></p>
<p>The following table describes the commands supported in this
OpenDaylight release.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Command</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>r</strong></td>
<td>Repeats the last command you executed.</td>
</tr>
<tr class="row-odd"><td><strong>list vtables</strong></td>
<td>Lists the schema node containers that are
currently installed. Whenever an OpenDaylight
module is installed, its YANG model is placed in
the schema context. At that point, the XSQL
receives a notification, confirms that the
module’s YANG model resides in the schema context
and then maps the model to XSQL by setting up the
necessary vtables and vfields. This command is
useful when you need to determine vtable
information for a query.</td>
</tr>
<tr class="row-even"><td><strong>list vfields</strong>
<em>&lt;vtable name&gt;</em></td>
<td>Lists the vfields present in a specific vtable.
This command is useful when you need to determine
vfields information for a query.</td>
</tr>
<tr class="row-odd"><td><strong>jdbc</strong> <em>&lt;ip
address&gt;</em></td>
<td>When the ODL server is behind a firewall, and the
JDBC client cannot connect to the JDBC server, run
this command to start the client as a server and
establish a connection.</td>
</tr>
<tr class="row-even"><td><strong>exit</strong></td>
<td>Closes the console.</td>
</tr>
<tr class="row-odd"><td><strong>tocsv</strong></td>
<td>Enables or disables the forwarding of query output
as a .csv file.</td>
</tr>
<tr class="row-even"><td><strong>filename</strong>
<em>&lt;filename&gt;</em></td>
<td>Specifies the .tocsv file to which the query data
is exported. If you do not specify a value for
this option when the toccsv option is enabled, the
filename for the query data file is generated
automatically.</td>
</tr>
</tbody>
</table>
<p>Table: Supported XSQL Console Commands</p>
</div>
<div class="section" id="xsql-queries">
<h3>XSQL Queries<a class="headerlink" href="#xsql-queries" title="Permalink to this headline">¶</a></h3>
<p>You can run a query to extract information that meets the criteria you
specify using the information provided by the <strong>list vtables</strong> and
<strong>list vfields</strong> <em>&lt;vtable name&gt;</em> commands. Any query you run should be
structured as follows:</p>
<p><strong>select</strong> <em>&lt;vfields you want to search for, separated by a comma and a
space&gt;</em> <strong>from</strong> <em>&lt;vtables you want to search in, separated by a comma
and a space&gt;</em> <strong>where</strong> <em>&lt;criteria&gt;</em> <strong>***&lt;criteria operator&gt;**</strong>;*</p>
<p>For example, if you want to search the nodes/node ID field in the
nodes/node-connector table and find every instance of the
Hardware-Address object that contains <em>BA</em> in its text string, enter the
following query:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">.</span><span class="n">ID</span> <span class="kn">from</span> <span class="nn">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span> <span class="n">where</span> <span class="n">Hardware</span><span class="o">-</span><span class="n">Address</span> <span class="n">like</span> <span class="s1">&#39;%BA%&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The following criteria operators are supported:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Criteria
Operators</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>=</strong></td>
<td>Lists results that equal the value you specify.</td>
</tr>
<tr class="row-odd"><td><strong>!=</strong></td>
<td>Lists results that do not equal the value you specify.</td>
</tr>
<tr class="row-even"><td><strong>like</strong></td>
<td>Lists results that contain the substring you specify. For
example, if you specify <strong>like %BC%</strong>, every string that
contains that particular substring is displayed.</td>
</tr>
<tr class="row-odd"><td><strong>&lt;</strong></td>
<td>Lists results that are less than the value you specify.</td>
</tr>
<tr class="row-even"><td><strong>&gt;</strong></td>
<td>Lists results that are more than the value you specify.</td>
</tr>
<tr class="row-odd"><td><strong>and</strong></td>
<td>Lists results that match both values you specify.</td>
</tr>
<tr class="row-even"><td><strong>or</strong></td>
<td>Lists results that match either of the two values you
specify.</td>
</tr>
<tr class="row-odd"><td><strong>&gt;=</strong></td>
<td>Lists results that are more than or equal to the value
you specify.</td>
</tr>
<tr class="row-even"><td><strong>⇐</strong></td>
<td>Lists results that are less than or equal to the value
you specify.</td>
</tr>
<tr class="row-odd"><td><strong>is null</strong></td>
<td>Lists results for which no value is assigned.</td>
</tr>
<tr class="row-even"><td><strong>not null</strong></td>
<td>Lists results for which any value is assigned.</td>
</tr>
<tr class="row-odd"><td><strong>skip</strong></td>
<td>Use this operator to list matching results from a child
node, even if its parent node does not meet the specified
criteria. See the following example for more information.</td>
</tr>
</tbody>
</table>
<p>Table: Supported XSQL Query Criteria Operators</p>
<div class="section" id="example-skip-criteria-operator">
<h4>Example: Skip Criteria Operator<a class="headerlink" href="#example-skip-criteria-operator" title="Permalink to this headline">¶</a></h4>
<p>If you are looking at the following structure and want to determine all
of the ports that belong to a YY type module:</p>
<ul class="simple">
<li>Network Element 1<ul>
<li>Module 1, Type XX<ul>
<li>Module 1.1, Type YY<ul>
<li>Port 1</li>
<li>Port 2</li>
</ul>
</li>
</ul>
</li>
<li>Module 2, Type YY<ul>
<li>Port 1</li>
<li>Port 2</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>If you specify <strong>Module.Type=*YY*</strong> in your query criteria, the ports
associated with module 1.1 will not be returned since its parent module
is type XX. Instead, enter <strong>Module.Type=*YY* or skip
Module!=*YY*</strong>. This tells XSQL to disregard any parent module data
that does not meet the type YY criteria and collect results for any
matching child modules. In this example, you are instructing the query
to skip module 1 and collect the relevant data from module 1.1.</p>
</div>
</div>
</div>
<div class="section" id="setting-up-clustering">
<h2>Setting Up Clustering<a class="headerlink" href="#setting-up-clustering" title="Permalink to this headline">¶</a></h2>
<div class="section" id="clustering-overview">
<h3>Clustering Overview<a class="headerlink" href="#clustering-overview" title="Permalink to this headline">¶</a></h3>
<p>Clustering is a mechanism that enables multiple processes and programs
to work together as one entity. For example, when you search for
something on google.com, it may seem like your search request is
processed by only one web server. In reality, your search request is
processed by may web servers connected in a cluster. Similarly, you can
have multiple instances of OpenDaylight working together as one entity.</p>
<p>Advantages of clustering are:</p>
<ul class="simple">
<li>Scaling: If you have multiple instances of OpenDaylight running, you
can potentially do more work and store more data than you could with
only one instance. You can also break up your data into smaller
chunks (shards) and either distribute that data across the cluster or
perform certain operations on certain members of the cluster.</li>
<li>High Availability: If you have multiple instances of OpenDaylight
running and one of them crashes, you will still have the other
instances working and available.</li>
<li>Data Persistence: You will not lose any data stored in OpenDaylight
after a manual restart or a crash.</li>
</ul>
<p>The following sections describe how to set up clustering on both
individual and multiple OpenDaylight instances.</p>
</div>
<div class="section" id="single-node-clustering">
<h3>Single Node Clustering<a class="headerlink" href="#single-node-clustering" title="Permalink to this headline">¶</a></h3>
<p>To enable clustering on a single instance of OpenDaylight, perform the
following steps:</p>
<ol class="arabic">
<li><p class="first">Download, unzip, and run the OpenDaylight distribution</p>
</li>
<li><p class="first">Install the clustering feature:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">mdsal</span><span class="o">-</span><span class="n">clustering</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">This</span> <span class="n">will</span> <span class="n">enabled</span> <span class="n">the</span> <span class="n">cluster</span><span class="o">-</span><span class="n">ready</span> <span class="n">version</span> <span class="n">of</span> <span class="n">the</span> <span class="n">MD</span><span class="o">-</span><span class="n">SAL</span> <span class="n">data</span>
<span class="n">store</span><span class="p">,</span> <span class="n">but</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">actually</span> <span class="n">create</span> <span class="n">a</span> <span class="n">cluster</span> <span class="n">of</span> <span class="n">multiple</span> <span class="n">instances</span><span class="o">.</span>
<span class="n">The</span> <span class="n">result</span> <span class="ow">is</span> <span class="n">that</span> <span class="n">you</span> <span class="n">will</span> <span class="n">get</span> <span class="n">data</span> <span class="n">persistence</span><span class="p">,</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">the</span>
<span class="n">scaling</span> <span class="ow">or</span> <span class="n">high</span> <span class="n">availability</span> <span class="n">advantages</span><span class="o">.</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="multiple-node-clustering">
<h3>Multiple Node Clustering<a class="headerlink" href="#multiple-node-clustering" title="Permalink to this headline">¶</a></h3>
<p>The following sections describe how to set up multiple node clusters in
OpenDaylight.</p>
<div class="section" id="deployment-considerations">
<h4>Deployment Considerations<a class="headerlink" href="#deployment-considerations" title="Permalink to this headline">¶</a></h4>
<p>To implement clustering, the deployment considerations are as follows:</p>
<ul>
<li><p class="first">To set up a cluster with multiple nodes, we recommend that you use a
minimum of three machines. You can set up a cluster with just two
nodes. However, if one of the two nodes fail, the cluster will not be
operational.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>This is because clustering in OpenDaylight requires a majority of
the nodes to be up and one node cannot be a majority of two
nodes.</p>
</div></blockquote>
</li>
<li><p class="first">Every device that belongs to a cluster needs to have an identifier.
OpenDaylight uses the node’s <code class="docutils literal"><span class="pre">role</span></code> for this purpose. After you
define the first node’s role as <em>member-1</em> in the <code class="docutils literal"><span class="pre">akka.conf</span></code> file,
OpenDaylight uses <em>member-1</em> to identify that node.</p>
</li>
<li><p class="first">Data shards are used to contain all or a certain segment of a
OpenDaylight’s MD-SAL datastore. For example, one shard can contain
all the inventory data while another shard contains all of the
topology data.</p>
<p>If you do not specify a module in the <code class="docutils literal"><span class="pre">modules.conf</span></code> file and do
not specify a shard in <code class="docutils literal"><span class="pre">module-shards.conf</span></code>, then (by default) all
the data is placed in the default shard (which must also be defined
in <code class="docutils literal"><span class="pre">module-shards.conf</span></code> file). Each shard has replicas configured.
You can specify the details of where the replicas reside in
<code class="docutils literal"><span class="pre">module-shards.conf</span></code> file.</p>
</li>
<li><p class="first">If you have a three node cluster and would like to be able to
tolerate any single node crashing, a replica of every defined data
shard must be running on all three cluster nodes.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>This is because OpenDaylight’s clustering implementation requires
a majority of the defined shard replicas to be running in order
to function. If you define data shard replicas on two of the
cluster nodes and one of those nodes goes down, the corresponding
data shards will not function.</p>
</div></blockquote>
</li>
<li><p class="first">If you have a three node cluster and have defined replicas for a data
shard on each of those nodes, that shard will still function even if
only two of the cluster nodes are running. Note that if one of those
remaining two nodes goes down, the shard will not be operational.</p>
</li>
<li><p class="first">It is recommended that you have multiple seed nodes configured. After
a cluster member is started, it sends a message to all of its seed
nodes. The cluster member then sends a join command to the first seed
node that responds. If none of its seed nodes reply, the cluster
member repeats this process until it successfully establishes a
connection or it is shut down.</p>
</li>
<li><p class="first">After a node is unreachable, it remains down for configurable period
of time (10 seconds, by default). Once a node goes down, you need to
restart it so that it can rejoin the cluster. Once a restarted node
joins a cluster, it will synchronize with the lead node
automatically.</p>
</li>
</ul>
</div>
<div class="section" id="setting-up-a-multiple-node-cluster">
<h4>Setting Up a Multiple Node Cluster<a class="headerlink" href="#setting-up-a-multiple-node-cluster" title="Permalink to this headline">¶</a></h4>
<p>To run OpenDaylight in a three node cluster, perform the following:</p>
<p>First, determine the three machines that will make up the cluster. After
that, do the following on each machine:</p>
<ol class="arabic">
<li><p class="first">Copy the OpenDaylight distribution zip file to the machine.</p>
</li>
<li><p class="first">Unzip the distribution.</p>
</li>
<li><p class="first">Open the following .conf files:</p>
<ul class="simple">
<li>configuration/initial/akka.conf</li>
<li>configuration/initial/module-shards.conf</li>
</ul>
</li>
<li><p class="first">In each configuration file, make the following changes:</p>
<ol class="loweralpha">
<li><p class="first">Find every instance of the following lines and replace <em>127.0.0.1</em>
with the hostname or IP address of the machine on which this file
resides and OpenDaylight will run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">netty</span><span class="o">.</span><span class="n">tcp</span> <span class="p">{</span>
  <span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1&quot;</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">The</span> <span class="n">value</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">will</span> <span class="n">be</span> <span class="n">different</span> <span class="k">for</span> <span class="n">each</span> <span class="n">node</span>
<span class="ow">in</span> <span class="n">the</span> <span class="n">cluster</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Find the following lines and replace <em>127.0.0.1</em> with the hostname
or IP address of any of the machines that will be part of the
cluster:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="p">{</span>
  <span class="n">seed</span><span class="o">-</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;akka.tcp://opendaylight-cluster-data@127.0.0.1:2550&quot;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first">Find the following section and specify the role for each member
node. Here we assign the first node with the <em>member-1</em> role, the
second node with the <em>member-2</em> role, and the third node with the
<em>member-3</em> role:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">roles</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">&quot;member-1&quot;</span>
<span class="p">]</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">This</span> <span class="n">step</span> <span class="n">should</span> <span class="n">use</span> <span class="n">a</span> <span class="n">different</span> <span class="n">role</span> <span class="n">on</span> <span class="n">each</span> <span class="n">node</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Open the configuration/initial/module-shards.conf file and update
the replicas so that each shard is replicated to all three nodes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">replicas</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;member-1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;member-2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;member-3&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>For reference, view a sample config files
<a class="reference external" href="#_sample_config_files">below</a>.</p>
</li>
</ol>
</li>
<li><p class="first">Move into the <code class="docutils literal"><span class="pre">&lt;karaf-distribution-directory&gt;/bin</span></code> directory.</p>
</li>
<li><p class="first">Run the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">JAVA_MAX_MEM</span><span class="o">=</span><span class="mi">4</span><span class="n">G</span> <span class="n">JAVA_MAX_PERM_MEM</span><span class="o">=</span><span class="mi">512</span><span class="n">m</span> <span class="o">./</span><span class="n">karaf</span>
</pre></div>
</div>
</li>
<li><p class="first">Enable clustering by running the following command at the Karaf
command line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">mdsal</span><span class="o">-</span><span class="n">clustering</span>
</pre></div>
</div>
</li>
</ol>
<p>OpenDaylight should now be running in a three node cluster. You can use
any of the three member nodes to access the data residing in the
datastore.</p>
<div class="section" id="sample-config-files">
<h5>Sample Config Files<a class="headerlink" href="#sample-config-files" title="Permalink to this headline">¶</a></h5>
<p><strong>Sample ``akka.conf`` file.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">odl</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">data</span> <span class="p">{</span>
  <span class="n">bounded</span><span class="o">-</span><span class="n">mailbox</span> <span class="p">{</span>
    <span class="n">mailbox</span><span class="o">-</span><span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;org.opendaylight.controller.cluster.common.actor.MeteredBoundedMailbox&quot;</span>
    <span class="n">mailbox</span><span class="o">-</span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">mailbox</span><span class="o">-</span><span class="n">push</span><span class="o">-</span><span class="n">timeout</span><span class="o">-</span><span class="n">time</span> <span class="o">=</span> <span class="mi">100</span><span class="n">ms</span>
  <span class="p">}</span>

  <span class="n">metric</span><span class="o">-</span><span class="n">capture</span><span class="o">-</span><span class="n">enabled</span> <span class="o">=</span> <span class="n">true</span>

  <span class="n">akka</span> <span class="p">{</span>
    <span class="n">loglevel</span> <span class="o">=</span> <span class="s2">&quot;DEBUG&quot;</span>
    <span class="n">loggers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;akka.event.slf4j.Slf4jLogger&quot;</span><span class="p">]</span>

    <span class="n">actor</span> <span class="p">{</span>

      <span class="n">provider</span> <span class="o">=</span> <span class="s2">&quot;akka.cluster.ClusterActorRefProvider&quot;</span>
      <span class="n">serializers</span> <span class="p">{</span>
                <span class="n">java</span> <span class="o">=</span> <span class="s2">&quot;akka.serialization.JavaSerializer&quot;</span>
                <span class="n">proto</span> <span class="o">=</span> <span class="s2">&quot;akka.remote.serialization.ProtobufSerializer&quot;</span>
              <span class="p">}</span>

              <span class="n">serialization</span><span class="o">-</span><span class="n">bindings</span> <span class="p">{</span>
                  <span class="s2">&quot;com.google.protobuf.Message&quot;</span> <span class="o">=</span> <span class="n">proto</span>

              <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">remote</span> <span class="p">{</span>
      <span class="n">log</span><span class="o">-</span><span class="n">remote</span><span class="o">-</span><span class="n">lifecycle</span><span class="o">-</span><span class="n">events</span> <span class="o">=</span> <span class="n">off</span>
      <span class="n">netty</span><span class="o">.</span><span class="n">tcp</span> <span class="p">{</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;10.194.189.96&quot;</span>
        <span class="n">port</span> <span class="o">=</span> <span class="mi">2550</span>
        <span class="n">maximum</span><span class="o">-</span><span class="n">frame</span><span class="o">-</span><span class="n">size</span> <span class="o">=</span> <span class="mi">419430400</span>
        <span class="n">send</span><span class="o">-</span><span class="n">buffer</span><span class="o">-</span><span class="n">size</span> <span class="o">=</span> <span class="mi">52428800</span>
        <span class="n">receive</span><span class="o">-</span><span class="n">buffer</span><span class="o">-</span><span class="n">size</span> <span class="o">=</span> <span class="mi">52428800</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">cluster</span> <span class="p">{</span>
      <span class="n">seed</span><span class="o">-</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;akka.tcp://opendaylight-cluster-data@10.194.189.96:2550&quot;</span><span class="p">]</span>

      <span class="n">auto</span><span class="o">-</span><span class="n">down</span><span class="o">-</span><span class="n">unreachable</span><span class="o">-</span><span class="n">after</span> <span class="o">=</span> <span class="mi">10</span><span class="n">s</span>

      <span class="n">roles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;member-1&quot;</span>
      <span class="p">]</span>

    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">odl</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">rpc</span> <span class="p">{</span>
  <span class="n">bounded</span><span class="o">-</span><span class="n">mailbox</span> <span class="p">{</span>
    <span class="n">mailbox</span><span class="o">-</span><span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;org.opendaylight.controller.cluster.common.actor.MeteredBoundedMailbox&quot;</span>
    <span class="n">mailbox</span><span class="o">-</span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">mailbox</span><span class="o">-</span><span class="n">push</span><span class="o">-</span><span class="n">timeout</span><span class="o">-</span><span class="n">time</span> <span class="o">=</span> <span class="mi">100</span><span class="n">ms</span>
  <span class="p">}</span>

  <span class="n">metric</span><span class="o">-</span><span class="n">capture</span><span class="o">-</span><span class="n">enabled</span> <span class="o">=</span> <span class="n">true</span>

  <span class="n">akka</span> <span class="p">{</span>
    <span class="n">loglevel</span> <span class="o">=</span> <span class="s2">&quot;INFO&quot;</span>
    <span class="n">loggers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;akka.event.slf4j.Slf4jLogger&quot;</span><span class="p">]</span>

    <span class="n">actor</span> <span class="p">{</span>
      <span class="n">provider</span> <span class="o">=</span> <span class="s2">&quot;akka.cluster.ClusterActorRefProvider&quot;</span>

    <span class="p">}</span>
    <span class="n">remote</span> <span class="p">{</span>
      <span class="n">log</span><span class="o">-</span><span class="n">remote</span><span class="o">-</span><span class="n">lifecycle</span><span class="o">-</span><span class="n">events</span> <span class="o">=</span> <span class="n">off</span>
      <span class="n">netty</span><span class="o">.</span><span class="n">tcp</span> <span class="p">{</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;10.194.189.96&quot;</span>
        <span class="n">port</span> <span class="o">=</span> <span class="mi">2551</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">cluster</span> <span class="p">{</span>
      <span class="n">seed</span><span class="o">-</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;akka.tcp://opendaylight-cluster-rpc@10.194.189.96:2551&quot;</span><span class="p">]</span>

      <span class="n">auto</span><span class="o">-</span><span class="n">down</span><span class="o">-</span><span class="n">unreachable</span><span class="o">-</span><span class="n">after</span> <span class="o">=</span> <span class="mi">10</span><span class="n">s</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Sample ``module-shards.conf`` file.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span><span class="o">-</span><span class="n">shards</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
        <span class="n">shards</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;default&quot;</span>
                <span class="n">replicas</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;member-1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-3&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;topology&quot;</span>
        <span class="n">shards</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;topology&quot;</span>
                <span class="n">replicas</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;member-1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-3&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;inventory&quot;</span>
        <span class="n">shards</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inventory&quot;</span>
                <span class="n">replicas</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;member-1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-3&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
         <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;toaster&quot;</span>
         <span class="n">shards</span> <span class="o">=</span> <span class="p">[</span>
             <span class="p">{</span>
                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;toaster&quot;</span>
                 <span class="n">replicas</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;member-1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member-3&quot;</span>
                 <span class="p">]</span>
             <span class="p">}</span>
         <span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This second part of the user guide covers project specific usage
instructions.</p>
</div>
</div>
</div>
</div>
<div class="section" id="alto-user-guide">
<h2>ALTO User Guide<a class="headerlink" href="#alto-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>The ALTO project provides support for <em>Application Layer Traffic
Optimization</em> services defined in <a class="reference external" href="https://tools.ietf.org/html/rfc7285">RFC
7285</a>.</p>
<p>In the Lithium release, ALTO uses the YANG model described in <a class="reference external" href="https://tools.ietf.org/html/draft-shi-alto-yang-model-03">this
draft</a>.</p>
</div>
<div class="section" id="alto-architecture">
<h3>ALTO Architecture<a class="headerlink" href="#alto-architecture" title="Permalink to this headline">¶</a></h3>
<p>There are three kinds of ALTO packages in OpenDaylight.</p>
<ol class="arabic simple">
<li><strong>Core</strong> The <strong>core</strong> packages include:<ol class="loweralpha">
<li><code class="docutils literal"><span class="pre">alto-model</span></code>: Defines the YANG model of ALTO services in MD-SAL</li>
<li><code class="docutils literal"><span class="pre">service-api-rfc7285</span></code>: Defines interfaces for ALTO services in
AD-SAL</li>
<li><code class="docutils literal"><span class="pre">alto-northbound</span></code>: Implements the RFC7285-compatible RESTful API</li>
</ol>
</li>
<li><strong>Basic</strong> The <strong>basic</strong> packages include:<ol class="loweralpha">
<li>Basic implementations of ALTO services:<ol class="lowerroman">
<li><code class="docutils literal"><span class="pre">alto-provider</span></code>: Implements the services defined in
<code class="docutils literal"><span class="pre">alto-model</span></code></li>
<li><code class="docutils literal"><span class="pre">simple-impl</span></code>: Implements the services defined in
<code class="docutils literal"><span class="pre">service-api-rfc7285</span></code></li>
</ol>
</li>
<li>Utilities:<ol class="lowerroman">
<li><code class="docutils literal"><span class="pre">alto-manager</span></code>: Provides a karaf command line tool to
manipulate network maps and cost maps.</li>
</ol>
</li>
</ol>
</li>
<li><strong>Service</strong> The <strong>service</strong> packages include:<ol class="loweralpha">
<li><code class="docutils literal"><span class="pre">alto-hosttracker</span></code>: Generates a network map, a corresponding
cost map and the endpoint cost service based on
<a class="reference external" href="#_l2switch_user_guide">l2switch</a>.</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="configuring-alto">
<h3>Configuring ALTO<a class="headerlink" href="#configuring-alto" title="Permalink to this headline">¶</a></h3>
<p>There are three packages that require their own configuration files,
including <code class="docutils literal"><span class="pre">alto-provider</span></code>, <code class="docutils literal"><span class="pre">alto-hosttracker</span></code> and <code class="docutils literal"><span class="pre">simple-impl</span></code>.
However, the only configurable option is the type of the data broker in
all three configuration files.</p>
</div>
<div class="section" id="administering-or-managing-alto">
<h3>Administering or Managing ALTO<a class="headerlink" href="#administering-or-managing-alto" title="Permalink to this headline">¶</a></h3>
<p>To enable ALTO, the features must be installed first.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">alto</span><span class="o">-</span><span class="n">provider</span>
<span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">alto</span><span class="o">-</span><span class="n">manager</span>
<span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">alto</span><span class="o">-</span><span class="n">northbound</span>
<span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">alto</span><span class="o">-</span><span class="n">hosttracker</span>
</pre></div>
</div>
<div class="section" id="managing-data-with-restconf">
<h4>Managing Data with RESTCONF<a class="headerlink" href="#managing-data-with-restconf" title="Permalink to this headline">¶</a></h4>
<p>After installing <code class="docutils literal"><span class="pre">odl-alto-provider</span></code> feature in karaf, it is possible
to manage network-maps and cost-maps using RESTCONF. Take a look at all
the operations provided by <code class="docutils literal"><span class="pre">alto-model</span></code> at the API service page which
can be found at <code class="docutils literal"><span class="pre">http://localhost:8181/apidoc/explorer/index.html</span></code>.</p>
<p>With the example input below you can insert a network map into the data
store, either by filling the form in the API doc page, or by using tools
such as <code class="docutils literal"><span class="pre">curl</span></code>.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>HOST_IP=localhost                   # IP address of the controller
CREDENTIAL=admin:admin              # username and password for authentication
BASE_URL=$HOST_IP:8181/restconf/config
SERVICE_PATH=alto-service:resources/alto-service:network-maps/alto-service:network-map
RESOURCE_ID=test_odl                # Should match the one in the input file
curl -X PUT -H &quot;content-type:application/yang.data+json&quot; \
            -d @example-input.json -u $CREDENTIAL \
            http://$BASE_URL/$SERVICE_PATH/$RESOURCE_ID
</pre></div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;alto-service:network-map&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;alto-service:map&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;alto-service:endpoint-address-group&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;alto-service:address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipv4&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;alto-service:endpoint-prefix&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;192.0.2.0/24&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;198.51.100.0/25&quot;</span>
                            <span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;alto-service:pid&quot;</span><span class="p">:</span> <span class="s2">&quot;PID1&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;alto-service:endpoint-address-group&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;alto-service:address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipv4&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;alto-service:endpoint-prefix&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;198.51.100.128/25&quot;</span>
                            <span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;alto-service:pid&quot;</span><span class="p">:</span> <span class="s2">&quot;PID2&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;alto-service:endpoint-address-group&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;alto-service:address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipv4&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;alto-service:endpoint-prefix&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;0.0.0.0/0&quot;</span>
                            <span class="p">]</span>
                        <span class="p">},</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;alto-service:address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipv6&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;alto-service:endpoint-prefix&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="s2">&quot;::/0&quot;</span>
                            <span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;alto-service:pid&quot;</span><span class="p">:</span> <span class="s2">&quot;PID3&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;alto-service:resource-id&quot;</span><span class="p">:</span> <span class="s2">&quot;test_odl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;alto-service:tag&quot;</span><span class="p">:</span> <span class="s2">&quot;da65eca2eb7a10ce8b059740b0b2e3f8eb1d4785&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Use the following command to see the results:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>HOST_IP=localhost                   # IP address of the controller
CREDENTIAL=admin:admin              # username and password for authentication
BASE_URL=$HOST_IP:8181/restconf/config
SERVICE_PATH=alto-service:resources/alto-service:network-maps/alto-service:network-map
RESOURCE_ID=test_odl
curl -X GET -u $CREDENTIAL http://$BASE_URL/$SERVICE_PATH/$RESOURCE_ID
</pre></div>
</div>
<p>Use <code class="docutils literal"><span class="pre">DELETE</span></code> method to remove the data from the data store.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>HOST_IP=localhost                   # IP address of the controller
CREDENTIAL=admin:admin              # username and password for authentication
BASE_URL=$HOST_IP:8181/restconf/config
SERVICE_PATH=alto-service:resources/alto-service:network-maps/alto-service:network-map
RESOURCE_ID=test_odl
curl -X DELETE -H &quot;content-type:application/yang.data+json&quot; \
               -u $CREDENTIAL http://$BASE_URL/$SERVICE_PATH/$RESOURCE_ID
</pre></div>
</div>
</div>
<div class="section" id="using-alto-manager">
<h4>Using <code class="docutils literal"><span class="pre">alto-manager</span></code><a class="headerlink" href="#using-alto-manager" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">alto-manager</span></code> package provides a karaf command line tool which
wraps up the functions described in the last section.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">alto</span><span class="o">-</span><span class="n">create</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">resource</span><span class="o">-</span><span class="n">file</span><span class="o">&gt;</span>
<span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">alto</span><span class="o">-</span><span class="n">delete</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">resource</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Currently only <code class="docutils literal"><span class="pre">network-map</span></code> and <code class="docutils literal"><span class="pre">cost-map</span></code> are supported. Also the
resource files used in <code class="docutils literal"><span class="pre">alto-manager</span></code> follow the RFC7285-compatible
format instead of RESTCONF format.</p>
<p>The following example shows how to use <code class="docutils literal"><span class="pre">alto-manager</span></code> to put a network
map into the data store.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">karaf</span> <span class="o">&gt;</span> <span class="n">alto</span><span class="o">-</span><span class="n">create</span> <span class="n">network</span><span class="o">-</span><span class="nb">map</span> <span class="n">example</span><span class="o">-</span><span class="n">rfc7285</span><span class="o">-</span><span class="n">networkmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;meta&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;resource-id&quot;</span><span class="p">:</span> <span class="s2">&quot;test_odl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;da65eca2eb7a10ce8b059740b0b2e3f8eb1d4785&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;network-map&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;PID1&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ipv4&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;192.0.2.0/24&quot;</span><span class="p">,</span>
                <span class="s2">&quot;192.51.100.0/25&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;PID2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ipv4&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;192.51.100.128/25&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;PID3&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ipv4&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;0.0.0.0/0&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;ipv6&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;::/0&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="using-alto-hosttracker">
<h4>Using <code class="docutils literal"><span class="pre">alto-hosttracker</span></code><a class="headerlink" href="#using-alto-hosttracker" title="Permalink to this headline">¶</a></h4>
<p>As a real instance of ALTO services, <code class="docutils literal"><span class="pre">alto-hosttracker</span></code> reads data
from <code class="docutils literal"><span class="pre">l2switch</span></code> and generates a network map with resource id
<code class="docutils literal"><span class="pre">hosttracker-network-map</span></code> and a cost map with resource id
<code class="docutils literal"><span class="pre">hostracker-cost-map</span></code>. It can only work with OpenFlow-enabled
networks.</p>
<p>After installing the <code class="docutils literal"><span class="pre">odl-alto-hosttracker</span></code> feature, the corresponding
network map and cost map will be inserted into the data store. Follow
the steps in <a class="reference external" href="#read-restconf">how to read data with RESTCONF</a> to see
the contents.</p>
</div>
</div>
</div>
<div class="section" id="authentication-and-authorization-services">
<h2>Authentication and Authorization Services<a class="headerlink" href="#authentication-and-authorization-services" title="Permalink to this headline">¶</a></h2>
<div class="section" id="authentication-service">
<h3>Authentication Service<a class="headerlink" href="#authentication-service" title="Permalink to this headline">¶</a></h3>
<p>Authentication uses the credentials presented by a user to identify the
user.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>The Authentication user store provided in the Lithium release does
not fully support a clustered node deployment. Specifically, the AAA
user store provided by the H2 database needs to be synchronized
using out of band means. The AAA Token cache is however
cluster-capable.</p>
</div></blockquote>
<div class="section" id="authentication-data-model">
<h4>Authentication data model<a class="headerlink" href="#authentication-data-model" title="Permalink to this headline">¶</a></h4>
<p>A user requests authentication within a domain in which the user has
defined roles. The user chooses either of the following ways to request
authentication:</p>
<ul class="simple">
<li>Provides credentials</li>
<li>Creates a token scoped to a domain. In OpenDaylight, a domain is a
grouping of resources (direct or indirect, physical, logical, or
virtual) for the purpose of access control.</li>
</ul>
<div class="section" id="terms-and-definitions-in-the-model">
<h5>Terms and definitions in the model<a class="headerlink" href="#terms-and-definitions-in-the-model" title="Permalink to this headline">¶</a></h5>
<dl class="docutils">
<dt>Token</dt>
<dd>A claim of access to a group of resources on the controller</dd>
<dt>Domain</dt>
<dd>A group of resources, direct or indirect, physical, logical, or
virtual, for the purpose of access control</dd>
<dt>User</dt>
<dd>A person who either owns or has access to a resource or group of
resources on the controller</dd>
<dt>Role</dt>
<dd>Opaque representation of a set of permissions, which is merely a
unique string as admin or guest</dd>
<dt>Credential</dt>
<dd>Proof of identity such as username and password, OTP, biometrics, or
others</dd>
<dt>Client</dt>
<dd>A service or application that requires access to the controller</dd>
<dt>Claim</dt>
<dd>A data set of validated assertions regarding a user, e.g. the role,
domain, name, etc.</dd>
</dl>
</div>
<div class="section" id="authentication-methods">
<h5>Authentication methods<a class="headerlink" href="#authentication-methods" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">There are three ways a user may authenticate in OpenDaylight:</div>
</div>
<ul class="simple">
<li>Basic HTTP Authentication<ul>
<li>Regular, non-token based, authentication with username/password.</li>
</ul>
</li>
<li>Token-based Authentication<ul>
<li>Direct authentication: A user presents username/password and a
domain the user wishes to access to the controller and obtains a
timed (default is 1 hour) scoped access token. The user then uses
this token to access RESTCONF (for example).</li>
<li>Federated authentication: A user presents credentials to a
third-party Identity Provider (for example, SSSD) trusted by the
controller. Upon successful authentication, the controller returns
a refresh (unscoped) token with a list of domains that the user
has access to. The user then presents this refresh token scoped to
a domain that the user has access to obtain a scoped access token.
The user then uses this access token to access RESTCONF (for
example).</li>
</ul>
</li>
</ul>
<div class="section" id="example-with-token-authentication-using-curl">
<h6>Example with token authentication using curl:<a class="headerlink" href="#example-with-token-authentication-using-curl" title="Permalink to this headline">¶</a></h6>
<p>(username/password = admin/admin, domain = sdn)</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Create a token</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">ik</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;grant_type=password&amp;username=admin&amp;password=admin&amp;scope=sdn&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">oauth2</span><span class="o">/</span><span class="n">token</span>

<span class="c1"># Use the token (e.g.,  ed3e5e05-b5e7-3865-9f63-eb8ed5c87fb9) obtained from above (default token validity is 1 hour):</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">ik</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;Authorization:Bearer ed3e5e05-b5e7-3865-9f63-eb8ed5c87fb9&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">toaster</span><span class="p">:</span><span class="n">toaster</span>
</pre></div>
</div>
</div>
<div class="section" id="example-with-basic-http-auth-using-curl">
<h6>Example with basic HTTP auth using curl:<a class="headerlink" href="#example-with-basic-http-auth-using-curl" title="Permalink to this headline">¶</a></h6>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">ik</span> <span class="o">-</span><span class="n">u</span> <span class="s1">&#39;admin:admin&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">toaster</span><span class="p">:</span><span class="n">toaster</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-the-opendaylight-authentication-service-works">
<h4>How the OpenDaylight Authentication Service works<a class="headerlink" href="#how-the-opendaylight-authentication-service-works" title="Permalink to this headline">¶</a></h4>
<p>In direct authentication, a service relationship exists between the user
and the OpenDaylight controller. The user and the controller establish
trust that allows them to use, and validate credentials. The user
establishes user identity through credentials.</p>
<p>In direct authentication, a user request progresses through the
following steps:</p>
<ol class="arabic">
<li><p class="first">The user requests the controller administrator for a user account.</p>
<blockquote>
<div><p>Associated with the user account are user credentials, initially
created by the administrator. OpenDaylight supports only
username/password credentials. By default, an administrator
account is present in OpenDaylight out-of-the-box with the
default username and password being admin/admin. In addition to
creating the user account, the controller administrator also
assigns roles to that account on one or more domain. By default,
there are two user roles; admin, and user, and there is only one
domain; sdn.</p>
</div></blockquote>
</li>
<li><p class="first">The user presents credentials in a token request to the token service
within a domain.</p>
</li>
<li><p class="first">The request is then passed on to the controller token endpoint.</p>
</li>
<li><p class="first">The controller token endpoint uses the credential authentication
entity which returns a claim for the client.</p>
</li>
<li><p class="first">The controller token entity transforms the claim (user, domain, and
roles) into a token which it then provides to the user.</p>
</li>
</ol>
<p>In federated authentication, with the absence of a direct trust
relationship between the user and the service, a third-party Identity
Provider (IdP) is used for authentication. Federated authentication
relies on third-party identity providers (IdP) to authenticate the user.</p>
<p>The user is authenticated by the trusted IdP and a claim is returned to
the OpenDaylight authentication service. The claim is transformed into
an OpenDaylight claim and successively into a token that is passed on to
the user.</p>
<p>In a federated authentication set-up, the OpenDaylight controller AAA
module provides SSSD claim support. SSSD can be used to map users in an
external LDAP server to users defined on the OpenDaylight controller.</p>
</div>
<div class="section" id="configuring-authentication-service">
<h4>Configuring Authentication service<a class="headerlink" href="#configuring-authentication-service" title="Permalink to this headline">¶</a></h4>
<p>Changes to AAA configurations can be made as follows:</p>
<p>For Authentication functionality via one of:</p>
<ul class="simple">
<li>Webconsole</li>
<li>CLI (config command in the Karaf shell)</li>
<li>Editing the etc/org.opendaylight.aaa.*.cfg files directly</li>
</ul>
<p>For Token Cache Store settings via one of:</p>
<ul>
<li><p class="first">Editing the 08-authn-config.xml configuration file in
etc/opendaylight/karaf</p>
</li>
<li><p class="first">Using RESTCONF</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Configurations for AAA are all dynamic and require no restart.</p>
</div></blockquote>
</li>
</ul>
<div class="section" id="configuring-authentication">
<h5>Configuring Authentication<a class="headerlink" href="#configuring-authentication" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">To configure features from the Web console:</div>
</div>
<ol class="arabic">
<li><p class="first">Install the Web console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">webconsole</span>
</pre></div>
</div>
</li>
<li><p class="first">On the console (<a class="reference external" href="http://localhost:8181/system/console">http://localhost:8181/system/console</a>) (default Karaf
username/password: karaf/karaf), go to <strong>OSGi</strong> &gt; <strong>Configuration</strong> &gt;
<strong>OpenDaylight AAA Authentication Configuration</strong>.</p>
<ol class="loweralpha simple">
<li><strong>Authorized Clients</strong>: List of software clients that are
authorized to access OpenDaylight northbound APIs.</li>
<li><strong>Enable Authentication</strong>: Enable or disable authentication. (The
default is enable.)</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="configuring-the-token-store">
<h5>Configuring the token store<a class="headerlink" href="#configuring-the-token-store" title="Permalink to this headline">¶</a></h5>
<ol class="arabic">
<li><p class="first">Open in a text editor etc/opendaylight/karaf/08-authn-config.xml</p>
<blockquote>
<div><p>The fields you can configure are as follows:</p>
<ol class="loweralpha simple">
<li><strong>timeToLive</strong>: Configure the maximum time, in milliseconds,
that tokens are to be cached. Default is 360000.</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">Save the file.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>When token’s are expired, they are lazily removed from the cache.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="configuring-aaa-federation">
<h5>Configuring AAA federation<a class="headerlink" href="#configuring-aaa-federation" title="Permalink to this headline">¶</a></h5>
<ol class="arabic">
<li><p class="first">On the console, click <strong>OpenDaylight AAA Federation Configuration</strong>.</p>
</li>
<li><p class="first">Use the <strong>Custom HTTP Headers</strong> or <strong>Custom HTTP Attributes</strong> fields
to specify the HTTP headers or attributes for federated
authentication. Normally, additional specification beyond the default
is not required.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>As the changes you make to the configurations are automatically
committed when they are saved, no restart of the Authentication
service is required.</p>
</div></blockquote>
</li>
</ol>
<div class="section" id="configuring-federated-authentication">
<h6>Configuring federated authentication<a class="headerlink" href="#configuring-federated-authentication" title="Permalink to this headline">¶</a></h6>
<div class="line-block">
<div class="line">Use the following steps to set up federated authentication:</div>
</div>
<ol class="arabic simple">
<li>Set up an Apache front-end and Apache mods for the OpenDaylight
controller.</li>
<li>Set up mapping rules (from LDAP users to OpenDaylight users).</li>
<li>Use the ClaimAuthFilter in federation to allow claim transformation.</li>
</ol>
</div>
<div class="section" id="mapping-users-to-roles-and-domains">
<h6>Mapping users to roles and domains<a class="headerlink" href="#mapping-users-to-roles-and-domains" title="Permalink to this headline">¶</a></h6>
<div class="line-block">
<div class="line">The OpenDaylight authentication service transforms assertions from an
external federated IdP into Authentication Service data:</div>
</div>
<ol class="arabic simple">
<li>The Apache web server which fronts OpenDaylight AAA sends data to
SssdAuthFilter.</li>
<li>SssdAuthFilter constructs a JSON document from the data.</li>
<li>OpenDaylight Authentication Service uses a general purpose
transformation mapper to transform the JSON document.</li>
</ol>
</div>
<div class="section" id="operational-model">
<h6>Operational model<a class="headerlink" href="#operational-model" title="Permalink to this headline">¶</a></h6>
<div class="line-block">
<div class="line">The mapping model works as follows:</div>
</div>
<ol class="arabic simple">
<li>Assertions from an IdP are stored in an associative array.</li>
<li>A sequence of rules is applied, and the first rule which returns
success is considered a match.</li>
<li>Upon success, an associative array of mapped values is returned.<ul>
<li>The mapped values are taken from the local variables set during
the rule execution.</li>
<li>The definition of the rules and mapped results are expressed in
JSON notation.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="operational-model-sample-code">
<h6>Operational Model: Sample code<a class="headerlink" href="#operational-model-sample-code" title="Permalink to this headline">¶</a></h6>
<div class="code java highlight-default"><div class="highlight"><pre><span></span><span class="n">mapped</span> <span class="o">=</span> <span class="n">null</span>
<span class="n">foreach</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span> <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">null</span>
    <span class="n">initialize</span> <span class="n">rule</span><span class="o">.</span><span class="n">variables</span> <span class="k">with</span> <span class="n">pre</span><span class="o">-</span><span class="n">defined</span> <span class="n">values</span>

    <span class="n">foreach</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">rule</span><span class="o">.</span><span class="n">statement_blocks</span> <span class="p">{</span>
        <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">statements</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">statement</span><span class="o">.</span><span class="n">verb</span> <span class="ow">is</span> <span class="n">exit</span> <span class="p">{</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">exit</span><span class="o">.</span><span class="n">status</span>
                <span class="k">break</span>
            <span class="p">}</span>
            <span class="k">elif</span> <span class="n">statement</span><span class="o">.</span><span class="n">verb</span> <span class="ow">is</span> <span class="k">continue</span> <span class="p">{</span>
                <span class="k">break</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">result</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">null</span> <span class="p">{</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">success</span>
    <span class="p">}</span>
<span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">success</span> <span class="p">{</span>
    <span class="n">mapped</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">mapping</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
<span class="p">}</span>
<span class="k">return</span> <span class="n">mapped</span>
</pre></div>
</div>
</div>
<div class="section" id="mapping-users">
<h6>Mapping Users<a class="headerlink" href="#mapping-users" title="Permalink to this headline">¶</a></h6>
<div class="line-block">
<div class="line">A JSON Object acts as a mapping template to produce the final
associative array of name/value pairs. The value in a name/value pair
can be a constant or a variable. An example of a mapping template and
rule variables in JSON:</div>
<div class="line">Template:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span>{
    &quot;organization&quot;: &quot;BigCorp.com&quot;,
    &quot;user: &quot;$subject&quot;,
    &quot;roles&quot;: &quot;$roles&quot;
}
</pre></div>
</div>
<div class="line-block">
<div class="line">Local variables:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;Sally&quot;</span><span class="p">,</span>
    <span class="s2">&quot;roles&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The final mapped result will be:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;organization&quot;</span><span class="p">:</span> <span class="s2">&quot;BigCorp.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user: &quot;</span><span class="n">Sally</span><span class="s2">&quot;,</span>
    <span class="s2">&quot;roles&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="example-splitting-a-fully-qualified-username-into-user-and-realm-components">
<h6>Example: Splitting a fully qualified username into user and realm components<a class="headerlink" href="#example-splitting-a-fully-qualified-username-into-user-and-realm-components" title="Permalink to this headline">¶</a></h6>
<p>Some IdPs return a fully qualified username (for example, principal or
subject). The fully qualified username is the concatenation of the user
name, separator, and realm name. The following example shows the mapped
result that returns the user and realm as independent values for the
fully qualified username is <a class="reference external" href="mailto:bob&#37;&#52;&#48;example&#46;com">bob<span>&#64;</span>example<span>&#46;</span>com</a> .</p>
<div class="line-block">
<div class="line">The mapping in JSON:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;$username&quot;</span><span class="p">,</span>
    <span class="s2">&quot;realm&quot;</span><span class="p">:</span> <span class="s2">&quot;$domain&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The assertion in JSON:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Principal&quot;</span><span class="p">:</span> <span class="s2">&quot;bob@example.com&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">The rule applied:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span>[
    [
        [&quot;in&quot;, &quot;Principal&quot;, &quot;assertion&quot;],
        [&quot;exit&quot;, &quot;rule_fails&quot;, &quot;if_not_success&quot;],
        [&quot;regexp&quot;, &quot;$assertion[Principal]&quot;, (?P&lt;username&gt;\\w+)@(?P&lt;domain&gt;.+)&quot;],
        [&quot;set&quot;, &quot;$username&quot;, &quot;$regexp_map[username]&quot;],
        [&quot;set&quot;, &quot;$domain&quot;, &quot;$regexp_map[domain]&quot;],
        [&quot;exit, &quot;rule_succeeds&quot;, &quot;always&quot;]
    ]
]
</pre></div>
</div>
<div class="line-block">
<div class="line">The mapped result in JSON:</div>
</div>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>
    <span class="s2">&quot;realm&quot;</span><span class="p">:</span> <span class="s2">&quot;example.com&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Also, users may be granted roles based on their membership in certain
groups.</p>
<p>The Authentication Service allows white lists for users with specific
roles. The white lists ensure that users are unconditionally accepted
and authorized with specific roles. Users who must be unconditionally
denied access can be placed in a black list.</p>
</div>
</div>
</div>
</div>
<div class="section" id="administering-opendaylight-authentication-services">
<h3>Administering OpenDaylight Authentication Services<a class="headerlink" href="#administering-opendaylight-authentication-services" title="Permalink to this headline">¶</a></h3>
<div class="section" id="actors-in-the-system">
<h4>Actors in the System<a class="headerlink" href="#actors-in-the-system" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><strong>OpenDaylight Controller administrator</strong></div>
<div class="line">The OpenDaylight Controller administrator has the following
responsibilities:</div>
</div>
<ul class="simple">
<li>Author Authentication policies using the IdmLight Service API</li>
<li>Provides credentials, usernames and passwords to users who request
them</li>
</ul>
<div class="line-block">
<div class="line"><strong>OpenDaylight resource owners</strong></div>
<div class="line">Resource owners authenticate (either by means of federation or
directly providing their own credentials to the controller) to obtain
an access token. This access token can then be used to access
resources on the controller. An OpenDaylight resource owner enjoys the
following privileges:</div>
</div>
<ul class="simple">
<li>Creates, refreshes, or deletes access tokens</li>
<li>Gets access tokens from the Secure Token Service</li>
<li>Passes secure tokens to resource users</li>
</ul>
<div class="line-block">
<div class="line"><strong>OpenDaylight resource users</strong></div>
<div class="line">Resource users do not need to authenticate: they can access resources
if they are given an access tokens by the resource owner. The default
timeout for access tokens is 1 hour (This duration is configurable.).
An OpenDaylight resource user does the following:</div>
</div>
<ul class="simple">
<li>Gets access tokens either from a resource owner or the controller
administrator</li>
<li>Uses tokens at access applications from the north-bound APIs</li>
</ul>
</div>
<div class="section" id="system-components">
<h4>System Components<a class="headerlink" href="#system-components" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>IdmLight Identity manager</dt>
<dd>Stores local user authentication and authorization data, provides an
Admin REST API for CRUD operations.</dd>
<dt>Pluggable authenticators</dt>
<dd>Provides domain-specific authentication mechanisms</dd>
<dt>Authenticator</dt>
<dd>Authenticates users against and establishes claims</dd>
<dt>Authentication Cache</dt>
<dd>Caches all authentication states and tokens</dd>
<dt>Authentication Filter</dt>
<dd>Verifies tokens and extracts claims</dd>
<dt>Authentication Manager</dt>
<dd>Contains the session token and authentication claim store</dd>
</dl>
<div class="section" id="idmlight-identity-manager">
<h5>IdmLight Identity manager<a class="headerlink" href="#idmlight-identity-manager" title="Permalink to this headline">¶</a></h5>
<p>The Light-weight Identity Manager (IdmLight) Stores local user
authentication and authorization data, and roles and provides an Admin
REST API for CRUD operations on the users/roles/domains database. The
IdmLight REST API is by default accessed via the {controller
baseURI:8181}/auth/v1/ API end point. Access to the API is restricted to
authenticated clients only, or those possessing a token:</p>
<p>Example: To retrieve the users list.</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">admin</span><span class="p">:</span><span class="n">admin</span><span class="nd">@localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">users</span>
</pre></div>
</div>
<p>The following document contains a detailed list of supported CRUD
operations allowed by the API:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">wiki</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">a</span><span class="o">/</span><span class="n">ad</span><span class="o">/</span><span class="n">AAA_Idmlight_REST_APIs</span><span class="o">.</span><span class="n">xlsx</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="opendaylight-authorization-service">
<h3>OpenDaylight Authorization Service<a class="headerlink" href="#opendaylight-authorization-service" title="Permalink to this headline">¶</a></h3>
<p>The authorization service currently included in OpenDaylight is of an
experimental kind and only briefly documented here. Authorization
follows successful authentication and is modeled on the Role Based
Access Control (RBAC) approach for defining permissions and decide
access levels to API resources on the controller.</p>
</div>
</div>
<div class="section" id="armoury">
<h2>Armoury<a class="headerlink" href="#armoury" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to use the Armoury feature in OpenDaylight
and contains contains configuration, administration, and management
sections for the feature.</p>
<div class="section" id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Just as compute needs to make requests to the controller to get
networking resources in order to provide its services, so too does the
controller sometimes need to make requests of the workload manager to
get compute resources and/or network function (NF) (physical or virtual)
orchestration to provide its services.</p>
</div>
<div class="section" id="armoury-architecture">
<h3>Armoury Architecture<a class="headerlink" href="#armoury-architecture" title="Permalink to this headline">¶</a></h3>
<p>There are mainly three components :</p>
<ul class="simple">
<li><strong>Armoury Catalog</strong> A registry or catalog of the necessary
information (images, metadata, templatized day 0 config, how to
communicate with the NF, etc) to describe the NF to the workload
manager and/or network function (NF) (physical or virtual)
orchestration.</li>
<li><strong>Armoury Workload Manager</strong> The most minimal possible API to allow
applications to request that the workload manager start/stop/etc the
NF and some information from the workload manager/nf orchestrator
about the state of the NF.</li>
<li><strong>Armoury Driver Registry</strong> Example Drivers to talk to various
workload managers (OpenStack/Meseophere/Docker/ Kubernetes/etc).</li>
</ul>
</div>
<div class="section" id="armoury-catalog">
<h3>Armoury Catalog<a class="headerlink" href="#armoury-catalog" title="Permalink to this headline">¶</a></h3>
<p>The NF Catalog contains metadata describing a NF.</p>
<div class="section" id="configuring-armoury-catalog">
<h4>Configuring Armoury Catalog<a class="headerlink" href="#configuring-armoury-catalog" title="Permalink to this headline">¶</a></h4>
<p>TBD: Describe how to configure Armoury Catalog after installation.</p>
</div>
<div class="section" id="administering-armoury-catalog">
<h4>Administering Armoury Catalog<a class="headerlink" href="#administering-armoury-catalog" title="Permalink to this headline">¶</a></h4>
<p>TBD: Include related command reference or operations for using Armoury
Catalog.</p>
</div>
</div>
<div class="section" id="armoury-workload-manager">
<h3>Armoury Workload Manager<a class="headerlink" href="#armoury-workload-manager" title="Permalink to this headline">¶</a></h3>
<p>The Workload Manager defines RPCs to manage instances.</p>
<div class="section" id="configuring-armoury-workload-manager">
<h4>Configuring Armoury Workload Manager<a class="headerlink" href="#configuring-armoury-workload-manager" title="Permalink to this headline">¶</a></h4>
<p>TBD: Describe how to configure Armoury Workload Manager after
installation.</p>
</div>
<div class="section" id="administering-armoury-workload-manager">
<h4>Administering Armoury Workload Manager<a class="headerlink" href="#administering-armoury-workload-manager" title="Permalink to this headline">¶</a></h4>
<p>TBD: Include related command reference or operations for using Armoury
Workload Manager.</p>
</div>
</div>
<div class="section" id="armoury-driver-registry">
<h3>Armoury Driver Registry<a class="headerlink" href="#armoury-driver-registry" title="Permalink to this headline">¶</a></h3>
<p>The Driver Registry Describes the driver that is used to talk with the
workload manager (OpenStack/Meseophere/Docker/Kubernetes/etc).</p>
<div class="section" id="configuring-armoury-driver-registry">
<h4>Configuring Armoury Driver Registry<a class="headerlink" href="#configuring-armoury-driver-registry" title="Permalink to this headline">¶</a></h4>
<p>TBD: Describe how to configure Armoury Driver Registry.</p>
</div>
<div class="section" id="administering-armoury-driver-registry">
<h4>Administering Armoury Driver Registry<a class="headerlink" href="#administering-armoury-driver-registry" title="Permalink to this headline">¶</a></h4>
<p>TBD: Include related command reference or operations for using Driver
Registry.</p>
</div>
</div>
<div class="section" id="tutorials">
<h3>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h3>
<p>Below are tutorials for Armoury.</p>
<div class="section" id="using-armoury-catalog">
<h4>Using Armoury Catalog<a class="headerlink" href="#using-armoury-catalog" title="Permalink to this headline">¶</a></h4>
<p>TBD: State the purpose of tutorial</p>
<div class="section" id="id2">
<h5>Overview<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<p>TBD: An overview of the Armoury Catalog tutorial</p>
</div>
<div class="section" id="prerequisites">
<h5>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h5>
<p>TBD: Provide any prerequisite information, assumed knowledge, or
environment required to execute the use case.</p>
</div>
<div class="section" id="target-environment">
<h5>Target Environment<a class="headerlink" href="#target-environment" title="Permalink to this headline">¶</a></h5>
<p>TBD: Include any topology requirement for the use case.</p>
</div>
<div class="section" id="instructions">
<h5>Instructions<a class="headerlink" href="#instructions" title="Permalink to this headline">¶</a></h5>
<p>TBD: Step by step procedure for using Armoury Catalog.</p>
</div>
</div>
<div class="section" id="using-armoury-workload-manager">
<h4>Using Armoury Workload Manager<a class="headerlink" href="#using-armoury-workload-manager" title="Permalink to this headline">¶</a></h4>
<p>TBD: State the purpose of tutorial</p>
<div class="section" id="id3">
<h5>Overview<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>TBD: An overview of the Armoury Workload Manager tutorial</p>
</div>
<div class="section" id="id4">
<h5>Prerequisites<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<p>TBD: Provide any prerequisite information, assumed knowledge, or
environment required to execute the use case.</p>
</div>
<div class="section" id="id5">
<h5>Target Environment<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<p>TBD: Include any topology requirement for the use case.</p>
</div>
<div class="section" id="id6">
<h5>Instructions<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<p>TBD: Step by step procedure for using Armoury Workload Manager.</p>
</div>
</div>
<div class="section" id="using-armoury-driver-registry">
<h4>Using Armoury Driver Registry<a class="headerlink" href="#using-armoury-driver-registry" title="Permalink to this headline">¶</a></h4>
<p>TBD: State the purpose of tutorial</p>
<div class="section" id="id7">
<h5>Overview<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<p>TBD: An overview of the Armoury Driver Registry tutorial</p>
</div>
<div class="section" id="id8">
<h5>Prerequisites<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<p>TBD: Provide any prerequisite information, assumed knowledge, or
environment required to execute the use case.</p>
</div>
<div class="section" id="id9">
<h5>Target Environment<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h5>
<p>TBD: Include any topology requirement for the use case.</p>
</div>
<div class="section" id="id10">
<h5>Instructions<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h5>
<p>TBD: Step by step procedure for using Armoury Driver Registry.</p>
</div>
</div>
</div>
</div>
<div class="section" id="bgp-user-guide">
<h2>BGP User Guide<a class="headerlink" href="#bgp-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id11">
<h3>Overview<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>The OpenDaylight Karaf distribution comes pre-configured with baseline
BGP configuration. You can find it in the etc/opendaylight/karaf
directory and it consists of two files:</p>
<ul class="simple">
<li><strong>31-bgp.xml</strong> (defines the basic parser and RIB support)</li>
<li><strong>41-bgp-example.xml</strong> (which contains a sample configuration which
needs to be customized to your deployment)</li>
</ul>
<p>The next sections will describe how to configure BGP manually or using
RESTCONF.</p>
</div>
<div class="section" id="configuring-bgp">
<h3>Configuring BGP<a class="headerlink" href="#configuring-bgp" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rib">
<h4>RIB<a class="headerlink" href="#rib" title="Permalink to this headline">¶</a></h4>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">rib</span><span class="o">-</span><span class="n">impl</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="k">as</span><span class="o">&gt;</span><span class="mi">64496</span><span class="o">&lt;/</span><span class="n">local</span><span class="o">-</span><span class="k">as</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">bgp</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.2</span><span class="o">&lt;/</span><span class="n">bgp</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">cluster</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.3</span><span class="o">&lt;/</span><span class="n">cluster</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
    <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>rib-id</strong> - BGP RIB Identifier, in this configuration file you can
specify more BGP RIBs by copy-pasting the above module. These RIBs
must have a unique rib-id and name.</li>
<li><strong>local-as</strong> - Our local AS number (where OpenDaylight is deployed),
we use this in best path selection</li>
<li><strong>bgp-id</strong> - Our local BGP identifier (the IP of the VM where
OpenDaylight is deployed), we use this in best path selection.</li>
<li><strong>cluster-id</strong> - Cluster Identifier, non-mandatory, if not specified,
BGP Identifier will be used</li>
</ul>
<p>MIGHT NOT BE NEEDED: depending on your BGP router, you might need to
switch from linkstate attribute type 99 to 29. Check with your router
vendor. Change the field iana-linkstate-attribute-type to true if your
router supports type 29. This snippet is located in 31-bgp.xml file.</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:linkstate&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">linkstate</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">linkstate</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">iana</span><span class="o">-</span><span class="n">linkstate</span><span class="o">-</span><span class="n">attribute</span><span class="o">-</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">iana</span><span class="o">-</span><span class="n">linkstate</span><span class="o">-</span><span class="n">attribute</span><span class="o">-</span><span class="nb">type</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>iana-linkstate-attribute-type</strong> - IANA has issued an early
allocation for the BGP Linkstate path attribute (=29). To preserve
(TYPE = 99) set value bellow to false; to use IANA assigned type set
the value to true or remove it as it’s true by default.</li>
</ul>
</div>
<div class="section" id="bgp-peer">
<h4>BGP Peer<a class="headerlink" href="#bgp-peer" title="Permalink to this headline">¶</a></h4>
<p>The initial configuration is written so that it will be ignored to
prevent the client from starting with default configuration. Therefore
the first step is to uncomment the module containing bgp-peer.</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="o">&lt;/</span><span class="n">host</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">holdtimer</span><span class="o">&gt;</span><span class="mi">180</span><span class="o">&lt;/</span><span class="n">holdtimer</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">peer</span><span class="o">-</span><span class="n">role</span><span class="o">&gt;</span><span class="n">ibgp</span><span class="o">&lt;/</span><span class="n">peer</span><span class="o">-</span><span class="n">role</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">rib</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">rib</span><span class="o">-</span><span class="n">instance</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">rib</span><span class="o">&gt;</span>
 <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>name</strong> - BGP Peer name, in this configuration file you can specify
more BGP Peers by copy-pasting the above module. These peers must
have a <strong>unique</strong> name.</li>
<li><strong>host</strong> - IP address or hostname of BGP speaker (IP where
OpenDaylight should connect to gather topology)</li>
<li><strong>holdtimer</strong> - unit: seconds</li>
<li><strong>peer-role</strong> - If peer role is not present, default value &#8220;ibgp&#8221;
will be used (allowed values are also &#8220;ebgp&#8221; and &#8220;rr-client&#8221;). This
field is case-sensitive.</li>
<li><strong>rib</strong> - BGP RIB identifier</li>
</ul>
</div>
<div class="section" id="configure-connection-attributes-optional">
<h4>Configure Connection Attributes - OPTIONAL<a class="headerlink" href="#configure-connection-attributes-optional" title="Permalink to this headline">¶</a></h4>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:reconnectstrategy&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">timed</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nb">min</span><span class="o">-</span><span class="n">sleep</span><span class="o">&gt;</span><span class="mi">1000</span><span class="o">&lt;/</span><span class="nb">min</span><span class="o">-</span><span class="n">sleep</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nb">max</span><span class="o">-</span><span class="n">sleep</span><span class="o">&gt;</span><span class="mi">180000</span><span class="o">&lt;/</span><span class="nb">max</span><span class="o">-</span><span class="n">sleep</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">sleep</span><span class="o">-</span><span class="n">factor</span><span class="o">&gt;</span><span class="mf">2.00</span><span class="o">&lt;/</span><span class="n">sleep</span><span class="o">-</span><span class="n">factor</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">connect</span><span class="o">-</span><span class="n">time</span><span class="o">&gt;</span><span class="mi">5000</span><span class="o">&lt;/</span><span class="n">connect</span><span class="o">-</span><span class="n">time</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">executor</span><span class="o">&gt;</span>
       <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">netty</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:netty&quot;</span><span class="o">&gt;</span><span class="n">netty</span><span class="p">:</span><span class="n">netty</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
       <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">executor</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>min-sleep</strong> - Minimum sleep time (miliseconds) in between reconnect
tries</li>
<li><strong>max-sleep</strong> - Maximum sleep time (miliseconds) in between reconnect
tries</li>
<li><strong>sleep-factor</strong> - Power factor of the sleep time between reconnect
tries</li>
<li><strong>connect-time</strong> - How long we should wait (miliseconds) for the TCP
connect attempt, overrides default connection timeout dictated by TCP
retransmits</li>
</ul>
</div>
<div class="section" id="bgp-speaker-configuration">
<h4>BGP Speaker Configuration<a class="headerlink" href="#bgp-speaker-configuration" title="Permalink to this headline">¶</a></h4>
<p>Previous entries addressed the configuration of a BGP connection
initiated by OpenDaylight. OpenDaylight also supports BGP Speaker
functionality and accepts incoming BGP connections.</p>
<p>*The configuration of BGP speaker is located in: 41-bgp-example.xml:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;module&gt;
    &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;prefix:bgp-peer-acceptor&lt;/type&gt;
    &lt;name&gt;bgp-peer-server&lt;/name&gt;

    &lt;!--Default parameters--&gt;
    &lt;!--&lt;binding-address&gt;0.0.0.0&lt;/binding-address&gt;--&gt;
    &lt;!--&lt;binding-port&gt;1790&lt;/binding-port&gt;--&gt;

    ...
    &lt;!--Drops or accepts incoming BGP connection, every BGP Peer that should be accepted needs to be added to this registry--&gt;
    &lt;peer-registry&gt;
        &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;prefix:bgp-peer-registry&lt;/type&gt;
        &lt;name&gt;global-bgp-peer-registry&lt;/name&gt;
    &lt;/peer-registry&gt;
&lt;/module&gt;
</pre></div>
</div>
<p><strong>Changing speaker configuration</strong> - Changing binding address: Uncomment
tag binding-address and change the address to e.g. <em>127.0.0.1</em>. The
default binding address is <em>0.0.0.0</em>. - Changing binding port: Uncomment
tag binding-port and change the port to e.g. <em>1790</em>. The default binding
port is <em>179</em> as specified in <a class="reference external" href="http://tools.ietf.org/html/rfc4271">BGP
RFC</a>.  —</p>
</div>
<div class="section" id="incomming-bgp-connections">
<h4>Incomming BGP Connections<a class="headerlink" href="#incomming-bgp-connections" title="Permalink to this headline">¶</a></h4>
<p><strong>BGP speaker drops all BGP connections from unknown BGP peers.</strong> The
decision is made in component bgp-peer-registry that is injected into
the speaker (The registry is configured in 31-bgp.xml).</p>
<p>To add BGP Peer configuration into the registry, it is necessary to
configure regular BGP peer just like in example in 41-bgp-example.xml.
Notice that the BGP peer depends on the same bgp-peer-registry as
bgp-speaker:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="o">&lt;/</span><span class="n">host</span><span class="o">&gt;</span>
    <span class="o">...</span>
    <span class="o">&lt;</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
    <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The BGP peer registers itself into the registry, which allows incoming
BGP connections handled by the bgp-speaker. (Config attribute
peer-registry is optional for now to preserve backwards compatibility).
With this configuration, the connection to 192.0.2.1 is initiated by
OpenDaylight but will also be accepted from 192.0.2.1. In case both
connections are being established, only one of them will be preserved
and the other will be dropped. The connection initiated from device with
lower bgp id will be dropped by the registry. Each BGP peer must be
configured in its own module. Note, that the name of the module needs to
be unique, so if you are configuring more peers, when changing the
<strong>host</strong>, change also the <strong>name</strong>. There is a way to configure the peer
only for incoming connections (The connection will not be initiated by
the OpenDaylight, OpenDaylight will only wait for incoming connection
from the peer. The peer is identified by its IP address). To configure
peer only for incoming connection add attribute initiate-connection to
peer’s configuration:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="o">&lt;/</span><span class="n">host</span><span class="o">&gt;</span>                         <span class="o">//</span> <span class="n">IP</span> <span class="n">address</span> <span class="ow">or</span> <span class="n">hostname</span> <span class="n">of</span> <span class="n">the</span> <span class="n">speaker</span>
    <span class="o">&lt;</span><span class="n">holdtimer</span><span class="o">&gt;</span><span class="mi">180</span><span class="o">&lt;/</span><span class="n">holdtimer</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">initiate</span><span class="o">-</span><span class="n">connection</span><span class="o">&gt;</span><span class="n">false</span><span class="o">&lt;/</span><span class="n">initiate</span><span class="o">-</span><span class="n">connection</span><span class="o">&gt;</span>  <span class="o">//</span> <span class="n">Connection</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">initiated</span> <span class="n">by</span> <span class="n">ODL</span>
    <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>initiate-connection</strong> - if set to false OpenDaylight will not
initiate connection to this peer. Default value is true for all
peers.</li>
</ul>
</div>
<div class="section" id="bgp-application-peer">
<h4>BGP Application Peer<a class="headerlink" href="#bgp-application-peer" title="Permalink to this headline">¶</a></h4>
<p>A BGP speaker needs to register all peers that can be connected to it
(meaning if a BGP peer is not configured, the connection with
OpenDaylight won’t be successful). As a first step, configure RIB. Then,
instead of configuring regular peer, configure this application peer,
with its own application RIB. Change the value in bold bgp-peer-id which
is your local BGP-ID that will be used in BGP Best Path Selection
algorithm.</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">application</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">app</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="mf">10.25</span><span class="o">.</span><span class="mf">1.9</span><span class="o">&lt;/</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">target</span><span class="o">-</span><span class="n">rib</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">rib</span><span class="o">-</span><span class="n">instance</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">target</span><span class="o">-</span><span class="n">rib</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">application</span><span class="o">-</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">application</span><span class="o">-</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
 <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>bgp-peer-id</strong> - Our local BGP identifier (the IP of the VM where
OpenDaylight is deployed), we use this in best path selection</li>
<li><strong>target-rib</strong> - RIB ID of existing RIB where the data should be
transferred</li>
<li><strong>application-rib-id</strong> - RIB ID of local application RIB (all the
routes that you put to OpenDaylight will be displayed here)</li>
</ul>
</div>
</div>
<div class="section" id="configuration-through-restconf">
<h3>Configuration through RESTCONF<a class="headerlink" href="#configuration-through-restconf" title="Permalink to this headline">¶</a></h3>
<p>Another method to configure BGP is dynamically through RESTCONF. Before
you start, make sure, you’ve completed steps 1-5 in Installation Guide.
Instead of restarting Karaf, install another feature, that provides you
the access to <em>restconf/config/</em> URLs.</p>
<p>feature:install odl-netconf-connector-all</p>
<p>To check what modules you have currently configured, check following
link:
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/</a>
This URL is also used to POST new configuration. If you want to change
any other configuration that is listed here, make sure you include the
correct namespaces. RESTCONF will tell you if some namespace is wrong.</p>
<p>To update an existing configuration use <strong>PUT</strong> and give the full path
to the element you wish to update.</p>
<p>It is vital that you respect the order of steps described in user guide.</p>
<div class="section" id="id12">
<h4>RIB<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>First, configure RIB. This module is already present in the
configuration, therefore we change only the parameters we need. In this
case, it’s <strong>bgp-rib-id</strong> and <strong>local-as</strong>.</p>
<p><strong>URL:</strong> _
<em>http://127.0.0.1:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-bgp-rib-impl-cfg:rib-impl/example-bgp-rib</em></p>
<p><strong>PUT:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">rib</span><span class="o">-</span><span class="n">impl</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">session</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:protocol:framework&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">session</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">extensions</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:spi&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">extensions</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">rib</span><span class="o">-</span><span class="n">extensions</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">extensions</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">codec</span><span class="o">-</span><span class="n">tree</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:binding&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">binding</span><span class="o">-</span><span class="n">codec</span><span class="o">-</span><span class="n">tree</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">runtime</span><span class="o">-</span><span class="n">mapping</span><span class="o">-</span><span class="n">singleton</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">codec</span><span class="o">-</span><span class="n">tree</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">tcp</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:protocol:framework&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">tcp</span><span class="o">-</span><span class="n">reconnect</span><span class="o">-</span><span class="n">strategy</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">data</span><span class="o">-</span><span class="n">provider</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:binding&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">binding</span><span class="o">-</span><span class="k">async</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">pingpong</span><span class="o">-</span><span class="n">binding</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">data</span><span class="o">-</span><span class="n">provider</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="k">as</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="mi">64496</span><span class="o">&lt;/</span><span class="n">local</span><span class="o">-</span><span class="k">as</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">dispatcher</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">bgp</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">dom</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">provider</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:dom&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">dom</span><span class="o">-</span><span class="k">async</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">pingpong</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">dom</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">provider</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ipv4</span><span class="o">-</span><span class="n">unicast</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">local</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ipv6</span><span class="o">-</span><span class="n">unicast</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">local</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">linkstate</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">local</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">flowspec</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">local</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.2</span><span class="o">&lt;/</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>

<span class="o">**</span><span class="n">Important</span><span class="o">**</span>

<span class="n">MIGHT</span> <span class="n">NOT</span> <span class="n">BE</span> <span class="n">NEEDED</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">your</span> <span class="n">BGP</span> <span class="n">router</span><span class="p">,</span> <span class="n">you</span> <span class="n">might</span> <span class="n">need</span> <span class="n">a</span>
<span class="n">switch</span> <span class="kn">from</span> <span class="nn">linkstate</span> <span class="n">attribute</span> <span class="nb">type</span> <span class="mi">99</span> <span class="n">to</span> <span class="mf">29.</span> <span class="n">Check</span> <span class="k">with</span> <span class="n">your</span>
<span class="n">router</span> <span class="n">vendor</span><span class="o">.</span> <span class="n">Switch</span> <span class="n">the</span> <span class="n">field</span> <span class="n">to</span> <span class="n">true</span> <span class="k">if</span> <span class="n">your</span> <span class="n">router</span> <span class="n">supports</span> <span class="nb">type</span>
<span class="mf">29.</span>
</pre></div>
</div>
<p><strong>URL:</strong>
<em>http://127.0.0.1:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-bgp-linkstate-cfg:bgp-linkstate/bgp-linkstate</em></p>
<p><strong>PUT:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:linkstate&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">linkstate</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">bgp</span><span class="o">-</span><span class="n">linkstate</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">iana</span><span class="o">-</span><span class="n">linkstate</span><span class="o">-</span><span class="n">attribute</span><span class="o">-</span><span class="nb">type</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:linkstate&quot;</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">iana</span><span class="o">-</span><span class="n">linkstate</span><span class="o">-</span><span class="n">attribute</span><span class="o">-</span><span class="nb">type</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h4>BGP Peer<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>We also need to add new module to configuration (bgp-peer). In this
case, the whole module needs to be configured. Please change values
<strong>host</strong>, <strong>holdtimer</strong> and <strong>peer-role</strong> (if necessary).</p>
<p><strong>**POST:</strong>.**</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">host</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="mf">192.0</span><span class="o">.</span><span class="mf">2.1</span><span class="o">&lt;/</span><span class="n">host</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">holdtimer</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="mi">180</span><span class="o">&lt;/</span><span class="n">holdtimer</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">peer</span><span class="o">-</span><span class="n">role</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">ibgp</span><span class="o">&lt;/</span><span class="n">peer</span><span class="o">-</span><span class="n">role</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">rib</span> <span class="n">xmlns</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">rib</span><span class="o">-</span><span class="n">instance</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">rib</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">rib</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">peer</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ipv4</span><span class="o">-</span><span class="n">unicast</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ipv6</span><span class="o">-</span><span class="n">unicast</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">linkstate</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">table</span><span class="o">-</span><span class="nb">type</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">flowspec</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">advertized</span><span class="o">-</span><span class="n">table</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This is all necessary information that you need to get ODL connect to
your speaker.</p>
</div>
<div class="section" id="id14">
<h4>BGP Application Peer<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>Change the value <strong>bgp-peer-id</strong> which is your local BGP ID that will be
used in BGP Best Path Selection algorithm.</p>
<p><strong>**POST:</strong>.**</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;module xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;&gt;
 &lt;type xmlns:x=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;x:bgp-application-peer&lt;/type&gt;
 &lt;name&gt;example-bgp-peer-app&lt;/name&gt;
 &lt;bgp-peer-id xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;10.25.1.9&lt;/bgp-peer-id&gt; &lt;!-- Your local BGP-ID that will be used in BGP Best Path Selection algorithm --&gt;
 &lt;target-rib xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;
  &lt;type xmlns:x=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;x:rib-instance&lt;/type&gt;
  &lt;name&gt;example-bgp-rib&lt;/name&gt;
  &lt;/target-rib&gt;
 &lt;application-rib-id xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;example-app-rib&lt;/application-rib-id&gt;
 &lt;data-broker xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;
  &lt;type xmlns:x=&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:dom&quot;&gt;x:dom-async-data-broker&lt;/type&gt;
  &lt;name&gt;pingpong-broker&lt;/name&gt;
 &lt;/data-broker&gt;
&lt;/module&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="id15">
<h3>Tutorials<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<div class="section" id="viewing-bgp-topology">
<h4>Viewing BGP Topology<a class="headerlink" href="#viewing-bgp-topology" title="Permalink to this headline">¶</a></h4>
<p>This section summarizes how data from BGP can be viewed through
RESTCONF. Currently it is the only way to view the data.</p>
<blockquote>
<div><p><strong>Important</strong></p>
<p>From Helium release the port changed from 8080 to 8181.</p>
</div></blockquote>
<div class="section" id="network-topology-view">
<h5>Network Topology View<a class="headerlink" href="#network-topology-view" title="Permalink to this headline">¶</a></h5>
<p>Basic URL for network topology is
<strong>http://localhost:8181/restconf/operational/network-topology:network-topology/</strong>
.</p>
<p>If BGP is configured properly, it should display output similar to this
one:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">topology</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="n">pcep</span><span class="o">-</span><span class="n">topology</span><span class="o">&lt;/</span><span class="n">topology</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="n">types</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="n">pcep</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">topology</span><span class="o">-</span><span class="n">types</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">topology</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">topology</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">server</span><span class="o">-</span><span class="n">provided</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">server</span><span class="o">-</span><span class="n">provided</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">ipv4</span><span class="o">-</span><span class="n">topology</span><span class="o">&lt;/</span><span class="n">topology</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="n">types</span><span class="o">/&gt;</span>
 <span class="o">&lt;/</span><span class="n">topology</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">topology</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">server</span><span class="o">-</span><span class="n">provided</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">server</span><span class="o">-</span><span class="n">provided</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">linkstate</span><span class="o">-</span><span class="n">topology</span><span class="o">&lt;/</span><span class="n">topology</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">topology</span><span class="o">-</span><span class="n">types</span><span class="o">/&gt;</span>
 <span class="o">&lt;/</span><span class="n">topology</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>BGP data as were sent from BGP speaker are listed in three topologies
(if all three are configured):</p>
<p><strong>example-linkstate-topology</strong> - displays links and nodes advertised
through linkstate Update messages</p>
<p><a class="reference external" href="http://localhost:8181/restconf/operational/network-topology:network-topology/topology/example-linkstate-topology">http://localhost:8181/restconf/operational/network-topology:network-topology/topology/example-linkstate-topology</a></p>
<p><strong>example-ipv4-topology</strong> - display Ipv4 adresses of nodes in the
topology</p>
<p><a class="reference external" href="http://localhost:8181/restconf/operational/network-topology:network-topology/topology/example-ipv4-topology">http://localhost:8181/restconf/operational/network-topology:network-topology/topology/example-ipv4-topology</a></p>
<p><strong>example-ipv6-topology</strong> - display Ipv6 adresses of nodes in the
topology</p>
<p><a class="reference external" href="http://localhost:8181/restconf/operational/network-topology:network-topology/topology/example-ipv6-topology">http://localhost:8181/restconf/operational/network-topology:network-topology/topology/example-ipv6-topology</a></p>
</div>
<div class="section" id="route-information-base-rib-view">
<h5>Route Information Base (RIB) View<a class="headerlink" href="#route-information-base-rib-view" title="Permalink to this headline">¶</a></h5>
<p>Another view of BGP data is through <strong>BGP RIBs</strong>, located here:</p>
<p><a class="reference external" href="http://localhost:8181/restconf/operational/bgp-rib:bgp-rib/">http://localhost:8181/restconf/operational/bgp-rib:bgp-rib/</a></p>
<p>There are multiple RIBs configured:</p>
<ul class="simple">
<li>AdjRibsIn (per Peer) : Adjacency RIBs In, BGP routes as they come
from BGP Peer</li>
<li>EffectiveRib (per Peer) : BGP routes after applying Import policies</li>
<li>LocRib (per RIB) : Local RIB, BGP routes from all peers</li>
<li>AdjRibsOut (per Peer) : BGP routes that will be advertizes, after
applying Export policies</li>
</ul>
<p>This is how the output looks like, when address families for IPv4 and
Linkstate were configured:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">loc</span><span class="o">-</span><span class="n">rib</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">tables</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">attributes</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">safi</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">linkstate</span><span class="o">-</span><span class="n">subsequent</span><span class="o">-</span><span class="n">address</span><span class="o">-</span><span class="n">family</span><span class="o">&lt;/</span><span class="n">safi</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">afi</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">linkstate</span><span class="o">-</span><span class="n">address</span><span class="o">-</span><span class="n">family</span><span class="o">&lt;/</span><span class="n">afi</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">linkstate</span><span class="o">-</span><span class="n">routes</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">tables</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">tables</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">attributes</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">safi</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">unicast</span><span class="o">-</span><span class="n">subsequent</span><span class="o">-</span><span class="n">address</span><span class="o">-</span><span class="n">family</span><span class="o">&lt;/</span><span class="n">safi</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">afi</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">ipv4</span><span class="o">-</span><span class="n">address</span><span class="o">-</span><span class="n">family</span><span class="o">&lt;/</span><span class="n">afi</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">ipv4</span><span class="o">-</span><span class="n">routes</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">tables</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">loc</span><span class="o">-</span><span class="n">rib</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>You can see details for each AFI by expanding the RESTCONF link:</p>
<p><strong>IPv4</strong> :
<a class="reference external" href="http://localhost:8181/restconf/operational/bgp-rib:bgp-rib/rib/example-bgp-rib/loc-rib/tables/bgp-types:ipv4-address-family/bgp-types:unicast-subsequent-address-family/ipv4-routes">http://localhost:8181/restconf/operational/bgp-rib:bgp-rib/rib/example-bgp-rib/loc-rib/tables/bgp-types:ipv4-address-family/bgp-types:unicast-subsequent-address-family/ipv4-routes</a></p>
<p><strong>Linkstate</strong> :
<a class="reference external" href="http://localhost:8181/restconf/operational/bgp-rib:bgp-rib/rib/example-bgp-rib/loc-rib/tables/bgp-linkstate:linkstate-address-family/bgp-linkstate:linkstate-subsequent-address-family/linkstate-routes">http://localhost:8181/restconf/operational/bgp-rib:bgp-rib/rib/example-bgp-rib/loc-rib/tables/bgp-linkstate:linkstate-address-family/bgp-linkstate:linkstate-subsequent-address-family/linkstate-routes</a></p>
</div>
</div>
<div class="section" id="populate-rib">
<h4>Populate RIB<a class="headerlink" href="#populate-rib" title="Permalink to this headline">¶</a></h4>
<p>If your peer is configured, you can populate the RIB by making following
POST call to RESTCONF:</p>
<p><strong>URL:</strong>
<a class="reference external" href="http://localhost:8181/restconf/config/bgp-rib:application-rib/example-app-rib/tables/bgp-types:ipv4-address-family/bgp-types:unicast-subsequent-address-family/">http://localhost:8181/restconf/config/bgp-rib:application-rib/example-app-rib/tables/bgp-types:ipv4-address-family/bgp-types:unicast-subsequent-address-family/</a></p>
<ul class="simple">
<li>where example-app-rib is your application RIB id (that you specified
in the configuration) and tables specifies AFI and SAFI of the data
that you want to add.</li>
</ul>
<p><strong>POST:</strong></p>
<p><strong>Content-Type:</strong> application/xml</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;ipv4-routes xmlns=&quot;urn:opendaylight:params:xml:ns:yang:bgp-inet&quot;&gt;
 &lt;ipv4-route&gt;
  &lt;prefix&gt;200.20.160.1/32&lt;/prefix&gt;
  &lt;attributes&gt;
   &lt;ipv4-next-hop&gt;
    &lt;global&gt;199.20.160.41&lt;/global&gt;
   &lt;/ipv4-next-hop&gt;&lt;as-path/&gt;
   &lt;multi-exit-disc&gt;
    &lt;med&gt;0&lt;/med&gt;
   &lt;/multi-exit-disc&gt;
   &lt;local-pref&gt;
    &lt;pref&gt;100&lt;/pref&gt;
   &lt;/local-pref&gt;
   &lt;originator-id&gt;
    &lt;originator&gt;41.41.41.41&lt;/originator&gt;
   &lt;/originator-id&gt;
   &lt;origin&gt;
    &lt;value&gt;igp&lt;/value&gt;
   &lt;/origin&gt;
   &lt;cluster-id&gt;
    &lt;cluster&gt;40.40.40.40&lt;/cluster&gt;
   &lt;/cluster-id&gt;
  &lt;/attributes&gt;
 &lt;/ipv4-route&gt;
&lt;/ipv4-routes&gt;
</pre></div>
</div>
<p>The request results in <strong>204 No content</strong>. This is expected.</p>
</div>
</div>
</div>
<div class="section" id="capwap-user-guide">
<h2>CAPWAP User Guide<a class="headerlink" href="#capwap-user-guide" title="Permalink to this headline">¶</a></h2>
<p>This document describes how to use the Control And Provisioning of
Wireless Access Points (CAPWAP) feature in OpenDaylight. This document
contains configuration, administration, and management sections for the
feature.</p>
<div class="section" id="id16">
<h3>Overview<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>CAPWAP feature fills the gap OpenDaylight Controller has with respect to
managing CAPWAP compliant wireless termination point (WTP) network
devices present in enterprise networks. Intelligent applications (e.g.
centralized firmware management, radio planning) can be developed by
tapping into the WTP network device’s operational states via REST APIs.</p>
</div>
<div class="section" id="capwap-architecture">
<h3>CAPWAP Architecture<a class="headerlink" href="#capwap-architecture" title="Permalink to this headline">¶</a></h3>
<p>The CAPWAP feature is implemented as an MD-SAL based provider module,
which helps discover WTP devices and update their states in MD-SAL
operational datastore.</p>
</div>
<div class="section" id="scope-of-capwap-project">
<h3>Scope of CAPWAP Project<a class="headerlink" href="#scope-of-capwap-project" title="Permalink to this headline">¶</a></h3>
<p>In the Lithium release, CAPWAP project aims to only detect the WTPs and
store their basic attributes in the operational data store, which is
accessible via REST and JAVA APIs.</p>
</div>
<div class="section" id="installing-capwap">
<h3>Installing CAPWAP<a class="headerlink" href="#installing-capwap" title="Permalink to this headline">¶</a></h3>
<p>To install CAPWAP, download OpenDaylight and use the Karaf console to
install the following feature:</p>
<p>odl-capwap-ac-rest</p>
</div>
<div class="section" id="configuring-capwap">
<h3>Configuring CAPWAP<a class="headerlink" href="#configuring-capwap" title="Permalink to this headline">¶</a></h3>
<p>As of Lithium, there are no configuration requirements.</p>
</div>
<div class="section" id="administering-or-managing-capwap">
<h3>Administering or Managing CAPWAP<a class="headerlink" href="#administering-or-managing-capwap" title="Permalink to this headline">¶</a></h3>
<p>After installing the odl-capwap-ac-rest feature from the Karaf console,
users can administer and manage CAPWAP from the APIDOCS explorer.</p>
<p>Go to
<a class="reference external" href="http://${ipaddress}:8181/apidoc/explorer/index.html">http://${ipaddress}:8181/apidoc/explorer/index.html</a>,
sign in, and expand the capwap-impl panel. From there, users can execute
various API calls.</p>
</div>
<div class="section" id="id17">
<h3>Tutorials<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<div class="section" id="viewing-discovered-wtps">
<h4>Viewing Discovered WTPs<a class="headerlink" href="#viewing-discovered-wtps" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id18">
<h5>Overview<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h5>
<p>This tutorial can be used as a walk through to understand the steps for
starting the CAPWAP feature, detecting CAPWAP WTPs, accessing the
operational states of WTPs.</p>
</div>
<div class="section" id="id19">
<h5>Prerequisites<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h5>
<p>It is assumed that user has access to at least one hardware/software
based CAPWAP compliant WTP. These devices should be configured with
OpenDaylight controller IP address as a CAPWAP Access Controller (AC)
address. It is also assumed that WTPs and OpenDaylight controller share
the same ethernet broadcast domain.</p>
</div>
<div class="section" id="id20">
<h5>Instructions<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>Run the OpenDaylight distribution and install odl-capwap-ac-rest from
the Karaf console.</li>
<li>Go to
<a class="reference external" href="http://${ipaddress}:8181/apidoc/explorer/index.html">http://${ipaddress}:8181/apidoc/explorer/index.html</a></li>
<li>Expand capwap-impl</li>
<li>Click /operational/capwap-impl:capwap-ac-root/</li>
<li>Click &#8220;Try it out&#8221;</li>
<li>The above step should display list of WTPs discovered using ODL
CAPWAP feature.</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section" id="didm-user-guide">
<h2>DIDM User Guide<a class="headerlink" href="#didm-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id21">
<h3>Overview<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>The Device Identification and Driver Management (DIDM) project addresses
the need to provide device-specific functionality. Device-specific
functionality is code that performs a feature, and the code is
knowledgeable of the capability and limitations of the device. For
example, configuring VLANs and adjusting FlowMods are features, and
there may be different implementations for different device types.
Device-specific functionality is implemented as Device Drivers. Device
Drivers need to be associated with the devices they can be used with. To
determine this association requires the ability to identify the device
type.</p>
</div>
<div class="section" id="didm-architecture">
<h3>DIDM Architecture<a class="headerlink" href="#didm-architecture" title="Permalink to this headline">¶</a></h3>
<p>The DIDM project creates the infrastructure to support the following
functions:</p>
<ul class="simple">
<li><strong>Discovery</strong> - Determination that a device exists in the controller
management domain and connectivity to the device can be established.
For devices that support the OpenFlow protocol, the existing
discovery mechanism in OpenDaylight suffices. Devices that do not
support OpenFlow will be discovered through manual means such as the
operator entering device information via GUI or REST API.</li>
<li><strong>Identification</strong> – Determination of the device type.</li>
<li><strong>Driver Registration</strong> – Registration of Device Drivers as routed
RPCs.</li>
<li><strong>Synchronization</strong> – Collection of device information, device
configuration, and link (connection) information.</li>
<li><strong>Data Models for Common Features</strong> – Data models will be defined to
perform common features such as VLAN configuration. For example,
applications can configure a VLAN by writing the VLAN data to the
data store as specified by the common data model.</li>
<li><strong>RPCs for Common Features</strong> – Configuring VLANs and adjusting
FlowMods are example of features. RPCs will be defined that specify
the APIs for these features. Drivers implement features for specific
devices and support the APIs defined by the RPCs. There may be
different Driver implementations for different device types.</li>
</ul>
</div>
</div>
<div class="section" id="group-based-policy-user-guide">
<h2>Group Based Policy User Guide<a class="headerlink" href="#group-based-policy-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id22">
<h3>Overview<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>OpenDaylight Group Based Policy allows users to express network
configuration in a declarative versus imperative way.</p>
<p>This is often described as asking for <strong>&#8220;what you want&#8221;</strong>, rather than
<strong>&#8220;how to do it&#8221;</strong>.</p>
<p>In order to achieve this Group Based Policy (herein referred to as
<strong>GBP</strong>) is an implementation of an <strong>Intent System</strong>.</p>
<p>An <strong>Intent System</strong>:</p>
<ul class="simple">
<li>is a process around an intent driven data model</li>
<li>contains no domain specifics</li>
<li>is capable of addressing multiple semantic definitions of intent</li>
</ul>
<p>To this end, <strong>GBP</strong> Policy views an <strong>Intent System</strong> visually as:</p>
<div class="figure" id="id181">
<img alt="Intent System Process and Policy Surfaces" src="../_images/IntentSystemPolicySurfaces.png" />
<p class="caption"><span class="caption-text">Intent System Process and Policy Surfaces</span></p>
</div>
<ul class="simple">
<li><strong>expressed intent</strong> is the entry point into the system.</li>
<li><strong>operational constraints</strong> provide policy for the usage of the
system which modulates how the system is consumed. For instance <em>&#8220;All
Financial applications must use a specific encryption standard&#8221;</em>.</li>
<li><strong>capabilities and state</strong> are provided by <em>renderers</em>. <em>Renderers</em>
dynamically provide their capabilities to the core model, allowing
the core model to remain non-domain specific.</li>
<li><strong>governance</strong> provides feedback on the delivery of the <em>expressed
intent</em>. i.e. <em>&#8220;Did we do what you asked us?&#8221;</em></li>
</ul>
<p>In summary <strong>GBP is about the Automation of Intent</strong>.</p>
<p>By thinking of <strong>Intent Systems</strong> in this way, it enables:</p>
<ul>
<li><p class="first"><strong>automation of intent</strong></p>
<p>By focusing on <strong>Model. Process. Automation</strong>, a consistent policy
resolution process enables for mapping between the <strong>expressed
intent</strong> and renderers responsible for providing the capabilities of
implementing that intent.</p>
</li>
<li><p class="first">recursive/intent level-independent behaviour.</p>
<p>Where <em>one person’s concrete is another’s abstract</em>, intent can be
fulfilled through a hierarchical implementation of non-domain
specific policy resolution. Domain specifics are provided by the
<em>renderers</em>, and exposed via the API, at each policy resolution
instance. For example:</p>
<ul class="simple">
<li>To DNS: The name &#8220;www.foo.com&#8221; is <em>abstract</em>, and it’s IPv4
address 10.0.0.10 is <em>concrete</em>,</li>
<li>To an IP stack: 10.0.0.10 is <em>abstract</em> and the MAC
08:05:04:03:02:01 is <em>concrete</em>,</li>
<li>To an Ethernet switch: The MAC 08:05:04:03:02:01 is <em>abstract</em>,
the resolution to a port in it’s CAM table is <em>concrete</em>,</li>
<li>To an optical network: The port maybe <em>abstract</em>, yet the optical
wavelength is <em>concrete</em>.</li>
</ul>
<blockquote>
<div><p><strong>Note</strong></p>
<p><em>This is a very domain specific analogy, tied to something most
readers will understand. It in no way implies the **GBP*</em> should be
implemented in an OSI type fashion. The premise is that by
implementing a full <strong>Intent System</strong>, the user is freed from a lot
of the constraints of how the expressed intent is realised.*</p>
</div></blockquote>
</li>
</ul>
<p>It is important to show the overall philosophy of <strong>GBP</strong> as it sets the
project’s direction.</p>
<p>In the Beryllium release of OpenDaylight, <strong>GBP</strong> focused on <strong>expressed
intent</strong>, <strong>refactoring of how renderers consume and publish Subject
Feature Definitions for multi-renderer support</strong>.</p>
</div>
<div class="section" id="gbp-base-architecture-and-value-proposition">
<h3>GBP Base Architecture and Value Proposition<a class="headerlink" href="#gbp-base-architecture-and-value-proposition" title="Permalink to this headline">¶</a></h3>
<div class="section" id="terminology">
<h4>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h4>
<p>In order to explain the fundamental value proposition of <strong>GBP</strong>, an
illustrated example is given. In order to do that some terminology must
be defined.</p>
<p>The Access Model is the core of the <strong>GBP</strong> Intent System policy
resolution process.</p>
<div class="figure" id="id182">
<img alt="GBP Access Model Terminology - Subject, Classifier, Action" src="../_images/GBPTerminology2.png" />
<p class="caption"><span class="caption-text">GBP Access Model Terminology - Subject, Classifier, Action</span></p>
</div>
<ul>
<li><p class="first">Endpoints:</p>
<p>Define concrete uniquely identifiable entities. In Beryllium,
examples could be a Docker container, or a Neutron port</p>
</li>
<li><p class="first">EndpointGroups:</p>
<p>EndpointGroups are sets of endpoints that share a common set of
policies. EndpointGroups can participate in contracts that determine
the kinds of communication that are allowed. EndpointGroups <em>consume</em>
and <em>provide</em> contracts. They also expose both <em>requirements and
capabilities</em>, which are labels that help to determine how contracts
will be applied. An EndpointGroup can specify a parent EndpointGroup
from which it inherits.</p>
</li>
<li><p class="first">Contracts:</p>
<p>Contracts determine which endpoints can communicate and in what way.
Contracts between pairs of EndpointGroups are selected by the
contract selectors defined by the EndpointGroup. Contracts expose
qualities, which are labels that can help EndpointGroups to select
contracts. Once the contract is selected, contracts have clauses that
can match against requirements and capabilities exposed by
EndpointGroups, as well as any conditions that may be set on
endpoints, in order to activate subjects that can allow specific
kinds of communication. A contract is allowed to specify a parent
contract from which it inherits.</p>
</li>
<li><p class="first">Subject</p>
<p>Subjects describe some aspect of how two endpoints are allowed to
communicate. Subjects define an ordered list of rules that will match
against the traffic and perform any necessary actions on that
traffic. No communication is allowed unless a subject allows that
communication.</p>
</li>
<li><p class="first">Clause</p>
<p>Clauses are defined as part of a contract. Clauses determine how a
contract should be applied to particular endpoints and
EndpointGroups. Clauses can match against requirements and
capabilities exposed by EndpointGroups, as well as any conditions
that may be set on endpoints. Matching clauses define some set of
subjects which can be applied to the communication between the pairs
of endpoints.</p>
</li>
</ul>
</div>
<div class="section" id="architecture-and-value-proposition">
<h4>Architecture and Value Proposition<a class="headerlink" href="#architecture-and-value-proposition" title="Permalink to this headline">¶</a></h4>
<p><strong>GBP</strong> offers an intent based interface, accessed via the <a class="reference external" href="#UX">UX</a>,
via the <a class="reference external" href="#REST">REST API</a> or directly from a domain-specific-language
such as <a class="reference external" href="#Neutron">Neutron</a> through a mapping interface.</p>
<p>There are two models in <strong>GBP</strong>:</p>
<ul class="simple">
<li>the access (or core) model</li>
<li>the forwarding model</li>
</ul>
<div class="figure" id="id183">
<img alt="GBP Access (or Core) Model" src="../_images/GBP_AccessModel_simple.png" />
<p class="caption"><span class="caption-text">GBP Access (or Core) Model</span></p>
</div>
<p>The <em>classifier</em> and <em>action</em> portions of the model can be thought of as
hooks, with their definition provided by each <em>renderer</em> about its
domain specific capabilities. In <strong>GBP</strong> Beryllium, there is one
renderer, the <em>`OpenFlow Overlay renderer (OfOverlay). &lt;#OfOverlay&gt;`__</em></p>
<p>These hooks are filled with <em>definitions</em> of the types of <em>features</em> the
renderer can provide the <em>subject</em>, and are called
<strong>subject-feature-definitions</strong>.</p>
<p>This means an <em>expressed intent</em> can be fulfilled by, and across,
multiple renderers simultaneously, without any specific provisioning
from the consumer of <strong>GBP</strong>.</p>
<p>Since <strong>GBP</strong> is implemented in OpenDaylight, which is an SDN
controller, it also must address networking. This is done via the
<em>forwarding model</em>, which is domain specific to networking, but could be
applied to many different <em>types</em> of networking.</p>
<div class="figure" id="id184">
<img alt="GBP Forwarding Model" src="../_images/GBP_ForwardingModel_simple.png" />
<p class="caption"><span class="caption-text">GBP Forwarding Model</span></p>
</div>
<p>Each endpoint is provisioned with a <em>network-containment</em>. This can be
a:</p>
<ul class="simple">
<li>subnet<ul>
<li>normal IP stack behaviour, where ARP is performed in subnet, and
for out of subnet, traffic is sent to default gateway.</li>
<li>a subnet can be a child of any of the below forwarding model
contexts, but typically would be a child of a flood-domain</li>
</ul>
</li>
<li>L2 flood-domain<ul>
<li>allows flooding behaviour.</li>
<li>is a n:1 child of a bridge-domain</li>
<li>can have multiple children</li>
</ul>
</li>
<li>L2 bridge-domain<ul>
<li>is a layer2 namespace</li>
<li>is the realm where traffic can be sent at layer 2</li>
<li>is a n:1 child of a L3 context</li>
<li>can have multiple children</li>
</ul>
</li>
<li>L3 context<ul>
<li>is a layer3 namespace</li>
<li>is the realm where traffic is passed at layer 3</li>
<li>is a n:1 child of a tenant</li>
<li>can have multiple children</li>
</ul>
</li>
</ul>
<p>A simple example of how the access and forwarding models work is as
follows:</p>
<div class="figure" id="id185">
<img alt="GBP Endpoints, EndpointGroups and Contracts" src="../_images/GBP_Endpoint_EPG_Contract.png" />
<p class="caption"><span class="caption-text">GBP Endpoints, EndpointGroups and Contracts</span></p>
</div>
<p>In this example, the <strong>EPG:webservers</strong> is <em>providing</em> the <em>web</em> and
<em>ssh</em> contracts. The <strong>EPG:client</strong> is consuming those contracts.
<strong>EPG:client</strong> is providing the <em>any</em> contract, which is consumed by
<strong>EPG:webservers</strong>.</p>
<p>The <em>direction</em> keyword is always from the perspective of the <em>provider</em>
of the contract. In this case contract <em>web</em>, being <em>provided</em> by
<strong>EPG:webservers</strong>, with the classifier to match TCP destination port
80, means:</p>
<ul class="simple">
<li>packets with a TCP destination port of 80</li>
<li>sent to (<em>in</em>) endpoints in the <strong>EPG:webservers</strong></li>
<li>will be <em>allowed</em>.</li>
</ul>
<div class="figure" id="id186">
<img alt="GBP Endpoints and the Forwarding Model" src="../_images/GBP_Endpoint_EPG_Forwarding.png" />
<p class="caption"><span class="caption-text">GBP Endpoints and the Forwarding Model</span></p>
</div>
<p>When the forwarding model is considered in the figure above, it can be
seen that even though all endpoints are communicating using a common set
of contracts, their forwarding is <em>contained</em> by the forwarding model
contexts or namespaces. In the example shown, the endpoints associated
with a <em>network-containment</em> that has an ultimate parent of
<em>L3Context:Sales</em> can only communicate with other endpoints within this
L3Context. In this way L3VPN services can be implemented without any
impact to the <strong>Intent</strong> of the contract.</p>
<div class="section" id="high-level-implementation-architecture">
<h5>High-level implementation Architecture<a class="headerlink" href="#high-level-implementation-architecture" title="Permalink to this headline">¶</a></h5>
<p>The overall architecture, including <em>`Neutron &lt;#Neutron&gt;`__</em> domain
specific mapping, and the <a class="reference external" href="#OfOverlay">OpenFlow Overlay renderer</a>
looks as so:</p>
<div class="figure" id="id187">
<img alt="GBP High Level Beryllium Architecture" src="../_images/GBP_High-levelBerylliumArchitecture.png" />
<p class="caption"><span class="caption-text">GBP High Level Beryllium Architecture</span></p>
</div>
<p>The major benefit of this architecture is that the mapping of the
domain-specific-language is completely separate and independent of the
underlying renderer implementation.</p>
<p>For instance, using the <a class="reference external" href="#Neutron">Neutron Mapper</a>, which maps the
Neutron API to the <strong>GBP</strong> core model, any contract automatically
generated from this mapping can be augmented via the <a class="reference external" href="#UX">UX</a> to use
<a class="reference external" href="#SFC">Service Function Chaining</a>, a capability not currently
available in OpenStack Neutron.</p>
<p>When another renderer is added, for instance, NetConf, the same policy
can now be leveraged across NetConf devices simultaneously:</p>
<div class="figure" id="id188">
<img alt="GBP High Level Beryllium Architecture - adding a renderer" src="../_images/GBP_High-levelExtraRenderer.png" />
<p class="caption"><span class="caption-text">GBP High Level Beryllium Architecture - adding a renderer</span></p>
</div>
<p>As other domain-specific mappings occur, they too can leverage the same
renderers, as the renderers only need to implement the <strong>GBP</strong> access
and forwarding models, and the domain-specific mapping need only manage
mapping to the access and forwarding models. For instance:</p>
<div class="figure" id="id189">
<img alt="GBP High Level Beryllium Architecture - adding a renderer" src="../_images/High-levelBerylliumArchitectureEvolution2.png" />
<p class="caption"><span class="caption-text">GBP High Level Beryllium Architecture - adding a renderer</span></p>
</div>
<p>In summary, the <strong>GBP</strong> architecture:</p>
<ul class="simple">
<li>separates concerns: the Expressed Intent is kept completely separated
from the underlying renderers.</li>
<li>is cohesive: each part does it’s part and it’s part only</li>
<li>is scalable: code can be optimised around model
mapping/implementation, and functionality re-used</li>
</ul>
</div>
</div>
<div class="section" id="policy-resolution">
<h4>Policy Resolution<a class="headerlink" href="#policy-resolution" title="Permalink to this headline">¶</a></h4>
<div class="section" id="contract-selection">
<h5>Contract Selection<a class="headerlink" href="#contract-selection" title="Permalink to this headline">¶</a></h5>
<p>The first step in policy resolution is to select the contracts that are
in scope.</p>
<p>EndpointGroups participate in contracts either as a <em>provider</em> or as a
<em>consumer</em> of a contract. Each EndpointGroup can participate in many
contracts at the same time, but for each contract it can be in only one
role at a time. In addition, there are two ways for an EndpointGroup to
select a contract: either with either a:</p>
<ul>
<li><p class="first"><em>named selector</em></p>
<p>Named selectors simply select a specific contract by its contract ID.</p>
</li>
<li><p class="first">target selector.</p>
<p>Target selectors allow for additional flexibility by matching against
<em>qualities</em> of the contract’s <em>target.</em></p>
</li>
</ul>
<p>Thus, there are a total of 4 kinds of contract selector:</p>
<ul>
<li><p class="first">provider named selector</p>
<p>Select a contract by contract ID, and participate as a provider.</p>
</li>
<li><p class="first">provider target selector</p>
<p>Match against a contract’s target with a quality matcher, and
participate as a provider.</p>
</li>
<li><p class="first">consumer named selector</p>
<p>Select a contract by contract ID, and participate as a consumer.</p>
</li>
<li><p class="first">consumer target selector</p>
<p>Match against a contract’s target with a quality matcher, and
participate as a consumer.</p>
</li>
</ul>
<p>To determine which contracts are in scope, contracts are found where
either the source EndpointGroup selects a contract as either a provider
or consumer, while the destination EndpointGroup matches against the
same contract in the corresponding role. So if endpoint <em>x</em> in
EndpointGroup <em>X</em> is communicating with endpoint <em>y</em> in EndpointGroup
<em>Y</em>, a contract <em>C</em> is in scope if either <em>X</em> selects <em>C</em> as a provider
and <em>Y</em> selects <em>C</em> as a consumer, or vice versa.</p>
<p>The details of how quality matchers work are described further in
<a class="reference external" href="#Matchers">Matchers</a>. Quality matchers provide a flexible mechanism
for contract selection based on labels.</p>
<p>The end result of the contract selection phase can be thought of as a
set of tuples representing selected contract scopes. The fields of the
tuple are:</p>
<ul class="simple">
<li>Contract ID</li>
<li>The provider EndpointGroup ID</li>
<li>The name of the selector in the provider EndpointGroup that was used
to select the contract, called the <em>matching provider selector.</em></li>
<li>The consumer EndpointGroup ID</li>
<li>The name of the selector in the consumer EndpointGroup that was used
to select the contract, called the <em>matching consumer selector.</em></li>
</ul>
<p>The result is then stored in the datastore under <strong>Resolved Policy</strong>.</p>
</div>
<div class="section" id="subject-selection">
<h5>Subject Selection<a class="headerlink" href="#subject-selection" title="Permalink to this headline">¶</a></h5>
<p>The second phase in policy resolution is to determine which subjects are
in scope. The subjects define what kinds of communication are allowed
between endpoints in the EndpointGroups. For each of the selected
contract scopes from the contract selection phase, the subject selection
procedure is applied.</p>
<p>Labels called, capabilities, requirements and conditions are matched
against to bring a Subject <em>into scope</em>. EndpointGroups have
capabilities and requirements, while endpoints have conditions.</p>
</div>
<div class="section" id="requirements-and-capabilities">
<h5>Requirements and Capabilities<a class="headerlink" href="#requirements-and-capabilities" title="Permalink to this headline">¶</a></h5>
<p>When acting as a <em>provider</em>, EndpointGroups expose <em>capabilities,</em> which
are labels representing specific pieces of functionality that can be
exposed to other EndpointGroups that may meet functional requirements of
those EndpointGroups.</p>
<p>When acting as a <em>consumer</em>, EndpointGroups expose <em>requirements</em>, which
are labels that represent that the EndpointGroup requires some specific
piece of functionality.</p>
<p>As an example, we might create a capability called &#8220;user-database&#8221; which
indicates that an EndpointGroup contains endpoints that implement a
database of users.</p>
<p>We might create a requirement also called &#8220;user-database&#8221; to indicate an
EndpointGroup contains endpoints that will need to communicate with the
endpoints that expose this service.</p>
<p>Note that in this example the requirement and capability have the same
name, but the user need not follow this convention.</p>
<p>The matching provider selector (that was used by the provider
EndpointGroup to select the contract) is examined to determine the
capabilities exposed by the provider EndpointGroup for this contract
scope.</p>
<p>The provider selector will have a list of capabilities either directly
included in the provider selector or inherited from a parent selector or
parent EndpointGroup. (See <a class="reference external" href="#Inheritance">Inheritance</a>).</p>
<p>Similarly, the matching consumer selector will expose a set of
requirements.</p>
</div>
<div class="section" id="conditions">
<h5>Conditions<a class="headerlink" href="#conditions" title="Permalink to this headline">¶</a></h5>
<p>Endpoints can have <em>conditions</em>, which are labels representing some
relevant piece of operational state related to the endpoint.</p>
<p>An example of a condition might be &#8220;malware-detected,&#8221; or
&#8220;authentication-succeeded.&#8221; Conditions are used to affect how that
particular endpoint can communicate.</p>
<p>To continue with our example, the &#8220;malware-detected&#8221; condition might
cause an endpoint’s connectivity to be cut off, while
&#8220;authentication-succeeded&#8221; might open up communication with services
that require an endpoint to be first authenticated and then forward its
authentication credentials.</p>
</div>
<div class="section" id="clauses">
<h5>Clauses<a class="headerlink" href="#clauses" title="Permalink to this headline">¶</a></h5>
<p>Clauses perform the actual selection of subjects. A clause has lists of
matchers in two categories. In order for a clause to become active, all
lists of matchers must match. A matching clause will select all the
subjects referenced by the clause. Note that an empty list of matchers
counts as a match.</p>
<p>The first category is the consumer matchers, which match against the
consumer EndpointGroup and endpoints. The consumer matchers are:</p>
<ul>
<li><p class="first">Group Idenfication Constraint: Requirement matchers</p>
<p>Matches against requirements in the matching consumer selector.</p>
</li>
<li><p class="first">Group Identification Constraint: GroupName</p>
<p>Matches against the group name</p>
</li>
<li><p class="first">Consumer condition matchers</p>
<p>Matches against conditions on endpoints in the consumer EndpointGroup</p>
</li>
<li><p class="first">Consumer Endpoint Identification Constraint</p>
<p>Label based criteria for matching against endpoints. In Beryllium
this can be used to label endpoints based on IpPrefix.</p>
</li>
</ul>
<p>The second category is the provider matchers, which match against the
provider EndpointGroup and endpoints. The provider matchers are:</p>
<ul>
<li><p class="first">Group Idenfication Constraint: Capability matchers</p>
<p>Matches against capabilities in the matching provider selector.</p>
</li>
<li><p class="first">Group Identification Constraint: GroupName</p>
<p>Matches against the group name</p>
</li>
<li><p class="first">Consumer condition matchers</p>
<p>Matches against conditions on endpoints in the provider EndpointGroup</p>
</li>
<li><p class="first">Consumer Endpoint Identification Constraint</p>
<p>Label based criteria for matching against endpoints. In Beryllium
this can be used to label endpoints based on IpPrefix.</p>
</li>
</ul>
<p>Clauses have a list of subjects that apply when all the matchers in the
clause match. The output of the subject selection phase logically is a
set of subjects that are in scope for any particular pair of endpoints.</p>
</div>
<div class="section" id="rule-application">
<h5>Rule Application<a class="headerlink" href="#rule-application" title="Permalink to this headline">¶</a></h5>
<p>Now subjects have been selected that apply to the traffic between a
particular set of endpoints, policy can be applied to allow endpoints to
communicate. The applicable subjects from the previous step will each
contain a set of rules.</p>
<p>Rules consist of a set of <em>classifiers</em> and a set of <em>actions</em>.
Classifiers match against traffic between two endpoints. An example of a
classifier would be something that matches against all TCP traffic on
port 80, or one that matches against HTTP traffic containing a
particular cookie. Actions are specific actions that need to be taken on
the traffic before it reaches its destination. Actions could include
tagging or encapsulating the traffic in some way, redirecting the
traffic, or applying a <a class="reference external" href="#SFC">service function chain</a>.</p>
<p>Rules, subjects, and actions have an <em>order</em> parameter, where a lower
order value means that a particular item will be applied first. All
rules from a particular subject will be applied before the rules of any
other subject, and all actions from a particular rule will be applied
before the actions from another rule. If more than item has the same
order parameter, ties are broken with a lexicographic ordering of their
names, with earlier names having logically lower order.</p>
<div class="section" id="matchers">
<h6>Matchers<a class="headerlink" href="#matchers" title="Permalink to this headline">¶</a></h6>
<p>Matchers specify a set of labels (which include requirements,
capabilities, conditions, and qualities) to match against. There are
several kinds of matchers that operate similarly:</p>
<ul>
<li><p class="first">Quality matchers</p>
<p>used in target selectors during the contract selection phase. Quality
matchers provide a more advanced and flexible way to select contracts
compared to a named selector.</p>
</li>
<li><p class="first">Requirement and capability matchers</p>
<p>used in clauses during the subject selection phase to match against
requirements and capabilities on EndpointGroups</p>
</li>
<li><p class="first">Condition matchers</p>
<p>used in clauses during the subject selection phase to match against
conditions on endpoints</p>
</li>
</ul>
<p>A matcher is, at its heart, fairly simple. It will contain a list of
label names, along with a <em>match type</em>. The match type can be either:</p>
<ul>
<li><p class="first">&#8220;all&#8221;</p>
<p>which means the matcher matches when all of its labels match</p>
</li>
<li><p class="first">&#8220;any&#8221;</p>
<p>which means the matcher matches when any of its labels match,</p>
</li>
<li><p class="first">&#8220;none&#8221;</p>
<p>which means the matcher matches when none of its labels match.</p>
</li>
</ul>
<p>Note a <em>match all</em> matcher can be made by matching against an empty set
of labels with a match type of &#8220;all.&#8221;</p>
<p>Additionally each label to match can optionally include a relevant name
field. For quality matchers, this is a target name. For capability and
requirement matchers, this is a selector name. If the name field is
specified, then the matcher will only match against targets or selectors
with that name, rather than any targets or selectors.</p>
</div>
</div>
<div class="section" id="inheritance">
<h5>Inheritance<a class="headerlink" href="#inheritance" title="Permalink to this headline">¶</a></h5>
<p>Some objects in the system include references to parents, from which
they will inherit definitions. The graph of parent references must be
loop free. When resolving names, the resolution system must detect loops
and raise an exception. Objects that are part of these loops may be
considered as though they are not defined at all. Generally, inheritance
works by simply importing the objects in the parent into the child
object. When there are objects with the same name in the child object,
then the child object will override the parent object according to rules
which are specific to the type of object. We’ll next explore the
detailed rules for inheritance for each type of object</p>
<p><strong>EndpointGroups</strong></p>
<p>EndpointGroups will inherit all their selectors from their parent
EndpointGroups. Selectors with the same names as selectors in the parent
EndpointGroups will inherit their behavior as defined below.</p>
<p><strong>Selectors</strong></p>
<p>Selectors include provider named selectors, provider target selectors,
consumer named selectors, and consumer target selectors. Selectors
cannot themselves have parent selectors, but when selectors have the
same name as a selector of the same type in the parent EndpointGroup,
then they will inherit from and override the behavior of the selector in
the parent EndpointGroup.</p>
<p><strong>Named Selectors</strong></p>
<p>Named selectors will add to the set of contract IDs that are selected by
the parent named selector.</p>
<p><strong>Target Selectors</strong></p>
<p>A target selector in the child EndpointGroup with the same name as a
target selector in the parent EndpointGroup will inherit quality
matchers from the parent. If a quality matcher in the child has the same
name as a quality matcher in the parent, then it will inherit as
described below under Matchers.</p>
<p><strong>Contracts</strong></p>
<p>Contracts will inherit all their targets, clauses and subjects from
their parent contracts. When any of these objects have the same name as
in the parent contract, then the behavior will be as defined below.</p>
<p><strong>Targets</strong></p>
<p>Targets cannot themselves have a parent target, but it may inherit from
targets with the same name as the target in a parent contract. Qualities
in the target will be inherited from the parent. If a quality with the
same name is defined in the child, then this does not have any semantic
effect except if the quality has its inclusion-rule parameter set to
&#8220;exclude.&#8221; In this case, then the label should be ignored for the
purpose of matching against this target.</p>
<p><strong>Subjects</strong></p>
<p>Subjects cannot themselves have a parent subject, but it may inherit
from a subject with the same name as the subject in a parent contract.
The order parameter in the child subject, if present, will override the
order parameter in the parent subject. The rules in the parent subject
will be added to the rules in the child subject. However, the rules will
not override rules of the same name. Instead, all rules in the parent
subject will be considered to run with a higher order than all rules in
the child; that is all rules in the child will run before any rules in
the parent. This has the effect of overriding any rules in the parent
without the potentially-problematic semantics of merging the ordering.</p>
<p><strong>Clauses</strong></p>
<p>Clauses cannot themselves have a parent clause, but it may inherit from
a clause with the same name as the clause in a parent contract. The list
of subject references in the parent clause will be added to the list of
subject references in the child clause. This is just a union operation.
A subject reference that refers to a subject name in the parent contract
might have that name overridden in the child contract. Each of the
matchers in the clause are also inherited by the child clause. Matchers
in the child of the same name and type as a matcher from the parent will
inherit from and override the parent matcher. See below under Matchers
for more information.</p>
<p><strong>Matchers</strong></p>
<p>Matchers include quality matchers, condition matchers, requirement
matchers, and capability matchers. Matchers cannot themselves have
parent matchers, but when there is a matcher of the same name and type
in the parent object, then the matcher in the child object will inherit
and override the behavior of the matcher in the parent object. The match
type, if specified in the child, overrides the value specified in the
parent. Labels are also inherited from the parent object. If there is a
label with the same name in the child object, this does not have any
semantic effect except if the label has its inclusion-rule parameter set
to &#8220;exclude.&#8221; In this case, then the label should be ignored for the
purpose of matching. Otherwise, the label with the same name will
completely override the label from the parent.</p>
</div>
</div>
</div>
<div class="section" id="using-the-gbp-ux-interface">
<h3>Using the GBP UX interface<a class="headerlink" href="#using-the-gbp-ux-interface" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id23">
<h4>Overview<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<p>These following components make up this application and are described in
more detail in following sections:</p>
<ul class="simple">
<li>Basic view</li>
<li>Governance view</li>
<li>Policy Expression view</li>
<li>Wizard view</li>
</ul>
<p>The <strong>GBP</strong> UX is access via:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">odl</span> <span class="n">controller</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</div>
<div class="section" id="basic-view">
<h4>Basic view<a class="headerlink" href="#basic-view" title="Permalink to this headline">¶</a></h4>
<p>Basic view contains 5 navigation buttons which switch user to the
desired section of application:</p>
<ul class="simple">
<li>Governance – switch to the Governance view (middle of graphic has the
same function)</li>
<li>Renderer configuration – switch to the Policy expression view with
Renderers section expanded</li>
<li>Policy expression – switch to the Policy expression view with Policy
section expanded</li>
<li>Operational constraints – placeholder for development in next release</li>
</ul>
<div class="figure" id="id190">
<img alt="Basic view" src="../_images/ui-1-basicview.png" />
<p class="caption"><span class="caption-text">Basic view</span></p>
</div>
</div>
<div class="section" id="governance-view">
<h4>Governance view<a class="headerlink" href="#governance-view" title="Permalink to this headline">¶</a></h4>
<p>Governance view consists from three columns.</p>
<div class="figure" id="id191">
<img alt="Governance view" src="../_images/ui-2-governanceview.png" />
<p class="caption"><span class="caption-text">Governance view</span></p>
</div>
<p><strong>Governance view – Basic view – Left column</strong></p>
<p>In the left column is Health section with Exception and Conflict buttons
with no functionality yet. This is a placeholder for development in
further releases.</p>
<p><strong>Governance view – Basic view – Middle column</strong></p>
<p>In the top half of this section is select box with list of tenants for
select. Once the tenant is selected, all sub sections in application
operate and display data with actual selected tenant.</p>
<p>Below the select box are buttons which display Expressed or Delivered
policy of Governance section. In the bottom half of this section is
select box with list of renderers for select. There is currently only
<a class="reference external" href="#OfOverlay">OfOverlay</a> renderer available.</p>
<p>Below the select box is Renderer configuration button, which switch the
app into the Policy expression view with Renderers section expanded for
performing CRUD operations. Renderer state button display Renderer state
view.</p>
<p><strong>Governance view – Basic view – Right column</strong></p>
<p>In the bottom part of the right section of Governance view is Home
button which switch the app to the Basic view.</p>
<p>In the top part is situated navigation menu with four main sections.</p>
<p>Policy expression button expand/collapse sub menu with three main parts
of Policy expression. By clicking on sub menu buttons, user will be
switched into the Policy expressions view with appropriate section
expanded for performing CRUD operations.</p>
<p>Renderer configuration button switches user into the Policy expressions
view.</p>
<p>Governance button expand/collapse sub menu with four main parts of
Governance section. Sub menu buttons of Governance section display
appropriate section of Governance view.</p>
<p>Operational constraints have no functionality yet, and is a placeholder
for development in further releases.</p>
<p>Below the menu is place for view info section which displays info about
actual selected element from the topology (explained below).</p>
<p><strong>Governance view – Expressed policy</strong></p>
<p>In this view are displayed contracts with their consumed and provided
EndpointGroups of actual selected tenant, which can be changed in select
box in the upper left corner.</p>
<p>By single-clicking on any contract or EPG, the data of actual selected
element will be shown in the right column below the menu. A Manage
button launches a display wizard window for managing configuration of
items such as <a class="reference external" href="#SFC">Service Function Chaining</a>.</p>
<div class="figure" id="id192">
<img alt="Expressed policy" src="../_images/ui-3-governanceview-expressed.png" />
<p class="caption"><span class="caption-text">Expressed policy</span></p>
</div>
<p><strong>Governance view – Delivered policy</strong> In this view are displayed
subjects with their consumed and provided EndpointGroups of actual
selected tenant, which can be changed in select box in the upper left
corner.</p>
<p>By single-clicking on any subject or EPG, the data of actual selected
element will be shown in the right column below the menu.</p>
<p>By double-click on subject the subject detail view will be displayed
with subject’s rules of actual selected subject, which can be changed in
select box in the upper left corner.</p>
<p>By single-clicking on rule or subject, the data of actual selected
element will be shown in the right column below the menu.</p>
<p>By double-clicking on EPG in Delivered policy view, the EPG detail view
will be displayed with EPG’s endpoints of actual selected EPG, which can
be changed in select box in the upper left corner.</p>
<p>By single-clicking on EPG or endpoint the data of actual selected
element will be shown in the right column below the menu.</p>
<div class="figure" id="id193">
<img alt="Delivered policy" src="../_images/ui-4-governanceview-delivered-0.png" />
<p class="caption"><span class="caption-text">Delivered policy</span></p>
</div>
<div class="figure" id="id194">
<img alt="Subject detail" src="../_images/ui-4-governanceview-delivered-1-subject.png" />
<p class="caption"><span class="caption-text">Subject detail</span></p>
</div>
<div class="figure" id="id195">
<img alt="EPG detail" src="../_images/ui-4-governanceview-delivered-2-epg.png" />
<p class="caption"><span class="caption-text">EPG detail</span></p>
</div>
<p><strong>Governance view – Renderer state</strong></p>
<p>In this part are displayed Subject feature definition data with two main
parts: Action definition and Classifier definition.</p>
<p>By clicking on the down/right arrow in the circle is possible to
expand/hide data of appropriate container or list. Next to the list node
are displayed names of list’s elements where one is always selected and
element’s data are shown (blue line under the name).</p>
<p>By clicking on names of children nodes is possible to select desired
node and node’s data will be displayed.</p>
<div class="figure" id="id196">
<img alt="Renderer state" src="../_images/ui-4-governanceview-renderer.png" />
<p class="caption"><span class="caption-text">Renderer state</span></p>
</div>
</div>
<div class="section" id="policy-expression-view">
<h4>Policy expression view<a class="headerlink" href="#policy-expression-view" title="Permalink to this headline">¶</a></h4>
<p>In the left part of this view is placed topology of actual selected
elements with the buttons for switching between types of topology at the
bottom.</p>
<p>Right column of this view contains four parts. At the top of this column
are displayed breadcrumbs with actual position in the application.</p>
<p>Below the breadcrumbs is select box with list of tenants for select. In
the middle part is situated navigation menu, which allows switch to the
desired section for performing CRUD operations.</p>
<p>At the bottom is quick navigation menu with Access Model Wizard button
which display Wizard view, Home button which switch application to the
Basic view and occasionally Back button, which switch application to the
upper section.</p>
<p><strong>Policy expression - Navigation menu</strong></p>
<p>To open Policy expression, select Policy expression from the GBP Home
screen.</p>
<p>In the top of navigation box you can select the tenant from the tenants
list to activate features addicted to selected tenant.</p>
<p>In the right menu, by default, the Policy menu section is expanded.
Subitems of this section are modules for CRUD (creating, reading,
updating and deleting) of tenants, EndpointGroups, contracts, L2/L3
objects.</p>
<ul class="simple">
<li>Section Renderers contains CRUD forms for Classifiers and Actions.</li>
<li>Section Endpoints contains CRUD forms for Endpoint and L3 prefix
endpoint.</li>
</ul>
<div class="figure" id="id197">
<img alt="Navigation menu" src="../_images/ui-5-expresssion-1.png" />
<p class="caption"><span class="caption-text">Navigation menu</span></p>
</div>
<div class="figure" id="id198">
<img alt="CRUD operations" src="../_images/ui-5-expresssion-2.png" />
<p class="caption"><span class="caption-text">CRUD operations</span></p>
</div>
<p><strong>Policy expression - Types of topology</strong></p>
<p>There are three different types of topology:</p>
<ul class="simple">
<li>Configured topology - EndpointGroups and contracts between them from
CONFIG datastore</li>
<li>Operational topology - displays same information but is based on
operational data.</li>
<li>L2/L3 - displays relationships between L3Contexts, L2 Bridge domains,
L2 Flood domains and Subnets.</li>
</ul>
<div class="figure" id="id199">
<img alt="L2/L3 Topology" src="../_images/ui-5-expresssion-3.png" />
<p class="caption"><span class="caption-text">L2/L3 Topology</span></p>
</div>
<div class="figure" id="id200">
<img alt="Config Topology" src="../_images/ui-5-expresssion-4.png" />
<p class="caption"><span class="caption-text">Config Topology</span></p>
</div>
<p><strong>Policy expression - CRUD operations</strong></p>
<p>In this part are described basic flows for viewing, adding, editing and
deleting system elements like tenants, EndpointGroups etc.</p>
</div>
<div class="section" id="tenants">
<h4>Tenants<a class="headerlink" href="#tenants" title="Permalink to this headline">¶</a></h4>
<p>To edit tenant objects click the Tenants button in the right menu. You
can see the CRUD form containing tenants list and control buttons.</p>
<p>To add new tenant, click the Add button This will display the form for
adding a new tenant. After filling tenant attributes Name and
Description click Save button. Saving of any object can be performed
only if all the object attributes are filled correctly. If some
attribute doesn’t have correct value, exclamation mark with mouse-over
tooltip will be displayed next to the label for the attribute. After
saving of tenant the form will be closed and the tenants list will be
set to default value.</p>
<p>To view an existing tenant, select the tenant from the select box
Tenants list. The view form is read-only and can be closed by clicking
cross mark in the top right of the form.</p>
<p>To edit selected tenant, click the Edit button, which will display the
edit form for selected tenant. After editing the Name and Description of
selected tenant click the Save button to save selected tenant. After
saving of tenant the edit form will be closed and the tenants list will
be set to default value.</p>
<p>To delete tenant select the tenant from the Tenants list and click
Delete button.</p>
<p>To return to the Policy expression click Back button on the bottom of
window.</p>
<p><strong>EndpointGroups</strong></p>
<p>For managing EndpointGroups (EPG) the tenant from the top Tenants list
must be selected.</p>
<p>To add new EPG click Add button and after filling required attributes
click Save button. After adding the EPG you can edit it and assign
Consumer named selector or Provider named selector to it.</p>
<p>To edit EPG click the Edit button after selecting the EPG from Group
list.</p>
<p>To add new Consumer named selector (CNS) click the Add button next to
the Consumer named selectors list. While CNS editing you can set one or
more contracts for current CNS pressing the Plus button and selecting
the contract from the Contracts list. To remove the contract, click on
the cross mark next to the contract. Added CNS can be viewed, edited or
deleted by selecting from the Consumer named selectors list and clicking
the Edit and Delete buttons like with the EPG or tenants.</p>
<p>To add new Provider named selector (PNS) click the Add button next to
the Provider named selectors list. While PNS editing you can set one or
more contracts for current PNS pressing the Plus button and selecting
the contract from the Contracts list. To remove the contract, click on
the cross mark next to the contract. Added PNS can be viewed, edited or
deleted by selecting from the Provider named selectors list and clicking
the Edit and Delete buttons like with the EPG or tenants.</p>
<p>To delete EPG, CNS or PNS select it in selectbox and click the Delete
button next to the selectbox.</p>
<p><strong>Contracts</strong></p>
<p>For managing contracts the tenant from the top Tenants list must be
selected.</p>
<p>To add new Contract click Add button and after filling required fields
click Save button.</p>
<p>After adding the Contract user can edit it by selecting in the Contracts
list and clicking Edit button.</p>
<p>To add new Clause click Add button next to the Clause list while editing
the contract. While editing the Clause after selecting clause from the
Clause list user can assign clause subjects by clicking the Plus button
next to the Clause subjects label. Adding and editing action must be
submitted by pressing Save button. To manage Subjects you can use CRUD
form like with the Clause list.</p>
<p><strong>L2/L3</strong></p>
<p>For managing L2/L3 the tenant from the top Tenants list must be
selected.</p>
<p>To add L3 Context click the Add button next to the L3 Context list
,which will display the form for adding a new L3 Context. After filling
L3 Context attributes click Save button. After saving of L3 Context,
form will be closed and the L3 Context list will be set to default
value.</p>
<p>To view an existing L3 Context, select the L3 Context from the select
box L3 Context list. The view form is read-only and can be closed by
clicking cross mark in the top right of the form.</p>
<p>If user wants to edit selected L3 Context, click the Edit button, which
will display the edit form for selected L3 Context. After editing click
the Save button to save selected L3 Context. After saving of L3 Context,
the edit form will be closed and the L3 Context list will be set to
default value.</p>
<p>To delete L3 Context, select it from the L3 Context list and click
Delete button.</p>
<p>To add L2 Bridge Domain, click the Add button next to the L2 Bridge
Domain list. This will display the form for adding a new L2 Bridge
Domain. After filling L2 Bridge Domain attributes click Save button.
After saving of L2 Bridge Domain, form will be closed and the L2 Bridge
Domain list will be set to default value.</p>
<p>To view an existing L2 Bridge Domain, select the L2 Bridge Domain from
the select box L2 Bridge Domain list. The view form is read-only and can
be closed by clicking cross mark in the top right of the form.</p>
<p>If user wants to edit selected L2 Bridge Domain, click the Edit button,
which will display the edit form for selected L2 Bridge Domain. After
editing click the Save button to save selected L2 Bridge Domain. After
saving of L2 Bridge Domain the edit form will be closed and the L2
Bridge Domain list will be set to default value.</p>
<p>To delete L2 Bridge Domain select it from the L2 Bridge Domain list and
click Delete button.</p>
<p>To add L3 Flood Domain, click the Add button next to the L3 Flood Domain
list. This will display the form for adding a new L3 Flood Domain. After
filling L3 Flood Domain attributes click Save button. After saving of L3
Flood Domain, form will be closed and the L3 Flood Domain list will be
set to default value.</p>
<p>To view an existing L3 Flood Domain, select the L3 Flood Domain from the
select box L3 Flood Domain list. The view form is read-only and can be
closed by clicking cross mark in the top right of the form.</p>
<p>If user wants to edit selected L3 Flood Domain, click the Edit button,
which will display the edit form for selected L3 Flood Domain. After
editing click the Save button to save selected L3 Flood Domain. After
saving of L3 Flood Domain the edit form will be closed and the L3 Flood
Domain list will be set to default value.</p>
<p>To delete L3 Flood Domain select it from the L3 Flood Domain list and
click Delete button.</p>
<p>To add Subnet click the Add button next to the Subnet list. This will
display the form for adding a new Subnet. After filling Subnet
attributes click Save button. After saving of Subnet, form will be
closed and the Subnet list will be set to default value.</p>
<p>To view an existing Subnet, select the Subnet from the select box Subnet
list. The view form is read-only and can be closed by clicking cross
mark in the top right of the form.</p>
<p>If user wants to edit selected Subnet, click the Edit button, which will
display the edit form for selected Subnet. After editing click the Save
button to save selected Subnet. After saving of Subnet the edit form
will be closed and the Subnet list will be set to default value.</p>
<p>To delete Subnet select it from the Subnet list and click Delete button.</p>
<p><strong>Classifiers</strong></p>
<p>To add Classifier, click the Add button next to the Classifier list.
This will display the form for adding a new Classifier. After filling
Classifier attributes click Save button. After saving of Classifier,
form will be closed and the Classifier list will be set to default
value.</p>
<p>To view an existing Classifier, select the Classifier from the select
box Classifier list. The view form is read-only and can be closed by
clicking cross mark in the top right of the form.</p>
<p>If you want to edit selected Classifier, click the Edit button, which
will display the edit form for selected Classifier. After editing click
the Save button to save selected Classifier. After saving of Classifier
the edit form will be closed and the Classifier list will be set to
default value.</p>
<p>To delete Classifier select it from the Classifier list and click Delete
button.</p>
<p><strong>Actions</strong></p>
<p>To add Action, click the Add button next to the Action list. This will
display the form for adding a new Action. After filling Action
attributes click Save button. After saving of Action, form will be
closed and the Action list will be set to default value.</p>
<p>To view an existing Action, select the Action from the select box Action
list. The view form is read-only and can be closed by clicking cross
mark in the top right of the form.</p>
<p>If user wants to edit selected Action, click the Edit button, which will
display the edit form for selected Action. After editing click the Save
button to save selected Action. After saving of Action the edit form
will be closed and the Action list will be set to default value.</p>
<p>To delete Action select it from the Action list and click Delete button.</p>
<p><strong>Endpoint</strong></p>
<p>To add Endpoint, click the Add button next to the Endpoint list. This
will display the form for adding a new Endpoint. To add EndpointGroup
assignment click the Plus button next to the label EndpointGroups. To
add Condition click Plus button next to the label Condition. To add L3
Address click the Plus button next to the L3 Addresses label. After
filling Endpoint attributes click Save button. After saving of Endpoint,
form will be closed and the Endpoint list will be set to default value.</p>
<p>To view an existing Endpoint just, the Endpoint from the select box
Endpoint list. The view form is read-only and can be closed by clicking
cross mark in the top right of the form.</p>
<p>If you want to edit selected Endpoint, click the Edit button, which will
display the edit form for selected Endpoint. After editing click the
Save button to save selected Endpoint. After saving of Endpoint the edit
form will be closed and the Endpoint list will be set to default value.</p>
<p>To delete Endpoint select it from the Endpoint list and click Delete
button.</p>
<p><strong>L3 prefix endpoint</strong></p>
<p>To add L3 prefix endpoint, click the Add button next to the L3 prefix
endpoint list. This will display the form for adding a new Endpoint. To
add EndpointGroup assignment, click the Plus button next to the label
EndpointGroups. To add Condition, click Plus button next to the label
Condition. To add L2 gateway click the Plus button next to the L2
gateways label. To add L3 gateway, click the Plus button next to the L3
gateways label. After filling L3 prefix endpoint attributes click Save
button. After saving of L3 prefix endpoint, form will be closed and the
Endpoint list will be set to default value.</p>
<p>To view an existing L3 prefix endpoint, select the Endpoint from the
select box L3 prefix endpoint list. The view form is read-only and can
be closed by clicking cross mark in the top right of the form.</p>
<p>If you want to edit selected L3 prefix endpoint, click the Edit button,
which will display the edit form for selected L3 prefix endpoint. After
editing click the Save button to save selected L3 prefix endpoint. After
saving of Endpoint the edit form will be closed and the Endpoint list
will be set to default value.</p>
<p>To delete Endpoint select it from the L3 prefix endpoint list and click
Delete button.</p>
</div>
<div class="section" id="wizard">
<h4>Wizard<a class="headerlink" href="#wizard" title="Permalink to this headline">¶</a></h4>
<p>Wizard provides quick method to send basic data to controller necessary
for basic usage of GBP application. It is useful in the case that there
aren’t any data in controller. In the first tab is form for create
tenant. The second tab is for CRUD operations with contracts and their
sub elements such as subjects, rules, clauses, action refs and
classifier refs. The last tab is for CRUD operations with EndpointGroups
and their CNS and PNS. Created structure of data is possible to send by
clicking on Submit button.</p>
<div class="figure" id="id201">
<img alt="Wizard" src="../_images/ui-6-wizard.png" />
<p class="caption"><span class="caption-text">Wizard</span></p>
</div>
</div>
</div>
<div class="section" id="using-the-gbp-api">
<h3>Using the GBP API<a class="headerlink" href="#using-the-gbp-api" title="Permalink to this headline">¶</a></h3>
<p>Please see:</p>
<ul class="simple">
<li><a class="reference external" href="#OfOverlay">Using the GBP OpenFlow Overlay (OfOverlay) renderer</a></li>
<li><a class="reference external" href="#policyresolution">Policy Resolution</a></li>
<li><a class="reference external" href="#forwarding">Forwarding Model</a></li>
<li><a class="reference external" href="#demo">the **GBP** demo and development environments for tips</a></li>
</ul>
<p>It is recommended to use either:</p>
<ul class="simple">
<li><a class="reference external" href="#Neutron">Neutron mapper</a></li>
<li><a class="reference external" href="#UX">the UX</a></li>
</ul>
<p>If the REST API must be used, and the above resources are not
sufficient:</p>
<ul class="simple">
<li>feature:install odl-dlux-yangui</li>
<li>browse to:
<a href="#id260"><span class="problematic" id="id262">`http://&lt;odl-controller&gt;:8181/index.html &lt;http://&lt;odl-controller&gt;:8181/index.html&gt;`__</span></a>
and select YangUI from the left menu.</li>
</ul>
<p>to explore the various <strong>GBP</strong> REST options</p>
</div>
<div class="section" id="using-openstack-with-gbp">
<h3>Using OpenStack with GBP<a class="headerlink" href="#using-openstack-with-gbp" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id24">
<h4>Overview<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h4>
<p>This section is for Application Developers and Network Administrators
who are looking to integrate Group Based Policy with OpenStack.</p>
<p>To enable the <strong>GBP</strong> Neutron Mapper feature, at the Karaf console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">groupbasedpolicy</span><span class="o">-</span><span class="n">neutronmapper</span>
</pre></div>
</div>
<p>Neutron Mapper has the following dependencies that are automatically
loaded:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">odl</span><span class="o">-</span><span class="n">neutron</span><span class="o">-</span><span class="n">service</span>
</pre></div>
</div>
<p>Neutron Northbound implementing REST API used by OpenStack</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">odl</span><span class="o">-</span><span class="n">groupbasedpolicy</span><span class="o">-</span><span class="n">base</span>
</pre></div>
</div>
<p>Base <strong>GBP</strong> feature set, such as policy resolution, data model etc.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">odl</span><span class="o">-</span><span class="n">groupbasedpolicy</span><span class="o">-</span><span class="n">ofoverlay</span>
</pre></div>
</div>
<p>REST calls from OpenStack Neutron are by the Neutron NorthBound project.</p>
<p><strong>GBP</strong> provides the implementation of the <a class="reference external" href="http://developer.openstack.org/api-ref-networking-v2.html">Neutron V2.0
API</a>.</p>
</div>
<div class="section" id="features">
<h4>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h4>
<p>List of supported Neutron entities:</p>
<ul class="simple">
<li>Port</li>
<li>Network<ul>
<li>Standard Internal</li>
<li>External provider L2/L3 network</li>
</ul>
</li>
<li>Subnet</li>
<li>Security-groups</li>
<li>Routers<ul>
<li>Distributed functionality with local routing per compute</li>
<li>External gateway access per compute node (dedicated port required)</li>
<li>Multiple routers per tenant</li>
</ul>
</li>
<li>FloatingIP NAT</li>
<li>IPv4/IPv6 support</li>
</ul>
<p>The mapping of Neutron entities to <strong>GBP</strong> entities is as follows:</p>
<p><strong>Neutron Port</strong></p>
<div class="figure" id="id202">
<img alt="Neutron Port" src="../_images/neutronmapper-gbp-mapping-port1.png" />
<p class="caption"><span class="caption-text">Neutron Port</span></p>
</div>
<p>The Neutron port is mapped to an endpoint.</p>
<p>The current implementation supports one IP address per Neutron port.</p>
<p>An endpoint and L3-endpoint belong to multiple EndpointGroups if the
Neutron port is in multiple Neutron Security Groups.</p>
<p>The key for endpoint is L2-bridge-domain obtained as the parent of
L2-flood-domain representing Neutron network. The MAC address is from
the Neutron port. An L3-endpoint is created based on L3-context (the
parent of the L2-bridge-domain) and IP address of Neutron Port.</p>
<p><strong>Neutron Network</strong></p>
<div class="figure" id="id203">
<img alt="Neutron Network" src="../_images/neutronmapper-gbp-mapping-network1.png" />
<p class="caption"><span class="caption-text">Neutron Network</span></p>
</div>
<p>A Neutron network has the following characteristics:</p>
<ul class="simple">
<li>defines a broadcast domain</li>
<li>defines a L2 transmission domain</li>
<li>defines a L2 name space.</li>
</ul>
<p>To represent this, a Neutron Network is mapped to multiple <strong>GBP</strong>
entities. The first mapping is to an L2 flood-domain to reflect that the
Neutron network is one flooding or broadcast domain. An L2-bridge-domain
is then associated as the parent of L2 flood-domain. This reflects both
the L2 transmission domain as well as the L2 addressing namespace.</p>
<p>The third mapping is to L3-context, which represents the distinct L3
address space. The L3-context is the parent of L2-bridge-domain.</p>
<p><strong>Neutron Subnet</strong></p>
<div class="figure" id="id204">
<img alt="Neutron Subnet" src="../_images/neutronmapper-gbp-mapping-subnet1.png" />
<p class="caption"><span class="caption-text">Neutron Subnet</span></p>
</div>
<p>Neutron subnet is associated with a Neutron network. The Neutron subnet
is mapped to a <strong>GBP</strong> subnet where the parent of the subnet is
L2-flood-domain representing the Neutron network.</p>
<p><strong>Neutron Security Group</strong></p>
<div class="figure" id="id205">
<img alt="Neutron Security Group and Rules" src="../_images/neutronmapper-gbp-mapping-securitygroup1.png" />
<p class="caption"><span class="caption-text">Neutron Security Group and Rules</span></p>
</div>
<p><strong>GBP</strong> entity representing Neutron security-group is EndpointGroup.</p>
<p><strong>Infrastructure EndpointGroups</strong></p>
<p>Neutron-mapper automatically creates EndpointGroups to manage key
infrastructure items such as:</p>
<ul class="simple">
<li>DHCP EndpointGroup - contains endpoints representing Neutron DHCP
ports</li>
<li>Router EndpointGroup - contains endpoints representing Neutron router
interfaces</li>
<li>External EndpointGroup - holds L3-endpoints representing Neutron
router gateway ports, also associated with FloatingIP ports.</li>
</ul>
<p><strong>Neutron Security Group Rules</strong></p>
<p>This is the most involved amongst all the mappings because Neutron
security-group-rules are mapped to contracts with clauses, subjects,
rules, action-refs, classifier-refs, etc. Contracts are used between
EndpointGroups representing Neutron Security Groups. For simplification
it is important to note that Neutron security-group-rules are similar to
a <strong>GBP</strong> rule containing:</p>
<ul class="simple">
<li>classifier with direction</li>
<li>action of <strong>allow</strong>.</li>
</ul>
<p><strong>Neutron Routers</strong></p>
<div class="figure" id="id206">
<img alt="Neutron Router" src="../_images/neutronmapper-gbp-mapping-router1.png" />
<p class="caption"><span class="caption-text">Neutron Router</span></p>
</div>
<p>Neutron router is represented as a L3-context. This treats a router as a
Layer3 namespace, and hence every network attached to it a part of that
Layer3 namespace.</p>
<p>This allows for multiple routers per tenant with complete isolation.</p>
<p>The mapping of the router to an endpoint represents the router’s
interface or gateway port.</p>
<p>The mapping to an EndpointGroup represents the internal infrastructure
EndpointGroups created by the <strong>GBP</strong> Neutron Mapper</p>
<p>When a Neutron router interface is attached to a network/subnet, that
network/subnet and its associated endpoints or Neutron Ports are
seamlessly added to the namespace.</p>
<p><strong>Neutron FloatingIP</strong></p>
<p>When associated with a Neutron Port, this leverages the
<a class="reference external" href="#OfOverlay">OfOverlay</a> renderer’s NAT capabilities.</p>
<p>A dedicated <em>external</em> interface on each Nova compute host allows for
disitributed external access. Each Nova instance associated with a
FloatingIP address can access the external network directly without
having to route via the Neutron controller, or having to enable any form
of Neutron distributed routing functionality.</p>
<p>Assuming the gateway provisioned in the Neutron Subnet command for the
external network is reachable, the combination of <strong>GBP</strong> Neutron Mapper
and <a class="reference external" href="#OfOverlay">OfOverlay renderer</a> will automatically ARP for this
default gateway, requiring no user intervention.</p>
<p><strong>Troubleshooting within GBP</strong></p>
<p>Logging level for the mapping functionality can be set for package
org.opendaylight.groupbasedpolicy.neutron.mapper. An example of enabling
TRACE logging level on Karaf console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">log</span><span class="p">:</span><span class="nb">set</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">groupbasedpolicy</span><span class="o">.</span><span class="n">neutron</span><span class="o">.</span><span class="n">mapper</span>
</pre></div>
</div>
<p><strong>Neutron mapping example</strong></p>
<p>As an example for mapping can be used creation of Neutron network,
subnet and port. When a Neutron network is created 3 <strong>GBP</strong> entities
are created: l2-flood-domain, l2-bridge-domain, l3-context.</p>
<div class="figure" id="id207">
<img alt="Neutron network mapping" src="../_images/neutronmapper-gbp-mapping-network-example1.png" />
<p class="caption"><span class="caption-text">Neutron network mapping</span></p>
</div>
<p>After an subnet is created in the network mapping looks like this.</p>
<div class="figure" id="id208">
<img alt="Neutron subnet mapping" src="../_images/neutronmapper-gbp-mapping-subnet-example1.png" />
<p class="caption"><span class="caption-text">Neutron subnet mapping</span></p>
</div>
<p>If an Neutron port is created in the subnet an endpoint and l3-endpoint
are created. The endpoint has key composed from l2-bridge-domain and MAC
address from Neutron port. A key of l3-endpoint is compesed from
l3-context and IP address. The network containment of endpoint and
l3-endpoint points to the subnet.</p>
<div class="figure" id="id209">
<img alt="Neutron port mapping" src="../_images/neutronmapper-gbp-mapping-port-example1.png" />
<p class="caption"><span class="caption-text">Neutron port mapping</span></p>
</div>
</div>
<div class="section" id="configuring-gbp-neutron">
<h4>Configuring GBP Neutron<a class="headerlink" href="#configuring-gbp-neutron" title="Permalink to this headline">¶</a></h4>
<p>No intervention passed initial OpenStack setup is required by the user.</p>
<p>More information about configuration can be found in our DevStack demo
environment on the <a class="reference external" href="https://wiki.opendaylight.org/view/Group_Based_Policy_(GBP)">**GBP**
wiki</a>.</p>
</div>
<div class="section" id="administering-or-managing-gbp-neutron">
<h4>Administering or Managing GBP Neutron<a class="headerlink" href="#administering-or-managing-gbp-neutron" title="Permalink to this headline">¶</a></h4>
<p>For consistencies sake, all provisioning should be performed via the
Neutron API. (CLI or Horizon).</p>
<p>The mapped policies can be augmented via the <strong>GBP</strong> <a class="reference external" href="#UX">UX</a>, to:</p>
<ul class="simple">
<li>Enable <a class="reference external" href="#SFC">Service Function Chaining</a></li>
<li>Add endpoints from outside of Neutron i.e. VMs/containers not
provisioned in OpenStack</li>
<li>Augment policies/contracts derived from Security Group Rules</li>
<li>Overlay additional contracts or groupings</li>
</ul>
</div>
<div class="section" id="id25">
<h4>Tutorials<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<p>A DevStack demo environment can be found on the <a class="reference external" href="https://wiki.opendaylight.org/view/Group_Based_Policy_(GBP)">**GBP**
wiki</a>.</p>
</div>
</div>
<div class="section" id="using-the-gbp-openflow-overlay-ofoverlay-renderer">
<h3>Using the GBP OpenFlow Overlay (OfOverlay) renderer<a class="headerlink" href="#using-the-gbp-openflow-overlay-ofoverlay-renderer" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id26">
<h4>Overview<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>The OpenFlow Overlay (OfOverlay) feature enables the OpenFlow Overlay
renderer, which creates a network virtualization solution across nodes
that host Open vSwitch software switches.</p>
<div class="section" id="installing-and-pre-requisites">
<h5>Installing and Pre-requisites<a class="headerlink" href="#installing-and-pre-requisites" title="Permalink to this headline">¶</a></h5>
<p>From the Karaf console in OpenDaylight:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">groupbasedpolicy</span><span class="o">-</span><span class="n">ofoverlay</span>
</pre></div>
</div>
<p>This renderer is designed to work with OpenVSwitch (OVS) 2.1+ (although
2.3 is strongly recommended) and OpenFlow 1.3.</p>
<p>When used in conjunction with the <a class="reference external" href="#Neutron">Neutron Mapper feature</a>
no extra OfOverlay specific setup is required.</p>
<p>When this feature is loaded &#8220;standalone&#8221;, the user is required to
configure infrastructure, such as</p>
<ul class="simple">
<li>instantiating OVS bridges,</li>
<li>attaching hosts to the bridges,</li>
<li>and creating the VXLAN/VXLAN-GPE tunnel ports on the bridges.</li>
</ul>
<p>The <strong>GBP</strong> OfOverlay renderer also supports a table offset option, to
offset the pipeline post-table 0. The value of table offset is stored in
the config datastore and it may be rewritten at runtime.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">{{</span><span class="n">controllerIp</span><span class="p">}}:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">ofoverlay</span><span class="p">:</span><span class="n">of</span><span class="o">-</span><span class="n">overlay</span><span class="o">-</span><span class="n">config</span>
<span class="p">{</span>
    <span class="s2">&quot;of-overlay-config&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;gbp-ofoverlay-table-offset&quot;</span><span class="p">:</span> <span class="mi">6</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default value is set by changing:
&lt;gbp-ofoverlay-table-offset&gt;0&lt;/gbp-ofoverlay-table-offset&gt;</p>
<p>in file:
distribution-karaf/target/assembly/etc/opendaylight/karaf/15-groupbasedpolicy-ofoverlay.xml</p>
<p>To avoid overwriting runtime changes, the default value is used only
when the OfOverlay renderer starts and no other value has been written
before.</p>
</div>
</div>
<div class="section" id="openflow-overlay-architecture">
<h4>OpenFlow Overlay Architecture<a class="headerlink" href="#openflow-overlay-architecture" title="Permalink to this headline">¶</a></h4>
<p>These are the primary components of <strong>GBP</strong>. The OfOverlay components
are highlighted in red.</p>
<div class="figure" id="id210">
<img alt="OfOverlay within **GBP**" src="../_images/ofoverlay-1-components.png" />
<p class="caption"><span class="caption-text">OfOverlay within <strong>GBP</strong></span></p>
</div>
<p>In terms of the inner components of the <strong>GBP</strong> OfOverlay renderer:</p>
<div class="figure" id="id211">
<img alt="OfOverlay expanded view:" src="../_images/ofoverlay-2-components.png" />
<p class="caption"><span class="caption-text">OfOverlay expanded view:</span></p>
</div>
<p><strong>OfOverlay Renderer</strong></p>
<p>Launches components below:</p>
<p><strong>Policy Resolver</strong></p>
<p>Policy resolution is completely domain independent, and the OfOverlay
leverages process policy information internally. See <a class="reference external" href="#policyresolution">Policy Resolution
process</a>.</p>
<p>It listens to inputs to the <em>Tenants</em> configuration datastore, validates
tenant input, then writes this to the Tenants operational datastore.</p>
<p>From there an internal notification is generated to the PolicyManager.</p>
<p>In the next release, this will be moving to a non-renderer specific
location.</p>
<p><strong>Endpoint Manager</strong></p>
<p>The endpoint repository operates in <strong>orchestrated</strong> mode. This means
the user is responsible for the provisioning of endpoints via:</p>
<ul>
<li><p class="first"><a class="reference external" href="#UX">UX/GUI</a></p>
</li>
<li><p class="first">REST API</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>When using the <a class="reference external" href="#Neutron">Neutron mapper</a> feature, everything is
managed transparently via Neutron.</p>
</div></blockquote>
</li>
</ul>
<p>The Endpoint Manager is responsible for listening to Endpoint repository
updates and notifying the Switch Manager when a valid Endpoint has been
registered.</p>
<p>It also supplies utility functions to the flow pipeline process.</p>
<p><strong>Switch Manager</strong></p>
<p>The Switch Manager is purely a state manager.</p>
<p>Switches are in one of 3 states:</p>
<ul class="simple">
<li>DISCONNECTED</li>
<li>PREPARING</li>
<li>READY</li>
</ul>
<p><strong>Ready</strong> is denoted by a connected switch:</p>
<ul class="simple">
<li>having a tunnel interface</li>
<li>having at least one endpoint connected.</li>
</ul>
<p>In this way <strong>GBP</strong> is not writing to switches it has no business to.</p>
<p><strong>Preparing</strong> simply means the switch has a controller connection but is
missing one of the above <em>complete and necessary</em> conditions</p>
<p><strong>Disconnected</strong> means a previously connected switch is no longer
present in the Inventory operational datastore.</p>
<div class="figure" id="id212">
<img alt="OfOverlay Flow Pipeline" src="../_images/ofoverlay-3-flowpipeline.png" />
<p class="caption"><span class="caption-text">OfOverlay Flow Pipeline</span></p>
</div>
<p>The OfOverlay leverages Nicira registers as follows:</p>
<ul class="simple">
<li>REG0 = Source EndpointGroup + Tenant ordinal</li>
<li>REG1 = Source Conditions + Tenant ordinal</li>
<li>REG2 = Destination EndpointGroup + Tenant ordinal</li>
<li>REG3 = Destination Conditions + Tenant ordinal</li>
<li>REG4 = Bridge Domain + Tenant ordinal</li>
<li>REG5 = Flood Domain + Tenant ordinal</li>
<li>REG6 = Layer 3 Context + Tenant ordinal</li>
</ul>
<p><strong>Port Security</strong></p>
<p>Table 0 of the OpenFlow pipeline. Responsible for ensuring that only
valid connections can send packets into the pipeline:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">3</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">1</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">121</span><span class="p">,</span><span class="n">arp</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">,</span><span class="n">arp_spa</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.3</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">,</span><span class="n">nw_src</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.3</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">115</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">,</span><span class="n">nw_dst</span><span class="o">=</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">112</span><span class="p">,</span><span class="n">ipv6</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span> <span class="n">ip</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span><span class="n">arp</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
</pre></div>
</div>
<p>Ingress from tunnel interface, go to Table <em>Source Mapper</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">3</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>Ingress from outside, goto Table <em>Ingress NAT Mapper</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<p>ARP from Endpoint, go to Table <em>Source Mapper</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">121</span><span class="p">,</span><span class="n">arp</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">,</span><span class="n">arp_spa</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.3</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>IPv4 from Endpoint, go to Table <em>Source Mapper</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">,</span><span class="n">nw_src</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.3</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>DHCP DORA from Endpoint, go to Table <em>Source Mapper</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">115</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span><span class="p">,</span><span class="n">nw_dst</span><span class="o">=</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.255</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>Series of DROP tables with priority set to capture any non-specific
traffic that should have matched above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">112</span><span class="p">,</span><span class="n">ipv6</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span> <span class="n">ip</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
<span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span><span class="n">arp</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
</pre></div>
</div>
<p>&#8220;L2&#8221; catch all traffic not identified above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">d5</span><span class="p">:</span><span class="n">b9</span><span class="p">:</span><span class="mi">8</span><span class="n">d</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>Drop Flow:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
</pre></div>
</div>
<p><strong>Ingress NAT Mapper</strong></p>
<p>Table <a class="reference external" href="#offset">*offset*</a>+1.</p>
<p>ARP responder for external NAT address:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">arp</span><span class="p">,</span><span class="n">arp_tpa</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">111.51</span><span class="p">,</span><span class="n">arp_op</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">move</span><span class="p">:</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_OF_ETH_DST</span><span class="p">[],</span><span class="n">set_field</span><span class="p">:</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="n">dd</span><span class="o">-&gt;</span><span class="n">eth_src</span><span class="p">,</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_OF_ARP_OP</span><span class="p">[],</span><span class="n">move</span><span class="p">:</span><span class="n">NXM_NX_ARP_SHA</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_NX_ARP_THA</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0xfa163e58c3dd</span><span class="o">-&gt;</span><span class="n">NXM_NX_ARP_SHA</span><span class="p">[],</span><span class="n">move</span><span class="p">:</span><span class="n">NXM_OF_ARP_SPA</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_OF_ARP_TPA</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0xc0a86f33</span><span class="o">-&gt;</span><span class="n">NXM_OF_ARP_SPA</span><span class="p">[],</span><span class="n">IN_PORT</span>
</pre></div>
</div>
<p>Translate from Outside to Inside and perform same functions as
SourceMapper.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">nw_dst</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">111.51</span> <span class="n">actions</span><span class="o">=</span><span class="n">set_field</span><span class="p">:</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.2</span><span class="o">-&gt;</span><span class="n">ip_dst</span><span class="p">,</span><span class="n">set_field</span><span class="p">:</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="n">dd</span><span class="o">-&gt;</span><span class="n">eth_dst</span><span class="p">,</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG1</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x4</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG4</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x5</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG5</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x7</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG6</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x3</span><span class="o">-&gt;</span><span class="n">NXM_NX_TUN_ID</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">31</span><span class="p">],</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">3</span>
</pre></div>
</div>
<p><strong>Source Mapper</strong></p>
<p>Table <a class="reference external" href="#offset">*offset*</a>+2.</p>
<p>Determines based on characteristics from the ingress port, which:</p>
<ul class="simple">
<li>EndpointGroup(s) it belongs to</li>
<li>Forwarding context</li>
<li>Tunnel VNID ordinal</li>
</ul>
<p>Establishes tunnels at valid destination switches for ingress.</p>
<p>Ingress Tunnel established at remote node with VNID Ordinal that maps to
Source EPG, Forwarding Context etc:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">tun_id</span><span class="o">=</span><span class="mh">0xd</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">3</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0xc</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0xffffff</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG1</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x4</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG4</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x5</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG5</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x7</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG6</span><span class="p">[],</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">3</span>
</pre></div>
</div>
<p>Maps endpoint to Source EPG, Forwarding Context based on ingress port,
and MAC:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">in_port</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">b4</span><span class="p">:</span><span class="n">b4</span><span class="p">:</span><span class="n">b1</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0xc</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG0</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG1</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x4</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG4</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x5</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG5</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x7</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG6</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0xd</span><span class="o">-&gt;</span><span class="n">NXM_NX_TUN_ID</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">31</span><span class="p">],</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">3</span>
</pre></div>
</div>
<p>Generic drop:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">197.622</span><span class="n">s</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_packets</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_bytes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">drop</span>
</pre></div>
</div>
<p><strong>Destination Mapper</strong></p>
<p>Table <a class="reference external" href="#offset">*offset*</a>+3.</p>
<p>Determines based on characteristics of the endpoint:</p>
<ul class="simple">
<li>EndpointGroup(s) it belongs to</li>
<li>Forwarding context</li>
<li>Tunnel Destination value</li>
</ul>
<p>Manages routing based on valid ingress nodes ARP’ing for their default
gateway, and matches on either gateway MAC or destination endpoint MAC.</p>
<p>ARP for default gateway for the 10.1.1.0/24 subnet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">arp</span><span class="p">,</span><span class="n">reg6</span><span class="o">=</span><span class="mh">0x7</span><span class="p">,</span><span class="n">arp_tpa</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.1</span><span class="p">,</span><span class="n">arp_op</span><span class="o">=</span><span class="mi">1</span> <span class="n">actions</span><span class="o">=</span><span class="n">move</span><span class="p">:</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_OF_ETH_DST</span><span class="p">[],</span><span class="n">set_field</span><span class="p">:</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">4</span><span class="n">c</span><span class="p">:</span><span class="mi">82</span><span class="o">-&gt;</span><span class="n">eth_src</span><span class="p">,</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_OF_ARP_OP</span><span class="p">[],</span><span class="n">move</span><span class="p">:</span><span class="n">NXM_NX_ARP_SHA</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_NX_ARP_THA</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0xfa163e284c82</span><span class="o">-&gt;</span><span class="n">NXM_NX_ARP_SHA</span><span class="p">[],</span><span class="n">move</span><span class="p">:</span><span class="n">NXM_OF_ARP_SPA</span><span class="p">[]</span><span class="o">-&gt;</span><span class="n">NXM_OF_ARP_TPA</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0xa010101</span><span class="o">-&gt;</span><span class="n">NXM_OF_ARP_SPA</span><span class="p">[],</span><span class="n">IN_PORT</span>
</pre></div>
</div>
<p>Broadcast traffic destined for GroupTable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span><span class="n">reg5</span><span class="o">=</span><span class="mh">0x5</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="o">/</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x5</span><span class="o">-&gt;</span><span class="n">NXM_NX_TUN_ID</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">31</span><span class="p">],</span><span class="n">group</span><span class="p">:</span><span class="mi">5</span>
</pre></div>
</div>
<p>Layer3 destination matching flows, where priority=100+masklength. Since
<strong>GBP</strong> now support L3Prefix endpoint, we can set default routes etc:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">132</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">reg6</span><span class="o">=</span><span class="mh">0x7</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">b4</span><span class="p">:</span><span class="n">b4</span><span class="p">:</span><span class="n">b1</span><span class="p">,</span><span class="n">nw_dst</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.3</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0xc</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG2</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG3</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x5</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG7</span><span class="p">[],</span><span class="n">set_field</span><span class="p">:</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="n">b4</span><span class="p">:</span><span class="n">b4</span><span class="p">:</span><span class="n">b1</span><span class="o">-&gt;</span><span class="n">eth_dst</span><span class="p">,</span><span class="n">dec_ttl</span><span class="p">,</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">4</span>
</pre></div>
</div>
<p>Layer2 destination matching flows, designed to be caught only after last
IP flow (lowest priority IP flow is 100):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">323.203</span><span class="n">s</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_packets</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_bytes</span><span class="o">=</span><span class="mi">168</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">reg4</span><span class="o">=</span><span class="mh">0x4</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">fa</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="n">c3</span><span class="p">:</span><span class="n">dd</span> <span class="n">actions</span><span class="o">=</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG2</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x1</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG3</span><span class="p">[],</span><span class="n">load</span><span class="p">:</span><span class="mh">0x2</span><span class="o">-&gt;</span><span class="n">NXM_NX_REG7</span><span class="p">[],</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">4</span>
</pre></div>
</div>
<p>General drop flow: cookie=0x0, duration=323.207s, table=3, n_packets=6,
n_bytes=588, priority=1 actions=drop</p>
<p><strong>Policy Enforcer</strong></p>
<p>Table <a class="reference external" href="#offset">*offset*</a>+4.</p>
<p>Once the Source and Destination EndpointGroups are assigned, policy is
enforced based on resolved rules.</p>
<p>In the case of <a class="reference external" href="#SFC">Service Function Chaining</a>, the encapsulation
and destination for traffic destined to a chain, is discovered and
enforced.</p>
<p>Policy flow, allowing IP traffic between EndpointGroups:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">64998</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">reg0</span><span class="o">=</span><span class="mh">0x8</span><span class="p">,</span><span class="n">reg1</span><span class="o">=</span><span class="mh">0x1</span><span class="p">,</span><span class="n">reg2</span><span class="o">=</span><span class="mh">0xc</span><span class="p">,</span><span class="n">reg3</span><span class="o">=</span><span class="mh">0x1</span> <span class="n">actions</span><span class="o">=</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">5</span>
</pre></div>
</div>
<p><strong>Egress NAT Mapper</strong></p>
<p>Table <a class="reference external" href="#offset">*offset*</a>+5.</p>
<p>Performs NAT function before Egressing OVS instance to the underlay
network.</p>
<p>Inside to Outside NAT translation before sending to underlay:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span> <span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">reg6</span><span class="o">=</span><span class="mh">0x7</span><span class="p">,</span><span class="n">nw_src</span><span class="o">=</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.2</span> <span class="n">actions</span><span class="o">=</span><span class="n">set_field</span><span class="p">:</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">111.51</span><span class="o">-&gt;</span><span class="n">ip_src</span><span class="p">,</span><span class="n">goto_table</span><span class="p">:</span><span class="mi">6</span>
</pre></div>
</div>
<p><strong>External Mapper</strong></p>
<p>Table <a class="reference external" href="#offset">*offset*</a>+6.</p>
<p>Manages post-policy enforcement for endpoint specific destination
effects. Specifically for <a class="reference external" href="#SFC">Service Function Chaining</a>, which is
why we can support both symmetric and asymmetric chains and distributed
ingress/egress classification.</p>
<p>Generic allow:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cookie</span><span class="o">=</span><span class="mh">0x0</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">snip</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">100</span> <span class="n">actions</span><span class="o">=</span><span class="n">output</span><span class="p">:</span><span class="n">NXM_NX_REG7</span><span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-openflow-overlay-via-rest">
<h4>Configuring OpenFlow Overlay via REST<a class="headerlink" href="#configuring-openflow-overlay-via-rest" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Please see the <a class="reference external" href="#UX">UX</a> section on how to configure <strong>GBP</strong> via
the GUI.</p>
</div></blockquote>
<p><strong>Endpoint</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">{{</span><span class="n">controllerIp</span><span class="p">}}:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">endpoint</span><span class="p">:</span><span class="n">register</span><span class="o">-</span><span class="n">endpoint</span>
<span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;endpoint-group&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;epg0&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;endpoint-groups&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;epg1&gt;&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;epg2&gt;&quot;</span><span class="p">],</span>
        <span class="s2">&quot;network-containment&quot;</span> <span class="p">:</span> <span class="s2">&quot;&lt;fowarding-model-context1&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l2-context&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;bridge-domain1&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mac-address&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;mac1&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;l3-address&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;ip-address&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ipaddress1&gt;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;l3-context&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;l3_context1&gt;&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;*ofoverlay:port-name*&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ovs port name&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;tenant1&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">The</span> <span class="n">usage</span> <span class="n">of</span> <span class="s2">&quot;port-name&quot;</span> <span class="n">preceded</span> <span class="n">by</span> <span class="s2">&quot;ofoverlay&quot;</span><span class="o">.</span> <span class="n">In</span> <span class="n">OpenDaylight</span><span class="p">,</span>
<span class="n">base</span> <span class="n">datastore</span> <span class="n">objects</span> <span class="n">can</span> <span class="n">be</span> <span class="o">*</span><span class="n">augmented</span><span class="o">*.</span> <span class="n">In</span> <span class="o">**</span><span class="n">GBP</span><span class="o">**</span><span class="p">,</span> <span class="n">the</span> <span class="n">base</span>
<span class="n">endpoint</span> <span class="n">model</span> <span class="n">has</span> <span class="n">no</span> <span class="n">renderer</span> <span class="n">specifics</span><span class="p">,</span> <span class="n">hence</span> <span class="n">can</span> <span class="n">be</span> <span class="n">leveraged</span>
<span class="n">across</span> <span class="n">multiple</span> <span class="n">renderers</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>OVS Augmentations to Inventory</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="p">{{</span><span class="n">controllerIp</span><span class="p">}}:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span>
<span class="p">{</span>
    <span class="s2">&quot;opendaylight-inventory:nodes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ofoverlay:tunnel&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;tunnel-type&quot;</span><span class="p">:</span> <span class="s2">&quot;overlay:tunnel-type-vxlan&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ip_address_of_ovs&gt;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">4789</span><span class="p">,</span>
                        <span class="s2">&quot;node-connector-id&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:123456:1&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:654321&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ofoverlay:tunnel&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;tunnel-type&quot;</span><span class="p">:</span> <span class="s2">&quot;overlay:tunnel-type-vxlan&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ip_address_of_ovs&gt;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">4789</span><span class="p">,</span>
                        <span class="s2">&quot;node-connector-id&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:654321:1&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Tenants</strong> see <a class="reference external" href="#policyresolution">Policy Resolution</a> and
<a class="reference external" href="#forwarding">Forwarding Model</a> for details:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;policy:tenant&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;contract&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;clause&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow-http-clause&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subject-refs&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;allow-http-subject&quot;</span><span class="p">,</span>
              <span class="s2">&quot;allow-icmp-subject&quot;</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow-http-subject&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;classifier-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;in&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-dest&quot;</span>
                  <span class="p">},</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;out&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-src&quot;</span>
                  <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;action-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                  <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow-http-rule&quot;</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow-icmp-subject&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;classifier-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;icmp&quot;</span>
                  <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;action-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                  <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow-icmp-rule&quot;</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;endpoint-group&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;consumer-named-selector&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;contract&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;&lt;id&gt;&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;name&gt;&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;provider-named-selector&quot;</span><span class="p">:</span> <span class="p">[]</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;consumer-named-selector&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;provider-named-selector&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;contract&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;&lt;id&gt;&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;name&gt;&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;l2-bridge-domain&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;l2-flood-domain&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;l3-context&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;GBPPOC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;subject-feature-instances&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;classifier-instance&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;classifier-definition-id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-dest&quot;</span><span class="p">,</span>
          <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;proto&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;destport&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;classifier-definition-id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-src&quot;</span><span class="p">,</span>
          <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;proto&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sourceport&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;classifier-definition-id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;icmp&quot;</span><span class="p">,</span>
          <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;proto&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;action-instance&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;action-definition-id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;subnet&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ip_prefix&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;virtual-router-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ip address&gt;&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ip prefix&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;id&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;virtual-router-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ip address&gt;&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h4>Tutorials<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>Comprehensive tutorials, along with a demonstration environment
leveraging Vagrant can be found on the <a class="reference external" href="https://wiki.opendaylight.org/view/Group_Based_Policy_(GBP)">**GBP**
wiki</a></p>
</div>
</div>
<div class="section" id="using-the-gbp-ebpf-io-visor-agent-renderer">
<h3>Using the GBP eBPF IO Visor Agent renderer<a class="headerlink" href="#using-the-gbp-ebpf-io-visor-agent-renderer" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id28">
<h4>Overview<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h4>
<p>The IO Visor renderer feature enables container endpoints (e.g. Docker,
LXC) to leverage GBP policies.</p>
<p>The renderer interacts with a IO Visor module from the Linux Foundation
IO Visor project.</p>
<div class="section" id="id29">
<h5>Installing and Pre-requisites<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h5>
<p>From the Karaf console in OpenDaylight:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">groupbasedpolicy</span><span class="o">-</span><span class="n">iovisor</span> <span class="n">odl</span><span class="o">-</span><span class="n">restconf</span>
</pre></div>
</div>
<p>Installation details, usage, and other information for the IO Visor GBP
module can be found here: <a class="reference external" href="https://github.com/iovisor/iomodules">**IO Visor** github repo for IO
Modules</a></p>
</div>
</div>
</div>
<div class="section" id="using-the-gbp-faas-renderer">
<h3>Using the GBP FaaS renderer<a class="headerlink" href="#using-the-gbp-faas-renderer" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id30">
<h4>Overview<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h4>
<p>The FaaS renderer feature enables leveraging the FaaS project as a GBP
renderer.</p>
<div class="section" id="id31">
<h5>Installing and Pre-requisites<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h5>
<p>From the Karaf console in OpenDaylight:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">groupbasedpolicy</span><span class="o">-</span><span class="n">faas</span>
</pre></div>
</div>
<p>More information about FaaS can be found here:
<a class="reference external" href="https://wiki.opendaylight.org/view/FaaS:GBPIntegration">https://wiki.opendaylight.org/view/FaaS:GBPIntegration</a></p>
</div>
</div>
</div>
<div class="section" id="using-service-function-chaining-sfc-with-gbp-neutron-mapper-and-ofoverlay">
<h3>Using Service Function Chaining (SFC) with GBP Neutron Mapper and OfOverlay<a class="headerlink" href="#using-service-function-chaining-sfc-with-gbp-neutron-mapper-and-ofoverlay" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id32">
<h4>Overview<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h4>
<p>Please refer to the Service Function Chaining project for specifics on
SFC provisioning and theory.</p>
<p><strong>GBP</strong> allows for the use of a chain, by name, in policy.</p>
<p>This takes the form of an <em>action</em> in <strong>GBP</strong>.</p>
<p>Using the <a class="reference external" href="#demo">**GBP** demo and development environment</a> as an
example:</p>
<div class="figure" id="id213">
<img alt="GBP and SFC integration environment" src="../_images/sfc-1-topology.png" />
<p class="caption"><span class="caption-text">GBP and SFC integration environment</span></p>
</div>
<p>In the topology above, a symmetrical chain between H35_2 and H36_3
could take path:</p>
<p>H35_2 to sw1 to sff1 to sf1 to sff1 to sff2 to sf2 to sff2 to sw6 to
H36_3</p>
<p>If symmetric chaining was desired, the return path is:</p>
<div class="figure" id="id214">
<img alt="GBP and SFC symmetric chain environment" src="../_images/sfc-2-symmetric.png" />
<p class="caption"><span class="caption-text">GBP and SFC symmetric chain environment</span></p>
</div>
<p>If asymmetric chaining was desired, the return path could be direct, or
an <strong>entirely different chain</strong>.</p>
<div class="figure" id="id215">
<img alt="GBP and SFC assymmetric chain environment" src="../_images/sfc-3-asymmetric.png" />
<p class="caption"><span class="caption-text">GBP and SFC assymmetric chain environment</span></p>
</div>
<p>All these scenarios are supported by the integration.</p>
<p>In the <strong>Subject Feature Instance</strong> section of the tenant config, we
define the instances of the classifier definitions for ICMP and HTTP:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;subject-feature-instances&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">&quot;classifier-instance&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;icmp&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;proto&quot;</span><span class="p">,</span>
          <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-dest&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;proto&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;destport&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-src&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;proto&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;int-value&quot;</span><span class="p">:</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sourceport&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
</pre></div>
</div>
<p>Then the action instances to associate to traffic that matches
classifiers are defined.</p>
<p>Note the <em>SFC chain name</em> must exist in SFC, and is validated against
the datastore once the tenant configuration is entered, before entering
a valid tenant configuration into the operational datastore (which
triggers policy resolution).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="s2">&quot;action-instance&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;chain1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parameter-value&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc-chain-name&quot;</span><span class="p">,</span>
          <span class="s2">&quot;string-value&quot;</span><span class="p">:</span> <span class="s2">&quot;SFCGBP&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow1&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">},</span>
</pre></div>
</div>
<p>When ICMP is matched, allow the traffic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;contract&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;icmp-subject&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow-icmp-rule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;order&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;classifier-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;icmp&quot;</span>
              <span class="p">}</span>
            <span class="p">],</span>
            <span class="s2">&quot;action-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span>

        <span class="p">]</span>
      <span class="p">},</span>
</pre></div>
</div>
<p>When HTTP is matched, <strong>in</strong> to the provider of the contract with a TCP
destination port of 80 (HTTP) or the HTTP request. The chain action is
triggered, and similarly <strong>out</strong> from the provider for traffic with TCP
source port of 80 (HTTP), or the HTTP response.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-subject&quot;</span><span class="p">,</span>
  <span class="s2">&quot;rule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-chain-rule-in&quot;</span><span class="p">,</span>
      <span class="s2">&quot;classifier-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-dest&quot;</span><span class="p">,</span>
          <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;in&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;action-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;chain1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-chain-rule-out&quot;</span><span class="p">,</span>
      <span class="s2">&quot;classifier-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-src&quot;</span><span class="p">,</span>
          <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;out&quot;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;action-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;chain1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To enable asymmetrical chaining, for instance, the user desires that
HTTP requests traverse the chain, but the HTTP response does not, the
HTTP response is set to <em>allow</em> instead of chain:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-chain-rule-out&quot;</span><span class="p">,</span>
  <span class="s2">&quot;classifier-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http-src&quot;</span><span class="p">,</span>
      <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;out&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;action-ref&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;allow1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="demo-development-environment">
<h3>Demo/Development environment<a class="headerlink" href="#demo-development-environment" title="Permalink to this headline">¶</a></h3>
<p>The <strong>GBP</strong> project for Beryllium has two demo/development environments.</p>
<ul class="simple">
<li>Docker based GBP and GBP+SFC integration Vagrant environment</li>
<li>DevStack based GBP+Neutron integration Vagrant environment</li>
</ul>
<p><a class="reference external" href="https://wiki.opendaylight.org/view/Group_Based_Policy_(GBP)/Consumability/Demo">Demo &#64; GBP
wiki</a></p>
</div>
</div>
<div class="section" id="l2switch-user-guide">
<h2>L2Switch User Guide<a class="headerlink" href="#l2switch-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id33">
<h3>Overview<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<p>The L2Switch project provides Layer2 switch functionality.</p>
</div>
<div class="section" id="l2switch-architecture">
<h3>L2Switch Architecture<a class="headerlink" href="#l2switch-architecture" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Packet Handler<ul>
<li>Decodes the packets coming to the controller and dispatches them
appropriately</li>
</ul>
</li>
<li>Loop Remover<ul>
<li>Removes loops in the network</li>
</ul>
</li>
<li>Arp Handler<ul>
<li>Handles the decoded ARP packets</li>
</ul>
</li>
<li>Address Tracker<ul>
<li>Learns the Addresses (MAC and IP) of entities in the network</li>
</ul>
</li>
<li>Host Tracker<ul>
<li>Tracks the locations of hosts in the network</li>
</ul>
</li>
<li>L2Switch Main<ul>
<li>Installs flows on each switch based on network traffic</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuring-l2switch">
<h3>Configuring L2Switch<a class="headerlink" href="#configuring-l2switch" title="Permalink to this headline">¶</a></h3>
<p>This sections below give details about the configuration settings for
the components that can be configured.</p>
</div>
<div class="section" id="configuring-loop-remover">
<h3>Configuring Loop Remover<a class="headerlink" href="#configuring-loop-remover" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>52-loopremover.xml<ul>
<li>is-install-lldp-flow<ul>
<li>&#8220;true&#8221; means a flow that sends all LLDP packets to the
controller will be installed on each switch</li>
<li>&#8220;false&#8221; means this flow will not be installed</li>
</ul>
</li>
<li>lldp-flow-table-id<ul>
<li>The LLDP flow will be installed on the specified flow table of
each switch</li>
<li>This field is only relevant when &#8220;is-install-lldp-flow&#8221; is set
to &#8220;true&#8221;</li>
</ul>
</li>
<li>lldp-flow-priority<ul>
<li>The LLDP flow will be installed with the specified priority</li>
<li>This field is only relevant when &#8220;is-install-lldp-flow&#8221; is set
to &#8220;true&#8221;</li>
</ul>
</li>
<li>lldp-flow-idle-timeout<ul>
<li>The LLDP flow will timeout (removed from the switch) if the
flow doesn’t forward a packet for <em>x</em> seconds</li>
<li>This field is only relevant when &#8220;is-install-lldp-flow&#8221; is set
to &#8220;true&#8221;</li>
</ul>
</li>
<li>lldp-flow-hard-timeout<ul>
<li>The LLDP flow will timeout (removed from the switch) after <em>x</em>
seconds, regardless of how many packets it is forwarding</li>
<li>This field is only relevant when &#8220;is-install-lldp-flow&#8221; is set
to &#8220;true&#8221;</li>
</ul>
</li>
<li>graph-refresh-delay<ul>
<li>A graph of the network is maintained and gets updated as
network elements go up/down (i.e. links go up/down and switches
go up/down)</li>
<li>After a network element going up/down, it waits
<em>graph-refresh-delay</em> seconds before recomputing the graph</li>
<li>A higher value has the advantage of doing less graph updates,
at the potential cost of losing some packets because the graph
didn’t update immediately.</li>
<li>A lower value has the advantage of handling network topology
changes quicker, at the cost of doing more computation.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuring-arp-handler">
<h3>Configuring Arp Handler<a class="headerlink" href="#configuring-arp-handler" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>54-arphandler.xml<ul>
<li>is-proactive-flood-mode<ul>
<li>&#8220;true&#8221; means that flood flows will be installed on each switch.
With this flood flow, each switch will flood a packet that
doesn’t match any other flows.<ul>
<li>Advantage: Fewer packets are sent to the controller because
those packets are flooded to the network.</li>
<li>Disadvantage: A lot of network traffic is generated.</li>
</ul>
</li>
<li>&#8220;false&#8221; means the previously mentioned flood flows will not be
installed. Instead an ARP flow will be installed on each switch
that sends all ARP packets to the controller.<ul>
<li>Advantage: Less network traffic is generated.</li>
<li>Disadvantage: The controller handles more packets (ARP
requests &amp; replies) and the ARP process takes longer than if
there were flood flows.</li>
</ul>
</li>
</ul>
</li>
<li>flood-flow-table-id<ul>
<li>The flood flow will be installed on the specified flow table of
each switch</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>flood-flow-priority<ul>
<li>The flood flow will be installed with the specified priority</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>flood-flow-idle-timeout<ul>
<li>The flood flow will timeout (removed from the switch) if the
flow doesn’t forward a packet for <em>x</em> seconds</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>flood-flow-hard-timeout<ul>
<li>The flood flow will timeout (removed from the switch) after <em>x</em>
seconds, regardless of how many packets it is forwarding</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>arp-flow-table-id<ul>
<li>The ARP flow will be installed on the specified flow table of
each switch</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;false&#8221;</li>
</ul>
</li>
<li>arp-flow-priority<ul>
<li>The ARP flow will be installed with the specified priority</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;false&#8221;</li>
</ul>
</li>
<li>arp-flow-idle-timeout<ul>
<li>The ARP flow will timeout (removed from the switch) if the flow
doesn’t forward a packet for <em>x</em> seconds</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;false&#8221;</li>
</ul>
</li>
<li>arp-flow-hard-timeout<ul>
<li>The ARP flow will timeout (removed from the switch) after
<em>arp-flow-hard-timeout</em> seconds, regardless of how many packets
it is forwarding</li>
<li>This field is only relevant when &#8220;is-proactive-flood-mode&#8221; is
set to &#8220;false&#8221;</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuring-address-tracker">
<h3>Configuring Address Tracker<a class="headerlink" href="#configuring-address-tracker" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>56-addresstracker.xml<ul>
<li>timestamp-update-interval<ul>
<li>A last-seen timestamp is associated with each address. This
last-seen timestamp will only be updated after
<em>timestamp-update-interval</em> milliseconds.</li>
<li>A higher value has the advantage of performing less writes to
the database.</li>
<li>A lower value has the advantage of knowing how fresh an address
is.</li>
</ul>
</li>
<li>observe-addresses-from<ul>
<li>IP and MAC addresses can be observed/learned from ARP, IPv4,
and IPv6 packets. Set which packets to make these observations
from.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuring-l2switch-main">
<h3>Configuring L2Switch Main<a class="headerlink" href="#configuring-l2switch-main" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>58-l2switchmain.xml<ul>
<li>is-install-dropall-flow<ul>
<li>&#8220;true&#8221; means a drop-all flow will be installed on each switch,
so the default action will be to drop a packet instead of
sending it to the controller</li>
<li>&#8220;false&#8221; means this flow will not be installed</li>
</ul>
</li>
<li>dropall-flow-table-id<ul>
<li>The dropall flow will be installed on the specified flow table
of each switch</li>
<li>This field is only relevant when &#8220;is-install-dropall-flow&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>dropall-flow-priority<ul>
<li>The dropall flow will be installed with the specified priority</li>
<li>This field is only relevant when &#8220;is-install-dropall-flow&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>dropall-flow-idle-timeout<ul>
<li>The dropall flow will timeout (removed from the switch) if the
flow doesn’t forward a packet for <em>x</em> seconds</li>
<li>This field is only relevant when &#8220;is-install-dropall-flow&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>dropall-flow-hard-timeout<ul>
<li>The dropall flow will timeout (removed from the switch) after
<em>x</em> seconds, regardless of how many packets it is forwarding</li>
<li>This field is only relevant when &#8220;is-install-dropall-flow&#8221; is
set to &#8220;true&#8221;</li>
</ul>
</li>
<li>is-learning-only-mode<ul>
<li>&#8220;true&#8221; means that the L2Switch will only be learning addresses.
No additional flows to optimize network traffic will be
installed.</li>
<li>&#8220;false&#8221; means that the L2Switch will react to network traffic
and install flows on the switches to optimize traffic.
Currently, MAC-to-MAC flows are installed.</li>
</ul>
</li>
<li>reactive-flow-table-id<ul>
<li>The reactive flow will be installed on the specified flow table
of each switch</li>
<li>This field is only relevant when &#8220;is-learning-only-mode&#8221; is set
to &#8220;false&#8221;</li>
</ul>
</li>
<li>reactive-flow-priority<ul>
<li>The reactive flow will be installed with the specified priority</li>
<li>This field is only relevant when &#8220;is-learning-only-mode&#8221; is set
to &#8220;false&#8221;</li>
</ul>
</li>
<li>reactive-flow-idle-timeout<ul>
<li>The reactive flow will timeout (removed from the switch) if the
flow doesn’t forward a packet for <em>x</em> seconds</li>
<li>This field is only relevant when &#8220;is-learning-only-mode&#8221; is set
to &#8220;false&#8221;</li>
</ul>
</li>
<li>reactive-flow-hard-timeout<ul>
<li>The reactive flow will timeout (removed from the switch) after
<em>x</em> seconds, regardless of how many packets it is forwarding</li>
<li>This field is only relevant when &#8220;is-learning-only-mode&#8221; is set
to &#8220;false&#8221;</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="running-the-l2switch-project">
<h3>Running the L2Switch project<a class="headerlink" href="#running-the-l2switch-project" title="Permalink to this headline">¶</a></h3>
<p>To run the L2 Switch inside the Lithium OpenDaylight distribution simply
install the <code class="docutils literal"><span class="pre">odl-l2switch-switch-ui</span></code> feature;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">l2switch</span><span class="o">-</span><span class="n">switch</span><span class="o">-</span><span class="n">ui</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-network-using-mininet">
<h3>Create a network using mininet<a class="headerlink" href="#create-a-network-using-mininet" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mn</span> <span class="o">--</span><span class="n">controller</span><span class="o">=</span><span class="n">remote</span><span class="p">,</span><span class="n">ip</span><span class="o">=&lt;</span><span class="n">Controller</span> <span class="n">IP</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">topo</span><span class="o">=</span><span class="n">linear</span><span class="p">,</span><span class="mi">3</span> <span class="o">--</span><span class="n">switch</span> <span class="n">ovsk</span><span class="p">,</span><span class="n">protocols</span><span class="o">=</span><span class="n">OpenFlow13</span>
<span class="n">sudo</span> <span class="n">mn</span> <span class="o">--</span><span class="n">controller</span><span class="o">=</span><span class="n">remote</span><span class="p">,</span><span class="n">ip</span><span class="o">=</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="o">--</span><span class="n">topo</span><span class="o">=</span><span class="n">linear</span><span class="p">,</span><span class="mi">3</span> <span class="o">--</span><span class="n">switch</span> <span class="n">ovsk</span><span class="p">,</span><span class="n">protocols</span><span class="o">=</span><span class="n">OpenFlow13</span>
</pre></div>
</div>
<p>The above command will create a virtual network consisting of 3
switches. Each switch will connect to the controller located at the
specified IP, i.e. 127.0.0.1</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mn</span> <span class="o">--</span><span class="n">controller</span><span class="o">=</span><span class="n">remote</span><span class="p">,</span><span class="n">ip</span><span class="o">=</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="o">--</span><span class="n">mac</span> <span class="o">--</span><span class="n">topo</span><span class="o">=</span><span class="n">linear</span><span class="p">,</span><span class="mi">3</span> <span class="o">--</span><span class="n">switch</span> <span class="n">ovsk</span><span class="p">,</span><span class="n">protocols</span><span class="o">=</span><span class="n">OpenFlow13</span>
</pre></div>
</div>
<p>The above command has the &#8220;mac&#8221; option, which makes it easier to
distinguish between Host MAC addresses and Switch MAC addresses.</p>
</div>
<div class="section" id="generating-network-traffic-using-mininet">
<h3>Generating network traffic using mininet<a class="headerlink" href="#generating-network-traffic-using-mininet" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">h1</span> <span class="n">ping</span> <span class="n">h2</span>
</pre></div>
</div>
<p>The above command will cause host1 (h1) to ping host2 (h2)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pingall</span>
</pre></div>
</div>
<p><em>pingall</em> will cause each host to ping every other host.</p>
</div>
<div class="section" id="checking-address-observations">
<h3>Checking Address Observations<a class="headerlink" href="#checking-address-observations" title="Permalink to this headline">¶</a></h3>
<p>Address Observations are added to the Inventory data tree.</p>
<p>The Address Observations on a Node Connector can be checked through a
browser or a REST Client.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.194</span><span class="o">.</span><span class="mf">126.91</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">/</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<div class="figure" id="id216">
<img alt="Address Observations" src="../_images/l2switch-address-observations.png" />
<p class="caption"><span class="caption-text">Address Observations</span></p>
</div>
</div>
<div class="section" id="checking-hosts">
<h3>Checking Hosts<a class="headerlink" href="#checking-hosts" title="Permalink to this headline">¶</a></h3>
<p>Host information is added to the Topology data tree.</p>
<ul class="simple">
<li>Host address</li>
<li>Attachment point (link) to a node/switch</li>
</ul>
<p>This host information and attachment point information can be checked
through a browser or a REST Client.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.194</span><span class="o">.</span><span class="mf">126.91</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="p">:</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="o">/</span><span class="n">topology</span><span class="o">/</span><span class="n">flow</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span>
</pre></div>
</div>
<div class="figure" id="id217">
<img alt="Hosts" src="../_images/l2switch-hosts.png" />
<p class="caption"><span class="caption-text">Hosts</span></p>
</div>
</div>
<div class="section" id="checking-stp-status-of-each-link">
<h3>Checking STP status of each link<a class="headerlink" href="#checking-stp-status-of-each-link" title="Permalink to this headline">¶</a></h3>
<p>STP Status information is added to the Inventory data tree.</p>
<ul class="simple">
<li>A status of &#8220;forwarding&#8221; means the link is active and packets are
flowing on it.</li>
<li>A status of &#8220;discarding&#8221; means the link is inactive and packets are
not sent over it.</li>
</ul>
<p>The STP status of a link can be checked through a browser or a REST
Client.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.194</span><span class="o">.</span><span class="mf">126.91</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">/</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<div class="figure" id="id218">
<img alt="STP status" src="../_images/l2switch-stp-status.png" />
<p class="caption"><span class="caption-text">STP status</span></p>
</div>
</div>
<div class="section" id="miscellaneous-mininet-commands">
<h3>Miscellaneous mininet commands<a class="headerlink" href="#miscellaneous-mininet-commands" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">link</span> <span class="n">s1</span> <span class="n">s2</span> <span class="n">down</span>
</pre></div>
</div>
<p>This will bring the link between switch1 (s1) and switch2 (s2) down</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">link</span> <span class="n">s1</span> <span class="n">s2</span> <span class="n">up</span>
</pre></div>
</div>
<p>This will bring the link between switch1 (s1) and switch2 (s2) up</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">link</span> <span class="n">s1</span> <span class="n">h1</span> <span class="n">down</span>
</pre></div>
</div>
<p>This will bring the link between switch1 (s1) and host1 (h1) down</p>
</div>
</div>
<div class="section" id="l3vpn-service-user-guide">
<h2>L3VPN Service: User Guide<a class="headerlink" href="#l3vpn-service-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id34">
<h3>Overview<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<p>L3VPN Service in OpenDaylight provides a framework to create L3VPN based
on BGP-MP. It also helps to create Network Virtualization for DC Cloud
environment.</p>
</div>
<div class="section" id="modules-interfaces">
<h3>Modules &amp; Interfaces<a class="headerlink" href="#modules-interfaces" title="Permalink to this headline">¶</a></h3>
<p>L3VPN service can be realized using the following modules -</p>
<div class="section" id="vpn-service-modules">
<h4>VPN Service Modules<a class="headerlink" href="#vpn-service-modules" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><strong>VPN Manager</strong> : Creates and manages VPNs and VPN Interfaces</li>
<li><strong>BGP Manager</strong> : Configures BGP routing stack and provides interface
to routing services</li>
<li><strong>FIB Manager</strong> : Provides interface to FIB, creates and manages
forwarding rules in Dataplane</li>
<li><strong>Nexthop Manager</strong> : Creates and manages nexthop egress pointer,
creates egress rules in Dataplane</li>
<li><strong>Interface Manager</strong> : Creates and manages different type of network
interfaces, e.g., VLAN, l3tunnel etc.,</li>
<li><strong>Id Manager</strong> : Provides cluster-wide unique ID for a given key.
Used by different modules to get unique IDs for different entities.</li>
<li><strong>MD-SAL Util</strong> : Provides interface to MD-SAL. Used by service
modules to access MD-SAL Datastore and services.</li>
</ol>
<p>All the above modules can function independently and can be utilized by
other services as well.</p>
</div>
<div class="section" id="configuration-interfaces">
<h4>Configuration Interfaces<a class="headerlink" href="#configuration-interfaces" title="Permalink to this headline">¶</a></h4>
<p>The following modules expose configuration interfaces through which user
can configure L3VPN Service.</p>
<ol class="arabic simple">
<li>BGP Manager</li>
<li>VPN Manager</li>
<li>Interface Manager</li>
<li>FIB Manager</li>
</ol>
<div class="section" id="configuration-interface-details">
<h5>Configuration Interface Details<a class="headerlink" href="#configuration-interface-details" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>Data Node Path : <em>/config/bgp:bgp-router/</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>local-as-identifier</li>
<li>local-as-number</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path : <em>/config/bgp:bgp-neighbors/</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>List of bgp-neighbor</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path :
<em>/config/bgp:bgp-neighbors/bgp-neighbor/``{as-number}``/</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>as-number</li>
<li>ip-address</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
</ol>
<ol class="arabic simple">
<li>Data Node Path : <em>/config/l3vpn:vpn-instances/</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>List of vpn-instance</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path : <em>/config/l3vpn:vpn-interfaces/vpn-instance</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>name</li>
<li>route-distinguisher</li>
<li>import-route-policy</li>
<li>export-route-policy</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path : <em>/config/l3vpn:vpn-interfaces/</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>List of vpn-interface</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path : <em>/config/l3vpn:vpn-interfaces/vpn-interface</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>name</li>
<li>vpn-instance-name</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path :
<em>/config/l3vpn:vpn-interfaces/vpn-interface/``{name}``/adjacency</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>ip-address</li>
<li>mac-address</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
</ol>
<ol class="arabic simple">
<li>Data Node Path : <em>/config/if:interfaces/interface</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>name</li>
<li>type</li>
<li>enabled</li>
<li>of-port-id</li>
<li>tenant-id</li>
<li>base-interface</li>
</ol>
</li>
<li>type specific fields<ol class="lowerroman">
<li>when type = <em>l2vlan</em><ol class="upperalpha">
<li>vlan-id</li>
</ol>
</li>
<li>when type = <em>stacked_vlan</em><ol class="upperalpha">
<li>stacked-vlan-id</li>
</ol>
</li>
<li>when type = <em>l3tunnel</em><ol class="upperalpha">
<li>tunnel-type</li>
<li>local-ip</li>
<li>remote-ip</li>
<li>gateway-ip</li>
</ol>
</li>
<li>when type = <em>mpls</em><ol class="upperalpha">
<li>list labelStack</li>
<li>num-labels</li>
</ol>
</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
</ol>
<ol class="arabic simple">
<li>Data Node Path : <em>/config/odl-fib:fibEntries/vrfTables</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>List of vrfTables</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path :
<em>/config/odl-fib:fibEntries/vrfTables/``{routeDistinguisher}``/</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>route-distinguisher</li>
<li>list vrfEntries<ol class="upperalpha">
<li>destPrefix</li>
<li>label</li>
<li>nexthopAddress</li>
</ol>
</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
<li>Data Node Path : <em>/config/odl-fib:fibEntries/ipv4Table</em><ol class="loweralpha">
<li>Fields :<ol class="lowerroman">
<li>list ipv4Entry<ol class="upperalpha">
<li>destPrefix</li>
<li>nexthopAddress</li>
</ol>
</li>
</ol>
</li>
<li>REST Methods : GET, PUT, DELETE, POST</li>
</ol>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="provisioning-sequence-sample-configurations">
<h3>Provisioning Sequence &amp; Sample Configurations<a class="headerlink" href="#provisioning-sequence-sample-configurations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="installation">
<h4>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Edit <em>etc/custom.properties</em> and set the following property:
<em>vpnservice.bgpspeaker.host.name = &lt;bgpserver-ip&gt;</em> <em>&lt;bgpserver-ip&gt;</em>
here refers to the IP address of the host where BGP is running.</li>
<li>Run ODL and install VPN Service <em>feature:install odl-vpnservice-core</em></li>
</ol>
<p>Use REST interface to configure L3VPN service</p>
</div>
<div class="section" id="pre-requisites">
<h4>Pre-requisites:<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>BGP stack with VRF support needs to installed and configured<ol class="loweralpha">
<li><em>Configure BGP as specified in Step 1 below.</em></li>
</ol>
</li>
<li>Create pairs of GRE/VxLAN Tunnels (using ovsdb/ovs-vsctl) between
each switch and between each switch to the Gateway node<ol class="loweralpha">
<li><em>Create *l3tunnel</em> interfaces corresponding to each tunnel in
interfaces DS as specified in Step 2 below.*</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="step-1-configure-bgp">
<h4>Step 1 : Configure BGP<a class="headerlink" href="#step-1-configure-bgp" title="Permalink to this headline">¶</a></h4>
<div class="section" id="configure-bgp-router">
<h5>1. Configure BGP Router<a class="headerlink" href="#configure-bgp-router" title="Permalink to this headline">¶</a></h5>
<p><strong>REST API</strong> : <em>PUT /config/bgp:bgp-router/</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;bgp-router&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;local-as-identifier&quot;</span><span class="p">:</span> <span class="s2">&quot;10.10.10.10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;local-as-number&quot;</span><span class="p">:</span> <span class="mi">108</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-bgp-neighbors">
<h5>2. Configure BGP Neighbors<a class="headerlink" href="#configure-bgp-neighbors" title="Permalink to this headline">¶</a></h5>
<p><strong>REST API</strong> : <em>PUT /config/bgp:bgp-neighbors/</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;bgp-neighbor&quot;</span> <span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
              <span class="s2">&quot;as-number&quot;</span><span class="p">:</span> <span class="mi">105</span><span class="p">,</span>
              <span class="s2">&quot;ip-address&quot;</span><span class="p">:</span> <span class="s2">&quot;169.144.42.168&quot;</span>
          <span class="p">}</span>
     <span class="p">]</span>
 <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-2-create-tunnel-interfaces">
<h4>Step 2 : Create Tunnel Interfaces<a class="headerlink" href="#step-2-create-tunnel-interfaces" title="Permalink to this headline">¶</a></h4>
<p>Create l3tunnel interfaces corresponding to all GRE/VxLAN tunnels
created with ovsdb (<a class="reference external" href="#prer">refer Prerequisites</a>). Use following REST
Interface -</p>
<p><strong>REST API</strong> : <em>PUT /config/if:interfaces/if:interfacce</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;GRE_192.168.57.101_192.168.57.102&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;odl-interface:l3tunnel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-interface:tunnel-type&quot;</span><span class="p">:</span> <span class="s2">&quot;odl-interface:tunnel-type-gre&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-interface:local-ip&quot;</span> <span class="p">:</span> <span class="s2">&quot;192.168.57.101&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-interface:remote-ip&quot;</span> <span class="p">:</span> <span class="s2">&quot;192.168.57.102&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-interface:portId&quot;</span> <span class="p">:</span> <span class="s2">&quot;openflow:1:3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enabled&quot;</span> <span class="p">:</span> <span class="s2">&quot;true&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="following-is-expected-as-a-result-of-these-configurations">
<h5>Following is expected as a result of these configurations<a class="headerlink" href="#following-is-expected-as-a-result-of-these-configurations" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>Unique If-index is generated</li>
<li><em>Interface-state</em> operational DS is updated</li>
<li>Corresponding Nexthop Group Entry is created</li>
</ol>
</div>
</div>
<div class="section" id="step-3-os-create-neutron-ports-and-attach-vms">
<h4>Step 3 : OS Create Neutron Ports and attach VMs<a class="headerlink" href="#step-3-os-create-neutron-ports-and-attach-vms" title="Permalink to this headline">¶</a></h4>
<p>At this step user creates VMs.</p>
</div>
<div class="section" id="step-4-create-vm-interfaces">
<h4>Step 4 : Create VM Interfaces<a class="headerlink" href="#step-4-create-vm-interfaces" title="Permalink to this headline">¶</a></h4>
<p>Create l2vlan interfaces corresponding to VM created in step 3</p>
<p><strong>REST API</strong> : <em>PUT /config/if:interfaces/if:interface</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;dpn1-dp1.2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;l2vlan&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-interface:of-port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;openflow:1:2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-interface:vlan-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enabled&quot;</span> <span class="p">:</span> <span class="s2">&quot;true&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="step-5-create-vpn-instance">
<h4>Step 5: Create VPN Instance<a class="headerlink" href="#step-5-create-vpn-instance" title="Permalink to this headline">¶</a></h4>
<p><strong>REST API</strong> : <em>PUT /config/l3vpn:vpn-instances/l3vpn:vpn-instance/</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;vpn-instance&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Test VPN Instance 1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vpn-instance-name&quot;</span><span class="p">:</span> <span class="s2">&quot;testVpn1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipv4-family&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;route-distinguisher&quot;</span><span class="p">:</span> <span class="s2">&quot;4000:1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;export-route-policy&quot;</span><span class="p">:</span> <span class="s2">&quot;4000:1,5000:1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;import-route-policy&quot;</span><span class="p">:</span> <span class="s2">&quot;4000:1,5000:1&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="id35">
<h5>Following is expected as a result of these configurations<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>VPN ID is allocated and updated in data-store</li>
<li>Corresponding VRF is created in BGP</li>
<li>If there are vpn-interface configurations for this VPN, corresponding
action is taken as defined in step 5</li>
</ol>
</div>
</div>
<div class="section" id="step-5-create-vpn-interface-and-local-adjacency">
<h4>Step 5 : Create VPN-Interface and Local Adjacency<a class="headerlink" href="#step-5-create-vpn-interface-and-local-adjacency" title="Permalink to this headline">¶</a></h4>
<p><em>this can be done in two steps as well</em></p>
<div class="section" id="create-vpn-interface">
<h5>1. Create vpn-interface<a class="headerlink" href="#create-vpn-interface" title="Permalink to this headline">¶</a></h5>
<p><strong>REST API</strong> : <em>PUT /config/l3vpn:vpn-interfaces/l3vpn:vpn-interface/</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;vpn-interface&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;vpn-instance-name&quot;</span><span class="p">:</span> <span class="s2">&quot;testVpn1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;dpn1-dp1.2&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">name</span> <span class="n">here</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">VM</span> <span class="n">interface</span> <span class="n">created</span> <span class="ow">in</span> <span class="n">step</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="add-adjacencies-on-vpn-interafce">
<h5>2. Add Adjacencies on vpn-interafce<a class="headerlink" href="#add-adjacencies-on-vpn-interafce" title="Permalink to this headline">¶</a></h5>
<p><strong>REST API</strong> : <em>PUT
/config/l3vpn:vpn-interfaces/l3vpn:vpn-interface/dpn1-dp1.3/adjacency</em></p>
<p><strong>Sample JSON Data</strong></p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span>  <span class="p">{</span>
     <span class="s2">&quot;adjacency&quot;</span> <span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;ip-address&quot;</span> <span class="p">:</span> <span class="s2">&quot;169.144.42.168&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mac-address&quot;</span> <span class="p">:</span> <span class="s2">&quot;11:22:33:44:55:66&quot;</span>
            <span class="p">}</span>
       <span class="p">]</span>
   <span class="p">}</span>

<span class="n">its</span> <span class="n">a</span> <span class="nb">list</span><span class="p">,</span> <span class="n">user</span> <span class="n">can</span> <span class="n">define</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">adjacency</span> <span class="n">on</span> <span class="n">a</span>
<span class="n">vpn</span>\<span class="n">_interface</span>
</pre></div>
</div>
<p>Above steps can be carried out in a single step as following</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;vpn-interface&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;vpn-instance-name&quot;</span><span class="p">:</span> <span class="s2">&quot;testVpn1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;dpn1-dp1.3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;odl-l3vpn:adjacency&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;odl-l3vpn:mac_address&quot;</span><span class="p">:</span> <span class="s2">&quot;11:22:33:44:55:66&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;odl-l3vpn:ip_address&quot;</span><span class="p">:</span> <span class="s2">&quot;11.11.11.2&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id36">
<h5>Following is expected as a result of these configurations<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>Prefix label is generated and stored in DS</li>
<li>Ingress table is programmed with flow corresponding to interface</li>
<li>Local Egress Group is created</li>
<li>Prefix is added to BGP for advertisement</li>
<li>BGP pushes route update to FIB YANG Interface</li>
<li>FIB Entry flow is added to FIB Table in OF pipeline</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section" id="link-aggregation-control-protocol-user-guide">
<h2>Link Aggregation Control Protocol User Guide<a class="headerlink" href="#link-aggregation-control-protocol-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id37">
<h3>Overview<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<p>This section contains information about how to use the LACP plugin
project with OpenDaylight, including configurations.</p>
</div>
<div class="section" id="link-aggregation-control-protocol-architecture">
<h3>Link Aggregation Control Protocol Architecture<a class="headerlink" href="#link-aggregation-control-protocol-architecture" title="Permalink to this headline">¶</a></h3>
<p>The LACP Project within OpenDaylight implements Link Aggregation Control
Protocol (LACP) as an MD-SAL service module and will be used to
auto-discover and aggregate multiple links between an OpenDaylight
controlled network and LACP-enabled endpoints or switches. The result is
the creation of a logical channel, which represents the aggregation of
the links. Link aggregation provides link resiliency and bandwidth
aggregation. This implementation adheres to IEEE Ethernet specification
<a class="reference external" href="http://www.ieee802.org/3/hssg/public/apr07/frazier_01_0407.pdf">802.3ad</a>.</p>
</div>
<div class="section" id="configuring-link-aggregation-control-protocol">
<h3>Configuring Link Aggregation Control Protocol<a class="headerlink" href="#configuring-link-aggregation-control-protocol" title="Permalink to this headline">¶</a></h3>
<p>This feature can be enabled in the Karaf console of the OpenDaylight
Karaf distribution by issuing the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">lacp</span><span class="o">-</span><span class="n">ui</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="mf">1.</span> <span class="n">Ensure</span> <span class="n">that</span> <span class="n">legacy</span> <span class="p">(</span><span class="n">non</span><span class="o">-</span><span class="n">OpenFlow</span><span class="p">)</span> <span class="n">switches</span> <span class="n">are</span> <span class="n">configured</span> <span class="k">with</span>
   <span class="n">LACP</span> <span class="n">mode</span> <span class="n">active</span> <span class="k">with</span> <span class="n">a</span> <span class="n">long</span> <span class="n">timeout</span> <span class="n">to</span> <span class="n">allow</span> <span class="k">for</span> <span class="n">the</span> <span class="n">LACP</span> <span class="n">plugin</span>
   <span class="ow">in</span> <span class="n">OpenDaylight</span> <span class="n">to</span> <span class="n">respond</span> <span class="n">to</span> <span class="n">its</span> <span class="n">messages</span><span class="o">.</span>

<span class="mf">2.</span> <span class="n">Flows</span> <span class="n">that</span> <span class="n">want</span> <span class="n">to</span> <span class="n">take</span> <span class="n">advantage</span> <span class="n">of</span> <span class="n">LACP</span><span class="o">-</span><span class="n">configured</span> <span class="n">Link</span>
   <span class="n">Aggregation</span> <span class="n">Groups</span> <span class="p">(</span><span class="n">LAGs</span><span class="p">)</span> <span class="n">must</span> <span class="n">explicitly</span> <span class="n">use</span> <span class="n">a</span> <span class="n">OpenFlow</span> <span class="n">group</span>
   <span class="n">table</span> <span class="n">entry</span> <span class="n">created</span> <span class="n">by</span> <span class="n">the</span> <span class="n">LACP</span> <span class="n">plugin</span><span class="o">.</span> <span class="n">The</span> <span class="n">plugin</span> <span class="n">only</span> <span class="n">creates</span>
   <span class="n">group</span> <span class="n">table</span> <span class="n">entries</span><span class="p">,</span> <span class="n">it</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">program</span> <span class="nb">any</span> <span class="n">flows</span> <span class="n">on</span> <span class="n">its</span> <span class="n">own</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="administering-or-managing-link-aggregation-control-protocol">
<h3>Administering or Managing Link Aggregation Control Protocol<a class="headerlink" href="#administering-or-managing-link-aggregation-control-protocol" title="Permalink to this headline">¶</a></h3>
<p>LACP-discovered network inventory and network statistics can be viewed
using the following REST APIs.</p>
<ol class="arabic">
<li><p class="first">List of aggregators available for a node:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">ControllerIP</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/&lt;</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Aggregator information will appear within the <code class="docutils literal"><span class="pre">&lt;lacp-aggregators&gt;</span></code>
XML tag.</p>
</li>
<li><p class="first">To view only the information of an aggregator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">ControllerIP</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/&lt;</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;/</span><span class="n">lacp</span><span class="o">-</span><span class="n">aggregators</span><span class="o">/&lt;</span><span class="n">agg</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The group ID associated with the aggregator can be found inside the
<code class="docutils literal"><span class="pre">&lt;lag-groupid&gt;</span></code> XML tag.</p>
<p>The group table entry information for the <code class="docutils literal"><span class="pre">&lt;lag-groupid&gt;</span></code> added for
the aggregator is also available in the <code class="docutils literal"><span class="pre">opendaylight-inventory</span></code>
node database.</p>
</li>
<li><p class="first">To view physical port information.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">ControllerIP</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/&lt;</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;/</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">/&lt;</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Ports that are associated with an aggregator will have the tag
<code class="docutils literal"><span class="pre">&lt;lacp-agg-ref&gt;</span></code> updated with valid aggregator information.</p>
</li>
</ol>
</div>
<div class="section" id="id38">
<h3>Tutorials<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h3>
<p>The below tutorial demonstrates LACP LAG creation for a sample mininet
topology.</p>
<div class="section" id="sample-lacp-topology-creation-on-mininet">
<h4>Sample LACP Topology creation on Mininet<a class="headerlink" href="#sample-lacp-topology-creation-on-mininet" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mn</span> <span class="o">--</span><span class="n">controller</span><span class="o">=</span><span class="n">remote</span><span class="p">,</span><span class="n">ip</span><span class="o">=&lt;</span><span class="n">Controller</span> <span class="n">IP</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">topo</span><span class="o">=</span><span class="n">linear</span><span class="p">,</span><span class="mi">1</span> <span class="o">--</span><span class="n">switch</span> <span class="n">ovsk</span><span class="p">,</span><span class="n">protocols</span><span class="o">=</span><span class="n">OpenFlow13</span>
</pre></div>
</div>
<p>The above command will create a virtual network consisting of a switch
and a host. The switch will be connected to the controller.</p>
<p>Once the topology is discovered, verify the presence of a flow entry
with &#8220;dl_type&#8221; set to &#8220;0x8809&#8221; to handle LACP packets using the below
ovs-ofctl command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ovs</span><span class="o">-</span><span class="n">ofctl</span> <span class="o">-</span><span class="n">O</span> <span class="n">OpenFlow13</span> <span class="n">dump</span><span class="o">-</span><span class="n">flows</span> <span class="n">s1</span>
 <span class="n">OFPST_FLOW</span> <span class="n">reply</span> <span class="p">(</span><span class="n">OF1</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="n">xid</span><span class="o">=</span><span class="mh">0x2</span><span class="p">):</span>
 <span class="n">cookie</span><span class="o">=</span><span class="mh">0x300000000000001e</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">60.067</span><span class="n">s</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_packets</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_bytes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="mi">01</span><span class="p">:</span><span class="mi">80</span><span class="p">:</span><span class="n">c2</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span><span class="p">,</span><span class="n">dl_type</span><span class="o">=</span><span class="mh">0x8809</span> <span class="n">actions</span><span class="o">=</span><span class="n">CONTROLLER</span><span class="p">:</span><span class="mi">65535</span>
</pre></div>
</div>
<p>Configure an additional link between the switch (s1) and host (h1) using
the below command on mininet shell to aggregate 2 links:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">))</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">s1</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s1">&#39;s1-eth2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The LACP module will listen for LACP control packets that are generated
from legacy switch (non-OpenFlow enabled). In our example, host (h1)
will act as a LACP packet generator. In order to generate the LACP
control packets, a bond interface has to be created on the host (h1)
with mode type set to LACP with long-timeout. To configure bond
interface, create a new file bonding.conf under the /etc/modprobe.d/
directory and insert the below lines in this new file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">bond0</span> <span class="n">bonding</span>
<span class="n">options</span> <span class="n">bonding</span> <span class="n">mode</span><span class="o">=</span><span class="mi">4</span>
</pre></div>
</div>
<p>Here mode=4 is referred to LACP and the default timeout is set to long.</p>
<p>Enable bond interface and associate both physical interface h1-eth0 &amp;
h1-eth1 as members of the bond interface on host (h1) using the below
commands on the mininet shell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;modprobe bonding&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link add bond0 type bond&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link set bond0 address &lt;bond-mac-address&gt;&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link set h1-eth0 down&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link set h1-eth0 master bond0&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link set h1-eth1 down&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link set h1-eth1 master bond0&#39;</span><span class="p">)</span>
<span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;ip link set bond0 up&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the bond0 interface is up, the host (h1) will send LACP packets to
the switch (s1). The LACP Module will then create a LAG through exchange
of LACP packets between the host (h1) and switch (s1). To view the bond
interface output on the host (h1) side:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">py</span> <span class="n">net</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s1">&#39;cat /proc/net/bonding/bond0&#39;</span><span class="p">)</span>
<span class="n">Ethernet</span> <span class="n">Channel</span> <span class="n">Bonding</span> <span class="n">Driver</span><span class="p">:</span> <span class="n">v3</span><span class="o">.</span><span class="mf">7.1</span> <span class="p">(</span><span class="n">April</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">2011</span><span class="p">)</span>
<span class="n">Bonding</span> <span class="n">Mode</span><span class="p">:</span> <span class="n">IEEE</span> <span class="mf">802.3</span><span class="n">ad</span> <span class="n">Dynamic</span> <span class="n">link</span> <span class="n">aggregation</span>
<span class="n">Transmit</span> <span class="n">Hash</span> <span class="n">Policy</span><span class="p">:</span> <span class="n">layer2</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">MII</span> <span class="n">Status</span><span class="p">:</span> <span class="n">up</span>
<span class="n">MII</span> <span class="n">Polling</span> <span class="n">Interval</span> <span class="p">(</span><span class="n">ms</span><span class="p">):</span> <span class="mi">100</span>
<span class="n">Up</span> <span class="n">Delay</span> <span class="p">(</span><span class="n">ms</span><span class="p">):</span> <span class="mi">0</span>
<span class="n">Down</span> <span class="n">Delay</span> <span class="p">(</span><span class="n">ms</span><span class="p">):</span> <span class="mi">0</span>
<span class="mf">802.3</span><span class="n">ad</span> <span class="n">info</span>
<span class="n">LACP</span> <span class="n">rate</span><span class="p">:</span> <span class="n">slow</span>
<span class="n">Min</span> <span class="n">links</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Aggregator</span> <span class="n">selection</span> <span class="n">policy</span> <span class="p">(</span><span class="n">ad_select</span><span class="p">):</span> <span class="n">stable</span>
<span class="n">Active</span> <span class="n">Aggregator</span> <span class="n">Info</span><span class="p">:</span>
        <span class="n">Aggregator</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">1</span>
        <span class="n">Number</span> <span class="n">of</span> <span class="n">ports</span><span class="p">:</span> <span class="mi">2</span>
        <span class="n">Actor</span> <span class="n">Key</span><span class="p">:</span> <span class="mi">33</span>
        <span class="n">Partner</span> <span class="n">Key</span><span class="p">:</span> <span class="mi">27</span>
        <span class="n">Partner</span> <span class="n">Mac</span> <span class="n">Address</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">01</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Slave</span> <span class="n">Interface</span><span class="p">:</span> <span class="n">h1</span><span class="o">-</span><span class="n">eth0</span>
<span class="n">MII</span> <span class="n">Status</span><span class="p">:</span> <span class="n">up</span>
<span class="n">Speed</span><span class="p">:</span> <span class="mi">10000</span> <span class="n">Mbps</span>
<span class="n">Duplex</span><span class="p">:</span> <span class="n">full</span>
<span class="n">Link</span> <span class="n">Failure</span> <span class="n">Count</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Permanent</span> <span class="n">HW</span> <span class="n">addr</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">11</span>
<span class="n">Aggregator</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Slave</span> <span class="n">queue</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Slave</span> <span class="n">Interface</span><span class="p">:</span> <span class="n">h1</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">MII</span> <span class="n">Status</span><span class="p">:</span> <span class="n">up</span>
<span class="n">Speed</span><span class="p">:</span> <span class="mi">10000</span> <span class="n">Mbps</span>
<span class="n">Duplex</span><span class="p">:</span> <span class="n">full</span>
<span class="n">Link</span> <span class="n">Failure</span> <span class="n">Count</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Permanent</span> <span class="n">HW</span> <span class="n">addr</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">12</span>
<span class="n">Aggregator</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Slave</span> <span class="n">queue</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<p>A corresponding group table entry would be created on the OpenFlow
switch (s1) with &#8220;type&#8221; set to &#8220;select&#8221; to perform the LAG
functionality. To view the group entries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span><span class="n">ovs</span><span class="o">-</span><span class="n">ofctl</span> <span class="o">-</span><span class="n">O</span> <span class="n">Openflow13</span> <span class="n">dump</span><span class="o">-</span><span class="n">groups</span> <span class="n">s1</span>
<span class="n">OFPST_GROUP_DESC</span> <span class="n">reply</span> <span class="p">(</span><span class="n">OF1</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="n">xid</span><span class="o">=</span><span class="mh">0x2</span><span class="p">):</span>
 <span class="n">group_id</span><span class="o">=</span><span class="mi">60169</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="n">select</span><span class="p">,</span><span class="n">bucket</span><span class="o">=</span><span class="n">weight</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">actions</span><span class="o">=</span><span class="n">output</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">output</span><span class="p">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>To apply the LAG functionality on the switches, the flows should be
configured with action set to GroupId instead of output port. A sample
add-flow configuration with output action set to GroupId:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ovs</span><span class="o">-</span><span class="n">ofctl</span> <span class="o">-</span><span class="n">O</span> <span class="n">Openflow13</span> <span class="n">add</span><span class="o">-</span><span class="n">flow</span> <span class="n">s1</span> <span class="n">dl_type</span><span class="o">=</span><span class="mh">0x0806</span><span class="p">,</span><span class="n">dl_src</span><span class="o">=</span><span class="n">SRC_MAC</span><span class="p">,</span><span class="n">dl_dst</span><span class="o">=</span><span class="n">DST_MAC</span><span class="p">,</span><span class="n">actions</span><span class="o">=</span><span class="n">group</span><span class="p">:</span><span class="mi">60169</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lisp-flow-mapping-user-guide">
<h2>LISP Flow Mapping User Guide<a class="headerlink" href="#lisp-flow-mapping-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id39">
<h3>Overview<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<div class="section" id="locator-id-separation-protocol">
<h4>Locator/ID Separation Protocol<a class="headerlink" href="#locator-id-separation-protocol" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://tools.ietf.org/html/rfc6830">Locator/ID Separation Protocol
(LISP)</a> is a technology that
provides a flexible map-and-encap framework that can be used for overlay
network applications such as data center network virtualization and
Network Function Virtualization (NFV).</p>
<p>LISP provides the following name spaces:</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6830#page-6">Endpoint Identifiers
(EIDs)</a></li>
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6830#section-3">Routing Locators
(RLOCs)</a></li>
</ul>
<p>In a virtualization environment EIDs can be viewed as virtual address
space and RLOCs can be viewed as physical network address space.</p>
<p>The LISP framework decouples network control plane from the forwarding
plane by providing:</p>
<ul class="simple">
<li>A data plane that specifies how the virtualized network addresses are
encapsulated in addresses from the underlying physical network.</li>
<li>A control plane that stores the mapping of the virtual-to-physical
address spaces, the associated forwarding policies and serves this
information to the data plane on demand.</li>
</ul>
<p>Network programmability is achieved by programming forwarding policies
such as transparent mobility, service chaining, and traffic engineering
in the mapping system; where the data plane elements can fetch these
policies on demand as new flows arrive. This chapter describes the LISP
Flow Mapping project in OpenDaylight and how it can be used to enable
advanced SDN and NFV use cases.</p>
<p>LISP data plane Tunnel Routers are available at
<a class="reference external" href="http://LISPmob.org/">LISPmob.org</a> in the open source community on
the following platforms:</p>
<ul class="simple">
<li>Linux</li>
<li>Android</li>
<li>OpenWRT</li>
</ul>
<p>For more details and support for LISP data plane software please visit
<a class="reference external" href="http://LISPmob.org/">the LISPmob web site</a>.</p>
</div>
<div class="section" id="lisp-flow-mapping-service">
<h4>LISP Flow Mapping Service<a class="headerlink" href="#lisp-flow-mapping-service" title="Permalink to this headline">¶</a></h4>
<p>The LISP Flow Mapping service provides LISP Mapping System services.
This includes LISP Map-Server and LISP Map-Resolver services to store
and serve mapping data to data plane nodes as well as to OpenDaylight
applications. Mapping data can include mapping of virtual addresses to
physical network address where the virtual nodes are reachable or hosted
at. Mapping data can also include a variety of routing policies
including traffic engineering and load balancing. To leverage this
service, OpenDaylight applications and services can use the northbound
REST API to define the mappings and policies in the LISP Mapping
Service. Data plane devices capable of LISP control protocol can
leverage this service through a southbound LISP plugin. LISP-enabled
devices must be configured to use this OpenDaylight service as their Map
Server and/or Map Resolver.</p>
<p>The southbound LISP plugin supports the LISP control protocol
(Map-Register, Map-Request, Map-Reply messages), and can also be used to
register mappings in the OpenDaylight mapping service.</p>
</div>
</div>
<div class="section" id="lisp-flow-mapping-architecture">
<h3>LISP Flow Mapping Architecture<a class="headerlink" href="#lisp-flow-mapping-architecture" title="Permalink to this headline">¶</a></h3>
<p>The following figure shows the various LISP Flow Mapping modules.</p>
<div class="figure" id="id219">
<img alt="LISP Mapping Service Internal Architecture" src="../_images/ODL_lfm_Be_component.jpg" />
<p class="caption"><span class="caption-text">LISP Mapping Service Internal Architecture</span></p>
</div>
<p>A brief description of each module is as follows:</p>
<ul class="simple">
<li><strong>DAO (Data Access Object):</strong> This layer separates the LISP logic
from the database, so that we can separate the map server and map
resolver from the specific implementation of the mapping database.
Currently we have an implementation of this layer with an in-memory
HashMap, but it can be switched to any other key/value store and you
only need to implement the ILispDAO interface.</li>
<li><strong>Map Server:</strong> This module processes the adding or registration of
authentication tokens (keys) and mappings. For a detailed
specification of LISP Map Server, see
<a class="reference external" href="http://tools.ietf.org/search/rfc6830">LISP</a>.</li>
<li><strong>Map Resolver:</strong> This module receives and processes the mapping
lookup queries and provides the mappings to requester. For a detailed
specification of LISP Map Server, see
<a class="reference external" href="http://tools.ietf.org/search/rfc6830">LISP</a>.</li>
<li><strong>RPC/RESTCONF:</strong> This is the auto-generated RESTCONF-based
northbound API. This module enables defining key-EID associations as
well as adding mapping information through the Map Server. Key-EID
associations and mappings can also be queried via this API.</li>
<li><strong>GUI:</strong> This module enables adding and querying the mapping service
through a GUI based on ODL DLUX.</li>
<li><strong>Neutron:</strong> This module implements the OpenDaylight Neutron Service
APIs. It provides integration between the LISP service and the
OpenDaylight Neutron service, and thus OpenStack.</li>
<li><strong>Java API:</strong> The API module exposes the Map Server and Map Resolver
capabilities via a Java API.</li>
<li><strong>LISP Proto:</strong> This module includes LISP protocol dependent data
types and associated processing.</li>
<li><strong>In Memory DB:</strong> This module includes the in memory database
implementation of the mapping service.</li>
<li><strong>LISP Southbound Plugin:</strong> This plugin enables data plane devices
that support LISP control plane protocol (see
<a class="reference external" href="http://tools.ietf.org/search/rfc6830">LISP</a>) to register and
query mappings to the LISP Flow Mapping via the LISP control plane
protocol.</li>
</ul>
</div>
<div class="section" id="configuring-lisp-flow-mapping">
<h3>Configuring LISP Flow Mapping<a class="headerlink" href="#configuring-lisp-flow-mapping" title="Permalink to this headline">¶</a></h3>
<p>In order to use the LISP mapping service for registering EID to RLOC
mappings from northbound or southbound, keys have to be defined for the
EID prefixes first. Once a key is defined for an EID prefix, it can be
used to add mappings for that EID prefix multiple times. If the service
is going to be used to process Map-Register messages from the southbound
LISP plugin, the same key must be used by the data plane device to
create the authentication data in the Map-Register messages for the
associated EID prefix.</p>
<p>The <code class="docutils literal"><span class="pre">etc/custom.properties</span></code> file in the Karaf distribution allows
configuration of several OpenDaylight parameters. The LISP service has
the following properties that can be adjusted:</p>
<dl class="docutils">
<dt><strong>lisp.mappingOverwrite</strong> (default: <em>true</em>)</dt>
<dd>Configures handling of mapping updates. When set to <em>true</em> (default)
a mapping update (either through the southbound plugin via a
Map-Register message or through a northbound API PUT REST call) the
existing RLOC set associated to an EID prefix is overwritten. When
set to <em>false</em>, the RLOCs of the update are merged to the existing
set.</dd>
<dt><strong>lisp.smr</strong> (default: <em>false</em>)</dt>
<dd>Enables/disables the <a class="reference external" href="http://tools.ietf.org/html/rfc6830#section-6.6.2">Solicit-Map-Request
(SMR)</a>
functionality. SMR is a method to notify changes in an EID-to-RLOC
mapping to &#8220;subscribers&#8221;. The LISP service considers all
Map-Request’s source RLOC as a subscriber to the requested EID
prefix, and will send an SMR control message to that RLOC if the
mapping changes.</dd>
<dt><strong>lisp.elpPolicy</strong> (default: <em>default</em>)</dt>
<dd>Configures how to build a Map-Reply southbound message from a
mapping containing an Explicit Locator Path (ELP) RLOC. It is used
for compatibility with dataplane devices that don’t understand the
ELP LCAF format. The <em>default</em> setting doesn’t alter the mapping,
returning all RLOCs unmodified. The <em>both</em> setting adds a new RLOC
to the mapping, with a lower priority than the ELP, that is the next
hop in the service chain. To determine the next hop, it searches the
source RLOC of the Map-Request in the ELP, and chooses the next hop,
if it exists, otherwise it chooses the first hop. The <em>replace</em>
setting adds a new RLOC using the same algorithm as the <em>both</em>
setting, but using the origin priority of the ELP RLOC, which is
removed from the mapping.</dd>
<dt><strong>lisp.lookupPolicy</strong> (default: <em>northboundFirst</em>)</dt>
<dd>Configures the mapping lookup algorithm. When set to
<em>northboundFirst</em> mappings programmed through the northbound API
will take precedence. If no northbound programmed mappings exist,
then the mapping service will return mappings registered through the
southbound plugin, if any exists. When set to
<em>northboundAndSouthbound</em> the mapping programmed by the northbound
is returned, updated by the up/down status of these mappings as
reported by the southbound (if existing).</dd>
<dt><strong>lisp.mappingMerge</strong> (default: <em>false</em>)</dt>
<dd>Configures the merge policy on the southbound registrations through
the LISP SB Plugin. When set to <em>false</em>, only the latest mapping
registered through the SB plugin is valid in the southbound mapping
database, independent of which device it came from. When set to
<em>true</em>, mappings for the same EID registered by different devices
are merged together and a union of the locators is maintained as the
valid mapping for that EID.</dd>
</dl>
</div>
<div class="section" id="textual-conventions-for-lisp-address-formats">
<h3>Textual Conventions for LISP Address Formats<a class="headerlink" href="#textual-conventions-for-lisp-address-formats" title="Permalink to this headline">¶</a></h3>
<p>In addition to the more common IPv4, IPv6 and MAC address data types,
the LISP control plane supports arbitrary <a class="reference external" href="http://www.iana.org/assignments/address-family-numbers">Address Family
Identifiers</a>
assigned by IANA, and in addition to those the <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-lisp-lcaf">LISP Canoncal Address
Format (LCAF)</a>.</p>
<p>The LISP Flow Mapping project in OpenDaylight implements support for
many of these different address formats, the full list being summarized
in the following table. While some of the address formats have well
defined and widely used textual representation, many don’t. It became
necessary to define a convention to use for text rendering of all
implemented address types in logs, URLs, input fields, etc. The below
table lists the supported formats, along with their AFI number and LCAF
type, including the prefix used for disambiguation of potential overlap,
and examples output.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">AFI</th>
<th class="head">LCAF</th>
<th class="head">Prefix</th>
<th class="head">Text Rendering</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>No Address</strong></td>
<td>0</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>no:</td>
<td>No Address Present</td>
</tr>
<tr class="row-odd"><td><strong>IPv4 Prefix</strong></td>
<td>1</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>ipv4:</td>
<td>192.0.2.0/24</td>
</tr>
<tr class="row-even"><td><strong>IPv6 Prefix</strong></td>
<td>2</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>ipv6:</td>
<td>2001:db8::/32</td>
</tr>
<tr class="row-odd"><td><strong>MAC Address</strong></td>
<td>16389</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>mac:</td>
<td>00:00:5E:00:53:00</td>
</tr>
<tr class="row-even"><td><strong>Distinguished
Name</strong></td>
<td>17</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>dn:</td>
<td>stringAsIs</td>
</tr>
<tr class="row-odd"><td><strong>AS Number</strong></td>
<td>18</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>as:</td>
<td>AS64500</td>
</tr>
<tr class="row-even"><td><strong>AFI List</strong></td>
<td>16387</td>
<td>1</td>
<td>list:</td>
<td>{192.0.2.1,192.0.2.2,2001:db8::1
}</td>
</tr>
<tr class="row-odd"><td><strong>Instance ID</strong></td>
<td>16387</td>
<td>2</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>[223] 192.0.2.0/24</td>
</tr>
<tr class="row-even"><td><strong>Application
Data</strong></td>
<td>16387</td>
<td>4</td>
<td>appdata:</td>
<td>192.0.2.1!128!17!80-81!6667-7000</td>
</tr>
<tr class="row-odd"><td><strong>Explicit
Locator Path</strong></td>
<td>16387</td>
<td>10</td>
<td>elp:</td>
<td>{192.0.2.1→192.0.2.2|lps→192.0.
2.3}</td>
</tr>
<tr class="row-even"><td><strong>Source/Destina
tion
Key</strong></td>
<td>16387</td>
<td>12</td>
<td>srcdst:</td>
<td>192.0.2.1/32|192.0.2.2/32</td>
</tr>
<tr class="row-odd"><td><strong>Key/Value
Address Pair</strong></td>
<td>16387</td>
<td>15</td>
<td>kv:</td>
<td>192.0.2.1⇒192.0.2.2</td>
</tr>
<tr class="row-even"><td><strong>Service Path</strong></td>
<td>16387</td>
<td>N/A</td>
<td>sp:</td>
<td>42(3)</td>
</tr>
</tbody>
</table>
<p>Table: LISP Address Formats</p>
<p>Please note that the forward slash character <code class="docutils literal"><span class="pre">/</span></code> typically separating
IPv4 and IPv6 addresses from the mask length is transformed into <code class="docutils literal"><span class="pre">%2f</span></code>
when used in a URL.</p>
</div>
<div class="section" id="karaf-commands">
<h3>Karaf commands<a class="headerlink" href="#karaf-commands" title="Permalink to this headline">¶</a></h3>
<p>In this section we will discuss two types of Karaf commands: built-in,
and LISP specific. Some built-in commands are quite useful, and are
needed for the tutorial, so they will be discussed here. A reference of
all LISP specific commands, added by the LISP Flow Mapping project is
also included. They are useful mostly for debugging.</p>
<div class="section" id="useful-built-in-commands">
<h4>Useful built-in commands<a class="headerlink" href="#useful-built-in-commands" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">help</span></code></dt>
<dd>Lists all available command, with a short description of each.</dd>
<dt><code class="docutils literal"><span class="pre">help</span> <span class="pre">&lt;command_name&gt;</span></code></dt>
<dd>Show detailed help about a specific command.</dd>
<dt><code class="docutils literal"><span class="pre">feature:list</span> <span class="pre">[-i]</span></code></dt>
<dd>Show all locally available features in the Karaf container. The
<code class="docutils literal"><span class="pre">-i</span></code> option lists only features that are currently installed. It
is possible to use <code class="docutils literal"><span class="pre">|</span> <span class="pre">grep</span></code> to filter the output (for all
commands, not just this one).</dd>
<dt><code class="docutils literal"><span class="pre">feature:install</span> <span class="pre">&lt;feature_name&gt;</span></code></dt>
<dd>Install feature <code class="docutils literal"><span class="pre">feature_name</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">log:set</span> <span class="pre">&lt;level&gt;</span> <span class="pre">&lt;class&gt;</span></code></dt>
<dd>Set the log level for <code class="docutils literal"><span class="pre">class</span></code> to <code class="docutils literal"><span class="pre">level</span></code>. The default log level
for all classes is INFO. For debugging, or learning about LISP
internals it is useful to run
<code class="docutils literal"><span class="pre">log:set</span> <span class="pre">TRACE</span> <span class="pre">org.opendaylight.lispflowmapping</span></code> right after Karaf
starts up.</dd>
<dt><code class="docutils literal"><span class="pre">log:display</span></code></dt>
<dd>Outputs the log file to the console, and returns control to the
user.</dd>
<dt><code class="docutils literal"><span class="pre">log:tail</span></code></dt>
<dd>Continuously shows log output, requires <code class="docutils literal"><span class="pre">Ctrl+C</span></code> to return to the
console.</dd>
</dl>
</div>
<div class="section" id="lisp-specific-commands">
<h4>LISP specific commands<a class="headerlink" href="#lisp-specific-commands" title="Permalink to this headline">¶</a></h4>
<p>The available lisp commands can always be obtained by
<code class="docutils literal"><span class="pre">help</span> <span class="pre">mappingservice</span></code>. Currently they are:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">mappingservice:addkey</span></code></dt>
<dd>Add the default password <code class="docutils literal"><span class="pre">password</span></code> for the IPv4 EID prefix
0.0.0.0/0 (all addresses). This is useful when experimenting with
southbound devices, and using the REST interface would be combersome
for whatever reason.</dd>
<dt><code class="docutils literal"><span class="pre">mappingservice:mappings</span></code></dt>
<dd>Show the list of all mappings stored in the internal non-persistent
data store (the DAO), listing the full data structure. The output is
not human friendly, but can be used for debugging.</dd>
</dl>
</div>
</div>
<div class="section" id="lisp-flow-mapping-karaf-features">
<h3>LISP Flow Mapping Karaf Features<a class="headerlink" href="#lisp-flow-mapping-karaf-features" title="Permalink to this headline">¶</a></h3>
<p>LISP Flow Mapping has the following Karaf features that can be installed
from the Karaf console:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">odl-lispflowmapping-msmr</span></code></dt>
<dd>This includes the core features required to use the LISP Flow
Mapping Service such as mapping service and the LISP southbound
plugin.</dd>
<dt><code class="docutils literal"><span class="pre">odl-lispflowmapping-ui</span></code></dt>
<dd>This includes the GUI module for the LISP Mapping Service.</dd>
<dt><code class="docutils literal"><span class="pre">odl-lispflowmapping-neutron</span></code></dt>
<dd>This is the experimental Neutron provider module for LISP mapping
service.</dd>
</dl>
</div>
<div class="section" id="id40">
<h3>Tutorials<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<p>This section provides a tutorial demonstrating various features in this
service.</p>
<div class="section" id="creating-a-lisp-overlay">
<h4>Creating a LISP overlay<a class="headerlink" href="#creating-a-lisp-overlay" title="Permalink to this headline">¶</a></h4>
<p>This section provides instructions to set up a LISP network of three
nodes (one &#8220;client&#8221; node and two &#8220;server&#8221; nodes) using LISPmob as data
plane LISP nodes and the LISP Flow Mapping project from OpenDaylight as
the LISP programmable mapping system for the LISP network.</p>
<div class="section" id="id41">
<h5>Overview<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h5>
<p>The steps shown below will demonstrate setting up a LISP network between
a client and two servers, then performing a failover between the two
&#8220;server&#8221; nodes.</p>
</div>
<div class="section" id="id42">
<h5>Prerequisites<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><strong>OpenDaylight Beryllium</strong></li>
<li><strong>The Postman Chrome App</strong>: the most convenient way to follow along
this tutorial is to use the <a class="reference external" href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en">Postman Chrome
App</a>
to edit and send the requests. The project git repository hosts a
collection of the requests that are used in this tutorial in the
<code class="docutils literal"><span class="pre">resources/tutorial/Beryllium_Tutorial.json.postman_collection</span></code>
file. You can import this file to Postman by clicking <em>Import</em> at the
top, choosing <em>Download from link</em> and then entering the following
URL:
<code class="docutils literal"><span class="pre">https://git.opendaylight.org/gerrit/gitweb?p=lispflowmapping.git;a=blob_plain;f=resources/tutorial/Beryllium_Tutorial.json.postman_collection;hb=refs/heads/stable/beryllium</span></code>.
Alternatively, you can save the file on your machine, or if you have
the repository checked out, you can import from there. You will need
to create a new Postman Environment and define some variables within:
<code class="docutils literal"><span class="pre">controllerHost</span></code> set to the hostname or IP address of the machine
running the ODL instance, and <code class="docutils literal"><span class="pre">restconfPort</span></code> to 8181, if you didn’t
modify the default controller settings.</li>
<li><strong>LISPmob version 0.5.x</strong> The README.md lists the dependencies needed
to build it from source.</li>
<li><strong>A virtualization platform</strong></li>
</ul>
</div>
<div class="section" id="id43">
<h5>Target Environment<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h5>
<p>The three LISP data plane nodes and the LISP mapping system are assumed
to be running in Linux virtual machines, which have the <code class="docutils literal"><span class="pre">eth0</span></code>
interface in NAT mode to allow outside internet access and <code class="docutils literal"><span class="pre">eth1</span></code>
connected to a host-only network, with the following IP addresses
(please adjust configuration files, JSON examples, etc. accordingly if
you’re using another addressing scheme):</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Node</th>
<th class="head">Node Type</th>
<th class="head">IP Address</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>controller</strong></td>
<td>OpenDaylight</td>
<td>192.168.16.11</td>
</tr>
<tr class="row-odd"><td><strong>client</strong></td>
<td>LISPmob</td>
<td>192.168.16.30</td>
</tr>
<tr class="row-even"><td><strong>server1</strong></td>
<td>LISPmob</td>
<td>192.168.16.31</td>
</tr>
<tr class="row-odd"><td><strong>server2</strong></td>
<td>LISPmob</td>
<td>192.168.16.32</td>
</tr>
<tr class="row-even"><td><strong>service-node</strong></td>
<td>LISPmob</td>
<td>192.168.16.33</td>
</tr>
</tbody>
</table>
<p>Table: Nodes in the tutorial</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>While the tutorial uses LISPmob as the data plane, it could be any
LISP-enabled hardware or software router (commercial/open source).</p>
</div></blockquote>
</div>
<div class="section" id="id44">
<h5>Instructions<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h5>
<p>The below steps use the command line tool cURL to talk to the LISP Flow
Mapping RPC REST API. This is so that you can see the actual request
URLs and body content on the page.</p>
<ol class="arabic">
<li><p class="first">Install and run OpenDaylight Beryllium release on the controller VM.
Please follow the general OpenDaylight Beryllium Installation Guide
for this step. Once the OpenDaylight controller is running install
the <em>odl-lispflowmapping-msmr</em> feature from the Karaf CLI:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">lispflowmapping</span><span class="o">-</span><span class="n">msmr</span>
</pre></div>
</div>
<p>It takes quite a while to load and initialize all features and their
dependencies. It’s worth running the command <code class="docutils literal"><span class="pre">log:tail</span></code> in the
Karaf console to see when the log output is winding down, and
continue with the tutorial after that.</p>
</li>
<li><p class="first">Install LISPmob on the <strong>client</strong>, <strong>server1</strong>, <strong>server2</strong>, and
<strong>service-node</strong> VMs following the installation instructions <a class="reference external" href="https://github.com/LISPmob/lispmob#software-prerequisites">from
the LISPmob README
file</a>.</p>
</li>
<li><p class="first">Configure the LISPmob installations from the previous step. Starting
from the <code class="docutils literal"><span class="pre">lispd.conf.example</span></code> file in the distribution, set the
EID in each <code class="docutils literal"><span class="pre">lispd.conf</span></code> file from the IP address space selected
for your virtual/LISP network. In this tutorial the EID of the
<strong>client</strong> is set to 1.1.1.1/32, and that of <strong>server1</strong> and
<strong>server2</strong> to 2.2.2.2/32.</p>
</li>
<li><p class="first">Set the RLOC interface to <code class="docutils literal"><span class="pre">eth1</span></code> in each <code class="docutils literal"><span class="pre">lispd.conf</span></code> file. LISP
will determine the RLOC (IP address of the corresponding VM) based
on this interface.</p>
</li>
<li><p class="first">Set the Map-Resolver address to the IP address of the
<strong>controller</strong>, and on the <strong>client</strong> the Map-Server too. On
<strong>server1</strong> and <strong>server2</strong> set the Map-Server to something else, so
that it doesn’t interfere with the mappings on the controller, since
we’re going to program them manually.</p>
</li>
<li><p class="first">Modify the &#8220;key&#8221; parameter in each <code class="docutils literal"><span class="pre">lispd.conf</span></code> file to a
key/password of your choice (<em>password</em> in this tutorial).</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>The <code class="docutils literal"><span class="pre">resources/tutorial</span></code> directory in the <em>stable/beryllium</em>
branch of the project git repository has the files used in the
tutorial <a class="reference external" href="https://git.opendaylight.org/gerrit/gitweb?p=lispflowmapping.git;a=tree;f=resources/tutorial;hb=refs/heads/stable/beryllium">checked
in</a>,
so you can just copy the files to <code class="docutils literal"><span class="pre">/root/lispd.conf</span></code> on the
respective VMs. You will also find the JSON files referenced
below in the same directory.</p>
</div></blockquote>
</li>
<li><p class="first">Define a key and EID prefix association in OpenDaylight using the
RPC REST API for the <strong>client</strong> EID (1.1.1.1/32) to allow
registration from the southbound. Since the mappings for the server
EID will be configured from the REST API, no such association is
necessary. Run the below command on the <strong>controller</strong> (or any
machine that can reach <strong>controller</strong>, by replacing <em>localhost</em> with
the IP address of <strong>controller</strong>).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">odl</span><span class="o">-</span><span class="n">mappingservice</span><span class="p">:</span><span class="n">add</span><span class="o">-</span><span class="n">key</span> \
    <span class="o">--</span><span class="n">data</span> <span class="nd">@add</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>where the content of the <em>add-key.json</em> file is the following:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;eid&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ietf-lisp-address-types:ipv4-prefix-afi&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ipv4-prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;1.1.1.1/32&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;mapping-authkey&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;key-string&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="s2">&quot;key-type&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Verify that the key is added properly by requesting the following
URL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">odl</span><span class="o">-</span><span class="n">mappingservice</span><span class="p">:</span><span class="n">get</span><span class="o">-</span><span class="n">key</span> \
    <span class="o">--</span><span class="n">data</span> <span class="nd">@get1</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>where the content of the <em>get1.json</em> file can be derived from the
<em>add-key.json</em> file by removing the <em>mapping-authkey</em> field. The
output the above invocation should look like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;output&quot;</span><span class="p">:{</span><span class="s2">&quot;mapping-authkey&quot;</span><span class="p">:{</span><span class="s2">&quot;key-type&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;key-string&quot;</span><span class="p">:</span><span class="s2">&quot;password&quot;</span><span class="p">}}}</span>
</pre></div>
</div>
</li>
<li><p class="first">Run the <code class="docutils literal"><span class="pre">lispd</span></code> LISPmob daemon on all VMs:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">lispd</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">lispd</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
<li><p class="first">The <strong>client</strong> LISPmob node should now register its EID-to-RLOC
mapping in OpenDaylight. To verify you can lookup the corresponding
EIDs via the REST API</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">odl</span><span class="o">-</span><span class="n">mappingservice</span><span class="p">:</span><span class="n">get</span><span class="o">-</span><span class="n">mapping</span> \
    <span class="o">--</span><span class="n">data</span> <span class="nd">@get1</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>An alternative way for retrieving mappings from ODL using the
southbound interface is using the
<code class="docutils literal"><span class="pre">`lig</span></code> &lt;<a class="reference external" href="https://github.com/davidmeyer/lig">https://github.com/davidmeyer/lig</a>&gt;`__ open source tool.</p>
</li>
<li><p class="first">Register the EID-to-RLOC mapping of the server EID 2.2.2.2/32 to the
controller, pointing to <strong>server1</strong> and <strong>server2</strong> with a higher
priority for <strong>server1</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">odl</span><span class="o">-</span><span class="n">mappingservice</span><span class="p">:</span><span class="n">add</span><span class="o">-</span><span class="n">mapping</span> \
    <span class="o">--</span><span class="n">data</span> <span class="nd">@mapping</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>where the <em>mapping.json</em> file looks like this:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;mapping-record&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;recordTtl&quot;</span><span class="p">:</span> <span class="mi">1440</span><span class="p">,</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;NoAction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;authoritative&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;eid&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ietf-lisp-address-types:ipv4-prefix-afi&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ipv4-prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;2.2.2.2/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;LocatorRecord&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;locator-id&quot;</span><span class="p">:</span> <span class="s2">&quot;server1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;multicastPriority&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                    <span class="s2">&quot;multicastWeight&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;localLocator&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;rlocProbed&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                    <span class="s2">&quot;routed&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;rloc&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ietf-lisp-address-types:ipv4-afi&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;ipv4&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.16.31&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;locator-id&quot;</span><span class="p">:</span> <span class="s2">&quot;server2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;multicastPriority&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                    <span class="s2">&quot;multicastWeight&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;localLocator&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;rlocProbed&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                    <span class="s2">&quot;routed&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;rloc&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ietf-lisp-address-types:ipv4-afi&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;ipv4&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.16.32&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here the priority of the second RLOC (192.168.16.32 - <strong>server2</strong>)
is 2, a higher numeric value than the priority of 192.168.16.31,
which is 1. This policy is saying that <strong>server1</strong> is preferred to
<strong>server2</strong> for reaching EID 2.2.2.2/32. Note that lower priority
value has higher preference in LISP.</p>
</li>
<li><p class="first">Verify the correct registration of the 2.2.2.2/32 EID:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">odl</span><span class="o">-</span><span class="n">mappingservice</span><span class="p">:</span><span class="n">get</span><span class="o">-</span><span class="n">mapping</span> \
    <span class="o">--</span><span class="n">data</span> <span class="nd">@get2</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>where <em>get2.json</em> can be derived from <em>get1.json</em> by changing the
content of the <em>Ipv4Address</em> field from <em>1.1.1.1</em> to <em>2.2.2.2</em>.</p>
</li>
<li><p class="first">Now the LISP network is up. To verify, log into the <strong>client</strong> VM
and ping the server EID:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ping</span> <span class="mf">2.2</span><span class="o">.</span><span class="mf">2.2</span>
</pre></div>
</div>
</li>
<li><p class="first">Let’s test fail-over now. Suppose you had a service on <strong>server1</strong>
which became unavailable, but <strong>server1</strong> itself is still reachable.
LISP will not automatically fail over, even if the mapping for
2.2.2.2/32 has two locators, since both locators are still reachable
and uses the one with the higher priority (lowest priority value).
To force a failover, we need to set the priority of <strong>server2</strong> to a
lower value. Using the file mapping.json above, swap the priority
values between the two locators (lines 14 and 28 in <em>mapping.json</em>)
and repeat the request from step 11. You can also repeat step 12 to
see if the mapping is correctly registered. If you leave the ping
on, and monitor the traffic using wireshark, you can see that the
ping traffic to 2.2.2.2 will be diverted from the <strong>server1</strong> RLOC
to the <strong>server2</strong> RLOC.</p>
<p>With the default OpenDaylight configuration the failover should be
near instantaneous (we observed 3 lost pings in the worst case),
because of the LISP <a class="reference external" href="http://tools.ietf.org/html/rfc6830#section-6.6.2">Solicit-Map-Request (SMR)
mechanism</a> that
can ask a LISP data plane element to update its mapping for a
certain EID (enabled by default). It is controlled by the
<code class="docutils literal"><span class="pre">lisp.smr</span></code> variable in <code class="docutils literal"><span class="pre">etc/custom.porperties</span></code>. When enabled,
any mapping change from the RPC interface will trigger an SMR packet
to all data plane elements that have requested the mapping in the
last 24 hours (this value was chosen because it’s the default TTL of
Cisco IOS xTR mapping registrations). If disabled, ITRs keep their
mappings until the TTL specified in the Map-Reply expires.</p>
</li>
<li><p class="first">To add a service chain into the path from the client to the server,
we can use an Explicit Locator Path, specifying the <strong>service-node</strong>
as the first hop and <strong>server1</strong> (or <strong>server2</strong>) as the second hop.
The following will achieve that:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">odl</span><span class="o">-</span><span class="n">mappingservice</span><span class="p">:</span><span class="n">add</span><span class="o">-</span><span class="n">mapping</span> \
    <span class="o">--</span><span class="n">data</span> <span class="nd">@elp</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>where the <em>elp.json</em> file is as follows:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;mapping-record&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;recordTtl&quot;</span><span class="p">:</span> <span class="mi">1440</span><span class="p">,</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;NoAction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;authoritative&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;eid&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ietf-lisp-address-types:ipv4-prefix-afi&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ipv4-prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;2.2.2.2/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;LocatorRecord&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;locator-id&quot;</span><span class="p">:</span> <span class="s2">&quot;ELP&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;multicastPriority&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
                    <span class="s2">&quot;multicastWeight&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;localLocator&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;rlocProbed&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
                    <span class="s2">&quot;routed&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                    <span class="s2">&quot;rloc&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;address-type&quot;</span><span class="p">:</span> <span class="s2">&quot;ietf-lisp-address-types:explicit-locator-path-lcaf&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;explicit-locator-path&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;hop&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;hop-id&quot;</span><span class="p">:</span> <span class="s2">&quot;service-node&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.16.33&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;lrs-bits&quot;</span><span class="p">:</span> <span class="s2">&quot;strict&quot;</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;hop-id&quot;</span><span class="p">:</span> <span class="s2">&quot;server1&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.16.31&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;lrs-bits&quot;</span><span class="p">:</span> <span class="s2">&quot;strict&quot;</span>
                                <span class="p">}</span>
                            <span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After the mapping for 2.2.2.2/32 is updated with the above, the ICMP
traffic from <strong>client</strong> to <strong>server1</strong> will flow through the
<strong>service-node</strong>. You can confirm this in the LISPmob logs, or by
sniffing the traffic on either the <strong>service-node</strong> or <strong>server1</strong>.
Note that service chains are unidirectional, so unless another ELP
mapping is added for the return traffic, packets will go from
<strong>server1</strong> to <strong>client</strong> directly.</p>
</li>
<li><p class="first">Suppose the <strong>service-node</strong> is actually a firewall, and traffic is
diverted there to support access control lists (ACLs). In this
tutorial that can be emulated by using <code class="docutils literal"><span class="pre">iptables</span></code> firewall rules
in the <strong>service-node</strong> VM. To deny traffic on the service chain
defined above, the following rule can be added:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">OUTPUT</span> <span class="o">--</span><span class="n">dst</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">16.31</span> <span class="o">-</span><span class="n">j</span> <span class="n">DROP</span>
</pre></div>
</div>
<p>The ping from the <strong>client</strong> should now have stopped.</p>
<p>In this case the ACL is done on the destination RLOC. There is an
effort underway in the LISPmob community to allow filtering on EIDs,
which is the more logical place to apply ACLs.</p>
</li>
<li><p class="first">To delete the rule and restore connectivity on the service chain,
delete the ACL by issuing the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iptables</span> <span class="o">-</span><span class="n">D</span> <span class="n">OUTPUT</span> <span class="o">--</span><span class="n">dst</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">16.31</span> <span class="o">-</span><span class="n">j</span> <span class="n">DROP</span>
</pre></div>
</div>
<p>which should restore connectivity.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="lisp-flow-mapping-support">
<h3>LISP Flow Mapping Support<a class="headerlink" href="#lisp-flow-mapping-support" title="Permalink to this headline">¶</a></h3>
<p>For support the lispflowmapping project can be reached by emailing the
developer mailing list: <a class="reference external" href="mailto:lispflowmapping-dev&#37;&#52;&#48;lists&#46;opendaylight&#46;org">lispflowmapping-dev<span>&#64;</span>lists<span>&#46;</span>opendaylight<span>&#46;</span>org</a> or on
the #opendaylight-lispflowmapping IRC channel on irc.freenode.net.</p>
<p>Additional information is also available on the <a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Lisp_Flow_Mapping:Main">Lisp Flow Mapping
wiki</a></p>
</div>
</div>
<div class="section" id="messaging4transport-user-guide">
<h2>Messaging4Transport User Guide<a class="headerlink" href="#messaging4transport-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id45">
<h3>Overview<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<p>The OpenDaylight controller is based on an MD-SAL allows the modeling of
data, RPCs, and notifications. Because of this model basis, adding new
northbound bindings to the controller is simple, and everything modeled
becomes exposed automatically. Currently the MD-SAL has RESTCONF
northbound bindings, while more bindings such as AMQP and XMPP can
easily be implemented and integrated. Messaging4Transport attempts to
build more northbound interfaces to MD-SAL, with message-oriented
middleware protocols. Messaging4Transport Beryllium offers an AMQP
northbound to MD-SAL.</p>
</div>
<div class="section" id="architecture">
<h3>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://www.amqp.org">Advanced Message Queuing Protocol (AMQP)</a> is an
open standard application layer protocol for message-oriented
middleware. Messaging4Transport adds AMQP bindings to the MD-SAL, which
would automatically make all MD-SAL APIs available via that mechanism.
Messaging4Transport is built as an independent Karaf feature, that
exposes the MD-SAL data tree, RPCs, and notifications via AMQP, when
installed. While AMQP is the focus for the Beryllium Release, other
message-oriented transport protocols will be considered for future
releases.</p>
<p>A message broker internal or external to OpenDaylight receives the
messages that are published by the MD-SAL, and sends them to the
subscribers. Hence, the broker functions as an intermediary in messages
from the controller to the listeners, and vice versa. ActiveMQ has been
chosen as the default external broker in the Messaging4Transport
Beryllium.</p>
<div class="section" id="installing-karaf-features">
<h4>Installing Karaf Features<a class="headerlink" href="#installing-karaf-features" title="Permalink to this headline">¶</a></h4>
<p>Install Messaging4Transport by using the karaf console.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">mdsal</span><span class="o">-</span><span class="nb">all</span> <span class="n">odl</span><span class="o">-</span><span class="n">messaging4transport</span><span class="o">-</span><span class="n">api</span> <span class="n">odl</span><span class="o">-</span><span class="n">messaging4transport</span>
</pre></div>
</div>
</div>
<div class="section" id="activemq-integration-with-karaf">
<h4>ActiveMQ Integration with Karaf<a class="headerlink" href="#activemq-integration-with-karaf" title="Permalink to this headline">¶</a></h4>
<p>ActiveMQ broker can be integrated into the Karaf environment. The
<a class="reference external" href="http://activemq.apache.org/osgi-integration.html">ActiveMQ OSGi integration instructions
page</a> is for Karaf
2.x. Please see the <a class="reference external" href="http://karaf.apache.org/manual/latest/update-notes.html">Karaf updates
page</a> for
further updates.</p>
<p>Since OpenDaylight Beryllium is built on Karaf 3.x, the instructions are
given below to install and activate ActiveMQ OSGi bundle into Karaf.</p>
<ul>
<li><p class="first">Installing ActiveMQ in Karaf feature:repo-add activemq 5.9.0</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">activemq</span><span class="o">-</span><span class="n">broker</span>
</pre></div>
</div>
</li>
<li><p class="first">Installing <a class="reference external" href="http://hawt.io/getstarted/index.html">hawtio</a> in
Karaf.</p>
</li>
</ul>
<p>hawtio provides a user-friendly web user interface, that can be
installed optionally to work with the project.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">repo</span><span class="o">-</span><span class="n">add</span> <span class="n">hawtio</span> <span class="mf">1.4</span><span class="o">.</span><span class="mi">51</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">hawtio</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="administering-or-managing-messaging4transport">
<h3>Administering or Managing Messaging4Transport<a class="headerlink" href="#administering-or-managing-messaging4transport" title="Permalink to this headline">¶</a></h3>
<p>The broker can be a stand-alone or a Karaf-based broker integrated into
OpenDaylight. Just install the bundles as shown below for Karaf based
integration. In such a case, broker will start with OpenDaylight. The
publisher publishes the data tree. At least a dummy listener should be
started before the publisher to receive the published messages.</p>
<p>You may further configure the broker by modifying the ActiveMQ
configuration file in
ODL_INSTALLATION_DIR/karaf/target/assembly/etc/org.apache.activemq.server-default.cfg</p>
<p>Make sure to set the transport connections in
karaf/target/assembly/etc/activemq.xml, which is set by default in
ActiveMQ stand-alone implementation; but not in the Karaf
implementation.</p>
<p>It is suggested to limit concurrent connections to just 1000. However,
probably we will need more concurrency, based on the requirements.
Setting it to 100,000 for now.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;transportConnectors&gt;
&lt;!-- DOS protection, limit concurrent connections to 1000 and frame size to 100MB --&gt;
&lt;!-- Uncomment whatever necessary. --&gt;
&lt;transportConnector name=&quot;openwire&quot; uri=&quot;tcp://0.0.0.0:61616?maximumConnections=100000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;
&lt;transportConnector name=&quot;amqp&quot; uri=&quot;amqp://0.0.0.0:5672?maximumConnections=100000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;
&lt;!--transportConnector name=&quot;stomp&quot; uri=&quot;stomp://0.0.0.0:61613?maximumConnections=100000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/ --&gt;
&lt;!--transportConnector name=&quot;mqtt&quot; uri=&quot;mqtt://0.0.0.0:1883?maximumConnections=100000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/ --&gt;
&lt;!--transportConnector name=&quot;ws&quot; uri=&quot;ws://0.0.0.0:61614?maximumConnections=100000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/ --&gt;
&lt;/transportConnectors&gt;
</pre></div>
</div>
<p>You may need to install/re-install the bundle after that and restart the
container for the changes to take effort.</p>
<p>The MD-SAL will be the publisher that publishes the MD-SAL data tree,
RPCs, and notifications via AMQP. The listener can be any consumer that
consumes the data tree and the other data published by MD-SAL via the
AMQP binding.</p>
<p>Once configured, the ActiveMQ console can be accessed from the <a class="reference external" href="http://localhost:8181/hawtio/">hawtio
web console</a> with the credentials
karaf/karaf.</p>
<p>Messaging4Transport can hence be configured to publish MD-SAL
notifications to an external AMQP listener application through the
broker. A simple listener application is included in the
org.opendaylight.messaging4transport.sample package.</p>
</div>
</div>
<div class="section" id="network-modeling-nemo">
<h2>NEtwork MOdeling (NEMO)<a class="headerlink" href="#network-modeling-nemo" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to use the NEMO feature in OpenDaylight and
contains contains configuration, administration, and management sections
for the feature.</p>
<div class="section" id="id46">
<h3>Overview<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<p>TBD: An overview of the NEMO feature and the use case and the audience
who will use the feature.</p>
</div>
<div class="section" id="nemo-engine-architecture">
<h3>NEMO Engine Architecture<a class="headerlink" href="#nemo-engine-architecture" title="Permalink to this headline">¶</a></h3>
<p>TBD: Information about NEMO Engine components and how they work
together. Also include information about how the feature integrates with
OpenDaylight.</p>
</div>
<div class="section" id="configuring-nemo-engine">
<h3>Configuring NEMO Engine<a class="headerlink" href="#configuring-nemo-engine" title="Permalink to this headline">¶</a></h3>
<p>TBD: Describe how to configure the NEMO Engine after installation.</p>
</div>
<div class="section" id="administering-or-managing-nemo-engine">
<h3>Administering or Managing NEMO Engine<a class="headerlink" href="#administering-or-managing-nemo-engine" title="Permalink to this headline">¶</a></h3>
<p>TBD: Include related command reference or operations for using the NEMO
Engine.</p>
</div>
<div class="section" id="id47">
<h3>Tutorials<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h3>
<p>Below are tutorials for NEMO Engine.</p>
<div class="section" id="using-nemo-engine">
<h4>Using NEMO Engine<a class="headerlink" href="#using-nemo-engine" title="Permalink to this headline">¶</a></h4>
<p>TBD: State the purpose of tutorial</p>
<div class="section" id="id48">
<h5>Overview<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h5>
<p>TBD: An overview of the NEMO tutorial</p>
</div>
<div class="section" id="id49">
<h5>Prerequisites<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h5>
<p>TBD: Provide any prerequisite information, assumed knowledge, or
environment required to execute the use case.</p>
</div>
<div class="section" id="id50">
<h5>Target Environment<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h5>
<p>TBD: Include any topology requirement for the use case.</p>
</div>
<div class="section" id="id51">
<h5>Instructions<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h5>
<p>TBD: Step by step procedure for using NEMO Engine.</p>
</div>
</div>
</div>
</div>
<div class="section" id="netide-user-guide">
<h2>NetIDE User Guide<a class="headerlink" href="#netide-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id52">
<h3>Overview<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h3>
<p>OpenDaylight’s NetIDE project allows users to run SDN applications
written for different SDN controllers, e.g., Floodlight or Ryu, on top
of OpenDaylight managed infrastructure. The NetIDE Network Engine
integrates a client controller layer that executes the modules that
compose a Network Application and interfaces with a server SDN
controller layer that drives the underlying infrastructure. In addition,
it provides a uniform interface to common tools that are intended to
allow the inspection/debug of the control channel and the management of
the network resources.</p>
<p>The Network Engine provides a compatibility layer capable of translating
calls of the network applications running on top of the client
controllers, into calls for the server controller framework. The
communication between the client and the server layers is achieved
through the NetIDE intermediate protocol, which is an application-layer
protocol on top of TCP that transmits the network control/management
messages from the client to the server controller and vice-versa.
Between client and server controller sits the Core Layer which also
speaks the intermediate protocol.</p>
</div>
<div class="section" id="netide-api">
<h3>NetIDE API<a class="headerlink" href="#netide-api" title="Permalink to this headline">¶</a></h3>
<div class="section" id="architecture-and-design">
<h4>Architecture and Design<a class="headerlink" href="#architecture-and-design" title="Permalink to this headline">¶</a></h4>
<p>The NetIDE engine follows the ONF’s proposed Client/Server SDN
Application architecture.</p>
<div class="figure" id="id220">
<img alt="NetIDE Network Engine Architecture" src="../_images/netidearch.jpg" />
<p class="caption"><span class="caption-text">NetIDE Network Engine Architecture</span></p>
</div>
</div>
<div class="section" id="core">
<h4>Core<a class="headerlink" href="#core" title="Permalink to this headline">¶</a></h4>
<p>The NetIDE Core is a message-based system that allows for the exchange
of messages between OpenDaylight and subscribed Client SDN Controllers</p>
</div>
<div class="section" id="handling-reply-messages-correctly">
<h4>Handling reply messages correctly<a class="headerlink" href="#handling-reply-messages-correctly" title="Permalink to this headline">¶</a></h4>
<p>When an application module sends a request to the network (e.g. flow
statistics, features, etc.), the Network Engine must be able to
correctly drive the corresponding reply to such a module. This is not a
trivial task, as many modules may compose the network application
running on top of the Network Engine, and there is no way for the Core
to pair replies and requests. The transaction IDs (xid) in the OpenFlow
header are unusable in this case, as it may happen that different
modules use the same values.</p>
<p>In the proposed approach, represented in the figure below, the task of
pairing replies with requests is performed by the Shim Layer which
replaces the original xid of the OpenFlow requests coming from the core
with new unique xid values. The Shim also saves the original OpenFlow
xid value and the module id it finds in the NetIDE header. As the
network elements must use the same xid values in the replies, the Shim
layer can easily pair a reply with the correct request as it is using
unique xid values.</p>
<p>The below figure shows how the Network Engine should handle the
controller-to-switch OpenFlow messages. The diagram shows the case of a
request message sent by an application module to a network element where
the Backend inserts the module id of the module in the NetIDE header (X
in the Figure). For other messages generated by the client controller
platform (e.g. echo requests) or by the Backend, the module id of the
Backend is used (Y in the Figure).</p>
<div class="figure" id="id221">
<img alt="NetIDE Communication Flow" src="../_images/netide-flow.jpg" />
<p class="caption"><span class="caption-text">NetIDE Communication Flow</span></p>
</div>
</div>
<div class="section" id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h4>
<p>Below are the configuration items which can be edited, including their
default values.</p>
<ul class="simple">
<li>core-address: This is the ip address of the NetIDE Core, default is
127.0.0.1</li>
<li>core-port: The port of on which the NetIDE core is listening on</li>
<li>address: IP address where the controller listens for switch
connections, default is 127.0.0.1</li>
<li>port: Port where controller listens for switch connections, default:
6644</li>
<li>transport-protocol: default is TCP</li>
<li>switch-idle-timeout: default is 15000ms</li>
</ul>
</div>
</div>
</div>
<div class="section" id="network-intent-composition-nic-user-guide">
<h2>Network Intent Composition (NIC) User Guide<a class="headerlink" href="#network-intent-composition-nic-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id53">
<h3>Overview<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h3>
<p>Network Intent Composition (NIC) is an interface that allows clients to
express a desired state in an implementation-neutral form that will be
enforced via modification of available resources under the control of
the OpenDaylight system.</p>
<p>This description is purposely abstract as an intent interface might
encompass network services, virtual devices, storage, etc.</p>
<p>The intent interface is meant to be a controller-agnostic interface so
that &#8220;intents&#8221; are portable across implementations, such as OpenDaylight
and ONOS. Thus an intent specification should not contain implementation
or technology specifics.</p>
<p>The intent specification will be implemented by decomposing the intent
and augmenting it with implementation specifics that are driven by local
implementation rules, policies, and/or settings.</p>
</div>
<div class="section" id="network-intent-composition-nic-architecture">
<h3>Network Intent Composition (NIC) Architecture<a class="headerlink" href="#network-intent-composition-nic-architecture" title="Permalink to this headline">¶</a></h3>
<p>The core of the NIC architecture is the intent model, which specifies
the details of the desired state. It is the responsibility of the NIC
implementation transforms this desired state to the resources under the
control of OpenDaylight. The component that transforms the intent to the
implementation is typically referred to as a renderer.</p>
<p>For the Lithium release, multiple, simultaneous renderers will not be
supported. Instead either the VTN or GBP renderer feature can be
installed, but not both.</p>
<p>For the Litium release, the only actions supported are &#8220;ALLOW&#8221; and
&#8220;BLOCK&#8221;. The &#8220;ALLOW&#8221; action indicates that traffic can flow between the
source and destination end points, while &#8220;BLOCK&#8221; prevents that flow;
although it is possible that an given implementation may augment the
available actions with additional actions.</p>
<p>Besides transforming a desired state to an actual state it is the
responsibility of a renderer to update the operational state tree for
the NIC data model in OpenDaylight to reflect the intent which the
renderer implemented.</p>
</div>
<div class="section" id="configuring-network-intent-composition-nic">
<h3>Configuring Network Intent Composition (NIC)<a class="headerlink" href="#configuring-network-intent-composition-nic" title="Permalink to this headline">¶</a></h3>
<p>For the Litium release there is no default implementation of a renderer,
thus without an additional module installed the NIC will not function.</p>
</div>
<div class="section" id="administering-or-managing-network-intent-composition-nic">
<h3>Administering or Managing Network Intent Composition (NIC)<a class="headerlink" href="#administering-or-managing-network-intent-composition-nic" title="Permalink to this headline">¶</a></h3>
<p>There is no additional administration of management capabilities related
to the Network Intent Composition features.</p>
</div>
<div class="section" id="interactions">
<h3>Interactions<a class="headerlink" href="#interactions" title="Permalink to this headline">¶</a></h3>
<p>A user can interact with the Network Intent Composition (NIC) either
through the RESTful interface using standard RESTCONF operations and
syntax or via the Karaf console CLI.</p>
<div class="section" id="rest">
<h4>REST<a class="headerlink" href="#rest" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id54">
<h5>Configuration<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h5>
<p>The Network Intent Composition (NIC) feature supports the following REST
operations against the configuration data store.</p>
<ul class="simple">
<li>POST - creates a new instance of an intent in the configuration
store, which will trigger the realization of that intent. An ID
<em>must</em> be specified as part of this request as an attribute of the
intent.</li>
<li>PUT - creates or updates an instance of an intent in the
configuration store, which will trigger the realization of that
intent.</li>
<li>GET - fetches a list of all configured intents or a specific
configured intent.</li>
<li>DETELE - removes a configured intent from the configuration store,
which triggers the removal of the intent from the network.</li>
</ul>
</div>
<div class="section" id="operational">
<h5>Operational<a class="headerlink" href="#operational" title="Permalink to this headline">¶</a></h5>
<p>The Network Intent Composition (NIC) feature supports the following REST
operations against the operational data store.</p>
<ul class="simple">
<li>GET - fetches a list of all operational intents or a specific
operational intent.</li>
</ul>
</div>
</div>
<div class="section" id="karaf-console-cli">
<h4>Karaf Console CLI<a class="headerlink" href="#karaf-console-cli" title="Permalink to this headline">¶</a></h4>
<p>Using the Karaf console CLI intents can be manipulated. The following
Karaf console CLI commands are available.</p>
<ul class="simple">
<li>intent:add &lt;intent-data&gt; - creates a new intent</li>
<li>intent:update &lt;id&gt; &lt;intent-data&gt; - updates an existing intent</li>
<li>intent:list - lists all intents in the system</li>
<li>intent:show &lt;id&gt; - display the details of a specific intent</li>
<li>intent:delete &lt;id&gt; - removes an intent from the system</li>
</ul>
</div>
</div>
<div class="section" id="nic-usage-examples">
<h3>NIC Usage Examples<a class="headerlink" href="#nic-usage-examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="how-to-configure-vtn-renderer">
<h4>How to configure VTN Renderer<a class="headerlink" href="#how-to-configure-vtn-renderer" title="Permalink to this headline">¶</a></h4>
<p>The NIC Model provides an abstract model for expressing the desired
state and operation of the network.</p>
<div class="section" id="requirement">
<h5>Requirement<a class="headerlink" href="#requirement" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Configure mininet and create a topology:</li>
</ul>
<p>Replace &lt;Controller IP&gt; based on your environment</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$  mininet@mininet-vm:~$ sudo mn --controller=remote,ip=&lt;Controller IP&gt; --topo tree,2
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">net</span>
<span class="n">h1</span> <span class="n">h1</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">h2</span> <span class="n">h2</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth2</span>
<span class="n">h3</span> <span class="n">h3</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s3</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">h4</span> <span class="n">h4</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s3</span><span class="o">-</span><span class="n">eth2</span>
<span class="n">s1</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s1</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth3</span> <span class="n">s1</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">s3</span><span class="o">-</span><span class="n">eth3</span>
<span class="n">s2</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s2</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">h1</span><span class="o">-</span><span class="n">eth0</span> <span class="n">s2</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">h2</span><span class="o">-</span><span class="n">eth0</span> <span class="n">s2</span><span class="o">-</span><span class="n">eth3</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">s3</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s3</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">h3</span><span class="o">-</span><span class="n">eth0</span> <span class="n">s3</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">h4</span><span class="o">-</span><span class="n">eth0</span> <span class="n">s3</span><span class="o">-</span><span class="n">eth3</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth2</span>
<span class="n">c0</span>
</pre></div>
</div>
</div>
<div class="section" id="downloading-and-deploy-karaf-distribution">
<h5>Downloading and deploy Karaf distribution<a class="headerlink" href="#downloading-and-deploy-karaf-distribution" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Get the Lithium Distribution.</li>
<li>Unzip the downloaded zip distribution</li>
<li>To run the Karaf</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="nb">bin</span><span class="o">/</span><span class="n">karaf</span>
</pre></div>
</div>
<ul class="simple">
<li>Once the console is up, type as below to install feature.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">nic</span><span class="o">-</span><span class="n">renderer</span><span class="o">-</span><span class="n">vtn</span>
</pre></div>
</div>
</div>
<div class="section" id="id55">
<h5>Configuration<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h5>
<p>Please execute the following curl commands to test network intent using
mininet:</p>
<ul class="simple">
<li>Create Intent</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">intent</span><span class="p">:</span><span class="n">intents</span><span class="o">/</span><span class="n">intent</span><span class="o">/</span><span class="n">b9a13232</span><span class="o">-</span><span class="mi">525</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="n">d8c</span><span class="o">-</span><span class="n">be21</span><span class="o">-</span><span class="n">cd65e3436034</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{ &quot;intent:intent&quot; : { &quot;intent:id&quot;: &quot;b9a13232-525e-4d8c-be21-cd65e3436034&quot;, &quot;intent:actions&quot; : [ { &quot;order&quot; : 2, &quot;allow&quot; : </span><span class="si">{}</span><span class="s1"> } ], &quot;intent:subjects&quot; : [ { &quot;order&quot;:1 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;10.0.0.1&quot;} }, { &quot;order&quot;:2 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;10.0.0.2&quot;}} ] } }&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">intent</span><span class="p">:</span><span class="n">intents</span><span class="o">/</span><span class="n">intent</span><span class="o">/</span><span class="n">b9a13232</span><span class="o">-</span><span class="mi">525</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="n">d8c</span><span class="o">-</span><span class="n">be21</span><span class="o">-</span><span class="n">cd65e3436035</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{ &quot;intent:intent&quot; : { &quot;intent:id&quot;: &quot;b9a13232-525e-4d8c-be21-cd65e3436035&quot;, &quot;intent:actions&quot; : [ { &quot;order&quot; : 2, &quot;allow&quot; : </span><span class="si">{}</span><span class="s1"> } ], &quot;intent:subjects&quot; : [ { &quot;order&quot;:1 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;10.0.0.2&quot;} }, { &quot;order&quot;:2 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;10.0.0.3&quot;}} ] } }&#39;</span>
</pre></div>
</div>
<p><strong>Verification.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">pingall</span>
<span class="n">Ping</span><span class="p">:</span> <span class="n">testing</span> <span class="n">ping</span> <span class="n">reachability</span>
<span class="n">h1</span> <span class="o">-&gt;</span> <span class="n">h2</span> <span class="n">X</span> <span class="n">X</span>
<span class="n">h2</span> <span class="o">-&gt;</span> <span class="n">h1</span> <span class="n">h3</span> <span class="n">X</span>
<span class="n">h3</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">h2</span> <span class="n">X</span>
<span class="n">h4</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
</pre></div>
</div>
<ul class="simple">
<li>Update an Intent</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">intent</span><span class="p">:</span><span class="n">intents</span><span class="o">/</span><span class="n">intent</span><span class="o">/</span><span class="n">b9a13232</span><span class="o">-</span><span class="mi">525</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="n">d8c</span><span class="o">-</span><span class="n">be21</span><span class="o">-</span><span class="n">cd65e3436034</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{ &quot;intent:intent&quot; : { &quot;intent:id&quot;: &quot;b9a13232-525e-4d8c-be21-cd65e3436034&quot;, &quot;intent:actions&quot; : [ { &quot;order&quot; : 2, &quot;block&quot; : </span><span class="si">{}</span><span class="s1"> } ], &quot;intent:subjects&quot; : [ { &quot;order&quot;:1 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;10.0.0.1&quot;} }, { &quot;order&quot;:2 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;10.0.0.2&quot;}} ] } }&#39;</span>
</pre></div>
</div>
<p><strong>Verification.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">mininet</span><span class="o">&gt;</span> <span class="n">pingall</span>
 <span class="n">Ping</span><span class="p">:</span> <span class="n">testing</span> <span class="n">ping</span> <span class="n">reachability</span>
 <span class="n">h1</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
 <span class="n">h2</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">h3</span> <span class="n">X</span>
 <span class="n">h3</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">h2</span> <span class="n">X</span>
 <span class="n">h4</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">Old</span> <span class="n">actions</span> <span class="ow">and</span> <span class="n">hosts</span> <span class="n">are</span> <span class="n">replaced</span> <span class="n">by</span> <span class="n">the</span> <span class="n">new</span> <span class="n">action</span> <span class="ow">and</span> <span class="n">hosts</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li>Delete an Intent</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span>     <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">DELETE</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">intent</span><span class="p">:</span><span class="n">intents</span><span class="o">/</span><span class="n">intent</span><span class="o">/</span><span class="n">b9a13232</span><span class="o">-</span><span class="mi">525</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="n">d8c</span><span class="o">-</span><span class="n">be21</span><span class="o">-</span><span class="n">cd65e3436035</span>
</pre></div>
</div>
<p><strong>Verification.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">mininet</span><span class="o">&gt;</span> <span class="n">pingall</span>
 <span class="n">Ping</span><span class="p">:</span> <span class="n">testing</span> <span class="n">ping</span> <span class="n">reachability</span>
 <span class="n">h1</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
 <span class="n">h2</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
 <span class="n">h3</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
 <span class="n">h4</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">Ping</span> <span class="n">between</span> <span class="n">two</span> <span class="n">hosts</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">done</span> <span class="n">using</span> <span class="n">MAC</span> <span class="n">Address</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">intent</span><span class="p">:</span><span class="n">intents</span><span class="o">/</span><span class="n">intent</span><span class="o">/</span><span class="n">b9a13232</span><span class="o">-</span><span class="mi">525</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="n">d8c</span><span class="o">-</span><span class="n">be21</span><span class="o">-</span><span class="n">cd65e3436035</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{ &quot;intent:intent&quot; : { &quot;intent:id&quot;: &quot;b9a13232-525e-4d8c-be21-cd65e3436035&quot;, &quot;intent:actions&quot; : [ { &quot;order&quot; : 2, &quot;allow&quot; : </span><span class="si">{}</span><span class="s1"> } ], &quot;intent:subjects&quot; : [ { &quot;order&quot;:1 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;6e:4f:f7:27:15:c9&quot;} }, { &quot;order&quot;:2 , &quot;end-point-group&quot; : {&quot;name&quot;:&quot;aa:7d:1f:4a:70:81&quot;}} ] } }&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="odl-sdni-user-guide">
<h2>ODL-SDNi User Guide<a class="headerlink" href="#odl-sdni-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>This user guide will help to setup the ODL-SDNi application for lithium
release and contains the examples configuration using ODL-BGPCEP.</p>
</div>
<div class="section" id="components">
<h3>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h3>
<p>SDNiAggregator(controller), SDNi REST API(controller) and
SDNiWrapper(bgpcep) are the three components in ODL-SDNi App</p>
<ul class="simple">
<li>SDNiAggregator: Connects with switch, topology, hosttracker managers
of controller to get the topology and other related data.</li>
<li>SDNi REST API: It is a part of controller northbound, which gives the
required information by quering SDNiAggregator through RESTCONF.</li>
<li>SDNiWrapper: This component uses the SDNi REST API and gathers the
information required to be shared among controllers.</li>
</ul>
</div>
<div class="section" id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>To work with multiple controllers, change some of the configuration in
config.ini file. For example change the listening port of one controller
to 6653 and other controller to 6663 in
/root/controller/opendaylight/distribution/opendaylight/target/distribution.opendaylight-osgipackage/opendaylight/configuration/config.ini
(i.e of.listenPort=6653).</p>
<p><strong>OpenFlow related system parameters.</strong></p>
<p>TCP port on which the controller is listening (default 6633)
of.listenPort=6653</p>
</div>
</div>
<div class="section" id="openflow-plugin-project-user-guide">
<h2>OpenFlow Plugin Project User Guide<a class="headerlink" href="#openflow-plugin-project-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview-and-architecture">
<h3>Overview and Architecture<a class="headerlink" href="#overview-and-architecture" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id56">
<h4>Overview and Architecture<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id57">
<h5>Overview<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h5>
<p>OpenFlow is a vendor-neutral standard communications interface defined
to enable interaction between the control and forwarding layers of an
SDN architecture. The OpenFlow plugin project intends to develop a
plugin to support implementations of the OpenFlow specification as it
develops and evolves. Specifically the project has developed a plugin
aiming to support OpenFlow 1.0 and 1.3.x. It can be extended to add
support for subsequent OpenFlow specifications. The plugin is based on
the Model Driven Service Abstraction Layer (MD-SAL) architecture
(<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:MD-SAL">https://wiki.opendaylight.org/view/OpenDaylight_Controller:MD-SAL</a>).
This new OpenFlow 1.0/1.3 MD-SAL based plugin is distinct from the old
OpenFlow 1.0 plugin which was based on the API driven SAL (AD-SAL)
architecture.</p>
</div>
<div class="section" id="scope">
<h5>Scope<a class="headerlink" href="#scope" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Southbound plugin and integration of OpenFlow 1.0/1.3.x library
project</li>
<li>Ongoing support and integration of the OpenFlow specification</li>
<li>The plugin should be implemented in an easily extensibile manner</li>
<li>Protocol verification activities will be performed on supported
OpenFlow specifications</li>
</ul>
</div>
<div class="section" id="id58">
<h5>Architecture and Design<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h5>
<div class="section" id="functionality">
<h6>Functionality<a class="headerlink" href="#functionality" title="Permalink to this headline">¶</a></h6>
<p>OpenFlow 1.3 Plugin will support the following functionality</p>
<ul class="simple">
<li>Connection Handling</li>
<li>Session Management</li>
<li>State Management.</li>
<li>Error Handling.</li>
<li>Mapping function(Infrastructure to OF structures).</li>
<li>Connection establishment will be handled by OpenFlow library using
opensource netty.io library.</li>
<li>Message handling(Ex: Packet in).</li>
<li>Event handling and propagation to upper layers.</li>
<li>Plugin will support both MD-SAL and Hard SAL.</li>
<li>Will be backward compatible with OF 1.0.</li>
</ul>
<p><strong>Activities in OF plugin module</strong></p>
<ul class="simple">
<li>New OF plugin bundle will support both OF 1.0 and OF 1.3.</li>
<li>Integration with OpenFlow library.</li>
<li>Integration with corresponding MD-SAL infrastructure.</li>
<li>Hard SAL will be supported as adapter on top of MD-SAL plugin.</li>
<li>OF 1.3 and OF 1.0 plugin will be integrated as single bundle.</li>
</ul>
</div>
<div class="section" id="design">
<h6>Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h6>
<p><strong>Overall Architecture</strong></p>
<div class="figure" id="id222">
<img alt="overal architecture" src="../_images/plugin_design.jpg" />
<p class="caption"><span class="caption-text">overal architecture</span></p>
</div>
</div>
</div>
</div>
<div class="section" id="coverage">
<h4>Coverage<a class="headerlink" href="#coverage" title="Permalink to this headline">¶</a></h4>
<div class="section" id="intro">
<h5>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h5>
<p>This page is to catalog the things that have been tested and confirmed
to work:</p>
</div>
<div class="section" id="id59">
<h5>Coverage<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h5>
<p>Coverage has been moved to a <a class="reference external" href="https://docs.google.com/spreadsheet/ccc?key=0AtpUuSEP8OyMdHNTZjBoM0VjOE9BcGhHMzk3N19uamc&amp;usp=sharing%23gid=2#gid=0">GoogleDoc
Spreadshee</a></p>
</div>
<div class="section" id="of-1-3-considerations">
<h5>OF 1.3 Considerations<a class="headerlink" href="#of-1-3-considerations" title="Permalink to this headline">¶</a></h5>
<p>The baseline model is a OF 1.3 model, and the coverage tables primarily
deal with OF 1.3. However for OF 1.0, we have a column to indicate
either N/A if it doesn’t apply, or whether its been confirmed working.</p>
</div>
<div class="section" id="of-1-0-considerations">
<h5>OF 1.0 Considerations<a class="headerlink" href="#of-1-0-considerations" title="Permalink to this headline">¶</a></h5>
<p>OF 1.0 is being considered as a switch with: * 1 Table * 0 Groups * 0
Meters * 1 Instruction (Apply Actions) * and a limited vocabulary of
matches and actions.</p>
</div>
</div>
</div>
<div class="section" id="tutorial-how-to">
<h3>Tutorial / How-To<a class="headerlink" href="#tutorial-how-to" title="Permalink to this headline">¶</a></h3>
<div class="section" id="running-the-controller-with-the-new-openflow-plugin">
<h4>Running the controller with the new OpenFlow Plugin<a class="headerlink" href="#running-the-controller-with-the-new-openflow-plugin" title="Permalink to this headline">¶</a></h4>
<div class="section" id="opendaylight-controller-plugin-options">
<h5>Opendaylight Controller Plugin Options<a class="headerlink" href="#opendaylight-controller-plugin-options" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Run OpenDaylight controller with the new OpenFlow 1.0/1.3 plugin</li>
</ul>
<p>There are 2 ways. In integration project the plugin version is
controlled by startup parameter. Or there is distribution build
available directly in openflowplugin project.</p>
<ol class="arabic">
<li><p class="first">use <strong>integration</strong> project</p>
<ul>
<li><p class="first">download and unzip latest build from
<a class="reference external" href="https://nexus.opendaylight.org/content/repositories/opendaylight.snapshot/org/opendaylight/integration/distribution-karaf/0.2.2-SNAPSHOT/">https://nexus.opendaylight.org/content/repositories/opendaylight.snapshot/org/opendaylight/integration/distribution-karaf/0.2.2-SNAPSHOT/</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">extracted</span> <span class="n">directory</span><span class="o">&gt;/</span><span class="nb">bin</span>
<span class="o">./</span><span class="n">karaf</span>
</pre></div>
</div>
</li>
<li><p class="first">or clone and build <strong>integration</strong> project:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gerrit</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="n">integration</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">integration</span><span class="o">/</span><span class="n">distributions</span><span class="o">/</span><span class="n">extra</span><span class="o">/</span><span class="n">karaf</span>
<span class="n">mvn</span> <span class="n">clean</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">target</span><span class="o">/</span><span class="n">assembly</span><span class="o">/</span><span class="nb">bin</span>
</pre></div>
</div>
</li>
<li><p class="first">and finally run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">karaf</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">use <strong>openflowplugin</strong> project</p>
<ul>
<li><p class="first">download and unzip latest build from
<a class="reference external" href="https://nexus.opendaylight.org/content/repositories/opendaylight.snapshot/org/opendaylight/openflowplugin/openflowplugin-karaf/0.1.0-SNAPSHOT/">https://nexus.opendaylight.org/content/repositories/opendaylight.snapshot/org/opendaylight/openflowplugin/openflowplugin-karaf/0.1.0-SNAPSHOT/</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">extracted</span> <span class="n">directory</span><span class="o">&gt;/</span><span class="nb">bin</span>
<span class="o">./</span><span class="n">karaf</span>
</pre></div>
</div>
</li>
<li><p class="first">or clone and build <strong>openflowplugin</strong> project:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gerrit</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="n">openflowplugin</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">openflowplugin</span>
<span class="n">mvn</span> <span class="n">clean</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">distribution</span><span class="o">/</span><span class="n">karaf</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">assembly</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p class="first">or build whole distribution localy from folder distribution/karaf</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mvn</span> <span class="n">clean</span> <span class="n">install</span> <span class="o">-</span><span class="n">DskipTests</span>
</pre></div>
</div>
</li>
<li><p class="first">and run</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">karaf</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<p><strong>How to start</strong></p>
<p>There are all helium features (from features-openflowplugin) duplicated
into features-openflowplugin-li. The duplicates got suffix <em>-li</em> and
provide Lithium codebase functionality.</p>
<p>These are most used:</p>
<ul class="simple">
<li>odl-openflowplugin-app-lldp-speaker-li</li>
<li>odl-openflowplugin-flow-services-rest-li</li>
<li>odl-openflowplugin-drop-test-li</li>
</ul>
<p>In case topology is required then the first one should be installed.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">lldp</span><span class="o">-</span><span class="n">speaker</span><span class="o">-</span><span class="n">li</span>
</pre></div>
</div>
<p>The Li-southbound currently provides:</p>
<ul class="simple">
<li>flow management</li>
<li>group management</li>
<li>meter management</li>
<li>statistics polling</li>
</ul>
<p><strong>What to log</strong></p>
<p>In order to see really low level messages enter these in karaf console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">log</span><span class="p">:</span><span class="nb">set</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">openflowplugin</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">md</span><span class="o">.</span><span class="n">core</span>
<span class="n">log</span><span class="p">:</span><span class="nb">set</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">openflowplugin</span><span class="o">.</span><span class="n">impl</span>
</pre></div>
</div>
<p><strong>How enable topology</strong></p>
<p>In order for topology to work (fill dataStore/operational with links)
there must be LLDP responses delivered back to controller. This requires
table-miss-entries. Table-miss-entry is a flow in table.id=0 with low
priority, empty match and one output action = send to controller. Having
this flow installed on every node will enable for gathering and
exporting links between nodes into dataStore/operational. This is done
if you use for example l2 switch application.</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
   &lt;barrier&gt;false&lt;/barrier&gt;
   &lt;cookie&gt;54&lt;/cookie&gt;
   &lt;flags&gt;SEND_FLOW_REM&lt;/flags&gt;
   &lt;flow-name&gt;FooXf54&lt;/flow-name&gt;
   &lt;hard-timeout&gt;0&lt;/hard-timeout&gt;
   &lt;id&gt;4242&lt;/id&gt;
   &lt;idle-timeout&gt;0&lt;/idle-timeout&gt;
   &lt;installHw&gt;false&lt;/installHw&gt;
   &lt;instructions&gt;
       &lt;instruction&gt;
           &lt;apply-actions&gt;
               &lt;action&gt;
                   &lt;output-action&gt;
                       &lt;max-length&gt;65535&lt;/max-length&gt;
                       &lt;output-node-connector&gt;CONTROLLER&lt;/output-node-connector&gt;
                   &lt;/output-action&gt;
                   &lt;order&gt;0&lt;/order&gt;
               &lt;/action&gt;
           &lt;/apply-actions&gt;
           &lt;order&gt;0&lt;/order&gt;
       &lt;/instruction&gt;
   &lt;/instructions&gt;
   &lt;match/&gt;
   &lt;priority&gt;0&lt;/priority&gt;
   &lt;strict&gt;false&lt;/strict&gt;
   &lt;table_id&gt;0&lt;/table_id&gt;
&lt;/flow&gt;
</pre></div>
</div>
<p><strong>Enable RESTCONF and Controller GUI</strong></p>
<p>If you want to use RESTCONF with openflowplugin project, you have to
install <em>odl-restconf</em> feature to enable that. To install <em>odl-restconf</em>
feature run the following command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">karaf</span><span class="c1">#&gt;feature:install odl-restconf</span>
</pre></div>
</div>
<p>If you want to access the Controller GUI, you have to install
<em>odl-dlux-core</em> feature to enable that. Run following command to install
it</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">karaf</span><span class="c1">#&gt;feature:install odl-dlux-core</span>
</pre></div>
</div>
<p>Once you enable the feature, access the Controller GUI using following
URL</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">dlux</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
<p><strong>Run OpenDaylight controller with the old OpenFlow 1.0-only (old)
plugin</strong></p>
<p>There are 2 ways. In integration project the plugin version is
controlled by startup parameter. Or there is distribution build
available directly in controller project.</p>
<ol class="arabic">
<li><p class="first">use <strong>integration/distributions/base</strong> project</p>
<ul>
<li><p class="first">use the instructions from
OpenDaylight_OpenFlow_Plugin::Running_controller_with_the_new_OF_plugin#To_run_the_OpenDaylight_controller_with_the_new_OpenFlow_1.0/1.3_(new)_plugin[
1.0/1.3 plugin], but skip the plugin version parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">use <strong>controller/distribution/opendaylight</strong> project</p>
<ul>
<li><p class="first">download and unzip latest build from
<a class="reference external" href="https://nexus.opendaylight.org/content/repositories/opendaylight.snapshot/org/opendaylight/controller/distribution.opendaylight/">https://nexus.opendaylight.org/content/repositories/opendaylight.snapshot/org/opendaylight/controller/distribution.opendaylight/</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">opendaylight</span>
</pre></div>
</div>
</li>
<li><p class="first">or clone and build <strong>controller</strong> project:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">gerrit</span><span class="o">/</span><span class="n">p</span><span class="o">/</span><span class="n">controller</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">controller</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="n">mvn</span> <span class="n">clean</span> <span class="n">install</span>
<span class="n">cd</span> <span class="n">target</span><span class="o">/</span><span class="n">distribution</span><span class="o">.</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
</pre></div>
</div>
</li>
<li><p class="first">and finally run (there is no version specific option, because the</p>
<p>1.0/1.3 (new) plugin is not available here at all)</p>
</li>
</ul>
</li>
</ol>
<p><strong>Give it a minute to come up :)</strong></p>
</div>
</div>
<div class="section" id="openflow-1-3-enabled-software-switches-environment">
<h4>OpenFlow 1.3 Enabled Software Switches / Environment<a class="headerlink" href="#openflow-1-3-enabled-software-switches-environment" title="Permalink to this headline">¶</a></h4>
<div class="section" id="getting-mininet-with-of-1-3">
<h5>Getting Mininet with OF 1.3<a class="headerlink" href="#getting-mininet-with-of-1-3" title="Permalink to this headline">¶</a></h5>
<p><a class="reference external" href="https://www.dropbox.com/s/dbf9a372elqs1s1/mininet-of-1.3.zip">Download Mininet VM Upgraded to OF
1.3</a>
(or the <a class="reference external" href="https://www.dropbox.com/s/t66vqfqx57a7nhk/mininet-2.1.0-of1.3.zip">newer mininet-2.1.0 with
OVS-2.0</a>
that works with VMware Player. For using this on VirtualBox, import this
to VMware Player and then export the .vmdk ) or you could build one
yourself Openflow Protocol Library:OpenVirtualSwitch[Instructions for
setting up Mininet with OF 1.3].</p>
<div class="section" id="installing-under-virtualbox">
<h6>Installing under VirtualBox<a class="headerlink" href="#installing-under-virtualbox" title="Permalink to this headline">¶</a></h6>
<div class="figure" id="id223">
<img alt="configuring a host-only adapter" src="../_images/host-only-vbox.png" />
<p class="caption"><span class="caption-text">configuring a host-only adapter</span></p>
</div>
<p>For whatever reason, at least on the Mac, NATed interfaces in VirtualBox
don’t actually seem to allow for connections from the host to the VM.
Instead, you need to configure a host-only network and set it up. Do
this by:</p>
<ul class="simple">
<li>Go to the VM’s settings in VirtualBox then to network and add a
second adapter attached to &#8220;Host-only Adapter&#8221; (see the screenshot to
the right)</li>
<li>Edit the /etc/network/interfaces file to configure the adapter
properly by adding these two lines</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">eth1</span>
<span class="n">iface</span> <span class="n">eth1</span> <span class="n">inet</span> <span class="n">dhcp</span>
</pre></div>
</div>
<ul class="simple">
<li>Reboot the VM</li>
</ul>
<p>At this point you should have two interfaces one which gives you NATed
access to the internet and another that gives you access between your
mac and the VMs. At least for me, the NATed interface gets a 10.0.2.x
address and the the host-only interface gets a 192.168.56.x address.</p>
</div>
<div class="section" id="your-simplest-choice-use-vagrant">
<h6>Your simplest choice: Use Vagrant<a class="headerlink" href="#your-simplest-choice-use-vagrant" title="Permalink to this headline">¶</a></h6>
<p><a class="reference external" href="https://www.virtualbox.org/">Download Virtual Box</a> and install it
<a class="reference external" href="http://www.vagrantup.com/">Download Vagrant</a> and install it</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">mininet</span><span class="o">-</span><span class="mf">2.1</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="mf">1.3</span><span class="o">/</span>
<span class="n">vagrant</span> <span class="n">up</span>
<span class="n">vagrant</span> <span class="n">ssh</span>
</pre></div>
</div>
<p>This will leave you sshed into a fully provisioned Ubuntu Trusty box
with mininet-2.1.0 and OVS 2.0 patches to work with OF 1.3.</p>
</div>
</div>
<div class="section" id="setup-cpqd-openflow-1-3-soft-switch">
<h5>Setup CPqD Openflow 1.3 Soft Switch<a class="headerlink" href="#setup-cpqd-openflow-1-3-soft-switch" title="Permalink to this headline">¶</a></h5>
<p>Latest version of Openvswitch (v2.0.0) doesn’t support all the openflow
1.3 features, e.g group multipart statistics request. Alternate options
is CPqD Openflow 1.3 soft switch, It supports most of the openflow 1.3
features.</p>
<ul class="simple">
<li>You can setup the switch as per the instructions given on the
following URL</li>
</ul>
<p><code class="docutils literal"><span class="pre">`https://github.com/CPqD/ofsoftswitch13</span></code> &lt;<a class="reference external" href="https://github.com/CPqD/ofsoftswitch13">https://github.com/CPqD/ofsoftswitch13</a>&gt;`__</p>
<ul class="simple">
<li>Fire following command to start the switch</li>
</ul>
<p>Start the datapath :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo udatapath/ofdatapath --datapath-id=&lt;dpid&gt; --interfaces=&lt;if-list&gt; ptcp:&lt;port&gt;
 e.g $ sudo udatapath/ofdatapath --datapath-id=000000000001 --interfaces=ethX ptcp:6680
</pre></div>
</div>
<p>ethX should not be associated with ip address and ipv6 should be
disabled on it. If you are installing the switch on your local machine,
you can use following command (for Ubuntu) to create virtual interface.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="n">link</span> <span class="n">add</span> <span class="n">link</span> <span class="n">ethX</span> <span class="n">address</span> <span class="mi">00</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="n">d1</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="n">d2</span><span class="p">:</span><span class="mi">58</span> <span class="n">macvlan0</span> <span class="nb">type</span> <span class="n">macvlan</span>
</pre></div>
</div>
<p>ethX - Any existing interface.</p>
<p>Or if you are using mininet VM for installing this switch, you can
simply add one more adaptor to your VM.</p>
<p>Start Openflow protocol agent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$secchan/ofprotocol tcp:&lt;switch-host&gt;:&lt;switch-port&gt; tcp:&lt;ctrl-host&gt;:&lt;ctrl-port&gt;
 e.g $secchan/ofprotocol tcp:127.0.0.1:6680 tcp:127.0.0.1:6653
</pre></div>
</div>
<div class="section" id="commands-to-add-entries-to-various-tables-of-the-switch">
<h6>Commands to add entries to various tables of the switch<a class="headerlink" href="#commands-to-add-entries-to-various-tables-of-the-switch" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Add meter</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>$utilities/dpctl tcp:&lt;switch-host&gt;:&lt;switch-port&gt; meter-mod cmd=add,meter=1 drop:rate=50
</pre></div>
</div>
<ul class="simple">
<li>Add Groups</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>$utilities/dpctl tcp:127.0.0.1:6680 group-mod cmd=add,type=all,group=1
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>$utilities/dpctl tcp:127.0.0.1:6680 group-mod cmd=add,type=sel,group=2 weight=10 output:1
</pre></div>
</div>
<ul class="simple">
<li>Create queue</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>$utilities/dpctl tcp:&lt;ip&gt;:&lt;switch port&gt; queue-mod &lt;port-number&gt; &lt;queue-number&gt; &lt;minimum-bandwidth&gt;
  e.g - $utilities/dpctl tcp:127.0.0.1:6680 queue-mod 1 1 23
</pre></div>
</div>
<p>&#8220;dpctl&#8221; &#8211;help is not very intuitive, so please keep adding any new
command you figured out while your experiment with the switch.</p>
</div>
<div class="section" id="using-the-built-in-wireshark">
<h6>Using the built-in Wireshark<a class="headerlink" href="#using-the-built-in-wireshark" title="Permalink to this headline">¶</a></h6>
<p>Mininet comes with pre-installed Wireshark, but for some reason it does
not include the Openflow protocol dissector. You may want to get and
install it in the <em>/.wireshark/plugins/</em> directory.</p>
<p>First login to your mininet VM</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">mininet</span><span class="o">@&lt;</span><span class="n">your</span> <span class="n">mininet</span> <span class="n">vm</span> <span class="n">ip</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">X</span>
</pre></div>
</div>
<p>The -X option in ssh will enable x-session over ssh so that the
wireshark window can be shown on your host machine’s display. when
prompted, enter the password (mininet).</p>
<p>From the mininet vm shell, set the wireshark capture privileges
(<a class="reference external" href="http://wiki.wireshark.org/CaptureSetup/CapturePrivileges">http://wiki.wireshark.org/CaptureSetup/CapturePrivileges</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chgrp</span> <span class="n">mininet</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="mi">754</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">dumpcap</span>
<span class="n">sudo</span> <span class="n">setcap</span> <span class="s1">&#39;CAP_NET_RAW+eip CAP_NET_ADMIN+eip&#39;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">dumpcap</span>
</pre></div>
</div>
<p>Finally, start wireshark:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">wireshark</span>
</pre></div>
</div>
<p>The wireshark window should show up.</p>
<p>To see only Openflow packets, you may want to apply the following filter
in the Filter window:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tcp</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="mi">6633</span> <span class="ow">and</span> <span class="n">tcp</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">push</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Start the capture on <em>any</em> port.</p>
</div>
</div>
<div class="section" id="running-mininet-with-of-1-3">
<h5>Running Mininet with OF 1.3<a class="headerlink" href="#running-mininet-with-of-1-3" title="Permalink to this headline">¶</a></h5>
<p>From within the Mininet VM, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mn</span> <span class="o">--</span><span class="n">topo</span> <span class="n">single</span><span class="p">,</span><span class="mi">3</span>  <span class="o">--</span><span class="n">controller</span> <span class="s1">&#39;remote,ip=&lt;your controller ip&gt;,port=6653&#39;</span> <span class="o">--</span><span class="n">switch</span> <span class="n">ovsk</span><span class="p">,</span><span class="n">protocols</span><span class="o">=</span><span class="n">OpenFlow13</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="end-to-end-inventory">
<h4>End to End Inventory<a class="headerlink" href="#end-to-end-inventory" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id60">
<h5>Introduction<a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h5>
<p>The purpose of this page is to walk you through how to see the Inventory
Manager working end to end with the openflowplugin using OpenFlow 1.3.</p>
<p>Basically, you will learn how to:</p>
<ol class="arabic simple">
<li>Run the Base/Virtualization/Service provider Edition with the new
openflowplugin:
OpenDaylight_OpenFlow_Plugin::Running_controller_with_the_new_OF_plugin[Running
the controller with the new OpenFlow Plugin]</li>
<li>Start mininet to use OF 1.3:
OpenDaylight_OpenFlow_Plugin::Test_Environment[OpenFlow 1.3
Enabled Software Switches / Environment]</li>
<li>Use RESTCONF to see the nodes appear in inventory.</li>
</ol>
</div>
<div class="section" id="restconf-for-inventory">
<h5>Restconf for Inventory<a class="headerlink" href="#restconf-for-inventory" title="Permalink to this headline">¶</a></h5>
<p>The REST url for listing all the nodes is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span>
</pre></div>
</div>
<p>You will need to set the Accept header:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">xml</span>
</pre></div>
</div>
<p>You will also need to use HTTP Basic Auth with username: admin password:
admin.</p>
<p>Alternately, if you have a node’s id you can address it as</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/&lt;</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>for example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<div class="section" id="how-to-hit-restconf-with-postman">
<h6>How to hit RestConf with Postman<a class="headerlink" href="#how-to-hit-restconf-with-postman" title="Permalink to this headline">¶</a></h6>
<p><a class="reference external" href="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en">Install Postman for
Chrome</a></p>
<p>In the chrome browser bar enter</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chrome</span><span class="p">:</span><span class="o">//</span><span class="n">apps</span><span class="o">/</span>
</pre></div>
</div>
<p>And click on Postman.</p>
<p>Enter the URL. Click on the Headers button on the far right. Enter the
Accept: header. Click on the Basic Auth Tab at the top and setup the
username and password. Send.</p>
</div>
</div>
<div class="section" id="known-bug">
<h5>Known Bug<a class="headerlink" href="#known-bug" title="Permalink to this headline">¶</a></h5>
<p>If you have not had any switches come up, and though no children for
<a class="reference external" href="http://localhost:8080/restconf/datastore/opendaylight-inventory:nodes/">http://localhost:8080/restconf/datastore/opendaylight-inventory:nodes/</a>
and exception will be thrown. I’m pretty sure I know how to fix this
bug, just need to get to it :)</p>
</div>
</div>
<div class="section" id="end-to-end-flows">
<h4>End to End Flows<a class="headerlink" href="#end-to-end-flows" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id61">
<h5>Instructions<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h5>
<div class="section" id="learn-end-to-end-for-inventory">
<h6>Learn End to End for Inventory<a class="headerlink" href="#learn-end-to-end-for-inventory" title="Permalink to this headline">¶</a></h6>
<p><a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to End
Inventory</a></p>
</div>
<div class="section" id="check-inventory">
<h6>Check inventory<a class="headerlink" href="#check-inventory" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Run mininet with support for OF 1.3 as described in <a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to End
Inventory</a></li>
<li>Make sure you see the openflow:1 node come up as described in <a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to
End
Inventory</a></li>
</ul>
</div>
<div class="section" id="flow-strategy">
<h6>Flow Strategy<a class="headerlink" href="#flow-strategy" title="Permalink to this headline">¶</a></h6>
<p>Current way to flush a flow to switch looks like this:</p>
<ol class="arabic simple">
<li>Create MD-SAL modeled flow and commit it into dataStore using two
phase commit <a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:MD-SAL:FAQ">MD-SAL
FAQ</a></li>
<li>FRM gets notified and invokes corresponding rpc (addFlow) on
particular service provider (if suitable provider for given node
registered)</li>
<li>The provider (plugin in this case) transforms MD-SAL modeled flow
into OF-API modeled flow</li>
<li>OF-API modeled flow is then flushed into OFLibrary</li>
<li>OFLibrary encodes flow into particular version of wire protocol and
sends it to particular switch</li>
<li>Check on mininet side if flow is set</li>
</ol>
</div>
<div class="section" id="push-your-flow">
<h6>Push your flow<a class="headerlink" href="#push-your-flow" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>With PostMan:<ul>
<li>Set headers:<ul>
<li>Content-Type: application/xml</li>
<li>Accept: application/xml</li>
<li>Authentication</li>
</ul>
</li>
<li>Use URL: &#8220;<a class="reference external" href="http:/">http:/</a>/&lt;controller
IP&gt;:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/0/flow/1&#8221;</li>
<li>PUT</li>
<li>Use Body:</li>
</ul>
</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;flow-name&gt;Foo&lt;/flow-name&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-destination&gt;10.0.10.2/24&lt;/ipv4-destination&gt;
    &lt;/match&gt;
    &lt;id&gt;1&lt;/id&gt;
    &lt;table_id&gt;0&lt;/table_id&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                   &lt;order&gt;0&lt;/order&gt;
                   &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
&lt;/flow&gt;
</pre></div>
</div>
<p><strong>*Note</strong>: If you want to try a different flow id or a different table,
make sure the URL and the body stay in sync. For example, if you wanted
to try: table 2 flow 20 you’d change the URL to:</p>
<p>&#8220;<a class="reference external" href="http:/">http:/</a>/&lt;controller
IP&gt;:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/flow/20&#8221;</p>
<p>but you would also need to update the 20 and 2 in the body of the XML.</p>
<p>Other caveat, we have a known bug with updates, so please only write to
a given flow id and table id on a given node once at this time until we
resolve it. Or you can use the DELETE method with the same URL in
PostMan to delete the flow information on switch and controller cache.</p>
</div>
<div class="section" id="check-for-your-flow-on-the-switch">
<h6>Check for your flow on the switch<a class="headerlink" href="#check-for-your-flow-on-the-switch" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>See your flow on your mininet:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>mininet@mininet-vm:~$ sudo ovs-ofctl -O OpenFlow13 dump-flows s1
OFPST_FLOW reply (OF1.3) (xid=0x2):
cookie=0x0, duration=7.325s, table=0, n_packets=0, n_bytes=0, idle_timeout=300, hard_timeout=600, send_flow_rem priority=2,ip,nw_dst=10.0.10.0/24 actions=dec_ttl
</pre></div>
</div>
<p>If you want to see the above information from the mininet prompt - use
&#8220;sh&#8221; instead of &#8220;sudo&#8221; i.e. use &#8220;sh ovs-ofctl -O OpenFlow13 dump-flows
s1&#8221;.</p>
</div>
<div class="section" id="check-for-your-flow-in-the-controller-config-via-restconf">
<h6>Check for your flow in the controller config via RESTCONF<a class="headerlink" href="#check-for-your-flow-in-the-controller-config-via-restconf" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>See your configured flow in POSTMAN with<ul>
<li>URL <a href="#id260"><span class="problematic" id="id263">`http://&lt;controller &lt;http://&lt;controller&gt;`__</span></a>
IP&gt;:8181/restconf/operational/opendaylight-inventory:nodes/node/openflow:1/table/0/</li>
<li>GET</li>
<li>You no longer need to set Accept header</li>
</ul>
</li>
</ul>
<p>Return Response:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;flow-node-inventory:table&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;flow-node-inventory:flow&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;10b1a23c-5299-4f7b-83d6-563bab472754&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:1&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;020bf359-1299-4da6-b4f7-368bd83b5841&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:1&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;42172bfc-9142-4a92-9e90-ee62529b1e85&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:1&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.3&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;99bf566e-89f3-4c6f-ae9e-e26012ceb1e4&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:1&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.4&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;019dcc2e-5b4f-44f0-90cc-de490294b862&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:2&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.5&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;968cf81e-3f16-42f1-8b16-d01ff719c63c&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:2&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.8&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;1c14ea3c-9dcc-4434-b566-7e99033ea252&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:2&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.6&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;ed9deeb2-be8f-4b84-bcd8-9d12049383d6&quot;</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s2">&quot;flow-node-inventory:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;flow-node-inventory:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                      <span class="s2">&quot;flow-node-inventory:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;flow-node-inventory:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:1:2&quot;</span>
                      <span class="p">},</span>
                      <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
                    <span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;flow-node-inventory:order&quot;</span><span class="p">:</span> <span class="mi">0</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;flow-node-inventory:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;flow-node-inventory:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;flow-node-inventory:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
              <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;flow-node-inventory:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.7&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;flow-node-inventory:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="look-for-your-flow-stats-in-the-controller-operational-data-via">
<h6>Look for your flow stats in the controller operational data via<a class="headerlink" href="#look-for-your-flow-stats-in-the-controller-operational-data-via" title="Permalink to this headline">¶</a></h6>
<p>RESTCONF</p>
<ul class="simple">
<li>See your operational flow stats in POSTMAN with<ul>
<li>URL &#8220;<a class="reference external" href="http:/">http:/</a>/&lt;controller
IP&gt;:8181/restconf/operational/opendaylight-inventory:nodes/node/openflow:1/table/0/&#8221;</li>
<li>GET</li>
</ul>
</li>
</ul>
<p>Return Response:</p>
<div class="code json highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;flow-node-inventory:table&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;flow-node-inventory:flow&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;10b1a23c-5299-4f7b-83d6-563bab472754&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">886000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2707</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">784</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;020bf359-1299-4da6-b4f7-368bd83b5841&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">826000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2711</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">1568</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;42172bfc-9142-4a92-9e90-ee62529b1e85&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">548000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2708</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">784</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.3/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;99bf566e-89f3-4c6f-ae9e-e26012ceb1e4&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">296000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2710</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">1274</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.4/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;019dcc2e-5b4f-44f0-90cc-de490294b862&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">392000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2711</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">1470</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.5/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;968cf81e-3f16-42f1-8b16-d01ff719c63c&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">344000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2707</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">784</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.8/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;ed9deeb2-be8f-4b84-bcd8-9d12049383d6&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">577000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2706</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">784</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.7/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;flow-node-inventory:id&quot;</span><span class="p">:</span> <span class="s2">&quot;1c14ea3c-9dcc-4434-b566-7e99033ea252&quot;</span><span class="p">,</span>
          <span class="s2">&quot;opendaylight-flow-statistics:flow-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;opendaylight-flow-statistics:cookie&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:duration&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:nanosecond&quot;</span><span class="p">:</span> <span class="mi">659000000</span><span class="p">,</span>
              <span class="s2">&quot;opendaylight-flow-statistics:second&quot;</span><span class="p">:</span> <span class="mi">2705</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:hard-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:byte-count&quot;</span><span class="p">:</span> <span class="mi">784</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:match&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ethernet-match&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;opendaylight-flow-statistics:ethernet-type&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:type&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="s2">&quot;opendaylight-flow-statistics:ipv4-destination&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.6/32&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;opendaylight-flow-statistics:priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:packet-count&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:idle-timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;opendaylight-flow-statistics:instructions&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;opendaylight-flow-statistics:instruction&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s2">&quot;opendaylight-flow-statistics:apply-actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;opendaylight-flow-statistics:action&quot;</span><span class="p">:</span> <span class="p">[</span>
                      <span class="p">{</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:order&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;opendaylight-flow-statistics:output-action&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:output-node-connector&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;opendaylight-flow-statistics:max-length&quot;</span><span class="p">:</span> <span class="mi">0</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">]</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">]</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;opendaylight-flow-table-statistics:flow-table-statistics&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;opendaylight-flow-table-statistics:active-flows&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;opendaylight-flow-table-statistics:packets-matched&quot;</span><span class="p">:</span> <span class="mi">97683</span><span class="p">,</span>
        <span class="s2">&quot;opendaylight-flow-table-statistics:packets-looked-up&quot;</span><span class="p">:</span> <span class="mi">101772</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="discovering-and-testing-new-flow-types">
<h5>Discovering and testing new Flow Types<a class="headerlink" href="#discovering-and-testing-new-flow-types" title="Permalink to this headline">¶</a></h5>
<p>Currently, the openflowplugin has a test-provider that allows you to
push various flows through the system from the OSGI command line. Once
those flows have been pushed through, you can see them as examples and
then use them to see in the config what a particular flow example looks
like.</p>
<div class="section" id="using-addmdflow">
<h6>Using addMDFlow<a class="headerlink" href="#using-addmdflow" title="Permalink to this headline">¶</a></h6>
<p>From the</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet at the controller as described above.</p>
<p>once you can see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addMDFlow</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">f</span><span class="c1">#</span>
</pre></div>
</div>
<p>Where # is a number between 1 and 80. This will create one of 80
possible flows. You can go confirm they were created on the switch.</p>
<p>Once you’ve done that, use</p>
<ul class="simple">
<li>GET</li>
<li>Accept: application/xml</li>
<li>URL:
&#8220;<a class="reference external" href="http://192.168.195.157:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/">http://192.168.195.157:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/</a>&#8220;</li>
</ul>
<p>To see a full listing of the flows in table 2 (where they will be put).
If you want to see a particular flow, look at</p>
<ul class="simple">
<li>URL:
&#8220;<a class="reference external" href="http://192.168.195.157:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/flow">http://192.168.195.157:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/flow</a>/#&#8221;</li>
</ul>
<p>Where # is 123 + the f# you used. So for example, for f22, your url
would be</p>
<ul class="simple">
<li>URL:
&#8220;<a class="reference external" href="http://192.168.195.157:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/flow/145">http://192.168.195.157:8181/restconf/config/opendaylight-inventory:nodes/node/openflow:1/table/2/flow/145</a>&#8220;</li>
</ul>
<p>Note: You may have to trim out some of the sections like that contain
bitfields and binary types that are not correctly modeled.</p>
<p>Note: Before attempting to PUT a flow you have created via addMDFlow,
please change its URL and body to, for example, use table 1 instead of
table 2 or another Flow Id, so you don’t collide.</p>
<p>Note: There are several test command providers and the one handling
flows is <strong>OpenflowpluginTestCommandProvider</strong>. Methods, which can be
use as <strong>commands in OSGI-console</strong> have prefix <em>_</em>.</p>
</div>
</div>
<div class="section" id="example-flows">
<h5>Example Flows<a class="headerlink" href="#example-flows" title="Permalink to this headline">¶</a></h5>
<p>Examples for XML for various flow matches, instructions &amp; actions can be
found in following section <a class="reference external" href="#odl-ofp-example-flows_overview">here</a></p>
</div>
</div>
<div class="section" id="end-to-end-topology">
<h4>End to End Topology<a class="headerlink" href="#end-to-end-topology" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id62">
<h5>Introduction<a class="headerlink" href="#id62" title="Permalink to this headline">¶</a></h5>
<p>The purpose of this page is to walk you through how to see the Topology
Manager working end to end with the openflowplugin using OpenFlow 1.3.</p>
<p>Basically, you will learn how to:</p>
<ol class="arabic simple">
<li>Run the Base/Virtualization/Service provider Edition with the new
openflowplugin: <a class="reference external" href="#odl-ofp-running-controller-with-the-new-of-plugin_top">Running the controller with the new OpenFlow
Plugin</a></li>
<li>Start mininet to use OF 1.3: <a class="reference external" href="#odl-ofp-test-environment_top">OpenFlow 1.3 Enabled Software Switches
/ Environment</a></li>
<li>Use RESTCONF to see the topology information.</li>
</ol>
</div>
<div class="section" id="restconf-for-topology">
<h5>Restconf for Topology<a class="headerlink" href="#restconf-for-topology" title="Permalink to this headline">¶</a></h5>
<p>The REST url for listing all the nodes is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="p">:</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="o">/</span>
</pre></div>
</div>
<p>You will need to set the Accept header:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">xml</span>
</pre></div>
</div>
<p>You will also need to use HTTP Basic Auth with username: admin password:
admin.</p>
<p>Alternately, if you have a node’s id you can address it as</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="p">:</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="o">/</span><span class="n">topology</span><span class="o">/&lt;</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>for example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="p">:</span><span class="n">network</span><span class="o">-</span><span class="n">topology</span><span class="o">/</span><span class="n">topology</span><span class="o">/</span><span class="n">flow</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span>
</pre></div>
</div>
<div class="section" id="id63">
<h6>How to hit RestConf with Postman<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h6>
<p>Install
<a class="reference external" href="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en">postman</a>
for Chrome</p>
<p>In the chrome browser bar enter</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chrome</span><span class="p">:</span><span class="o">//</span><span class="n">apps</span><span class="o">/</span>
</pre></div>
</div>
<p>And click on Postman.</p>
<p>Enter the URL. Click on the Headers button on the far right. Enter the
Accept: header. Click on the Basic Auth Tab at the top and setup the
username and password. Send.</p>
</div>
</div>
</div>
<div class="section" id="end-to-end-groups">
<h4>End to End Groups<a class="headerlink" href="#end-to-end-groups" title="Permalink to this headline">¶</a></h4>
<div class="section" id="note">
<h5>NOTE<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h5>
<p>Groups are NOT SUPPORTED in current (2.0.0) version of
<a class="reference external" href="http://www.openvswitch.org/download">openvswitch</a>. See</p>
<ul class="simple">
<li><a class="reference external" href="http://openvswitch.org/releases/NEWS-2.0.0">http://openvswitch.org/releases/NEWS-2.0.0</a></li>
<li><a class="reference external" href="http://comments.gmane.org/gmane.linux.network.openvswitch.general/3251">http://comments.gmane.org/gmane.linux.network.openvswitch.general/3251</a></li>
</ul>
<p>For testing group feature please use for example
<a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">CPQD</a>
virtual switch.</p>
</div>
<div class="section" id="id64">
<h5>Instructions<a class="headerlink" href="#id64" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id65">
<h6>Learn End to End for Inventory<a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h6>
<p><a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to End
Inventory</a></p>
</div>
<div class="section" id="id66">
<h6>Check inventory<a class="headerlink" href="#id66" title="Permalink to this headline">¶</a></h6>
<p>Run CPqD with support for OF 1.3 as described in <a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to End
Inventory</a></p>
<p>Make sure you see the openflow:1 node come up as described in <a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to
End
Inventory</a></p>
</div>
<div class="section" id="group-strategy">
<h6>Group Strategy<a class="headerlink" href="#group-strategy" title="Permalink to this headline">¶</a></h6>
<p>Current way to flush a group to switch looks like this:</p>
<ol class="arabic simple">
<li>create MD-SAL modeled group and commit it into dataStore using two
phase commit</li>
<li>FRM gets notified and invokes corresponding rpc (addGroup) on
particular service provider (if suitable provider for given node
registered)</li>
<li>the provider (plugin in this case) transforms MD-SAL modeled group
into OF-API modeled group</li>
<li>OF-API modeled group is then flushed into OFLibrary</li>
<li>OFLibrary encodes group into particular version of wire protocol and
sends it to particular switch</li>
<li>check on CPqD if group is installed</li>
</ol>
</div>
<div class="section" id="push-your-group">
<h6>Push your Group<a class="headerlink" href="#push-your-group" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>With PostMan:<ul>
<li>Set<ul>
<li>Content-Type: application/xml</li>
<li>Accept: application/xml</li>
</ul>
</li>
<li>Use URL:
&#8220;<a class="reference external" href="http:/">http:/</a>/&lt;ip-address&gt;:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/group/1&#8221;</li>
<li>PUT</li>
<li>Use Body:</li>
</ul>
</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;group xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;group-type&gt;group-all&lt;/group-type&gt;
    &lt;buckets&gt;
        &lt;bucket&gt;
            &lt;action&gt;
                &lt;pop-vlan-action/&gt;
                &lt;order&gt;0&lt;/order&gt;
            &lt;/action&gt;
            &lt;bucket-id&gt;12&lt;/bucket-id&gt;
            &lt;watch_group&gt;14&lt;/watch_group&gt;
            &lt;watch_port&gt;1234&lt;/watch_port&gt;
        &lt;/bucket&gt;
        &lt;bucket&gt;
            &lt;action&gt;
                &lt;set-field&gt;
                    &lt;ipv4-source&gt;100.1.1.1&lt;/ipv4-source&gt;
                &lt;/set-field&gt;
                &lt;order&gt;0&lt;/order&gt;
            &lt;/action&gt;
            &lt;action&gt;
                &lt;set-field&gt;
                    &lt;ipv4-destination&gt;200.71.9.5210&lt;/ipv4-destination&gt;
                &lt;/set-field&gt;
                &lt;order&gt;1&lt;/order&gt;
            &lt;/action&gt;
            &lt;bucket-id&gt;13&lt;/bucket-id&gt;
            &lt;watch_group&gt;14&lt;/watch_group&gt;
            &lt;watch_port&gt;1234&lt;/watch_port&gt;
        &lt;/bucket&gt;
    &lt;/buckets&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
    &lt;group-name&gt;Foo&lt;/group-name&gt;
    &lt;group-id&gt;1&lt;/group-id&gt;
&lt;/group&gt;

**Note**

If you want to try a different group id, make sure the URL and the
body stay in sync. For example, if you wanted to try: group-id 20
you’d change the URL to
&quot;http://&lt;ip-address&gt;:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/group/20&quot;
but you would also need to update the &lt;group-id&gt;20&lt;/group-id&gt; in the
body to match.

**Note**

&lt;ip-address&gt; :Provide the IP Address of the machine on which the
controller is running.
</pre></div>
</div>
</div>
<div class="section" id="check-for-your-group-on-the-switch">
<h6>Check for your group on the switch<a class="headerlink" href="#check-for-your-group-on-the-switch" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>See your group on your cpqd switch:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">COMMAND</span><span class="p">:</span> <span class="n">sudo</span> <span class="n">dpctl</span> <span class="n">tcp</span><span class="p">:</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6000</span> <span class="n">stats</span><span class="o">-</span><span class="n">group</span>

<span class="n">SENDING</span><span class="p">:</span>
<span class="n">stat_req</span><span class="p">{</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;grp&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s2">&quot;0x0&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">}</span>


<span class="n">RECEIVED</span><span class="p">:</span>
<span class="n">stat_repl</span><span class="p">{</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;grp&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="s2">&quot;0x0&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="p">[</span>
<span class="p">{</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">ref_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">pkt_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">byte_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">cntrs</span><span class="o">=</span><span class="p">[{</span><span class="n">pkt_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">byte_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">},</span> <span class="p">{</span><span class="n">pkt_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">byte_cnt</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">}]}]}</span>
</pre></div>
</div>
</div>
<div class="section" id="check-for-your-group-in-the-controller-config-via-restconf">
<h6>Check for your group in the controller config via RESTCONF<a class="headerlink" href="#check-for-your-group-in-the-controller-config-via-restconf" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>See your configured group in POSTMAN with<ul>
<li>URL
<a href="#id260"><span class="problematic" id="id264">`http://&lt;ip-address&gt;:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/group/1 &lt;http://&lt;ip-address&gt;:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/group/1&gt;`__</span></a></li>
<li>GET</li>
<li>You should no longer need to set Accept</li>
<li>Note: &lt;ip-address&gt; :Provide the IP Address of the machine on which
the controller is running.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="look-for-your-group-stats-in-the-controller-operational-data-via-restconf">
<h6>Look for your group stats in the controller operational data via RESTCONF<a class="headerlink" href="#look-for-your-group-stats-in-the-controller-operational-data-via-restconf" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>See your operational group stats in POSTMAN with<ul>
<li>URL
<a href="#id260"><span class="problematic" id="id265">`http://&lt;ip-address&gt;:8080/restconf/operational/opendaylight-inventory:nodes/node/openflow:1/group/1 &lt;http://&lt;ip-address&gt;:8080/restconf/operational/opendaylight-inventory:nodes/node/openflow:1/group/1&gt;`__</span></a></li>
<li>GET</li>
<li>Note: &lt;ip-address&gt; :Provide the IP Address of the machine on which
the controller is running.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="discovering-and-testing-group-types">
<h5>Discovering and testing Group Types<a class="headerlink" href="#discovering-and-testing-group-types" title="Permalink to this headline">¶</a></h5>
<p>Currently, the openflowplugin has a test-provider that allows you to
push various groups through the system from the OSGI command line. Once
those groups have been pushed through, you can see them as examples and
then use them to see in the config what a particular group example looks
like.</p>
</div>
<div class="section" id="using-addgroup">
<h5>Using addGroup<a class="headerlink" href="#using-addgroup" title="Permalink to this headline">¶</a></h5>
<p>From the</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your CPqD at the controller as described above.</p>
<p>once you can see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addGroup</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<p>This will install a group in the switch. You can check whether the group
is installed or not.</p>
<p>Once you’ve done that, use</p>
<ul>
<li><p class="first">GET</p>
</li>
<li><p class="first">Accept: application/xml</p>
</li>
<li><p class="first">URL:
&#8220;<a class="reference external" href="http:/">http:/</a>/&lt;ip-address&gt;:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/group/1&#8221;</p>
<ul class="simple">
<li>Note: &lt;ip-address&gt; :Provide the IP Address of the machine on which
the controller is running.</li>
</ul>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Before attempting to PUT a group you have created via addGroup,
please change its URL and body to, for example, use group 1 instead
of group 2 or another Group Id, so that they don’t collide.</p>
<p><strong>Note</strong></p>
<p>There are several test command providers and the one handling groups
is OpenflowpluginGroupTestCommandProvider. Methods, which can be use
as commands in OSGI-console have prefix <em>_</em>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="example-group">
<h5>Example Group<a class="headerlink" href="#example-group" title="Permalink to this headline">¶</a></h5>
<p>Examples for XML for various Group Types can be found in the
test-scripts bundle of the plugin code with names g1.xml, g2.xml and
g3.xml.</p>
</div>
</div>
<div class="section" id="end-to-end-meters">
<h4>End to End Meters<a class="headerlink" href="#end-to-end-meters" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id67">
<h5>Instructions<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id68">
<h6>Learn End to End for Inventory<a class="headerlink" href="#id68" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to End
Inventory</a></li>
</ul>
</div>
<div class="section" id="id69">
<h6>Check inventory<a class="headerlink" href="#id69" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Run mininet with support for OF 1.3 as described in <a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to End
Inventory</a></li>
<li>Make sure you see the openflow:1 node come up as described in <a class="reference external" href="#odl-ofp-end-to-end-inventory_introduction-introduction">End to
End
Inventory</a></li>
</ul>
</div>
<div class="section" id="meter-strategy">
<h6>Meter Strategy<a class="headerlink" href="#meter-strategy" title="Permalink to this headline">¶</a></h6>
<p>Current way to flush a meter to switch looks like this:</p>
<ol class="arabic simple">
<li>create MD-SAL modeled flow and commit it into dataStore using two
phase commit</li>
<li>FRM gets notified and invokes corresponding rpc (addMeter) on
particular service provider (if suitable provider for given node
registered)</li>
<li>the provider (plugin in this case) transforms MD-SAL modeled meter
into OF-API modeled meter</li>
<li>OF-API modeled meter is then flushed into OFLibrary</li>
<li>OFLibrary encodes meter into particular version of wire protocol and
sends it to particular switch</li>
<li>check on mininet side if meter is installed</li>
</ol>
</div>
<div class="section" id="push-your-meter">
<h6>Push your Meter<a class="headerlink" href="#push-your-meter" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Using PostMan:<ul>
<li>Set Request Headers<ul>
<li>Content-Type: application/xml</li>
<li>Accept: application/xml</li>
</ul>
</li>
<li>Use URL:
&#8220;<a class="reference external" href="http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/1">http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/1</a>&#8220;</li>
<li>Method:PUT</li>
<li>Request Body:</li>
</ul>
</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;meter xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;container-name&gt;abcd&lt;/container-name&gt;
    &lt;flags&gt;meter-burst&lt;/flags&gt;
    &lt;meter-band-headers&gt;
        &lt;meter-band-header&gt;
            &lt;band-burst-size&gt;444&lt;/band-burst-size&gt;
            &lt;band-id&gt;0&lt;/band-id&gt;
            &lt;band-rate&gt;234&lt;/band-rate&gt;
            &lt;dscp-remark-burst-size&gt;5&lt;/dscp-remark-burst-size&gt;
            &lt;dscp-remark-rate&gt;12&lt;/dscp-remark-rate&gt;
            &lt;prec_level&gt;1&lt;/prec_level&gt;
            &lt;meter-band-types&gt;
                &lt;flags&gt;ofpmbt-dscp-remark&lt;/flags&gt;
            &lt;/meter-band-types&gt;
        &lt;/meter-band-header&gt;
    &lt;/meter-band-headers&gt;
    &lt;meter-id&gt;1&lt;/meter-id&gt;
    &lt;meter-name&gt;Foo&lt;/meter-name&gt;
&lt;/meter&gt;

**Note**

If you want to try a different meter id, make sure the URL and the
body stay in sync. For example, if you wanted to try: meter-id 20
you’d change the URL to
&quot;http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/20&quot;
but you would also need to update the 20 in the body to match.

**Note**

:Provide the IP Address of the machine on which the controller is
running.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-for-your-meter-on-the-switch">
<h4>Check for your meter on the switch<a class="headerlink" href="#check-for-your-meter-on-the-switch" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>See your meter on your CPqD switch:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>COMMAND: $ sudo dpctl tcp:127.0.0.1:6000 meter-config

SENDING:
stat_req{type=&quot;mconf&quot;, flags=&quot;0x0&quot;{meter_id= ffffffff&quot;}


RECEIVED:
stat_repl{type=&quot;mconf&quot;, flags=&quot;0x0&quot;, stats=[{meter= c&quot;&quot;, flags=&quot;4&quot;, bands=[{type = dscp_remark, rate=&quot;12&quot;, burst_size=&quot;5&quot;, prec_level=&quot;1&quot;}]}]}
</pre></div>
</div>
<div class="section" id="check-for-your-meter-in-the-controller-config-via-restconf">
<h5>Check for your meter in the controller config via RESTCONF<a class="headerlink" href="#check-for-your-meter-in-the-controller-config-via-restconf" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>See your configured flow in POSTMAN with<ul>
<li>URL
&#8220;<a class="reference external" href="http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/1">http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/1</a>&#8220;</li>
<li>Method: GET</li>
<li>You should no longer need to set Request Headers for Accept</li>
<li>Note: :Provide the IP Address of the machine on which the
controller is running.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="look-for-your-meter-stats-in-the-controller-operational-data-via-restconf">
<h5>Look for your meter stats in the controller operational data via RESTCONF<a class="headerlink" href="#look-for-your-meter-stats-in-the-controller-operational-data-via-restconf" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>See your operational meter stats in POSTMAN with<ul>
<li>URL
&#8220;<a class="reference external" href="http://:8080/restconfig/operational/opendaylight-inventory:nodes/node/openflow:1/meter/1">http://:8080/restconfig/operational/opendaylight-inventory:nodes/node/openflow:1/meter/1</a>&#8220;</li>
<li>Method: GET</li>
<li>Note: :Provide the IP Address of the machine on which the
controller is running.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="discovering-and-testing-meter-types">
<h5>Discovering and testing Meter Types<a class="headerlink" href="#discovering-and-testing-meter-types" title="Permalink to this headline">¶</a></h5>
<p>Currently, the openflowplugin has a test-provider that allows you to
push various meters through the system from the OSGI command line. Once
those meters have been pushed through, you can see them as examples and
then use them to see in the config what a particular meter example looks
like.</p>
<div class="section" id="using-addmeter">
<h6>Using addMeter<a class="headerlink" href="#using-addmeter" title="Permalink to this headline">¶</a></h6>
<p>From the</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your CPqD at the controller as described above.</p>
<p>Once you can see your CPqD connected to the controller, at the OSGI
command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addMeter</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<p>Once you’ve done that, use</p>
<ul>
<li><p class="first">GET</p>
</li>
<li><p class="first">Accept: application/xml</p>
</li>
<li><p class="first">URL:
&#8220;<a class="reference external" href="http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/12">http://:8080/restconf/config/opendaylight-inventory:nodes/node/openflow:1/meter/12</a>&#8220;</p>
<ul class="simple">
<li>Note: :Provide the IP Address of the machine on which the
controller is running.</li>
</ul>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Before attempting to PUT a meter you have created via addMeter,
please change its URL and body to, for example, use meter 1 instead
of meter 2 or another Meter Id, so you don’t collide.</p>
<p><strong>Note</strong></p>
<p>There are several test command providers and the one handling Meter
is <strong>OpenflowpluginMeterTestCommandProvider</strong>. Methods, which can be
used as <strong>commands in OSGI-console</strong> have prefix <em>_</em>. Examples:
addMeter, modifyMeter and removeMeter.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="example-meter">
<h5>Example Meter<a class="headerlink" href="#example-meter" title="Permalink to this headline">¶</a></h5>
<p>Examples for XML for various Meter Types can be found in the
test-scripts bundle of the plugin code with names m1.xml, m2.xml and
m3.xml.</p>
</div>
</div>
<div class="section" id="statistics">
<h4>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id70">
<h5>Overview<a class="headerlink" href="#id70" title="Permalink to this headline">¶</a></h5>
<p>This page contains high level detail about the statistics collection
mechanism in new OpenFlow plugin.</p>
<div class="section" id="statistics-collection-in-new-openflow-plugin">
<h6>Statistics collection in new OpenFlow plugin<a class="headerlink" href="#statistics-collection-in-new-openflow-plugin" title="Permalink to this headline">¶</a></h6>
<p>New OpenFlow plugin collects following statistics from OpenFlow enabled
node(switch):</p>
<ol class="arabic simple">
<li>Individual Flow Statistics</li>
<li>Aggregate Flow Statistics</li>
<li>Flow Table Statistics</li>
<li>Port Statistics</li>
<li>Group Description</li>
<li>Group Statistics</li>
<li>Meter Configuration</li>
<li>Meter Statistics</li>
<li>Queue Statistics</li>
<li>Node Description</li>
<li>Flow Table Features</li>
<li>Port Description</li>
<li>Group Features</li>
<li>Meter Features</li>
</ol>
<p>At a high level statistics collection mechanism is divided into
following three parts</p>
<ol class="arabic simple">
<li>Statistics related <a class="reference external" href="https://git.opendaylight.org/gerrit/gitweb?p=controller.git;a=tree;f=opendaylight/md-sal/model/model-flow-statistics;h=3488133625ccf18d023bc59aa35c38e922b17d8d;hb=HEAD">YANG models, service APIs and notification
interfaces</a>
are defined in the MD-SAL.</li>
<li>Service APIs (RPCs) defined in yang models are implemented by
OpenFlow plugin. Notification interfaces are wired up by OpenFlow
plugin to MD-SAL.</li>
<li>Statistics Manager Module: This module use service APIs implemented
by OpenFlow plugin to send statistics requests to all the connected
OpenFlow enabled nodes. Module also implements notification
interfaces to receive statistics response from nodes. Once it
receives statistics response, it augment all the statistics data to
the relevant element of the node (like node-connector, flow,
table,group, meter) and store it in MD-SAL operational data store.</li>
</ol>
</div>
<div class="section" id="details-of-statistics-collection">
<h6>Details of statistics collection<a class="headerlink" href="#details-of-statistics-collection" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Current implementation collects above mentioned statistics (except
10-14) at a periodic interval of 15 seconds.</li>
<li>Statistics mentioned in 10 to 14 are only fetched when any node
connects to the controller because these statistics are just static
details about the respective elements.</li>
<li>Whenever any new element is added to node (like flow, group, meter,
queue) it sends statistics request immediately to fetch the latest
statistics and store it in the operational data store.</li>
<li>Whenever any element is deleted from the node, it immediately remove
the relevant statistics from operational data store.</li>
<li>Statistics data are augmented to their respective element stored in
the configuration data store. E.g Controller installed flows are
stored in configuration data store. Whenever Statistics Manager
receive statistics data related to these flow, it search the
corresponding flow in the configuration data store and augment
statistics in the corresponding location in operational data store.
Similar approach is used for other elements of the node.</li>
<li>Statistics Manager stores flow statistics as an unaccounted flow
statistics in operational data store if there is no corresponding
flow exist in configuration data store. ID format of unaccounted flow
statistics is as follows - [#UF$TABLE**Unaccounted-flow-count - e.g
#UF$TABLE*2*1].</li>
<li>All the unaccounted flows will be cleaned up periodically after every
two cycle of flow statistics collection, given that there is no
update for these flows in the last two cycles.</li>
<li>Statistics Manager only entertains statistics response for the
request sent by itself. User can write its own statistics collector
using the statistics service APIs and notification defined in yang
models, it won’t effect the functioning of Statistics Manager.</li>
<li>OpenFlow 1.0 don’t have concept of Meter and Group, so Statistics
Manager don’t send any group &amp; meter related statistics request to
OpenFlow 1.0 enabled switch.</li>
</ul>
</div>
<div class="section" id="restconf-uris-to-access-statistics-of-various-node-elements">
<h6>RESTCONF Uris to access statistics of various node elements<a class="headerlink" href="#restconf-uris-to-access-statistics-of-various-node-elements" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Aggregate Flow Statistics &amp; Flow Table Statistics</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">table</span><span class="o">/</span><span class="p">{</span><span class="n">table</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Individual Flow Statistics from specific table</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">table</span><span class="o">/</span><span class="p">{</span><span class="n">table</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">flow</span><span class="o">/</span><span class="p">{</span><span class="n">flow</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Group Features &amp; Meter Features Statistics</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Group Description &amp; Group Statistics</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">group</span><span class="o">/</span><span class="p">{</span><span class="n">group</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Meter Configuration &amp; Meter Statistics</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">meter</span><span class="o">/</span><span class="p">{</span><span class="n">meter</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Node Connector Statistics</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Queue Statistics</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">GET</span>  <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">controller</span><span class="o">-</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">/</span><span class="p">{</span><span class="n">node</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">queue</span><span class="o">/</span><span class="p">{</span><span class="n">queue</span><span class="o">-</span><span class="nb">id</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="bugs">
<h6>Bugs<a class="headerlink" href="#bugs" title="Permalink to this headline">¶</a></h6>
<p>For more details and queuries, please send mail to
<a class="reference external" href="mailto:openflowplugin-dev&#37;&#52;&#48;lists&#46;opendaylight&#46;org">openflowplugin-dev<span>&#64;</span>lists<span>&#46;</span>opendaylight<span>&#46;</span>org</a> or <a class="reference external" href="mailto:avishnoi&#37;&#52;&#48;in&#46;ibm&#46;com">avishnoi<span>&#64;</span>in<span>&#46;</span>ibm<span>&#46;</span>com</a> If you
want to report any bug in statistics collection, please use
<a class="reference external" href="https://bugs.opendaylight.org">bugzilla</a>.</p>
</div>
</div>
</div>
</div>
<div class="section" id="web-graphical-interface">
<h3>Web / Graphical Interface<a class="headerlink" href="#web-graphical-interface" title="Permalink to this headline">¶</a></h3>
<p>In the Hydrogen &amp; Helium release, the current Web UI does not support
the new OpenFlow 1.3 constructs such as groups, meters, new fields in
the flows, multiple flow tables, etc.</p>
</div>
<div class="section" id="command-line-interface">
<h3>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h3>
<p>The following is not exactly CLI - just a set of test commands which can
be executed on the OSGI console testing various features in OpenFlow 1.3
spec.</p>
<ul class="simple">
<li><a class="reference external" href="#odl-ofp-test-provider-flows_test-provider">OSGI Console Test Provider Commands:
Flows</a></li>
<li><a class="reference external" href="#odl-ofp-test-provider-groups_test-provider">OSGI Console Test Provider Commands:
Groups</a></li>
<li><a class="reference external" href="#odl-ofp-test-provider-meters_test-provider">OSGI Console Test Provider Commands:
Meters</a></li>
<li><a class="reference external" href="#odl-ofp-test-provider-topoogy_test-provider">OSGI Console Test Provider Commands: Topology
Events</a></li>
</ul>
<div class="section" id="flows-test-provider">
<h4>Flows : Test Provider<a class="headerlink" href="#flows-test-provider" title="Permalink to this headline">¶</a></h4>
<p>Currently, the openflowplugin has a test-provider that allows you to
push various flows through the system from the OSGI command line. Once
those flows have been pushed through, you can see them as examples and
then use them to see in the config what a particular flow example looks
like.</p>
<div class="section" id="addflow-addmdflow">
<h5>AddFlow : addMDFlow<a class="headerlink" href="#addflow-addmdflow" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet to the controller by giving the parameters
&#8211;controller=remote,ip=.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addMDFlow</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">f</span><span class="c1">#</span>
</pre></div>
</div>
<p>Where # is a number between 1 and 80 and openflow:1 is the of the
switch. This will create one of 80 possible flows. You can confirm that
they were created on the switch.</p>
</div>
<div class="section" id="removeflow-removemdflow">
<h5>RemoveFlow : removeMDFlow<a class="headerlink" href="#removeflow-removemdflow" title="Permalink to this headline">¶</a></h5>
<p>Similar to addMDFlow, from the controller OSGi prompt, while your switch
is connected to the controller, try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">removeMDFlow</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">f</span><span class="c1">#</span>
</pre></div>
</div>
<p>where # is a number between 1 and 80 and openflow:1 is the of the
switch. The flow to be deleted should have same flowid and Nodeid as
used for flow add.</p>
</div>
<div class="section" id="modifyflow-modifymdflow">
<h5>ModifyFlow : modifyMDFlow<a class="headerlink" href="#modifyflow-modifymdflow" title="Permalink to this headline">¶</a></h5>
<p>Similar to addMDFlow, from the controller OSGi prompt, while your switch
is connected to the controller, try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">modifyMDFlow</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">f</span><span class="c1">#</span>
</pre></div>
</div>
<p>where # is a number between 1 and 80 and openflow:1 is the of the
switch. The flow to be deleted should have same flowid and Nodeid as
used for flow add.</p>
</div>
</div>
<div class="section" id="group-test-provider">
<h4>Group : Test Provider<a class="headerlink" href="#group-test-provider" title="Permalink to this headline">¶</a></h4>
<p>Currently, the openflowplugin has a test-provider that allows you to
push various flows through the system from the OSGI command line. Once
those flows have been pushed through, you can see them as examples and
then use them to see in the config what a particular flow example looks
like.</p>
<div class="section" id="addgroup-addgroup">
<h5>AddGroup : addGroup<a class="headerlink" href="#addgroup-addgroup" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet to the controller by giving the parameters
&#8211;controller=remote,ip=.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addGroup</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">a</span><span class="c1"># g#</span>
</pre></div>
</div>
<p>Where # is a number between 1 and 4 for grouptype(g#) and 1 and 28 for
actiontype(a#). You can confirm that they were created on the switch.</p>
</div>
<div class="section" id="removegroup-removegroup">
<h5>RemoveGroup : removeGroup<a class="headerlink" href="#removegroup-removegroup" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet at the controller as described above.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">removeGroup</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">a</span><span class="c1"># g#</span>
</pre></div>
</div>
<p>Where # is a number between 1 and 4 for grouptype(g#) and 1 and 28 for
actiontype(a#). GroupId should be same as that used for adding the flow.
You can confirm that it was removed from the switch.</p>
</div>
<div class="section" id="modifygroup-modifygroup">
<h5>ModifyGroup : modifyGroup<a class="headerlink" href="#modifygroup-modifygroup" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet at the controller as described above.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">modifyGroup</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">a</span><span class="c1"># g#</span>
</pre></div>
</div>
<p>Where # is a number between 1 and 4 for grouptype(g#) and 1 and 28 for
actiontype(a#). GroupId should be same as that used for adding the flow.
You can confirm that it was modified on the switch.</p>
</div>
</div>
<div class="section" id="meters-test-provider">
<h4>Meters : Test Provider<a class="headerlink" href="#meters-test-provider" title="Permalink to this headline">¶</a></h4>
<p>Currently, the openflowplugin has a test-provider that allows you to
push various flows through the system from the OSGI command line. Once
those flows have been pushed through, you can see them as examples and
then use them to see in the config what a particular flow example looks
like.</p>
<div class="section" id="addmeter-addmeter">
<h5>AddMeter : addMeter<a class="headerlink" href="#addmeter-addmeter" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet to the controller by giving the parameters
&#8211;controller=remote,ip=.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addMeter</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<p>You can now confirm that meter has been created on the switch.</p>
</div>
<div class="section" id="removemeter-removemeter">
<h5>RemoveMeter : removeMeter<a class="headerlink" href="#removemeter-removemeter" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet to the controller by giving the parameters
&#8211;controller=remote,ip=.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">removeMeter</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<p>The CLI takes care of using the same meterId and nodeId as used for
meter add. You can confirm that it was removed from the switch.</p>
</div>
<div class="section" id="modifymeter-modifymeter">
<h5>ModifyMeter : modifyMeter<a class="headerlink" href="#modifymeter-modifymeter" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet to the controller by giving the parameters
&#8211;controller=remote,ip=.</p>
<p>Once you see your node (probably openflow:1 if you’ve been following
along) in the inventory, at the OSGI command line try running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">modifyMeter</span> <span class="n">openflow</span><span class="p">:</span><span class="mi">1</span>
</pre></div>
</div>
<p>The CLI takes care of using the same meterId and nodeId as used for
meter add. You can confirm that it was modified on the switch.</p>
</div>
</div>
<div class="section" id="topology-notification">
<h4>Topology : Notification<a class="headerlink" href="#topology-notification" title="Permalink to this headline">¶</a></h4>
<p>Currently, the openflowplugin has a test-provider that allows you to get
notifications for the topology related events like Link-Discovered ,
Link-Removed events.</p>
<div class="section" id="link-discovered-event-testing">
<h5>Link Discovered Event : Testing<a class="headerlink" href="#link-discovered-event-testing" title="Permalink to this headline">¶</a></h5>
<p>Run the controller by executing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">openflowplugin</span><span class="o">/</span><span class="n">distribution</span><span class="o">/</span><span class="n">base</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">distributions</span><span class="o">-</span><span class="n">openflowplugin</span><span class="o">-</span><span class="n">base</span><span class="o">-</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">SNAPSHOT</span><span class="o">-</span><span class="n">osgipackage</span><span class="o">/</span><span class="n">opendaylight</span>
<span class="o">./</span><span class="n">run</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Point your mininet to the controller by giving the parameters
&#8211;controller=remote,ip=. Once the controller is connected to the switch,
Link-Discovered event can be tested by initially configuring the
specific flows on the switch. For Link Discovered event either
table-miss flow or LLDP ether-type flow can be configured.</p>
<p>Configuring Table-Miss flow using OpenflowpluginTestCommandProvider</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addMDFlow</span> <span class="n">Openflow</span><span class="p">:</span><span class="mi">1</span> <span class="n">fTM</span>
</pre></div>
</div>
<p>as per this
OpenDaylight_OpenFlow_Plugin:Test_Provider#Flows_:_Test_Provider[link].
<em>fTM</em> is the table-miss scenario here.</p>
<p>Once the table-miss flow is configured through above command, we can see
the Link-Discovered event in the debug logs on the controller console.</p>
<p>Configuring LLDP ether-type flow using OpenflowpluginTestCommandProvider</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">addMDFlow</span> <span class="n">Openflow</span><span class="p">:</span><span class="mi">1</span> <span class="mi">0</span><span class="p">(</span><span class="n">table</span><span class="o">-</span><span class="nb">id</span><span class="p">)</span> <span class="n">f81</span>
</pre></div>
</div>
<p>You can confirm that they were created on the switch.</p>
<p>Once the LLDP ether-type flow is configured through above command, we
can see the Link-Discovered event in the debug logs on the controller
console.</p>
</div>
<div class="section" id="link-removed-event-testing">
<h5>Link Removed Event : Testing<a class="headerlink" href="#link-removed-event-testing" title="Permalink to this headline">¶</a></h5>
<p>Having configured either table-miss or lldp ether-type flow on switch,
once the switch is disconnected we see the Link-Removed event</p>
</div>
</div>
</div>
<div class="section" id="programmatic-interface">
<h3>Programmatic Interface<a class="headerlink" href="#programmatic-interface" title="Permalink to this headline">¶</a></h3>
<p>The API is documented in the model documentation under the section
OpenFlow Services at:</p>
<ul class="simple">
<li><a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Config:Model_Reference">Models Documentation (OpenFlow Services
Section)</a></li>
</ul>
</div>
<div class="section" id="id71">
<h3>Example flows<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id72">
<h4>Overview<a class="headerlink" href="#id72" title="Permalink to this headline">¶</a></h4>
<p>The flow examples on this page are tested to work with OVS.</p>
<p>Use, for example, POSTMAN with the following parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">ctrl</span><span class="o">-</span><span class="n">addr</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/&lt;</span><span class="n">Node</span><span class="o">-</span><span class="nb">id</span><span class="o">&gt;/</span><span class="n">table</span><span class="o">/&lt;</span><span class="n">Table</span><span class="o">-</span><span class="c1">#&gt;/flow/&lt;Flow-#&gt;</span>

<span class="o">-</span> <span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">xml</span>
<span class="o">-</span> <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">xml</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">PUT</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">opendaylight</span><span class="o">-</span><span class="n">inventory</span><span class="p">:</span><span class="n">nodes</span><span class="o">/</span><span class="n">node</span><span class="o">/</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">table</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">flow</span><span class="o">/</span><span class="mi">127</span>
</pre></div>
</div>
<p>Make sure that the Table-# and Flow-# in the URL and in the XML match.</p>
<p>The format of the flow-programming XML is determined by by the grouping
<em>flow</em> in the opendaylight-flow-types yang model: MISSING LINK.</p>
</div>
<div class="section" id="match-examples">
<h4>Match Examples<a class="headerlink" href="#match-examples" title="Permalink to this headline">¶</a></h4>
<p>The format of the XML that describes OpenFlow matches is determined by
the opendaylight-match-types yang model: .</p>
<p>The RESTCONF documentation for the match-types yang model can be found
at
<a class="reference external" href="https://jenkins.opendaylight.org/controller/job/controller-merge/lastSuccessfulBuild/artifact/opendaylight/md-sal/model/model-flow-base/target/site/models/opendaylight-match-types.html">opendaylight-match-types.html</a></p>
<div class="section" id="ipv4-dest-address">
<h5>IPv4 Dest Address<a class="headerlink" href="#ipv4-dest-address" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Flow=124, Table=2, Priority=2,
Instructions=\{Apply_Actions={dec_nw_ttl}},
match=\{ipv4_destination_address=10.0.1.1/24}</li>
<li>Note that ethernet-type MUST be 2048 (0x800)</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;124&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-destination&gt;10.0.1.1/24&lt;/ipv4-destination&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;12&lt;/hard-timeout&gt;
    &lt;cookie&gt;1&lt;/cookie&gt;
    &lt;idle-timeout&gt;34&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf1&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-address">
<h5>Ethernet Src Address<a class="headerlink" href="#ethernet-src-address" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Flow=126, Table=2, Priority=2,
Instructions=\{Apply_Actions={drop}},
match=\{ethernet-source=00:00:00:00:00:01}</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;drop-action/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;126&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:00:00:01&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;12&lt;/hard-timeout&gt;
    &lt;cookie&gt;3&lt;/cookie&gt;
    &lt;idle-timeout&gt;34&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf3&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ethernet-type">
<h5>Ethernet Src &amp; Dest Addresses, Ethernet Type<a class="headerlink" href="#ethernet-src-dest-addresses-ethernet-type" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Flow=127, Table=2, Priority=2,
Instructions=\{Apply_Actions={drop}},
match=\{ethernet-source=00:00:00:00:23:ae,
ethernet-destination=ff:ff:ff:ff:ff:ff, ethernet-type=45}</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-mpls-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;127&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;45&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:ff:ff:ff:ff&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:00:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;12&lt;/hard-timeout&gt;
    &lt;cookie&gt;4&lt;/cookie&gt;
    &lt;idle-timeout&gt;34&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf4&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ipv4-src-dest-addresses-input-port">
<h5>Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, Input Port<a class="headerlink" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-input-port" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34887 (0x8847)</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-mpls-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;128&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34887&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:ff:ff:ff:ff&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:00:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;10.1.2.3/24&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;20.4.5.6/16&lt;/ipv4-destination&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;12&lt;/hard-timeout&gt;
    &lt;cookie&gt;5&lt;/cookie&gt;
    &lt;idle-timeout&gt;34&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf5&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ipv4-src-dest-addresses-ip">
<h5>Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, IP<a class="headerlink" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-ip" title="Permalink to this headline">¶</a></h5>
<p>Protocol #, IP DSCP, IP ECN, Input Port</p>
<ul class="simple">
<li>Note that ethernet-type MUST be 2048 (0x800)</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;130&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:ff:ff:ff:aa&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;10.1.2.3/24&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;20.4.5.6/16&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;56&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;15&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;1&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;12000&lt;/hard-timeout&gt;
    &lt;cookie&gt;7&lt;/cookie&gt;
    &lt;idle-timeout&gt;12000&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf7&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ipv4-src-dest-addresses-tcp-src">
<h5>Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, TCP Src &amp;<a class="headerlink" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-tcp-src" title="Permalink to this headline">¶</a></h5>
<p>Dest Ports, IP DSCP, IP ECN, Input Port</p>
<ul class="simple">
<li>Note that ethernet-type MUST be 2048 (0x800)</li>
<li>Note that IP Protocol Type MUST be 6</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;131&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;17.1.2.3/8&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/16&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;2&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;2&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;25364&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;cookie&gt;8&lt;/cookie&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf8&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ipv4-src-dest-addresses-udp-src">
<h5>Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, UDP Src &amp;<a class="headerlink" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-udp-src" title="Permalink to this headline">¶</a></h5>
<p>Dest Ports, IP DSCP, IP ECN, Input Port</p>
<ul class="simple">
<li>Note that ethernet-type MUST be 2048 (0x800)</li>
<li>Note that IP Protocol Type MUST be 17</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;132&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;20:14:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;19.1.2.3/10&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/18&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;17&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;8&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;udp-source-port&gt;25364&lt;/udp-source-port&gt;
        &lt;udp-destination-port&gt;8080&lt;/udp-destination-port&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;cookie&gt;9&lt;/cookie&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf9&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ipv4-src-dest-addresses-icmpv4">
<h5>Ethernet Src &amp; Dest Addresses, IPv4 Src &amp; Dest Addresses, ICMPv4<a class="headerlink" href="#ethernet-src-dest-addresses-ipv4-src-dest-addresses-icmpv4" title="Permalink to this headline">¶</a></h5>
<p>Type &amp; Code, IP DSCP, IP ECN, Input Port</p>
<ul class="simple">
<li>Note that ethernet-type MUST be 2048 (0x800)</li>
<li>Note that IP Protocol Type MUST be 1</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;134&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;17.1.2.3/8&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/16&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;1&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;27&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;icmpv4-match&gt;
            &lt;icmpv4-type&gt;6&lt;/icmpv4-type&gt;
            &lt;icmpv4-code&gt;3&lt;/icmpv4-code&gt;
        &lt;/icmpv4-match&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;cookie&gt;11&lt;/cookie&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf11&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-arp-operation-arp-src-target">
<h5>Ethernet Src &amp; Dest Addresses, ARP Operation, ARP Src &amp; Target<a class="headerlink" href="#ethernet-src-dest-addresses-arp-operation-arp-src-target" title="Permalink to this headline">¶</a></h5>
<p>Transport Addresses, ARP Src &amp; Target Hw Addresses</p>
<ul class="simple">
<li>Note that ethernet-type MUST be 2054 (0x806)</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
                &lt;action&gt;
                    &lt;order&gt;1&lt;/order&gt;
                    &lt;dec-mpls-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;137&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2054&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:ff:ff:FF:ff&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:FC:01:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;arp-op&gt;1&lt;/arp-op&gt;
        &lt;arp-source-transport-address&gt;192.168.4.1&lt;/arp-source-transport-address&gt;
        &lt;arp-target-transport-address&gt;10.21.22.23&lt;/arp-target-transport-address&gt;
        &lt;arp-source-hardware-address&gt;
            &lt;address&gt;12:34:56:78:98:AB&lt;/address&gt;
        &lt;/arp-source-hardware-address&gt;
        &lt;arp-target-hardware-address&gt;
            &lt;address&gt;FE:DC:BA:98:76:54&lt;/address&gt;
        &lt;/arp-target-hardware-address&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;12&lt;/hard-timeout&gt;
    &lt;cookie&gt;14&lt;/cookie&gt;
    &lt;idle-timeout&gt;34&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf14&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-ethernet-type-vlan-id-vlan-pcp">
<h5>Ethernet Src &amp; Dest Addresses, Ethernet Type, VLAN ID, VLAN PCP<a class="headerlink" href="#ethernet-src-dest-addresses-ethernet-type-vlan-id-vlan-pcp" title="Permalink to this headline">¶</a></h5>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;id&gt;138&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;vlan-match&gt;
            &lt;vlan-id&gt;
                &lt;vlan-id&gt;78&lt;/vlan-id&gt;
                &lt;vlan-id-present&gt;true&lt;/vlan-id-present&gt;
            &lt;/vlan-id&gt;
            &lt;vlan-pcp&gt;3&lt;/vlan-pcp&gt;
      &lt;/vlan-match&gt;
    &lt;/match&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;cookie&gt;15&lt;/cookie&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;flow-name&gt;FooXf15&lt;/flow-name&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;barrier&gt;false&lt;/barrier&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ethernet-src-dest-addresses-mpls-label-mpls-tc-mpls-bos">
<h5>Ethernet Src &amp; Dest Addresses, MPLS Label, MPLS TC, MPLS BoS<a class="headerlink" href="#ethernet-src-dest-addresses-mpls-label-mpls-tc-mpls-bos" title="Permalink to this headline">¶</a></h5>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;flow-name&gt;FooXf17&lt;/flow-name&gt;
    &lt;id&gt;140&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;17&lt;/cookie&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34887&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;protocol-match-fields&gt;
            &lt;mpls-label&gt;567&lt;/mpls-label&gt;
            &lt;mpls-tc&gt;3&lt;/mpls-tc&gt;
            &lt;mpls-bos&gt;1&lt;/mpls-bos&gt;
        &lt;/protocol-match-fields&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ipv6-src-dest-addresses">
<h5>IPv6 Src &amp; Dest Addresses<a class="headerlink" href="#ipv6-src-dest-addresses" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34525</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf18&lt;/flow-name&gt;
    &lt;id&gt;141&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;18&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;fe80::2acf:e9ff:fe21:6431/128&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;aabb:1234:2acf:e9ff::fe21:6431/64&lt;/ipv6-destination&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="metadata">
<h5>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h5>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf19&lt;/flow-name&gt;
    &lt;id&gt;142&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;19&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;1&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="metadata-metadata-mask">
<h5>Metadata, Metadata Mask<a class="headerlink" href="#metadata-metadata-mask" title="Permalink to this headline">¶</a></h5>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf20&lt;/flow-name&gt;
    &lt;id&gt;143&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;20&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
            &lt;metadata-mask&gt;//FF&lt;/metadata-mask&gt;
        &lt;/metadata&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-udp-src-dest-ports">
<h5>IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, UDP Src &amp; Dest Ports<a class="headerlink" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-udp-src-dest-ports" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34525</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf21&lt;/flow-name&gt;
    &lt;id&gt;144&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;21&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80::2acf:e9ff:fe21:6431/128&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;17&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;8&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;udp-source-port&gt;25364&lt;/udp-source-port&gt;
        &lt;udp-destination-port&gt;8080&lt;/udp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dest-ports">
<h5>IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, TCP Src &amp; Dest Ports<a class="headerlink" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dest-ports" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34525</li>
<li>Note that IP Protocol MUST be 6</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf22&lt;/flow-name&gt;
    &lt;id&gt;145&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;22&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/94&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;60&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;183&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dest-ports-ipv6-label">
<h5>IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, TCP Src &amp; Dest Ports, IPv6 Label<a class="headerlink" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dest-ports-ipv6-label" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34525</li>
<li>Note that IP Protocol MUST be 6</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf23&lt;/flow-name&gt;
    &lt;id&gt;146&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;23&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/94&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ipv6-label&gt;
            &lt;ipv6-flabel&gt;33&lt;/ipv6-flabel&gt;
        &lt;/ipv6-label&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;60&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;183&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="tunnel-id">
<h5>Tunnel ID<a class="headerlink" href="#tunnel-id" title="Permalink to this headline">¶</a></h5>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf24&lt;/flow-name&gt;
    &lt;id&gt;147&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;24&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;tunnel&gt;
            &lt;tunnel-id&gt;2591&lt;/tunnel-id&gt;
        &lt;/tunnel&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-icmpv6-type-code-ipv6-label">
<h5>IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, ICMPv6 Type &amp; Code, IPv6 Label<a class="headerlink" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-icmpv6-type-code-ipv6-label" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34525</li>
<li>Note that IP Protocol MUST be 58</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf25&lt;/flow-name&gt;
    &lt;id&gt;148&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;25&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/94&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ipv6-label&gt;
            &lt;ipv6-flabel&gt;33&lt;/ipv6-flabel&gt;
        &lt;/ipv6-label&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;58&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;60&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;icmpv6-match&gt;
            &lt;icmpv6-type&gt;6&lt;/icmpv6-type&gt;
            &lt;icmpv6-code&gt;3&lt;/icmpv6-code&gt;
        &lt;/icmpv6-match&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dst-ports-ipv6-label-ipv6-ext-header">
<h5>IPv6 Src &amp; Dest Addresses, Metadata, IP DSCP, IP ECN, TCP Src &amp; Dst Ports, IPv6 Label, IPv6 Ext Header<a class="headerlink" href="#ipv6-src-dest-addresses-metadata-ip-dscp-ip-ecn-tcp-src-dst-ports-ipv6-label-ipv6-ext-header" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Note that ethernet-type MUST be 34525</li>
<li>Note that IP Protocol MUST be 58</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf27&lt;/flow-name&gt;
    &lt;id&gt;150&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;27&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;dec-nw-ttl/&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/94&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ipv6-label&gt;
            &lt;ipv6-flabel&gt;33&lt;/ipv6-flabel&gt;
        &lt;/ipv6-label&gt;
        &lt;ipv6-ext-header&gt;
            &lt;ipv6-exthdr&gt;0&lt;/ipv6-exthdr&gt;
        &lt;/ipv6-ext-header&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;60&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;183&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="actions">
<h4>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h4>
<p>The format of the XML that describes OpenFlow actions is determined by
the opendaylight-action-types yang model: .</p>
<p>The RESTCONF documentation for the match-types yang model can be found
at
<a class="reference external" href="https://jenkins.opendaylight.org/controller/job/controller-merge/lastSuccessfulBuild/artifact/opendaylight/md-sal/model/model-flow-base/target/site/models/opendaylight-action-types.html">opendaylight-action-types.html</a></p>
<div class="section" id="apply-actions">
<h5>Apply Actions<a class="headerlink" href="#apply-actions" title="Permalink to this headline">¶</a></h5>
<div class="section" id="output-to-table">
<h6>Output to TABLE<a class="headerlink" href="#output-to-table" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf101&lt;/flow-name&gt;
    &lt;id&gt;256&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;101&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;TABLE&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/94&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;60&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;183&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-inport">
<h6>Output to INPORT<a class="headerlink" href="#output-to-inport" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf102&lt;/flow-name&gt;
    &lt;id&gt;257&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;102&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;INPORT&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
7            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;17.1.2.3/8&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/16&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;2&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;2&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;25364&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-physical-port">
<h6>Output to Physical Port<a class="headerlink" href="#output-to-physical-port" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf103&lt;/flow-name&gt;
    &lt;id&gt;258&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;103&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;1&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;ff:ff:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;17.1.2.3/8&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/16&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;2&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;2&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;25364&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-local">
<h6>Output to LOCAL<a class="headerlink" href="#output-to-local" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf104&lt;/flow-name&gt;
    &lt;id&gt;259&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;104&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;LOCAL&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/76&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/94&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;60&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;183&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;8080&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-normal">
<h6>Output to NORMAL<a class="headerlink" href="#output-to-normal" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf105&lt;/flow-name&gt;
    &lt;id&gt;260&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;105&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;NORMAL&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/84&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/90&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;45&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;2&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;20345&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;80&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-flood">
<h6>Output to FLOOD<a class="headerlink" href="#output-to-flood" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf106&lt;/flow-name&gt;
    &lt;id&gt;261&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;106&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;FLOOD&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34525&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv6-source&gt;1234:5678:9ABC:DEF0:FDCD:A987:6543:210F/100&lt;/ipv6-source&gt;
        &lt;ipv6-destination&gt;fe80:2acf:e9ff:fe21::6431/67&lt;/ipv6-destination&gt;
        &lt;metadata&gt;
            &lt;metadata&gt;12345&lt;/metadata&gt;
        &lt;/metadata&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;6&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;45&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;2&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;tcp-source-port&gt;20345&lt;/tcp-source-port&gt;
        &lt;tcp-destination-port&gt;80&lt;/tcp-destination-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-all">
<h6>Output to ALL<a class="headerlink" href="#output-to-all" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf107&lt;/flow-name&gt;
    &lt;id&gt;262&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;107&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;ALL&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;20:14:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;19.1.2.3/10&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/18&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;17&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;8&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;udp-source-port&gt;25364&lt;/udp-source-port&gt;
        &lt;udp-destination-port&gt;8080&lt;/udp-destination-port&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-controller">
<h6>Output to CONTROLLER<a class="headerlink" href="#output-to-controller" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf108&lt;/flow-name&gt;
    &lt;id&gt;263&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;108&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;CONTROLLER&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;20:14:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;19.1.2.3/10&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/18&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;17&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;8&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;udp-source-port&gt;25364&lt;/udp-source-port&gt;
        &lt;udp-destination-port&gt;8080&lt;/udp-destination-port&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="output-to-any">
<h6>Output to ANY<a class="headerlink" href="#output-to-any" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;flow-name&gt;FooXf109&lt;/flow-name&gt;
    &lt;id&gt;264&lt;/id&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;109&lt;/cookie&gt;
    &lt;table_id&gt;2&lt;/table_id&gt;
    &lt;priority&gt;2&lt;/priority&gt;
    &lt;hard-timeout&gt;1200&lt;/hard-timeout&gt;
    &lt;idle-timeout&gt;3400&lt;/idle-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;ANY&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
            &lt;ethernet-destination&gt;
                &lt;address&gt;20:14:29:01:19:61&lt;/address&gt;
            &lt;/ethernet-destination&gt;
            &lt;ethernet-source&gt;
                &lt;address&gt;00:00:00:11:23:ae&lt;/address&gt;
            &lt;/ethernet-source&gt;
        &lt;/ethernet-match&gt;
        &lt;ipv4-source&gt;19.1.2.3/10&lt;/ipv4-source&gt;
        &lt;ipv4-destination&gt;172.168.5.6/18&lt;/ipv4-destination&gt;
        &lt;ip-match&gt;
            &lt;ip-protocol&gt;17&lt;/ip-protocol&gt;
            &lt;ip-dscp&gt;8&lt;/ip-dscp&gt;
            &lt;ip-ecn&gt;3&lt;/ip-ecn&gt;
        &lt;/ip-match&gt;
        &lt;udp-source-port&gt;25364&lt;/udp-source-port&gt;
        &lt;udp-destination-port&gt;8080&lt;/udp-destination-port&gt;
        &lt;in-port&gt;0&lt;/in-port&gt;
    &lt;/match&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="push-vlan">
<h6>Push VLAN<a class="headerlink" href="#push-vlan" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
   &lt;strict&gt;false&lt;/strict&gt;
   &lt;instructions&gt;
       &lt;instruction&gt;
           &lt;order&gt;0&lt;/order&gt;
           &lt;apply-actions&gt;
              &lt;action&gt;
                 &lt;push-vlan-action&gt;
                     &lt;ethernet-type&gt;33024&lt;/ethernet-type&gt;
                 &lt;/push-vlan-action&gt;
                 &lt;order&gt;0&lt;/order&gt;
              &lt;/action&gt;
               &lt;action&gt;
                   &lt;set-field&gt;
                       &lt;vlan-match&gt;
                            &lt;vlan-id&gt;
                                &lt;vlan-id&gt;79&lt;/vlan-id&gt;
                                &lt;vlan-id-present&gt;true&lt;/vlan-id-present&gt;
                            &lt;/vlan-id&gt;
                       &lt;/vlan-match&gt;
                   &lt;/set-field&gt;
                   &lt;order&gt;1&lt;/order&gt;
               &lt;/action&gt;
               &lt;action&gt;
                   &lt;output-action&gt;
                       &lt;output-node-connector&gt;5&lt;/output-node-connector&gt;
                   &lt;/output-action&gt;
                   &lt;order&gt;2&lt;/order&gt;
               &lt;/action&gt;
           &lt;/apply-actions&gt;
       &lt;/instruction&gt;
   &lt;/instructions&gt;
   &lt;table_id&gt;0&lt;/table_id&gt;
   &lt;id&gt;31&lt;/id&gt;
   &lt;match&gt;
       &lt;ethernet-match&gt;
           &lt;ethernet-type&gt;
               &lt;type&gt;2048&lt;/type&gt;
           &lt;/ethernet-type&gt;
           &lt;ethernet-destination&gt;
               &lt;address&gt;FF:FF:29:01:19:61&lt;/address&gt;
           &lt;/ethernet-destination&gt;
           &lt;ethernet-source&gt;
               &lt;address&gt;00:00:00:11:23:AE&lt;/address&gt;
           &lt;/ethernet-source&gt;
       &lt;/ethernet-match&gt;
     &lt;in-port&gt;1&lt;/in-port&gt;
   &lt;/match&gt;
   &lt;flow-name&gt;vlan_flow&lt;/flow-name&gt;
   &lt;priority&gt;2&lt;/priority&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="push-mpls">
<h6>Push MPLS<a class="headerlink" href="#push-mpls" title="Permalink to this headline">¶</a></h6>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow
    xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;flow-name&gt;push-mpls-action&lt;/flow-name&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;3&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;push-mpls-action&gt;
                        &lt;ethernet-type&gt;34887&lt;/ethernet-type&gt;
                    &lt;/push-mpls-action&gt;
                    &lt;order&gt;0&lt;/order&gt;
                &lt;/action&gt;
                &lt;action&gt;
                    &lt;set-field&gt;
                        &lt;protocol-match-fields&gt;
                            &lt;mpls-label&gt;27&lt;/mpls-label&gt;
                        &lt;/protocol-match-fields&gt;
                    &lt;/set-field&gt;
                    &lt;order&gt;1&lt;/order&gt;
                &lt;/action&gt;
                &lt;action&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;2&lt;/output-node-connector&gt;
                    &lt;/output-action&gt;
                    &lt;order&gt;2&lt;/order&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;id&gt;100&lt;/id&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;2048&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;in-port&gt;1&lt;/in-port&gt;
        &lt;ipv4-destination&gt;10.0.0.4/32&lt;/ipv4-destination&gt;
    &lt;/match&gt;
    &lt;idle-timeout&gt;0&lt;/idle-timeout&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;401&lt;/cookie&gt;
    &lt;priority&gt;8&lt;/priority&gt;
    &lt;hard-timeout&gt;0&lt;/hard-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;table_id&gt;0&lt;/table_id&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="swap-mpls">
<h6>Swap MPLS<a class="headerlink" href="#swap-mpls" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Note that ethernet-type MUST be 34887</li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow
    xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;flow-name&gt;push-mpls-action&lt;/flow-name&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;2&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;set-field&gt;
                        &lt;protocol-match-fields&gt;
                            &lt;mpls-label&gt;37&lt;/mpls-label&gt;
                        &lt;/protocol-match-fields&gt;
                    &lt;/set-field&gt;
                    &lt;order&gt;1&lt;/order&gt;
                &lt;/action&gt;
                &lt;action&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;2&lt;/output-node-connector&gt;
                    &lt;/output-action&gt;
                    &lt;order&gt;2&lt;/order&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;id&gt;101&lt;/id&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34887&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;in-port&gt;1&lt;/in-port&gt;
        &lt;protocol-match-fields&gt;
            &lt;mpls-label&gt;27&lt;/mpls-label&gt;
        &lt;/protocol-match-fields&gt;
    &lt;/match&gt;
    &lt;idle-timeout&gt;0&lt;/idle-timeout&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;cookie&gt;401&lt;/cookie&gt;
    &lt;priority&gt;8&lt;/priority&gt;
    &lt;hard-timeout&gt;0&lt;/hard-timeout&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;table_id&gt;0&lt;/table_id&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
<div class="section" id="pop-mpls">
<h6>Pop MPLS<a class="headerlink" href="#pop-mpls" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Note that ethernet-type MUST be 34887</li>
<li>Issue with OVS 2.1 <a class="reference external" href="http://git.openvswitch.org/cgi-bin/gitweb.cgi?p=openvswitch;a=commitdiff;h=b3f2fc93e3f357f8d05a92f53ec253339a40887f">OVS
fix</a></li>
</ul>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;
&lt;flow
    xmlns=&quot;urn:opendaylight:flow:inventory&quot;&gt;
    &lt;flow-name&gt;FooXf10&lt;/flow-name&gt;
    &lt;instructions&gt;
        &lt;instruction&gt;
            &lt;order&gt;0&lt;/order&gt;
            &lt;apply-actions&gt;
                &lt;action&gt;
                    &lt;pop-mpls-action&gt;
                        &lt;ethernet-type&gt;2048&lt;/ethernet-type&gt;
                    &lt;/pop-mpls-action&gt;
                    &lt;order&gt;1&lt;/order&gt;
                &lt;/action&gt;
                &lt;action&gt;
                    &lt;output-action&gt;
                        &lt;output-node-connector&gt;2&lt;/output-node-connector&gt;
                        &lt;max-length&gt;60&lt;/max-length&gt;
                    &lt;/output-action&gt;
                    &lt;order&gt;2&lt;/order&gt;
                &lt;/action&gt;
            &lt;/apply-actions&gt;
        &lt;/instruction&gt;
    &lt;/instructions&gt;
    &lt;id&gt;11&lt;/id&gt;
    &lt;strict&gt;false&lt;/strict&gt;
    &lt;match&gt;
        &lt;ethernet-match&gt;
            &lt;ethernet-type&gt;
                &lt;type&gt;34887&lt;/type&gt;
            &lt;/ethernet-type&gt;
        &lt;/ethernet-match&gt;
        &lt;in-port&gt;1&lt;/in-port&gt;
        &lt;protocol-match-fields&gt;
            &lt;mpls-label&gt;37&lt;/mpls-label&gt;
        &lt;/protocol-match-fields&gt;
    &lt;/match&gt;
    &lt;idle-timeout&gt;0&lt;/idle-timeout&gt;
    &lt;cookie&gt;889&lt;/cookie&gt;
    &lt;cookie_mask&gt;255&lt;/cookie_mask&gt;
    &lt;installHw&gt;false&lt;/installHw&gt;
    &lt;hard-timeout&gt;0&lt;/hard-timeout&gt;
    &lt;priority&gt;10&lt;/priority&gt;
    &lt;table_id&gt;0&lt;/table_id&gt;
&lt;/flow&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="opendaylight-openflow-plugin-troubleshooting">
<h3>Opendaylight OpenFlow Plugin: Troubleshooting<a class="headerlink" href="#opendaylight-openflow-plugin-troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>empty section</p>
</div>
</div>
<div class="section" id="opflex-agent-ovs-user-guide">
<h2>OpFlex agent-ovs User Guide<a class="headerlink" href="#opflex-agent-ovs-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id73">
<h3>Introduction<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h3>
<p>agent-ovs is a policy agent that works with OVS to enforce a group-based
policy networking model with locally attached virtual machines or
containers. The policy agent is designed to work well with orchestration
tools like OpenStack.</p>
</div>
<div class="section" id="agent-configuration">
<h3>Agent Configuration<a class="headerlink" href="#agent-configuration" title="Permalink to this headline">¶</a></h3>
<p>The agent configuration is handled using its config file which is by
default found at &#8220;/etc/opflex-agent-ovs/opflex-agent-ovs.conf&#8221;</p>
<p>Here is an example configuration file that documents the available
options:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="o">//</span> <span class="n">Logging</span> <span class="n">configuration</span>
    <span class="o">//</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="o">//</span>    <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;info&quot;</span>
    <span class="o">//</span> <span class="p">},</span>

    <span class="o">//</span> <span class="n">Configuration</span> <span class="n">related</span> <span class="n">to</span> <span class="n">the</span> <span class="n">OpFlex</span> <span class="n">protocol</span>
    <span class="s2">&quot;opflex&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">The</span> <span class="n">policy</span> <span class="n">domain</span> <span class="k">for</span> <span class="n">this</span> <span class="n">agent</span><span class="o">.</span>
        <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;openstack&quot;</span><span class="p">,</span>

        <span class="o">//</span> <span class="n">The</span> <span class="n">unique</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">policy</span> <span class="n">domain</span> <span class="k">for</span> <span class="n">this</span> <span class="n">agent</span><span class="o">.</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;example-agent&quot;</span><span class="p">,</span>

        <span class="o">//</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">peers</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span><span class="p">,</span> <span class="n">by</span> <span class="n">hostname</span> <span class="ow">and</span> <span class="n">port</span><span class="o">.</span>  <span class="n">One</span>
        <span class="o">//</span> <span class="n">peer</span><span class="p">,</span> <span class="ow">or</span> <span class="n">an</span> <span class="n">anycast</span> <span class="n">pseudo</span><span class="o">-</span><span class="n">peer</span><span class="p">,</span> <span class="ow">is</span> <span class="n">sufficient</span> <span class="n">to</span> <span class="n">bootstrap</span>
        <span class="o">//</span> <span class="n">the</span> <span class="n">connection</span> <span class="n">without</span> <span class="n">needing</span> <span class="n">an</span> <span class="n">exhaustive</span> <span class="nb">list</span> <span class="n">of</span> <span class="nb">all</span>
        <span class="o">//</span> <span class="n">peers</span><span class="o">.</span>
        <span class="s2">&quot;peers&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="o">//</span> <span class="n">EXAMPLE</span><span class="p">:</span>
            <span class="p">{</span><span class="s2">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.30&quot;</span><span class="p">,</span> <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">8009</span><span class="p">}</span>
        <span class="p">],</span>

        <span class="s2">&quot;ssl&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="o">//</span> <span class="n">SSL</span> <span class="n">mode</span><span class="o">.</span>  <span class="n">Possible</span> <span class="n">values</span><span class="p">:</span>
            <span class="o">//</span> <span class="n">disabled</span><span class="p">:</span> <span class="n">communicate</span> <span class="n">without</span> <span class="n">encryption</span>
            <span class="o">//</span> <span class="n">encrypted</span><span class="p">:</span> <span class="n">encrypt</span> <span class="n">but</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">verify</span> <span class="n">peers</span>
            <span class="o">//</span> <span class="n">secure</span><span class="p">:</span> <span class="n">encrypt</span> <span class="ow">and</span> <span class="n">verify</span> <span class="n">peer</span> <span class="n">certificates</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;disabled&quot;</span><span class="p">,</span>

            <span class="o">//</span> <span class="n">The</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">directory</span> <span class="n">containing</span> <span class="n">trusted</span> <span class="n">certificate</span>
            <span class="o">//</span> <span class="n">authority</span> <span class="n">public</span> <span class="n">certificates</span><span class="p">,</span> <span class="ow">or</span> <span class="n">a</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">a</span>
            <span class="o">//</span> <span class="n">specific</span> <span class="n">CA</span> <span class="n">certificate</span><span class="o">.</span>
            <span class="s2">&quot;ca-store&quot;</span><span class="p">:</span> <span class="s2">&quot;/etc/ssl/certs/&quot;</span>
        <span class="p">},</span>

        <span class="s2">&quot;inspector&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="o">//</span> <span class="n">Enable</span> <span class="n">the</span> <span class="n">MODB</span> <span class="n">inspector</span> <span class="n">service</span><span class="p">,</span> <span class="n">which</span> <span class="n">allows</span>
            <span class="o">//</span> <span class="n">inspecting</span> <span class="n">the</span> <span class="n">state</span> <span class="n">of</span> <span class="n">the</span> <span class="n">managed</span> <span class="nb">object</span> <span class="n">database</span><span class="o">.</span>
        <span class="o">//</span> <span class="n">Default</span><span class="p">:</span> <span class="n">enabled</span>
            <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>

            <span class="o">//</span> <span class="n">Listen</span> <span class="n">on</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">socket</span> <span class="k">for</span> <span class="n">the</span> <span class="n">inspector</span>
        <span class="o">//</span> <span class="n">Default</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">opflex</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">ovs</span><span class="o">-</span><span class="n">inspect</span><span class="o">.</span><span class="n">sock</span>
            <span class="s2">&quot;socket-name&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/run/opflex-agent-ovs-inspect.sock&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="o">//</span> <span class="n">Endpoint</span> <span class="n">sources</span> <span class="n">provide</span> <span class="n">metadata</span> <span class="n">about</span> <span class="n">local</span> <span class="n">endpoints</span>
    <span class="s2">&quot;endpoint-sources&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">Filesystem</span> <span class="n">path</span> <span class="n">to</span> <span class="n">monitor</span> <span class="k">for</span> <span class="n">endpoint</span> <span class="n">information</span>
        <span class="s2">&quot;filesystem&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;/var/lib/opflex-agent-ovs/endpoints&quot;</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="o">//</span> <span class="n">Renderers</span> <span class="n">enforce</span> <span class="n">policy</span> <span class="n">obtained</span> <span class="n">via</span> <span class="n">OpFlex</span><span class="o">.</span>
    <span class="s2">&quot;renderers&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">Stitched</span><span class="o">-</span><span class="n">mode</span> <span class="n">renderer</span> <span class="k">for</span> <span class="n">interoperating</span> <span class="k">with</span> <span class="n">a</span>
        <span class="o">//</span> <span class="n">hardware</span> <span class="n">fabric</span> <span class="n">such</span> <span class="k">as</span> <span class="n">ACI</span>
        <span class="o">//</span> <span class="n">EXAMPLE</span><span class="p">:</span>
        <span class="s2">&quot;stitched-mode&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ovs-bridge-name&quot;</span><span class="p">:</span> <span class="s2">&quot;br0&quot;</span><span class="p">,</span>

            <span class="o">//</span> <span class="n">Set</span> <span class="n">encapsulation</span> <span class="nb">type</span><span class="o">.</span>  <span class="n">Must</span> <span class="nb">set</span> <span class="n">either</span> <span class="n">vxlan</span> <span class="ow">or</span> <span class="n">vlan</span><span class="o">.</span>
            <span class="s2">&quot;encap&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="o">//</span> <span class="n">Encapsulate</span> <span class="n">traffic</span> <span class="k">with</span> <span class="n">VXLAN</span><span class="o">.</span>
                <span class="s2">&quot;vxlan&quot;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="o">//</span> <span class="n">The</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">tunnel</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">OVS</span>
                    <span class="s2">&quot;encap-iface&quot;</span><span class="p">:</span> <span class="s2">&quot;br0_vxlan0&quot;</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">The</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">interface</span> <span class="n">whose</span> <span class="n">IP</span> <span class="n">should</span> <span class="n">be</span> <span class="n">used</span>
                    <span class="o">//</span> <span class="k">as</span> <span class="n">the</span> <span class="n">source</span> <span class="n">IP</span> <span class="ow">in</span> <span class="n">encapsulated</span> <span class="n">traffic</span><span class="o">.</span>
                    <span class="s2">&quot;uplink-iface&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0.4093&quot;</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">The</span> <span class="n">vlan</span> <span class="n">tag</span><span class="p">,</span> <span class="k">if</span> <span class="nb">any</span><span class="p">,</span> <span class="n">used</span> <span class="n">on</span> <span class="n">the</span> <span class="n">uplink</span> <span class="n">interface</span><span class="o">.</span>
                    <span class="o">//</span> <span class="n">Set</span> <span class="n">to</span> <span class="n">zero</span> <span class="ow">or</span> <span class="n">omit</span> <span class="k">if</span> <span class="n">the</span> <span class="n">uplink</span> <span class="ow">is</span> <span class="n">untagged</span><span class="o">.</span>
                    <span class="s2">&quot;uplink-vlan&quot;</span><span class="p">:</span> <span class="mi">4093</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">The</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">used</span> <span class="k">for</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">IP</span> <span class="ow">in</span>
                    <span class="o">//</span> <span class="n">the</span> <span class="n">encapsulated</span> <span class="n">traffic</span><span class="o">.</span>  <span class="n">This</span> <span class="n">should</span> <span class="n">be</span> <span class="n">an</span>
                    <span class="o">//</span> <span class="n">anycast</span> <span class="n">IP</span> <span class="n">address</span> <span class="n">understood</span> <span class="n">by</span> <span class="n">the</span> <span class="n">upstream</span>
                    <span class="o">//</span> <span class="n">stiched</span><span class="o">-</span><span class="n">mode</span> <span class="n">fabric</span><span class="o">.</span>
                    <span class="s2">&quot;remote-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.32&quot;</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">UDP</span> <span class="n">port</span> <span class="n">number</span> <span class="n">of</span> <span class="n">the</span> <span class="n">encapsulated</span> <span class="n">traffic</span><span class="o">.</span>
                    <span class="s2">&quot;remote-port&quot;</span><span class="p">:</span> <span class="mi">8472</span>
                <span class="p">}</span>

                <span class="o">//</span> <span class="n">Encapsulate</span> <span class="n">traffic</span> <span class="k">with</span> <span class="n">a</span> <span class="n">locally</span><span class="o">-</span><span class="n">significant</span> <span class="n">VLAN</span>
                <span class="o">//</span> <span class="n">tag</span>
                <span class="o">//</span> <span class="n">EXAMPLE</span><span class="p">:</span>
                <span class="o">//</span> <span class="s2">&quot;vlan&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="o">//</span>     <span class="o">//</span> <span class="n">The</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">uplink</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">OVS</span>
                <span class="o">//</span>     <span class="s2">&quot;encap-iface&quot;</span><span class="p">:</span> <span class="s2">&quot;team0&quot;</span>
                <span class="o">//</span> <span class="p">}</span>
            <span class="p">},</span>

            <span class="o">//</span> <span class="n">Configure</span> <span class="n">forwarding</span> <span class="n">policy</span>
            <span class="s2">&quot;forwarding&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="o">//</span> <span class="n">Configure</span> <span class="n">the</span> <span class="n">virtual</span> <span class="n">distributed</span> <span class="n">router</span>
                <span class="s2">&quot;virtual-router&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="o">//</span> <span class="n">Enable</span> <span class="n">virtual</span> <span class="n">distributed</span> <span class="n">router</span><span class="o">.</span>  <span class="n">Set</span> <span class="n">to</span> <span class="n">true</span>
                    <span class="o">//</span> <span class="n">to</span> <span class="n">enable</span> <span class="ow">or</span> <span class="n">false</span> <span class="n">to</span> <span class="n">disable</span><span class="o">.</span>  <span class="n">Default</span> <span class="n">true</span><span class="o">.</span>
                    <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">Override</span> <span class="n">MAC</span> <span class="n">address</span> <span class="k">for</span> <span class="n">virtual</span> <span class="n">router</span><span class="o">.</span>
                    <span class="o">//</span> <span class="n">Default</span> <span class="ow">is</span> <span class="s2">&quot;00:22:bd:f8:19:ff&quot;</span>
                    <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;00:22:bd:f8:19:ff&quot;</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">Configure</span> <span class="n">IPv6</span><span class="o">-</span><span class="n">related</span> <span class="n">settings</span> <span class="k">for</span> <span class="n">the</span> <span class="n">virtual</span>
                    <span class="o">//</span> <span class="n">router</span>
                    <span class="s2">&quot;ipv6&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="o">//</span> <span class="n">Send</span> <span class="n">router</span> <span class="n">advertisement</span> <span class="n">messages</span> <span class="ow">in</span>
                        <span class="o">//</span> <span class="n">response</span> <span class="n">to</span> <span class="n">router</span> <span class="n">solicitation</span> <span class="n">requests</span> <span class="k">as</span>
                        <span class="o">//</span> <span class="n">well</span> <span class="k">as</span> <span class="n">unsolicited</span> <span class="n">advertisements</span><span class="o">.</span>  <span class="n">This</span>
                        <span class="o">//</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">required</span> <span class="ow">in</span> <span class="n">stitched</span> <span class="n">mode</span> <span class="n">since</span> <span class="n">the</span>
                        <span class="o">//</span> <span class="n">hardware</span> <span class="n">router</span> <span class="n">will</span> <span class="n">send</span> <span class="n">them</span><span class="o">.</span>
                        <span class="s2">&quot;router-advertisement&quot;</span><span class="p">:</span> <span class="n">true</span>
                    <span class="p">}</span>
                <span class="p">},</span>

                <span class="o">//</span> <span class="n">Configure</span> <span class="n">virtual</span> <span class="n">distributed</span> <span class="n">DHCP</span> <span class="n">server</span>
                <span class="s2">&quot;virtual-dhcp&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="o">//</span> <span class="n">Enable</span> <span class="n">virtual</span> <span class="n">distributed</span> <span class="n">DHCP</span> <span class="n">server</span><span class="o">.</span>  <span class="n">Set</span> <span class="n">to</span>
                    <span class="o">//</span> <span class="n">true</span> <span class="n">to</span> <span class="n">enable</span> <span class="ow">or</span> <span class="n">false</span> <span class="n">to</span> <span class="n">disable</span><span class="o">.</span>  <span class="n">Default</span>
                    <span class="o">//</span> <span class="n">true</span><span class="o">.</span>
                    <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>

                    <span class="o">//</span> <span class="n">Override</span> <span class="n">MAC</span> <span class="n">address</span> <span class="k">for</span> <span class="n">virtual</span> <span class="n">dhcp</span> <span class="n">server</span><span class="o">.</span>
                    <span class="o">//</span> <span class="n">Default</span> <span class="ow">is</span> <span class="s2">&quot;00:22:bd:f8:19:ff&quot;</span>
                    <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;00:22:bd:f8:19:ff&quot;</span>
                <span class="p">},</span>

                <span class="s2">&quot;endpoint-advertisements&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="o">//</span> <span class="n">Enable</span> <span class="n">generation</span> <span class="n">of</span> <span class="n">periodic</span> <span class="n">ARP</span><span class="o">/</span><span class="n">NDP</span>
                    <span class="o">//</span> <span class="n">advertisements</span> <span class="k">for</span> <span class="n">endpoints</span><span class="o">.</span>  <span class="n">Default</span> <span class="n">true</span><span class="o">.</span>
                    <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>

            <span class="o">//</span> <span class="n">Location</span> <span class="n">to</span> <span class="n">store</span> <span class="n">cached</span> <span class="n">IDs</span> <span class="k">for</span> <span class="n">managing</span> <span class="n">flow</span> <span class="n">state</span>
            <span class="s2">&quot;flowid-cache-dir&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/lib/opflex-agent-ovs/ids&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="endpoint-registration">
<h3>Endpoint Registration<a class="headerlink" href="#endpoint-registration" title="Permalink to this headline">¶</a></h3>
<p>The agent learns about endpoints using endpoint metadata files located
by default in &#8220;/var/lib/opflex-agent-ovs/endpoints&#8221;.</p>
<p>These are JSON-format files such as the (unusually complex) example
below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;83f18f0b-80f7-46e2-b06c-4d9487b0c754&quot;</span><span class="p">,</span>
    <span class="s2">&quot;policy-space-name&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;endpoint-group-name&quot;</span><span class="p">:</span> <span class="s2">&quot;group1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interface-name&quot;</span><span class="p">:</span> <span class="s2">&quot;veth0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;fd8f:69d8:c12c:ca62::1&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;dhcp4&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.200.44.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prefix-len&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
        <span class="s2">&quot;routers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10.200.44.1&quot;</span><span class="p">],</span>
        <span class="s2">&quot;dns-servers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;8.8.8.8&quot;</span><span class="p">,</span> <span class="s2">&quot;8.8.4.4&quot;</span><span class="p">],</span>
        <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;example.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;static-routes&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;169.254.169.0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dest-prefix&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
                <span class="s2">&quot;next-hop&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;dhcp6&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;dns-servers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2001:4860:4860::8888&quot;</span><span class="p">,</span> <span class="s2">&quot;2001:4860:4860::8844&quot;</span><span class="p">],</span>
        <span class="s2">&quot;search-list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;test1.example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;example.com&quot;</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;ip-address-mapping&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
           <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;91c5b217-d244-432c-922d-533c6c036ab4&quot;</span><span class="p">,</span>
           <span class="s2">&quot;floating-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;5.5.5.1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;mapped-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;policy-space-name&quot;</span><span class="p">:</span> <span class="s2">&quot;common&quot;</span><span class="p">,</span>
           <span class="s2">&quot;endpoint-group-name&quot;</span><span class="p">:</span> <span class="s2">&quot;nat-epg&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
           <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;22bfdc01-a390-4b6f-9b10-624d4ccb957b&quot;</span><span class="p">,</span>
           <span class="s2">&quot;floating-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;fdf1:9f86:d1af:6cc9::1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;mapped-ip&quot;</span><span class="p">:</span> <span class="s2">&quot;fd8f:69d8:c12c:ca62::1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;policy-space-name&quot;</span><span class="p">:</span> <span class="s2">&quot;common&quot;</span><span class="p">,</span>
           <span class="s2">&quot;endpoint-group-name&quot;</span><span class="p">:</span> <span class="s2">&quot;nat-epg&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:01&quot;</span><span class="p">,</span>
    <span class="s2">&quot;promiscuous-mode&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The possible parameters for these files are:</p>
<dl class="docutils">
<dt><strong>uuid</strong></dt>
<dd>A globally unique ID for the endpoint</dd>
<dt><strong>endpoint-group-name</strong></dt>
<dd>The name of the endpoint group for the endpoint</dd>
<dt><strong>policy-space-name</strong></dt>
<dd>The name of the policy space for the endpoint group.</dd>
<dt><strong>interface-name</strong></dt>
<dd>The name of the OVS interface to which the endpoint is attached</dd>
<dt><strong>ip</strong></dt>
<dd>A list of strings contains either IPv4 or IPv6 addresses that the
endpoint is allowed to use</dd>
<dt><strong>mac</strong></dt>
<dd>The MAC address for the endpoint’s interface.</dd>
<dt><strong>promiscuous-mode</strong></dt>
<dd>Allow traffic from this VM to bypass default port security</dd>
<dt><strong>dhcp4</strong></dt>
<dd>A distributed DHCPv4 configuration block (see below)</dd>
<dt><strong>dhcp6</strong></dt>
<dd>A distributed DHCPv6 configuration block (see below)</dd>
<dt><strong>ip-address-mapping</strong></dt>
<dd>A list of IP address mapping configuration blocks (see below)</dd>
</dl>
<p>DHCPv4 configuration blocks can contain the following parameters:</p>
<dl class="docutils">
<dt><strong>ip</strong></dt>
<dd>the IP address to return with DHCP. Must be one of the configured
IPv4 addresses.</dd>
<dt><strong>prefix</strong></dt>
<dd>the subnet prefix length</dd>
<dt><strong>routers</strong></dt>
<dd>a list of default gateways for the endpoint</dd>
<dt><strong>dns</strong></dt>
<dd>a list of DNS server addresses</dd>
<dt><strong>domain</strong></dt>
<dd>The domain name parameter to send in the DHCP reply</dd>
<dt><strong>static-routes</strong></dt>
<dd>A list of static route configuration blocks, which contains a
&#8220;dest&#8221;, &#8220;dest-prefix&#8221;, and &#8220;next-hop&#8221; parameters to send as static
routes to the end host</dd>
</dl>
<p>DHCPv6 configuration blocks can contain the following parameters:</p>
<dl class="docutils">
<dt><strong>dns</strong></dt>
<dd>A list of DNS servers for the endpoint</dd>
<dt><strong>search-patch</strong></dt>
<dd>The DNS search path for the endpoint</dd>
</dl>
<p>IP address mapping configuration blocks can contain the following
parameters:</p>
<dl class="docutils">
<dt><strong>uuid</strong></dt>
<dd>a globally unique ID for the virtual endpoint created by the
mapping.</dd>
<dt><strong>floating-ip</strong></dt>
<dd>Map using DNAT to this floating IPv4 or IPv6 address</dd>
<dt><strong>mapped-ip</strong></dt>
<dd>the source IPv4 or IPv6 address; must be one of the IPs assigned to
the endpoint.</dd>
<dt><strong>endpoint-group-name</strong></dt>
<dd>The name of the endpoint group for the NATed IP</dd>
<dt><strong>policy-space-name</strong></dt>
<dd>The name of the policy space for the NATed IP</dd>
</dl>
</div>
<div class="section" id="inspector">
<h3>Inspector<a class="headerlink" href="#inspector" title="Permalink to this headline">¶</a></h3>
<p>The Opflex inspector is a useful command-line tool that will allow you
to inspect the state of the managed object database for the agent for
debugging and diagnosis purposes.</p>
<p>The command is called &#8220;gbp_inspect&#8221; and takes the following arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># gbp_inspect -h</span>
<span class="n">Usage</span><span class="p">:</span> <span class="o">./</span><span class="n">gbp_inspect</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span>
<span class="n">Allowed</span> <span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span> <span class="p">[</span> <span class="o">--</span><span class="n">help</span> <span class="p">]</span>                         <span class="n">Print</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span>
  <span class="o">--</span><span class="n">log</span> <span class="n">arg</span>                             <span class="n">Log</span> <span class="n">to</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">file</span> <span class="p">(</span><span class="n">default</span>
                                        <span class="n">standard</span> <span class="n">out</span><span class="p">)</span>
  <span class="o">--</span><span class="n">level</span> <span class="n">arg</span> <span class="p">(</span><span class="o">=</span><span class="n">warning</span><span class="p">)</span>                <span class="n">Use</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">log</span> <span class="n">level</span> <span class="p">(</span><span class="n">default</span>
                                        <span class="n">info</span><span class="p">)</span>
  <span class="o">--</span><span class="n">syslog</span>                              <span class="n">Log</span> <span class="n">to</span> <span class="n">syslog</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">file</span> <span class="ow">or</span>
                                        <span class="n">standard</span> <span class="n">out</span>
  <span class="o">--</span><span class="n">socket</span> <span class="n">arg</span> <span class="p">(</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">opflex</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">ovs</span><span class="o">-</span><span class="n">inspect</span><span class="o">.</span><span class="n">sock</span><span class="p">)</span>
                                        <span class="n">Connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">UNIX</span> <span class="n">domain</span>
                                        <span class="n">socket</span> <span class="p">(</span><span class="n">default</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">opfl</span>
                                        <span class="n">ex</span><span class="o">-</span><span class="n">agent</span><span class="o">-</span><span class="n">ovs</span><span class="o">-</span><span class="n">inspect</span><span class="o">.</span><span class="n">sock</span><span class="p">)</span>
  <span class="o">-</span><span class="n">q</span> <span class="p">[</span> <span class="o">--</span><span class="n">query</span> <span class="p">]</span> <span class="n">arg</span>                    <span class="n">Query</span> <span class="k">for</span> <span class="n">a</span> <span class="n">specific</span> <span class="nb">object</span> <span class="k">with</span>
                                        <span class="n">subjectname</span><span class="p">,</span><span class="n">uri</span> <span class="ow">or</span> <span class="nb">all</span> <span class="n">objects</span> <span class="n">of</span> <span class="n">a</span>
                                        <span class="n">specific</span> <span class="nb">type</span> <span class="k">with</span> <span class="n">subjectname</span>
  <span class="o">-</span><span class="n">r</span> <span class="p">[</span> <span class="o">--</span><span class="n">recursive</span> <span class="p">]</span>                    <span class="n">Retrieve</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">subtree</span> <span class="k">for</span> <span class="n">each</span>
                                        <span class="n">returned</span> <span class="nb">object</span>
  <span class="o">-</span><span class="n">f</span> <span class="p">[</span> <span class="o">--</span><span class="n">follow</span><span class="o">-</span><span class="n">refs</span> <span class="p">]</span>                  <span class="n">Follow</span> <span class="n">references</span> <span class="ow">in</span> <span class="n">returned</span> <span class="n">objects</span>
  <span class="o">--</span><span class="n">load</span> <span class="n">arg</span>                            <span class="n">Load</span> <span class="n">managed</span> <span class="n">objects</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">specified</span>
                                        <span class="n">file</span> <span class="n">into</span> <span class="n">the</span> <span class="n">MODB</span> <span class="n">view</span>
  <span class="o">-</span><span class="n">o</span> <span class="p">[</span> <span class="o">--</span><span class="n">output</span> <span class="p">]</span> <span class="n">arg</span>                   <span class="n">Output</span> <span class="n">the</span> <span class="n">results</span> <span class="n">to</span> <span class="n">the</span> <span class="n">specified</span>
                                        <span class="n">file</span> <span class="p">(</span><span class="n">default</span> <span class="n">standard</span> <span class="n">out</span><span class="p">)</span>
  <span class="o">-</span><span class="n">t</span> <span class="p">[</span> <span class="o">--</span><span class="nb">type</span> <span class="p">]</span> <span class="n">arg</span> <span class="p">(</span><span class="o">=</span><span class="n">tree</span><span class="p">)</span>             <span class="n">Specify</span> <span class="n">the</span> <span class="n">output</span> <span class="nb">format</span><span class="p">:</span> <span class="n">tree</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span>
                                        <span class="ow">or</span> <span class="n">dump</span> <span class="p">(</span><span class="n">default</span> <span class="n">tree</span><span class="p">)</span>
  <span class="o">-</span><span class="n">p</span> <span class="p">[</span> <span class="o">--</span><span class="n">props</span> <span class="p">]</span>                        <span class="n">Include</span> <span class="nb">object</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">output</span>
</pre></div>
</div>
<p>Here are some examples of the ways to use this tool.</p>
<p>You can get information about the running system using one or more
queries, which consist of an object model class name and optionally the
URI of a specific object. The simplest query is to get a single object,
nonrecursively:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># gbp_inspect -q DmtreeRoot</span>
<span class="o">--*</span> <span class="n">DmtreeRoot</span><span class="p">,</span><span class="o">/</span>
<span class="c1"># gbp_inspect -q GbpEpGroup</span>
<span class="o">--*</span> <span class="n">GbpEpGroup</span><span class="p">,</span><span class="o">/</span><span class="n">PolicyUniverse</span><span class="o">/</span><span class="n">PolicySpace</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">GbpEpGroup</span><span class="o">/</span><span class="n">nat</span><span class="o">-</span><span class="n">epg</span><span class="o">/</span>
<span class="o">--*</span> <span class="n">GbpEpGroup</span><span class="p">,</span><span class="o">/</span><span class="n">PolicyUniverse</span><span class="o">/</span><span class="n">PolicySpace</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">GbpEpGroup</span><span class="o">/</span><span class="n">group1</span><span class="o">/</span>
<span class="c1"># gbp_inspect -q GbpEpGroup,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/</span>
<span class="o">--*</span> <span class="n">GbpEpGroup</span><span class="p">,</span><span class="o">/</span><span class="n">PolicyUniverse</span><span class="o">/</span><span class="n">PolicySpace</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">GbpEpGroup</span><span class="o">/</span><span class="n">nat</span><span class="o">-</span><span class="n">epg</span><span class="o">/</span>
</pre></div>
</div>
<p>You can also display all the properties for each object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># gbp_inspect -p -q GbpeL24Classifier</span>
<span class="o">--*</span> <span class="n">GbpeL24Classifier</span><span class="p">,</span><span class="o">/</span><span class="n">PolicyUniverse</span><span class="o">/</span><span class="n">PolicySpace</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">GbpeL24Classifier</span><span class="o">/</span><span class="n">classifier4</span><span class="o">/</span>
     <span class="p">{</span>
       <span class="n">connectionTracking</span> <span class="p">:</span> <span class="mi">1</span> <span class="p">(</span><span class="n">reflexive</span><span class="p">)</span>
       <span class="n">dFromPort</span>          <span class="p">:</span> <span class="mi">80</span>
       <span class="n">dToPort</span>            <span class="p">:</span> <span class="mi">80</span>
       <span class="n">etherT</span>             <span class="p">:</span> <span class="mi">2048</span> <span class="p">(</span><span class="n">ipv4</span><span class="p">)</span>
       <span class="n">name</span>               <span class="p">:</span> <span class="n">classifier4</span>
       <span class="n">prot</span>               <span class="p">:</span> <span class="mi">6</span>
     <span class="p">}</span>
<span class="o">--*</span> <span class="n">GbpeL24Classifier</span><span class="p">,</span><span class="o">/</span><span class="n">PolicyUniverse</span><span class="o">/</span><span class="n">PolicySpace</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">GbpeL24Classifier</span><span class="o">/</span><span class="n">classifier3</span><span class="o">/</span>
     <span class="p">{</span>
       <span class="n">etherT</span> <span class="p">:</span> <span class="mi">34525</span> <span class="p">(</span><span class="n">ipv6</span><span class="p">)</span>
       <span class="n">name</span>   <span class="p">:</span> <span class="n">classifier3</span>
       <span class="n">order</span>  <span class="p">:</span> <span class="mi">100</span>
       <span class="n">prot</span>   <span class="p">:</span> <span class="mi">58</span>
     <span class="p">}</span>
<span class="o">--*</span> <span class="n">GbpeL24Classifier</span><span class="p">,</span><span class="o">/</span><span class="n">PolicyUniverse</span><span class="o">/</span><span class="n">PolicySpace</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">GbpeL24Classifier</span><span class="o">/</span><span class="n">classifier2</span><span class="o">/</span>
     <span class="p">{</span>
       <span class="n">etherT</span> <span class="p">:</span> <span class="mi">2048</span> <span class="p">(</span><span class="n">ipv4</span><span class="p">)</span>
       <span class="n">name</span>   <span class="p">:</span> <span class="n">classifier2</span>
       <span class="n">order</span>  <span class="p">:</span> <span class="mi">101</span>
       <span class="n">prot</span>   <span class="p">:</span> <span class="mi">1</span>
     <span class="p">}</span>
</pre></div>
</div>
<p>You can also request to get the all the children of an object you query
for:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># gbp_inspect -r -q GbpEpGroup,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/
--* GbpEpGroup,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/
  |-* GbpeInstContext,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/GbpeInstContext/
  `-* GbpEpGroupToNetworkRSrc,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/GbpEpGroupToNetworkRSrc/
</pre></div>
</div>
<p>You can also follow references found in any object downloads:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span># gbp_inspect -fr -q GbpEpGroup,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/
--* GbpEpGroup,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/
  |-* GbpeInstContext,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/GbpeInstContext/
  `-* GbpEpGroupToNetworkRSrc,/PolicyUniverse/PolicySpace/common/GbpEpGroup/nat-epg/GbpEpGroupToNetworkRSrc/
--* GbpFloodDomain,/PolicyUniverse/PolicySpace/common/GbpFloodDomain/fd_ext/
  `-* GbpFloodDomainToNetworkRSrc,/PolicyUniverse/PolicySpace/common/GbpFloodDomain/fd_ext/GbpFloodDomainToNetworkRSrc/
--* GbpBridgeDomain,/PolicyUniverse/PolicySpace/common/GbpBridgeDomain/bd_ext/
  `-* GbpBridgeDomainToNetworkRSrc,/PolicyUniverse/PolicySpace/common/GbpBridgeDomain/bd_ext/GbpBridgeDomainToNetworkRSrc/
--* GbpRoutingDomain,/PolicyUniverse/PolicySpace/common/GbpRoutingDomain/rd_ext/
  |-* GbpRoutingDomainToIntSubnetsRSrc,/PolicyUniverse/PolicySpace/common/GbpRoutingDomain/rd_ext/GbpRoutingDomainToIntSubnetsRSrc/122/%2fPolicyUniverse%2fPolicySpace%2fcommon%2fGbpSubnets%2fsubnets_ext%2f/
  `-* GbpForwardingBehavioralGroupToSubnetsRSrc,/PolicyUniverse/PolicySpace/common/GbpRoutingDomain/rd_ext/GbpForwardingBehavioralGroupToSubnetsRSrc/
--* GbpSubnets,/PolicyUniverse/PolicySpace/common/GbpSubnets/subnets_ext/
  |-* GbpSubnet,/PolicyUniverse/PolicySpace/common/GbpSubnets/subnets_ext/GbpSubnet/subnet_ext4/
  `-* GbpSubnet,/PolicyUniverse/PolicySpace/common/GbpSubnets/subnets_ext/GbpSubnet/subnet_ext6/
</pre></div>
</div>
</div>
</div>
<div class="section" id="pcep-user-guide">
<h2>PCEP User Guide<a class="headerlink" href="#pcep-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id74">
<h3>Overview<a class="headerlink" href="#id74" title="Permalink to this headline">¶</a></h3>
<p>The OpenDaylight Karaf distribution comes preconfigured with baseline
PCEP configuration.</p>
<ul class="simple">
<li><strong>32-pcep.xml</strong> (basic PCEP configuration, including session
parameters)</li>
<li><strong>39-pcep-provider.xml</strong> (configuring for PCEP provider)</li>
</ul>
</div>
<div class="section" id="configuring-pcep">
<h3>Configuring PCEP<a class="headerlink" href="#configuring-pcep" title="Permalink to this headline">¶</a></h3>
<p>The default shipped configuration will start a PCE server on
0.0.0.0:4189. You can change this behavior in <strong>39-pcep-provider.xml</strong>:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:topology:provider&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">pcep</span><span class="o">-</span><span class="n">topology</span><span class="o">-</span><span class="n">provider</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">pcep</span><span class="o">-</span><span class="n">topology</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">listen</span><span class="o">-</span><span class="n">address</span><span class="o">&gt;</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">122.55</span><span class="o">&lt;/</span><span class="n">listen</span><span class="o">-</span><span class="n">address</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">listen</span><span class="o">-</span><span class="n">port</span><span class="o">&gt;</span><span class="mi">4189</span><span class="o">&lt;/</span><span class="n">listen</span><span class="o">-</span><span class="n">port</span><span class="o">&gt;</span>
<span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>listen-address</strong> - adress on which PCE will be started and listen</li>
<li><strong>listen-port</strong> - port on which the address will be started and
listen</li>
</ul>
<p>PCEP default configuration is set to conform stateful PCEP extension:</p>
<p><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-pce-stateful-pce">draft-ietf-pce-stateful-pce</a>
- in versions 02 and 07</p>
<div class="section" id="pcep-segment-routing">
<h4>PCEP Segment Routing<a class="headerlink" href="#pcep-segment-routing" title="Permalink to this headline">¶</a></h4>
<p>Conforms
<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-pce-segment-routing-01">draft-eitf-pce-segment-routing</a>
- PCEP extension for Segment Routing</p>
<p>The default configuration file is located in etc/opendaylight/karaf.</p>
<ul class="simple">
<li><strong>33-pcep-segment-routing.xml</strong> - You don’t need to edit this file.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="packetcable-user-guide">
<h2>PacketCable User Guide<a class="headerlink" href="#packetcable-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id75">
<h3>Overview<a class="headerlink" href="#id75" title="Permalink to this headline">¶</a></h3>
<p>These components introduce a DOCSIS QoS Gates management using the PCMM
protocol. The driver component is responsible for the PCMM/COPS/PDP
functionality required to service requests from PacketCable Provider and
FlowManager. Requests are transposed into PCMM Gate Control messages and
transmitted via COPS to the CMTS. This plugin adheres to the
PCMM/COPS/PDP functionality defined in the CableLabs specification.
PacketCable solution is an MDSAL compliant component.</p>
</div>
<div class="section" id="packetcable-components">
<h3>PacketCable Components<a class="headerlink" href="#packetcable-components" title="Permalink to this headline">¶</a></h3>
<p>PacketCable is comprised of two OpenDaylight bundles:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Bundle</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>odl-packetcable-policy-server</td>
<td>Plugin that provides PCMM model
implementation based on CMTS
structure and COPS protocol.</td>
</tr>
<tr class="row-odd"><td>odl-packetcable-policy-model</td>
<td>The Model provided provides a direct
mapping to the underlying QoS Gates
of CMTS.</td>
</tr>
</tbody>
</table>
<p>See the PacketCable <a class="reference external" href="https://git.opendaylight.org/gerrit/gitweb?p=packetcable.git;a=tree;f=packetcable-policy-model/src/main/yang">YANG
Models</a>.</p>
</div>
<div class="section" id="installing-packetcable">
<h3>Installing PacketCable<a class="headerlink" href="#installing-packetcable" title="Permalink to this headline">¶</a></h3>
<p>To install PacketCable, run the following <code class="docutils literal"><span class="pre">feature:install</span></code> command
from the Karaf CLI</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">packetcable</span><span class="o">-</span><span class="n">policy</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="nb">all</span> <span class="n">odl</span><span class="o">-</span><span class="n">restconf</span> <span class="n">odl</span><span class="o">-</span><span class="n">mdsal</span><span class="o">-</span><span class="n">apidocs</span>
</pre></div>
</div>
</div>
<div class="section" id="explore-and-exercise-the-packetcable-rest-api">
<h3>Explore and exercise the PacketCable REST API<a class="headerlink" href="#explore-and-exercise-the-packetcable-rest-api" title="Permalink to this headline">¶</a></h3>
<p>To see the PacketCable APIs, browse to this URL:
<a class="reference external" href="http://localhost:8181/apidoc/explorer/index.html">http://localhost:8181/apidoc/explorer/index.html</a></p>
<p>Replace localhost with the IP address or hostname where OpenDaylight is
running if you are not running OpenDaylight locally on your machine.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Prior to setting any PCMM gates, a CCAP must first be added.</p>
</div></blockquote>
</div>
<div class="section" id="postman">
<h3>Postman<a class="headerlink" href="#postman" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en">Install the Chrome
extension</a></p>
<p><a class="reference external" href="https://git.opendaylight.org/gerrit/gitweb?p=packetcable.git;a=tree;f=packetcable-policy-server/doc/restconf-samples">Download and import sample packetcable
collection</a></p>
<div class="figure" id="id224">
<img alt="Postman Operations" src="../_images/Screenshot5.png" />
<p class="caption"><span class="caption-text">Postman Operations</span></p>
</div>
</div>
</div>
<div class="section" id="service-function-chaining">
<h2>Service Function Chaining<a class="headerlink" href="#service-function-chaining" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opendaylight-service-function-chaining-sfc-overiew">
<h3>OpenDaylight Service Function Chaining (SFC) Overiew<a class="headerlink" href="#opendaylight-service-function-chaining-sfc-overiew" title="Permalink to this headline">¶</a></h3>
<p>OpenDaylight Service Function Chaining (SFC) provides the ability to
define an ordered list of a network services (e.g. firewalls, load
balancers). These service are then &#8220;stitched&#8221; together in the network to
create a service chain. This project provides the infrastructure
(chaining logic, APIs) needed for ODL to provision a service chain in
the network and an end-user application for defining such chains.</p>
<ul class="simple">
<li>ACE - Access Control Entry</li>
<li>ACL - Access Control List</li>
<li>SCF - Service Classifier Function</li>
<li>SF - Service Function</li>
<li>SFC - Service Function Chain</li>
<li>SFF - Service Function Forwarder</li>
<li>SFG - Service Function Group</li>
<li>SFP - Service Function Path</li>
<li>RSP - Rendered Service Path</li>
<li>NSH - Network Service Header</li>
</ul>
</div>
<div class="section" id="sfc-user-interface">
<h3>SFC User Interface<a class="headerlink" href="#sfc-user-interface" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id76">
<h4>Overview<a class="headerlink" href="#id76" title="Permalink to this headline">¶</a></h4>
<p>SFC User Interface (SFC-UI) is based on Dlux project. It provides an
easy way to create, read, update and delete configuration stored in
Datastore. Moreover, it shows the status of all SFC features (e.g
installed, uninstalled) and Karaf log messages as well.</p>
</div>
<div class="section" id="sfc-ui-architecture">
<h4>SFC-UI Architecture<a class="headerlink" href="#sfc-ui-architecture" title="Permalink to this headline">¶</a></h4>
<p>SFC-UI operates purely by using RESTCONF.</p>
<div class="figure" id="id225">
<img alt="SFC-UI integration into ODL" src="../_images/sfc-ui-architecture.png" />
<p class="caption"><span class="caption-text">SFC-UI integration into ODL</span></p>
</div>
</div>
<div class="section" id="configuring-sfc-ui">
<h4>Configuring SFC-UI<a class="headerlink" href="#configuring-sfc-ui" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Run ODL distribution (run karaf)</li>
<li>In karaf console execute: <code class="docutils literal"><span class="pre">feature:install</span> <span class="pre">odl-sfc-ui</span></code></li>
<li>Visit SFC-UI on: <code class="docutils literal"><span class="pre">http://&lt;odl_ip_address&gt;:8181/sfc/index.html</span></code></li>
</ol>
</div>
</div>
<div class="section" id="sfc-southbound-rest-plugin">
<h3>SFC Southbound REST Plugin<a class="headerlink" href="#sfc-southbound-rest-plugin" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id77">
<h4>Overview<a class="headerlink" href="#id77" title="Permalink to this headline">¶</a></h4>
<p>The Southbound REST Plugin is used to send configuration from DataStore
down to network devices supporting a REST API (i.e. they have a
configured REST URI). It supports POST/PUT/DELETE operations, which are
triggered accordingly by changes in the SFC data stores.</p>
<ul class="simple">
<li>Access Control List (ACL)</li>
<li>Service Classifier Function (SCF)</li>
<li>Service Function (SF)</li>
<li>Service Function Group (SFG)</li>
<li>Service Function Schedule Type (SFST)</li>
<li>Service Function Forwader (SFF)</li>
<li>Rendered Service Path (RSP)</li>
</ul>
</div>
<div class="section" id="southbound-rest-plugin-architecture">
<h4>Southbound REST Plugin Architecture<a class="headerlink" href="#southbound-rest-plugin-architecture" title="Permalink to this headline">¶</a></h4>
<p>From the user perspective, the REST plugin is another SFC Southbound
plugin used to communicate with network devices.</p>
<div class="figure" id="id226">
<img alt="Soutbound REST Plugin integration into ODL" src="../_images/sb-rest-architecture-user.png" />
<p class="caption"><span class="caption-text">Soutbound REST Plugin integration into ODL</span></p>
</div>
</div>
<div class="section" id="configuring-southbound-rest-plugin">
<h4>Configuring Southbound REST Plugin<a class="headerlink" href="#configuring-southbound-rest-plugin" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Run ODL distribution (run karaf)</li>
<li>In karaf console execute: <code class="docutils literal"><span class="pre">feature:install</span> <span class="pre">odl-sfc-sb-rest</span></code></li>
<li>Configure REST URIs for SF/SFF through SFC User Interface or RESTCONF
(required configuration steps can be found in the tutorial stated
bellow)</li>
</ol>
</div>
<div class="section" id="tutorial">
<h4>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h4>
<p>Comprehensive tutorial on how to use the Southbound REST Plugin and how
to control network devices with it can be found on:
<a class="reference external" href="https://wiki.opendaylight.org/view/Service_Function_Chaining:Main#SFC_101">https://wiki.opendaylight.org/view/Service_Function_Chaining:Main#SFC_101</a></p>
</div>
</div>
<div class="section" id="sfc-ovs-integration">
<h3>SFC-OVS integration<a class="headerlink" href="#sfc-ovs-integration" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id78">
<h4>Overview<a class="headerlink" href="#id78" title="Permalink to this headline">¶</a></h4>
<p>SFC-OVS provides integration of SFC with Open vSwitch (OVS) devices.
Integration is realized through mapping of SFC objects (like SF, SFF,
Classifier, etc.) to OVS objects (like Bridge,
TerminationPoint=Port/Interface). The mapping takes care of automatic
instantiation (setup) of corresponding object whenever its counterpart
is created. For example, when a new SFF is created, the SFC-OVS plugin
will create a new OVS bridge and when a new OVS Bridge is created, the
SFC-OVS plugin will create a new SFF.</p>
<p>The feature is intended for SFC users willing to use Open vSwitch as
underlying network infrastructure for deploying RSPs (Rendered Service
Paths).</p>
</div>
<div class="section" id="sfc-ovs-architecture">
<h4>SFC-OVS Architecture<a class="headerlink" href="#sfc-ovs-architecture" title="Permalink to this headline">¶</a></h4>
<p>SFC-OVS uses the OVSDB MD-SAL Southbound API for getting/writing
information from/to OVS devices. From the user perspective SFC-OVS acts
as a layer between SFC DataStore and OVSDB.</p>
<div class="figure" id="id227">
<img alt="SFC-OVS integration into ODL" src="../_images/sfc-ovs-architecture-user.png" />
<p class="caption"><span class="caption-text">SFC-OVS integration into ODL</span></p>
</div>
</div>
<div class="section" id="configuring-sfc-ovs">
<h4>Configuring SFC-OVS<a class="headerlink" href="#configuring-sfc-ovs" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Run ODL distribution (run karaf)</li>
<li>In karaf console execute: <code class="docutils literal"><span class="pre">feature:install</span> <span class="pre">odl-sfc-ovs</span></code></li>
<li>Configure Open vSwitch to use ODL as a manager, using following
command: <code class="docutils literal"><span class="pre">ovs-vsctl</span> <span class="pre">set-manager</span> <span class="pre">tcp:&lt;odl_ip_address&gt;:6640</span></code></li>
</ol>
</div>
<div class="section" id="id79">
<h4>Tutorials<a class="headerlink" href="#id79" title="Permalink to this headline">¶</a></h4>
<div class="section" id="verifying-mapping-from-ovs-to-sff">
<h5>Verifying mapping from OVS to SFF<a class="headerlink" href="#verifying-mapping-from-ovs-to-sff" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id80">
<h6>Overview<a class="headerlink" href="#id80" title="Permalink to this headline">¶</a></h6>
<p>This tutorial shows the usual workflow when OVS configuration is
transformed to corresponding SFC objects (in this case SFF).</p>
</div>
<div class="section" id="prerequisities">
<h6>Prerequisities<a class="headerlink" href="#prerequisities" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Open vSwitch installed (ovs-vsctl command available in shell)</li>
<li>SFC-OVS feature configured as stated above</li>
</ul>
</div>
<div class="section" id="id81">
<h6>Instructions<a class="headerlink" href="#id81" title="Permalink to this headline">¶</a></h6>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">ovs-vsctl</span> <span class="pre">set-manager</span> <span class="pre">tcp:&lt;odl_ip_address&gt;:6640</span></code></li>
<li><code class="docutils literal"><span class="pre">ovs-vsctl</span> <span class="pre">add-br</span> <span class="pre">br1</span></code></li>
<li><code class="docutils literal"><span class="pre">ovs-vsctl</span> <span class="pre">add-port</span> <span class="pre">br1</span> <span class="pre">testPort</span></code></li>
</ol>
</div>
<div class="section" id="verification">
<h6>Verification<a class="headerlink" href="#verification" title="Permalink to this headline">¶</a></h6>
<ol class="loweralpha simple">
<li>visit SFC User Interface:
<code class="docutils literal"><span class="pre">http://&lt;odl_ip_address&gt;:8181/sfc/index.html#/sfc/serviceforwarder</span></code></li>
<li>use pure RESTCONF and send GET request to URL:
<code class="docutils literal"><span class="pre">http://&lt;odl_ip_address&gt;:8181/restconf/config/service-function-forwarder:service-function-forwarders</span></code></li>
</ol>
<p>There should be SFF, which name will be ending with <em>br1</em> and the SFF
should containt two DataPlane locators: <em>br1</em> and <em>testPort</em>.</p>
</div>
</div>
<div class="section" id="verifying-mapping-from-sff-to-ovs">
<h5>Verifying mapping from SFF to OVS<a class="headerlink" href="#verifying-mapping-from-sff-to-ovs" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id82">
<h6>Overview<a class="headerlink" href="#id82" title="Permalink to this headline">¶</a></h6>
<p>This tutorial shows the usual workflow during creation of OVS Bridge
with use of SFC APIs.</p>
</div>
<div class="section" id="id83">
<h6>Prerequisities<a class="headerlink" href="#id83" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Open vSwitch installed (ovs-vsctl command available in shell)</li>
<li>SFC-OVS feature configured as stated above</li>
</ul>
</div>
<div class="section" id="id84">
<h6>Instructions<a class="headerlink" href="#id84" title="Permalink to this headline">¶</a></h6>
<ol class="arabic simple">
<li>In shell execute: <code class="docutils literal"><span class="pre">ovs-vsctl</span> <span class="pre">set-manager</span> <span class="pre">tcp:&lt;odl_ip_address&gt;:6640</span></code></li>
<li>Send POST request to URL:
<code class="docutils literal"><span class="pre">http://&lt;odl_ip_address&gt;:8181/restconf/operations/service-function-forwarder-ovs:create-ovs-bridge</span></code>
Use Basic auth with credentials: &#8220;admin&#8221;, &#8220;admin&#8221; and set
<code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">application/json</span></code>. The content of POST request
should be following:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;br-test&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ovs-node&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;Open_vSwitch_ip_address&gt;&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Open_vSwitch_ip_address is IP address of machine, where Open vSwitch
is installed.</p>
</div>
<div class="section" id="id85">
<h6>Verification<a class="headerlink" href="#id85" title="Permalink to this headline">¶</a></h6>
<p>In shell execute: <code class="docutils literal"><span class="pre">ovs-vsctl</span> <span class="pre">show</span></code>. There should be Bridge with name
<em>br-test</em> and one port/interface called <em>br-test</em>.</p>
<p>Also, corresponding SFF for this OVS Bridge should be configured, which
can be verified through SFC User Interface or RESTCONF as stated in
previous tutorial.</p>
</div>
</div>
</div>
</div>
<div class="section" id="sfc-classifier-user-guide">
<h3>SFC Classifier User Guide<a class="headerlink" href="#sfc-classifier-user-guide" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id86">
<h4>Overview<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h4>
<p>Description of classifier can be found in:
<a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-sfc-architecture/">https://datatracker.ietf.org/doc/draft-ietf-sfc-architecture/</a></p>
<p>There are two types of classifier:</p>
<ol class="arabic simple">
<li>OpenFlow Classifier</li>
<li>Iptables Classifier</li>
</ol>
</div>
<div class="section" id="openflow-classifier">
<h4>OpenFlow Classifier<a class="headerlink" href="#openflow-classifier" title="Permalink to this headline">¶</a></h4>
<p>OpenFlow Classifier implements the classification criteria based on
OpenFlow rules deployed into an OpenFlow switch. An Open vSwitch will
take the role of a classifier and performs various encapsulations such
NSH, VLAN, MPLS, etc. In the existing implementation, classifier can
support NSH encapsulation. Matching information is based on ACL for MAC
addresses, ports, protocol, IPv4 and IPv6. Supported protocols are TCP,
UDP and SCTP. Actions information in the OF rules, shall be forwarding
of the encapsulated packets with specific information related to the
RSP.</p>
<div class="section" id="classifier-architecture">
<h5>Classifier Architecture<a class="headerlink" href="#classifier-architecture" title="Permalink to this headline">¶</a></h5>
<p>The OVSDB Southbound interface is used to create an instance of a bridge
in a specific location (via IP address). This bridge contains the
OpenFlow rules that perform the classification of the packets and react
accordingly. The OpenFlow Southbound interface is used to translate the
ACL information into OF rules within the Open vSwitch.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>in order to create the instance of the bridge that takes the role of
a classifier, an &#8220;empty&#8221; SFF must be created.</p>
</div></blockquote>
</div>
<div class="section" id="configuring-classifier">
<h5>Configuring Classifier<a class="headerlink" href="#configuring-classifier" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>An empty SFF must be created in order to host the ACL that contains
the classification information.</li>
<li>SFF data plane locator must be configured</li>
<li>Classifier interface must be mannually added to SFF bridge.</li>
</ol>
</div>
<div class="section" id="administering-or-managing-classifier">
<h5>Administering or Managing Classifier<a class="headerlink" href="#administering-or-managing-classifier" title="Permalink to this headline">¶</a></h5>
<p>Classification information is based on MAC addresses, protocol, ports
and IP. ACL gathers this information and is assigned to an RSP which
turns to be a specific path for a Service Chain.</p>
</div>
</div>
<div class="section" id="iptables-classifier">
<h4>Iptables Classifier<a class="headerlink" href="#iptables-classifier" title="Permalink to this headline">¶</a></h4>
<p>Classifier manages everything from starting the packet listener to
creation (and removal) of appropriate ip(6)tables rules and marking
received packets accordingly. Its functionality is <strong>available only on
Linux</strong> as it leverdges <strong>NetfilterQueue</strong>, which provides access to
packets matched by an <strong>iptables</strong> rule. Classifier requires <strong>root
privileges</strong> to be able to operate.</p>
<p>So far it is capable of processing ACL for MAC addresses, ports, IPv4
and IPv6. Supported protocols are TCP and UDP.</p>
<div class="section" id="id87">
<h5>Classifier Architecture<a class="headerlink" href="#id87" title="Permalink to this headline">¶</a></h5>
<p>Python code located in the project repository
sfc-py/common/classifier.py.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>classifier assumes that Rendered Service Path (RSP) <strong>already
exists</strong> in ODL when an ACL referencing it is obtained</p>
</div></blockquote>
<ol class="arabic simple">
<li>sfc_agent receives an ACL and passes it for processing to the
classifier</li>
<li>the RSP (its SFF locator) referenced by ACL is requested from ODL</li>
<li>if the RSP exists in the ODL then ACL based iptables rules for it are
applied</li>
</ol>
<p>After this process is over, every packet successfully matched to an
iptables rule (i.e. successfully classified) will be NSH encapsulated
and forwarded to a related SFF, which knows how to traverse the RSP.</p>
<p>Rules are created using appropriate iptables command. If the Access
Control Entry (ACE) rule is MAC address related both iptables and
ip6tabeles rules re issued. If ACE rule is IPv4 address related, only
iptables rules are issued, same for IPv6.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>iptables <strong>raw</strong> table contains all created rules</p>
</div></blockquote>
</div>
<div class="section" id="id88">
<h5>Configuring Classifier<a class="headerlink" href="#id88" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">Classfier does’t need any configuration.</div>
<div class="line">Its only requirement is that the <strong>second (2) Netfilter Queue</strong> is not
used by any other process and is <strong>avalilable for the classifier</strong>.</div>
</div>
</div>
<div class="section" id="id89">
<h5>Administering or Managing Classifier<a class="headerlink" href="#id89" title="Permalink to this headline">¶</a></h5>
<p>Classfier runs alongside sfc_agent, therefore the commad for starting
it locally is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span><span class="o">.</span><span class="mi">4</span> <span class="n">sfc</span><span class="o">-</span><span class="n">py</span><span class="o">/</span><span class="n">sfc_agent</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">rest</span> <span class="o">--</span><span class="n">odl</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="n">port</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span> <span class="o">--</span><span class="n">auto</span><span class="o">-</span><span class="n">sff</span><span class="o">-</span><span class="n">name</span> <span class="o">--</span><span class="n">nfq</span><span class="o">-</span><span class="k">class</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sfc-openflow-layer-2-renderer-user-guide">
<h3>SFC OpenFlow Layer 2 Renderer User Guide<a class="headerlink" href="#sfc-openflow-layer-2-renderer-user-guide" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id90">
<h4>Overview<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h4>
<p>The Service Function Chaining (SFC) OpenFlow Layer 2 Renderer (SFCOFL2)
implements Service Chaining on OpenFlow switches. It listens for the
creation of a Rendered Service Path (RSP), and once received it programs
Service Function Forwarders (SFF) that are hosted on OpenFlow capable
switches to steer packets through the service chain.</p>
<p>Common acronyms used in the following sections:</p>
<ul class="simple">
<li>SF - Service Function</li>
<li>SFF - Service Function Forwarder</li>
<li>SFC - Service Function Chain</li>
<li>SFP - Service Function Path</li>
<li>RSP - Rendered Service Path</li>
</ul>
</div>
<div class="section" id="sfc-openflow-renderer-architecture">
<h4>SFC OpenFlow Renderer Architecture<a class="headerlink" href="#sfc-openflow-renderer-architecture" title="Permalink to this headline">¶</a></h4>
<p>The SFCOFL2 is invoked after a RSP is created using an MD-SAL listener
called <code class="docutils literal"><span class="pre">SfcL2RspDataListener</span></code>. Upon SFCOFL2 initialization, the
<code class="docutils literal"><span class="pre">SfcL2RspDataListener</span></code> registers itself to listen for RSP changes.
When invoked, the <code class="docutils literal"><span class="pre">SfcL2RspDataListener</span></code> processes the RSP and calls
the <code class="docutils literal"><span class="pre">SfcL2FlowProgrammerOFImpl</span></code> to create the necessary flows in the
Service Function Forwarders configured in the RSP. Refer to the
following diagram for more details.</p>
<div class="figure" id="id228">
<img alt="SFC OpenFlow Renderer High Level Architecture" src="../_images/sfcofl2_architecture.jpg" />
<p class="caption"><span class="caption-text">SFC OpenFlow Renderer High Level Architecture</span></p>
</div>
</div>
<div class="section" id="sfc-openflow-switch-flow-pipeline">
<h4>SFC OpenFlow Switch Flow pipeline<a class="headerlink" href="#sfc-openflow-switch-flow-pipeline" title="Permalink to this headline">¶</a></h4>
<p>The SFC OpenFlow Renderer uses the following tables for its Flow
pipeline:</p>
<ul class="simple">
<li>Table 0, Transport Ingress</li>
<li>Table 1, Path Mapper</li>
<li>Table 2, Next Hop</li>
<li>Table 10, Transport Egress</li>
</ul>
<p>The OpenFlow Table Pipeline is intended to be generic to work for all of
the different encapsulations supported by SFC.</p>
<p>All of the tables are explained in detail in the following section.</p>
<p>The SFFs (SFF1 and SFF2), SFs (SF1), and topology used for the flow
tables in the following sections are as described in the following
diagram.</p>
<div class="figure" id="id229">
<img alt="SFC OpenFlow Renderer Typical Network Topology" src="../_images/sfcofl2_architecture_nwtopo.jpg" />
<p class="caption"><span class="caption-text">SFC OpenFlow Renderer Typical Network Topology</span></p>
</div>
<div class="section" id="transport-ingress-table-detailed">
<h5>Transport Ingress Table detailed<a class="headerlink" href="#transport-ingress-table-detailed" title="Permalink to this headline">¶</a></h5>
<p>The Transport Ingress table has an entry per expected tunnel transport
type to be received in a particular SFF, as established in the SFC
configuration.</p>
<p>Here is an example on SFF1, assuming VLAN is used for the SFF-SF, and
the RSP tunnel is MPLS:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Priority</th>
<th class="head">Match</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>256</td>
<td>EtherType==0x8847 (MPLS
unicast)</td>
<td>Goto Table 1</td>
</tr>
<tr class="row-odd"><td>256</td>
<td>EtherType==0x8100 (VLAN)</td>
<td>Goto Table 1</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Match Any</td>
<td>Drop</td>
</tr>
</tbody>
</table>
<p>Table: Table Transport Ingress</p>
</div>
<div class="section" id="path-mapper-table-detailed">
<h5>Path Mapper Table detailed<a class="headerlink" href="#path-mapper-table-detailed" title="Permalink to this headline">¶</a></h5>
<p>The Path Mapper table has an entry per expected tunnel transport info to
be received in a particular SFF, as established in the SFC
configuration. The tunnel transport info is used to determine the RSP
Path ID, and is stored in the OpenFlow Metadata.</p>
<p>Since most SF nodes wont support tunneling, the IP header DSCP field is
used to store the RSP Path Id. The RSP Path Id is written to the DSCP
field in the Transport Egress table for those packets sent to an SF.</p>
<p>Here is an example on SFF1, assuming the following details:</p>
<ul class="simple">
<li>VLAN ID 1000 is used for the SFF-SF</li>
<li>The RSP Path 1 tunnel uses MPLS label 100 for ingress and 101 for
egress</li>
<li>The RSP Path 2 (symmetric downlink path) uses MPLS label 101 for
ingress and 100 for egress</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Priority</th>
<th class="head">Match</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>256</td>
<td>MPLS Label==100</td>
<td>RSP Path=1, Pop MPLS,
Goto Table 2</td>
</tr>
<tr class="row-odd"><td>256</td>
<td>MPLS Label==101</td>
<td>RSP Path=2, Pop MPLS,
Goto Table 2</td>
</tr>
<tr class="row-even"><td>256</td>
<td>VLAN ID==1000, IP
DSCP==1</td>
<td>RSP Path=1, Pop VLAN,
Goto Table 2</td>
</tr>
<tr class="row-odd"><td>256</td>
<td>VLAN ID==1000, IP
DSCP==2</td>
<td>RSP Path=2, Pop VLAN,
Goto Table 2</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Match Any</td>
<td>Drop</td>
</tr>
</tbody>
</table>
<p>Table: Table Path Mapper</p>
</div>
<div class="section" id="next-hop-table-detailed">
<h5>Next Hop Table detailed<a class="headerlink" href="#next-hop-table-detailed" title="Permalink to this headline">¶</a></h5>
<p>The Next Hop table uses the RSP Path Id and source MAC address to
determine the destination MAC address.</p>
<p>Here is an example on SFF1, assuming SFF1 is connected to SFF2 and RSP
Path 1 ingress packets come from external to SFC, for which we don’t
have the source MAC address (MacSrc).</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Priority</th>
<th class="head">Match</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>256</td>
<td>RSP Path==1, MacSrc==SF1</td>
<td>MacDst=SFF2, Goto Table
10</td>
</tr>
<tr class="row-odd"><td>256</td>
<td>RSP Path==2, MacSrc==SF1</td>
<td>Goto Table 10</td>
</tr>
<tr class="row-even"><td>256</td>
<td>RSP Path==2,
MacSrc==SFF2</td>
<td>MacDst=SF1, Goto Table
10</td>
</tr>
<tr class="row-odd"><td>246</td>
<td>RSP Path==1</td>
<td>MacDst=SF1, Goto Table
10</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Match Any</td>
<td>Drop</td>
</tr>
</tbody>
</table>
<p>Table: Table Next Hop</p>
</div>
<div class="section" id="transport-egress-table-detailed">
<h5>Transport Egress Table detailed<a class="headerlink" href="#transport-egress-table-detailed" title="Permalink to this headline">¶</a></h5>
<p>The Transport Egress table prepares egress tunnel information and sends
the packets out.</p>
<p>Here is an example on SFF1, assuming VLAN is used for the SFF-SF, and
the RSP tunnel is MPLS:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Priority</th>
<th class="head">Match</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>256</td>
<td>RSP Path==1, MacDst==SF1</td>
<td>Push VLAN ID 1000,
Port=SF1</td>
</tr>
<tr class="row-odd"><td>256</td>
<td>RSP Path==1,
MacDst==SFF2</td>
<td>Push MPLS Label 101,
Port=SFF2</td>
</tr>
<tr class="row-even"><td>256</td>
<td>RSP Path==2, MacDst==SF1</td>
<td>Push VLAN ID 1000,
Port=SF1</td>
</tr>
<tr class="row-odd"><td>246</td>
<td>RSP Path==2</td>
<td>Push MPLS Label 100,
Port=Ingress</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Match Any</td>
<td>Drop</td>
</tr>
</tbody>
</table>
<p>Table: Table Transport Egress</p>
</div>
</div>
<div class="section" id="administering-sfcofl2">
<h4>Administering SFCOFL2<a class="headerlink" href="#administering-sfcofl2" title="Permalink to this headline">¶</a></h4>
<p>To use the SFC OpenFlow Renderer Karaf, at least the following Karaf
features must be installed.</p>
<ul class="simple">
<li>odl-openflowplugin-all</li>
<li>odl-sfc-core (includes odl-sfc-provider and odl-sfc-model)</li>
<li>odl-sfcofl2</li>
<li>odl-sfc-ui (optional)</li>
</ul>
<p>The following command can be used to view all of the currently installed
Karaf features:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">opendaylight</span><span class="o">-</span><span class="n">user</span><span class="nd">@root</span><span class="o">&gt;</span><span class="n">feature</span><span class="p">:</span><span class="nb">list</span> <span class="o">-</span><span class="n">i</span>
</pre></div>
</div>
<p>Or, pipe the command to a grep to see a subset of the currently
installed Karaf features:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">opendaylight</span><span class="o">-</span><span class="n">user</span><span class="nd">@root</span><span class="o">&gt;</span><span class="n">feature</span><span class="p">:</span><span class="nb">list</span> <span class="o">-</span><span class="n">i</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">sfc</span>
</pre></div>
</div>
<p>To install a particular feature, use the Karaf <code class="docutils literal"><span class="pre">feature:install</span></code>
command.</p>
</div>
<div class="section" id="sfcofl2-tutorial">
<h4>SFCOFL2 Tutorial<a class="headerlink" href="#sfcofl2-tutorial" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id91">
<h5>Overview<a class="headerlink" href="#id91" title="Permalink to this headline">¶</a></h5>
<p>The following Network Topology diagram shows how to configure SFC to
create a Service Chain.</p>
<div class="figure" id="id230">
<img alt="SFC OpenFlow Renderer Typical Network Topology" src="../_images/sfcofl2_architecture_nwtopo.jpg" />
<p class="caption"><span class="caption-text">SFC OpenFlow Renderer Typical Network Topology</span></p>
</div>
</div>
<div class="section" id="id92">
<h5>Prerequisites<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h5>
<p>To use this example, SFF OpenFlow switches must be created and connected
as illustrated above. Additionally, The SFs must be created and
connected to the SFFs.</p>
</div>
<div class="section" id="id93">
<h5>Target Environment<a class="headerlink" href="#id93" title="Permalink to this headline">¶</a></h5>
<p>The target environment is not important, but this use-case was created
and only tested on Linux.</p>
</div>
<div class="section" id="id94">
<h5>Instructions<a class="headerlink" href="#id94" title="Permalink to this headline">¶</a></h5>
<p>The steps to use this tutorial are as follows. The referenced
configuration in the steps is listed in the following sections.</p>
<p>There are numerous ways to send the configuration. The following
configuration chapters, the appropriate <code class="docutils literal"><span class="pre">curl</span></code> command is shown for
each configuration to be sent, including the URL.</p>
<p>Steps to configure the SFCOFL2 tutorial:</p>
<ol class="arabic simple">
<li>Send the <code class="docutils literal"><span class="pre">SF</span></code> RESTCONF configuration</li>
<li>Send the <code class="docutils literal"><span class="pre">SFF</span></code> RESTCONF configuration</li>
<li>Send the <code class="docutils literal"><span class="pre">SFC</span></code> RESTCONF configuration</li>
<li>Send the <code class="docutils literal"><span class="pre">SFP</span></code> RESTCONF configuration</li>
<li>Create the <code class="docutils literal"><span class="pre">RSP</span></code> with a RESTCONF RPC command</li>
</ol>
<p>Once the configuration has been successfully created, query the Rendered
Service Paths with either the SFC UI or via RESTCONF. Notice that the
RSP is symetrical, so the following 2 RSPs will be created:</p>
<ul class="simple">
<li>sfc-path1</li>
<li>sfc-path1-Reverse</li>
</ul>
<p>At this point the Service Chains have been created, and the OpenFlow
Switches are programmed to steer traffic through the Service Chain.
Traffic can now be injected from a client into the Service Chain. To
debug problems, the OpenFlow tables can be dumped with the following
commands, assuming SFF1 is called <code class="docutils literal"><span class="pre">s1</span></code> and SFF2 is called <code class="docutils literal"><span class="pre">s2</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ovs</span><span class="o">-</span><span class="n">ofctl</span> <span class="o">-</span><span class="n">O</span> <span class="n">OpenFlow13</span>  <span class="n">dump</span><span class="o">-</span><span class="n">flows</span> <span class="n">s1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ovs</span><span class="o">-</span><span class="n">ofctl</span> <span class="o">-</span><span class="n">O</span> <span class="n">OpenFlow13</span>  <span class="n">dump</span><span class="o">-</span><span class="n">flows</span> <span class="n">s2</span>
</pre></div>
</div>
<p>In all the following configuration sections, replace the <code class="docutils literal"><span class="pre">${JSON}</span></code>
string with the appropriate JSON configuration. Also, change the
<code class="docutils literal"><span class="pre">localhost</span></code> desintation in the URL accordingly.</p>
<div class="section" id="service-function-configuration">
<h6>Service Function configuration<a class="headerlink" href="#service-function-configuration" title="Permalink to this headline">¶</a></h6>
<p>The Service Function configuration can be sent with the following
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;$</span><span class="si">{JSON}</span><span class="s1">&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="p">:</span><span class="n">service</span><span class="o">-</span><span class="n">functions</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>SF configuration JSON.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;service-functions&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;service-function&quot;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span>
       <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sf1&quot;</span><span class="p">,</span>
       <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:http-header-enrichment&quot;</span><span class="p">,</span>
       <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
       <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2&quot;</span><span class="p">,</span>
       <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sf1-sff1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:08:01:02:01&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vlan-id&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
           <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mac&quot;</span><span class="p">,</span>
           <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;sff1&quot;</span>
         <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">},</span>
     <span class="p">{</span>
       <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sf2&quot;</span><span class="p">,</span>
       <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span><span class="p">,</span>
       <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
       <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.3&quot;</span><span class="p">,</span>
       <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sf2-sff2&quot;</span><span class="p">,</span>
           <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:08:01:03:01&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vlan-id&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
           <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mac&quot;</span><span class="p">,</span>
           <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;sff2&quot;</span>
         <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">}</span>
   <span class="p">]</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="service-function-forwarder-configuration">
<h6>Service Function Forwarder configuration<a class="headerlink" href="#service-function-forwarder-configuration" title="Permalink to this headline">¶</a></h6>
<p>The Service Function Forwarder configuration can be sent with the
following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;$</span><span class="si">{JSON}</span><span class="s1">&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">forwarder</span><span class="p">:</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">forwarders</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>SFF configuration JSON.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;service-function-forwarders&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span>
       <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sff1&quot;</span><span class="p">,</span>
       <span class="s2">&quot;service-node&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:2&quot;</span><span class="p">,</span>
       <span class="s2">&quot;sff-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ulSff1Ingress&quot;</span><span class="p">,</span>
           <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mpls-label&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
               <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mpls&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;service-function-forwarder-ofs:ofs-port&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;11:11:11:11:11:11&quot;</span><span class="p">,</span>
               <span class="s2">&quot;port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span>
           <span class="p">}</span>
         <span class="p">},</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ulSff1ToSff2&quot;</span><span class="p">,</span>
           <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mpls-label&quot;</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
               <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mpls&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;service-function-forwarder-ofs:ofs-port&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;33:33:33:33:33:33&quot;</span><span class="p">,</span>
               <span class="s2">&quot;port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;2&quot;</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">],</span>
       <span class="s2">&quot;service-function-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sf1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:http-header-enrichment&quot;</span><span class="p">,</span>
           <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;22:22:22:22:22:22&quot;</span><span class="p">,</span>
               <span class="s2">&quot;vlan-id&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
               <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mac&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;service-function-forwarder-ofs:ofs-port&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;3&quot;</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">},</span>
     <span class="p">{</span>
       <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sff2&quot;</span><span class="p">,</span>
       <span class="s2">&quot;service-node&quot;</span><span class="p">:</span> <span class="s2">&quot;openflow:3&quot;</span><span class="p">,</span>
       <span class="s2">&quot;sff-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ulSff2Ingress&quot;</span><span class="p">,</span>
           <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mpls-label&quot;</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span>
               <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mpls&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;service-function-forwarder-ofs:ofs-port&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;44:44:44:44:44:44&quot;</span><span class="p">,</span>
               <span class="s2">&quot;port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span>
           <span class="p">}</span>
         <span class="p">},</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ulSff2Egress&quot;</span><span class="p">,</span>
           <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mpls-label&quot;</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span>
               <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mpls&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;service-function-forwarder-ofs:ofs-port&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;66:66:66:66:66:66&quot;</span><span class="p">,</span>
               <span class="s2">&quot;port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;2&quot;</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">],</span>
       <span class="s2">&quot;service-function-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sf2&quot;</span><span class="p">,</span>
           <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span><span class="p">,</span>
           <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;mac&quot;</span><span class="p">:</span> <span class="s2">&quot;55:55:55:55:55:55&quot;</span><span class="p">,</span>
               <span class="s2">&quot;vlan-id&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
               <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mac&quot;</span>
           <span class="p">},</span>
           <span class="s2">&quot;service-function-forwarder-ofs:ofs-port&quot;</span><span class="p">:</span>
           <span class="p">{</span>
               <span class="s2">&quot;port-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;3&quot;</span>
           <span class="p">}</span>
         <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">}</span>
   <span class="p">]</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="service-function-chain-configuration">
<h6>Service Function Chain configuration<a class="headerlink" href="#service-function-chain-configuration" title="Permalink to this headline">¶</a></h6>
<p>The Service Function Chain configuration can be sent with the following
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;$</span><span class="si">{JSON}</span><span class="s1">&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">chain</span><span class="p">:</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">chains</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>SFC configuration JSON.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;service-function-chains&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;service-function-chain&quot;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span>
       <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc-chain1&quot;</span><span class="p">,</span>
       <span class="s2">&quot;symmetric&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
       <span class="s2">&quot;sfc-service-function&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;hdr-enrich-abstract1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:http-header-enrichment&quot;</span>
         <span class="p">},</span>
         <span class="p">{</span>
           <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;firewall-abstract1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span>
         <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">}</span>
   <span class="p">]</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="service-function-path-configuration">
<h6>Service Function Path configuration<a class="headerlink" href="#service-function-path-configuration" title="Permalink to this headline">¶</a></h6>
<p>The Service Function Path configuration can be sent with the following
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;$</span><span class="si">{JSON}</span><span class="s1">&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">path</span><span class="p">:</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">paths</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>SFP configuration JSON.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;service-function-paths&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;service-function-path&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc-path1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;service-chain-name&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc-chain1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transport-type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:mpls&quot;</span><span class="p">,</span>
        <span class="s2">&quot;symmetric&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="rendered-service-path-creation">
<h6>Rendered Service Path creation<a class="headerlink" href="#rendered-service-path-creation" title="Permalink to this headline">¶</a></h6>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;$</span><span class="si">{JSON}</span><span class="s1">&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">rendered</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">path</span><span class="p">:</span><span class="n">create</span><span class="o">-</span><span class="n">rendered</span><span class="o">-</span><span class="n">path</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>RSP creation JSON.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc-path1&quot;</span><span class="p">,</span>
     <span class="s2">&quot;parent-service-function-path&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc-path1&quot;</span><span class="p">,</span>
     <span class="s2">&quot;symmetric&quot;</span><span class="p">:</span> <span class="n">true</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="rendered-service-path-removal">
<h6>Rendered Service Path removal<a class="headerlink" href="#rendered-service-path-removal" title="Permalink to this headline">¶</a></h6>
<p>The following command can be used to remove a Rendered Service Path
called <code class="docutils literal"><span class="pre">sfc-path1</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;{&quot;input&quot;: {&quot;name&quot;: &quot;sfc-path1&quot; } }&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operations</span><span class="o">/</span><span class="n">rendered</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">path</span><span class="p">:</span><span class="n">delete</span><span class="o">-</span><span class="n">rendered</span><span class="o">-</span><span class="n">path</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="rendered-service-path-query">
<h6>Rendered Service Path Query<a class="headerlink" href="#rendered-service-path-query" title="Permalink to this headline">¶</a></h6>
<p>The following command can be used to query all of the created Rendered
Service Paths:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">operational</span><span class="o">/</span><span class="n">rendered</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">path</span><span class="p">:</span><span class="n">rendered</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">paths</span><span class="o">/</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="service-function-scheduling-algorithms">
<h3>Service Function Scheduling Algorithms<a class="headerlink" href="#service-function-scheduling-algorithms" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id95">
<h4>Overview<a class="headerlink" href="#id95" title="Permalink to this headline">¶</a></h4>
<p>When creating the Rendered Service Path, the origin SFC controller chose
the first available service function from a list of service function
names. This may result in many issues such as overloaded service
functions and a longer service path as SFC has no means to understand
the status of service functions and network topology. The service
function selection framework supports at least four algorithms (Random,
Round Robin, Load Balancing and Shortest Path) to select the most
appropriate service function when instantiating the Rendered Service
Path. In addition, it is an extensible framework that allows 3rd party
selection algorithm to be plugged in.</p>
</div>
<div class="section" id="id96">
<h4>Architecture<a class="headerlink" href="#id96" title="Permalink to this headline">¶</a></h4>
<p>The following figure illustrates the service function selection
framework and algorithms.</p>
<div class="figure" id="id231">
<img alt="SF Selection Architecture" src="../_images/sf-selection-arch.png" />
<p class="caption"><span class="caption-text">SF Selection Architecture</span></p>
</div>
<p>A user has three different ways to select one service function selection
algorithm:</p>
<ol class="arabic simple">
<li>Integrated RESTCONF Calls. OpenStack and/or other administration
system could provide plugins to call the APIs to select one
scheduling algorithm.</li>
<li>Command line tools. Command line tools such as curl or browser
plugins such as POSTMAN (for Google Chrome) and RESTClient (for
Mozilla Firefox) could select schedule algorithm by making RESTCONF
calls.</li>
<li>SFC-UI. Now the SFC-UI provides an option for choosing a selection
algorithm when creating a Rendered Service Path.</li>
</ol>
<p>The RESTCONF northbound SFC API provides GUI/RESTCONF interactions for
choosing the service function selection algorithm. MD-SAL data store
provides all supported service function selection algorithms, and
provides APIs to enable one of the provided service function selection
algorithms. Once a service function selection algorithm is enabled, the
service function selection algorithm will work when creating a Rendered
Service Path.</p>
</div>
<div class="section" id="select-sfs-with-scheduler">
<h4>Select SFs with Scheduler<a class="headerlink" href="#select-sfs-with-scheduler" title="Permalink to this headline">¶</a></h4>
<p>Administrator could use both the following ways to select one of the
selection algorithm when creating a Rendered Service Path.</p>
<ul>
<li><p class="first">Command line tools. Command line tools includes Linux commands curl
or even browser plugins such as POSTMAN(for Google Chrome) or
RESTClient(for Mozilla Firefox). In this case, the following JSON
content is needed at the moment:
Service_function_schudule_type.json</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;service-function-scheduler-types&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;service-function-scheduler-type&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-scheduler-type:random&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;roundrobin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-scheduler-type:round-robin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;loadbalance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-scheduler-type:load-balance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;shortestpath&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-scheduler-type:shortest-path&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If using the Linux curl command, it could be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Cache-Control: no-cache&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s1">&#39;$$</span><span class="si">{Service_function_schudule_type.json}</span><span class="s1">&#39;</span>
<span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8181</span><span class="o">/</span><span class="n">restconf</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">scheduler</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span><span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">scheduler</span><span class="o">-</span><span class="n">types</span><span class="o">/</span>
</pre></div>
</div>
<p>Here is also a snapshot for using the RESTClient plugin:</p>
</li>
</ul>
<div class="figure" id="id232">
<img alt="Mozilla Firefox RESTClient" src="../_images/RESTClient-snapshot.png" />
<p class="caption"><span class="caption-text">Mozilla Firefox RESTClient</span></p>
</div>
<ul class="simple">
<li>SFC-UI.SFC-UI provides a drop down menu for service function
selection algorithm. Here is a snapshot for the user interaction from
SFC-UI when creating a Rendered Service Path.</li>
</ul>
<div class="figure" id="id233">
<img alt="Karaf Web UI" src="../_images/karaf-webui-select-a-type.png" />
<p class="caption"><span class="caption-text">Karaf Web UI</span></p>
<div class="legend">
<blockquote>
<div><p><strong>Note</strong></p>
<p>Some service function selection algorithms in the drop list are not
implemented yet. Only the first three algorithms are committed at
the moment.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="random">
<h5>Random<a class="headerlink" href="#random" title="Permalink to this headline">¶</a></h5>
<p>Select Service Function from the name list randomly.</p>
<div class="section" id="id97">
<h6>Overview<a class="headerlink" href="#id97" title="Permalink to this headline">¶</a></h6>
<p>The Random algorithm is used to select one Service Function from the
name list which it gets from the Service Function Type randomly.</p>
</div>
<div class="section" id="id98">
<h6>Prerequisites<a class="headerlink" href="#id98" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Service Function information are stored in datastore.</li>
<li>Either no algorithm or the Random algorithm is selected.</li>
</ul>
</div>
<div class="section" id="id99">
<h6>Target Environment<a class="headerlink" href="#id99" title="Permalink to this headline">¶</a></h6>
<p>The Random algorithm will work either no algorithm type is selected or
the Random algorithm is selected.</p>
</div>
<div class="section" id="id100">
<h6>Instructions<a class="headerlink" href="#id100" title="Permalink to this headline">¶</a></h6>
<p>Once the plugins are installed into Karaf successfully, a user can use
his favorite method to select the Random scheduling algorithm type.
There are no special instructions for using the Random algorithm.</p>
</div>
</div>
<div class="section" id="round-robin">
<h5>Round Robin<a class="headerlink" href="#round-robin" title="Permalink to this headline">¶</a></h5>
<p>Select Service Function from the name list in Round Robin manner.</p>
<div class="section" id="id101">
<h6>Overview<a class="headerlink" href="#id101" title="Permalink to this headline">¶</a></h6>
<p>The Round Robin algorithm is used to select one Service Function from
the name list which it gets from the Service Function Type in a Round
Robin manner, this will balance workloads to all Service Functions.
However, this method cannot help all Service Functions load the same
workload because it’s flow-based Round Robin.</p>
</div>
<div class="section" id="id102">
<h6>Prerequisites<a class="headerlink" href="#id102" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Service Function information are stored in datastore.</li>
<li>Round Robin algorithm is selected</li>
</ul>
</div>
<div class="section" id="id103">
<h6>Target Environment<a class="headerlink" href="#id103" title="Permalink to this headline">¶</a></h6>
<p>The Round Robin algorithm will work one the Round Robin algorithm is
selected.</p>
</div>
<div class="section" id="id104">
<h6>Instructions<a class="headerlink" href="#id104" title="Permalink to this headline">¶</a></h6>
<p>Once the plugins are installed into Karaf successfully, a user can use
his favorite method to select the Round Robin scheduling algorithm type.
There are no special instructions for using the Round Robin algorithm.</p>
</div>
</div>
<div class="section" id="load-balance-algorithm">
<h5>Load Balance Algorithm<a class="headerlink" href="#load-balance-algorithm" title="Permalink to this headline">¶</a></h5>
<p>Select appropriate Service Function by actual CPU utilization.</p>
<div class="section" id="id105">
<h6>Overview<a class="headerlink" href="#id105" title="Permalink to this headline">¶</a></h6>
<p>The Load Balance Algorithm is used to select appropriate Service
Function by actual CPU utilization of service functions. The CPU
utilization of service function obtained from monitoring information
reported via NETCONF.</p>
</div>
<div class="section" id="id106">
<h6>Prerequisites<a class="headerlink" href="#id106" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>CPU-utilization for Service Function.</li>
<li>NETCONF server.</li>
<li>NETCONF client.</li>
<li>Each VM has a NETCONF server and it could work with NETCONF client
well.</li>
</ul>
</div>
<div class="section" id="id107">
<h6>Instructions<a class="headerlink" href="#id107" title="Permalink to this headline">¶</a></h6>
<p>Set up VMs as Service Functions. enable NETCONF server in VMs. Ensure
that you specify them separately. For example:</p>
<ol class="loweralpha simple">
<li>Set up 4 VMs include 2 SFs&#8217; type are Firewall, Others are Napt44.
Name them as firewall-1, firewall-2, napt44-1, napt44-2 as Service
Function. The four VMs can run either the same server or different
servers.</li>
<li>Install NETCONF server on every VM and enable it. More information on
NETCONF can be found on the OpenDaylight wiki here:
<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Config:Examples:Netconf:Manual_netopeer_installation">https://wiki.opendaylight.org/view/OpenDaylight_Controller:Config:Examples:Netconf:Manual_netopeer_installation</a></li>
<li>Get Monitoring data from NETCONF server. These monitoring data should
be get from the NETCONF server which is running in VMs. The following
static XML data is an example:</li>
</ol>
<p>static XML data like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;service-function-description-monitor-report&gt;
  &lt;SF-description&gt;
    &lt;number-of-dataports&gt;2&lt;/number-of-dataports&gt;
    &lt;capabilities&gt;
      &lt;supported-packet-rate&gt;5&lt;/supported-packet-rate&gt;
      &lt;supported-bandwidth&gt;10&lt;/supported-bandwidth&gt;
      &lt;supported-ACL-number&gt;2000&lt;/supported-ACL-number&gt;
      &lt;RIB-size&gt;200&lt;/RIB-size&gt;
      &lt;FIB-size&gt;100&lt;/FIB-size&gt;
      &lt;ports-bandwidth&gt;
        &lt;port-bandwidth&gt;
          &lt;port-id&gt;1&lt;/port-id&gt;
          &lt;ipaddress&gt;10.0.0.1&lt;/ipaddress&gt;
          &lt;macaddress&gt;00:1e:67:a2:5f:f4&lt;/macaddress&gt;
          &lt;supported-bandwidth&gt;20&lt;/supported-bandwidth&gt;
        &lt;/port-bandwidth&gt;
        &lt;port-bandwidth&gt;
          &lt;port-id&gt;2&lt;/port-id&gt;
          &lt;ipaddress&gt;10.0.0.2&lt;/ipaddress&gt;
          &lt;macaddress&gt;01:1e:67:a2:5f:f6&lt;/macaddress&gt;
          &lt;supported-bandwidth&gt;10&lt;/supported-bandwidth&gt;
        &lt;/port-bandwidth&gt;
      &lt;/ports-bandwidth&gt;
    &lt;/capabilities&gt;
  &lt;/SF-description&gt;
  &lt;SF-monitoring-info&gt;
    &lt;liveness&gt;true&lt;/liveness&gt;
    &lt;resource-utilization&gt;
        &lt;packet-rate-utilization&gt;10&lt;/packet-rate-utilization&gt;
        &lt;bandwidth-utilization&gt;15&lt;/bandwidth-utilization&gt;
        &lt;CPU-utilization&gt;12&lt;/CPU-utilization&gt;
        &lt;memory-utilization&gt;17&lt;/memory-utilization&gt;
        &lt;available-memory&gt;8&lt;/available-memory&gt;
        &lt;RIB-utilization&gt;20&lt;/RIB-utilization&gt;
        &lt;FIB-utilization&gt;25&lt;/FIB-utilization&gt;
        &lt;power-utilization&gt;30&lt;/power-utilization&gt;
        &lt;SF-ports-bandwidth-utilization&gt;
          &lt;port-bandwidth-utilization&gt;
            &lt;port-id&gt;1&lt;/port-id&gt;
            &lt;bandwidth-utilization&gt;20&lt;/bandwidth-utilization&gt;
          &lt;/port-bandwidth-utilization&gt;
          &lt;port-bandwidth-utilization&gt;
            &lt;port-id&gt;2&lt;/port-id&gt;
            &lt;bandwidth-utilization&gt;30&lt;/bandwidth-utilization&gt;
          &lt;/port-bandwidth-utilization&gt;
        &lt;/SF-ports-bandwidth-utilization&gt;
    &lt;/resource-utilization&gt;
  &lt;/SF-monitoring-info&gt;
&lt;/service-function-description-monitor-report&gt;
</pre></div>
</div>
<ol class="loweralpha simple">
<li>Unzip SFC release tarball.</li>
<li>Run SFC: ${sfc}/bin/karaf. More information on Service Function
Chaining can be found on the OpenDaylight SFC’s wiki page:
<a class="reference external" href="https://wiki.opendaylight.org/view/Service_Function_Chaining:Main">https://wiki.opendaylight.org/view/Service_Function_Chaining:Main</a></li>
</ol>
<ol class="loweralpha simple">
<li>Deploy the SFC2 (firewall-abstract2⇒napt44-abstract2) and click
button to Create Rendered Service Path in SFC UI
(<a class="reference external" href="http://localhost:8181/sfc/index.html">http://localhost:8181/sfc/index.html</a>).</li>
<li>Verify the Rendered Service Path to ensure the CPU utilization of the
selected hop is the minimum one among all the service functions with
same type. The correct RSP is firewall-1⇒napt44-2</li>
</ol>
</div>
</div>
<div class="section" id="shortest-path-algorithm">
<h5>Shortest Path Algorithm<a class="headerlink" href="#shortest-path-algorithm" title="Permalink to this headline">¶</a></h5>
<p>Select appropriate Service Function by Dijkstra’s algorithm. Dijkstra’s
algorithm is an algorithm for finding the shortest paths between nodes
in a graph.</p>
<div class="section" id="id108">
<h6>Overview<a class="headerlink" href="#id108" title="Permalink to this headline">¶</a></h6>
<p>The Shortest Path Algorithm is used to select appropriate Service
Function by actual topology.</p>
</div>
<div class="section" id="id109">
<h6>Prerequisites<a class="headerlink" href="#id109" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Depolyed topology (include SFFs, SFs and their links).</li>
<li>Dijkstra’s algorithm. More information on Dijkstra’s algorithm can be
found on the wiki here:
<a class="reference external" href="http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm</a></li>
</ul>
</div>
<div class="section" id="id110">
<h6>Instructions<a class="headerlink" href="#id110" title="Permalink to this headline">¶</a></h6>
<ol class="loweralpha simple">
<li>Unzip SFC release tarball.</li>
<li>Run SFC: ${sfc}/bin/karaf.</li>
<li>Depoly SFFs and SFs. import the service-function-forwarders.json and
service-functions.json in UI
(<a class="reference external" href="http://localhost:8181/sfc/index.html#/sfc/config">http://localhost:8181/sfc/index.html#/sfc/config</a>)</li>
</ol>
<p>service-function-forwarders.json:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;service-function-forwarders&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;service-node&quot;</span><span class="p">:</span> <span class="s2">&quot;OVSDB-test01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:5001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sff-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder-ovs:ovs-bridge&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;4c3778e4-840d-47f4-b45e-0988e514d26c&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bridge-name&quot;</span><span class="p">:</span> <span class="s2">&quot;br-tun&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:vxlan-gpe&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;service-function-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10001</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;napt44-1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:napt44&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10003</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.102&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;firewall-1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;connected-sff-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br3&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;service-node&quot;</span><span class="p">:</span> <span class="s2">&quot;OVSDB-test01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:5002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sff-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder-ovs:ovs-bridge&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;fd4d849f-5140-48cd-bc60-6ad1f5fc0a1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bridge-name&quot;</span><span class="p">:</span> <span class="s2">&quot;br-tun&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.2&quot;</span><span class="p">,</span>
              <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:vxlan-gpe&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;service-function-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10002</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;napt44-2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:napt44&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10004</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.101&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;firewall-2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;connected-sff-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br3&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;service-node&quot;</span><span class="p">:</span> <span class="s2">&quot;OVSDB-test01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:5005&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sff-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;eth0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder-ovs:ovs-bridge&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;fd4d849f-5140-48cd-bc60-6ad1f5fc0a4&quot;</span><span class="p">,</span>
              <span class="s2">&quot;bridge-name&quot;</span><span class="p">:</span> <span class="s2">&quot;br-tun&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.2&quot;</span><span class="p">,</span>
              <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;service-locator:vxlan-gpe&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;service-function-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10005</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.104&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test-server&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:dpi&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;sff-sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10006</span><span class="p">,</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.102&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test-client&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:dpi&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;connected-sff-dictionary&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br1&quot;</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br2&quot;</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>service-functions.json:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;service-functions&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;service-function&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;preferred&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10001</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br1&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;napt44-1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:napt44&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;master&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10002</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br2&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;napt44-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:napt44&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10003</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.102&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br1&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;firewall-1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10004&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10004</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.101&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br2&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;firewall-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:firewall&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10005&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10005</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.104&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br3&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test-server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:dpi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10006&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sf-data-plane-locator&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">10006</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.102&quot;</span><span class="p">,</span>
            <span class="s2">&quot;service-function-forwarder&quot;</span><span class="p">:</span> <span class="s2">&quot;SFF-br3&quot;</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test-client&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:dpi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nsh-aware&quot;</span><span class="p">:</span> <span class="n">true</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The depolyed topology like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>          <span class="o">+----+</span>           <span class="o">+----+</span>          <span class="o">+----+</span>
          <span class="o">|</span><span class="n">sff1</span><span class="o">|+----------|</span><span class="n">sff3</span><span class="o">|---------+|</span><span class="n">sff2</span><span class="o">|</span>
          <span class="o">+----+</span>           <span class="o">+----+</span>          <span class="o">+----+</span>
            <span class="o">|</span>                                  <span class="o">|</span>
     <span class="o">+--------------+</span>                   <span class="o">+--------------+</span>
     <span class="o">|</span>              <span class="o">|</span>                   <span class="o">|</span>              <span class="o">|</span>
<span class="o">+----------+</span>   <span class="o">+--------+</span>          <span class="o">+----------+</span>   <span class="o">+--------+</span>
<span class="o">|</span><span class="n">firewall</span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>   <span class="o">|</span><span class="n">napt44</span><span class="o">-</span><span class="mi">1</span><span class="o">|</span>          <span class="o">|</span><span class="n">firewall</span><span class="o">-</span><span class="mi">2</span><span class="o">|</span>   <span class="o">|</span><span class="n">napt44</span><span class="o">-</span><span class="mi">2</span><span class="o">|</span>
<span class="o">+----------+</span>   <span class="o">+--------+</span>          <span class="o">+----------+</span>   <span class="o">+--------+</span>
</pre></div>
</div>
<ul class="simple">
<li>Deploy the SFC2(firewall-abstract2⇒napt44-abstract2), select
&#8220;Shortest Path&#8221; as schedule type and click button to Create Rendered
Service Path in SFC UI (<a class="reference external" href="http://localhost:8181/sfc/index.html">http://localhost:8181/sfc/index.html</a>).</li>
</ul>
<div class="figure" id="id234">
<img alt="select schedule type" src="../_images/sf-schedule-type.png" />
<p class="caption"><span class="caption-text">select schedule type</span></p>
</div>
<ul class="simple">
<li>Verify the Rendered Service Path to ensure the selected hops are
linked in one SFF. The correct RSP is firewall-1⇒napt44-1 or
firewall-2⇒napt44-2. The first SF type is Firewall in Service
Function Chain. So the algorithm will select first Hop randomly among
all the SFs type is Firewall. Assume the first selected SF is
firewall-2. All the path from firewall-1 to SF which type is Napt44
are list:<ul>
<li>Path1: firewall-2 → sff2 → napt44-2</li>
<li>Path2: firewall-2 → sff2 → sff3 → sff1 → napt44-1 The shortest
path is Path1, so the selected next hop is napt44-2.</li>
</ul>
</li>
</ul>
<div class="figure" id="id235">
<img alt="rendered service path" src="../_images/sf-rendered-service-path.png" />
<p class="caption"><span class="caption-text">rendered service path</span></p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="service-function-load-balancing-user-guide">
<h3>Service Function Load Balancing User Guide<a class="headerlink" href="#service-function-load-balancing-user-guide" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id111">
<h4>Overview<a class="headerlink" href="#id111" title="Permalink to this headline">¶</a></h4>
<p>SFC Load-Balancing feature implements load balancing of Service
Functions, rather than a one-to-one mapping between
Service-Function-Forwarder and Service-Function.</p>
</div>
<div class="section" id="load-balancing-architecture">
<h4>Load Balancing Architecture<a class="headerlink" href="#load-balancing-architecture" title="Permalink to this headline">¶</a></h4>
<p>Service Function Groups (SFG) can replace Service Functions (SF) in the
Rendered Path model. A Service Path can only be defined using SFGs or
SFs, but not a combination of both.</p>
<p>Relevant objects in the YANG model are as follows:</p>
<ol class="arabic">
<li><p class="first">Service-Function-Group-Algorithm:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Service</span><span class="o">-</span><span class="n">Function</span><span class="o">-</span><span class="n">Group</span><span class="o">-</span><span class="n">Algorithms</span> <span class="p">{</span>
    <span class="n">Service</span><span class="o">-</span><span class="n">Function</span><span class="o">-</span><span class="n">Group</span><span class="o">-</span><span class="n">Algorithm</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">name</span>
        <span class="n">String</span> <span class="nb">type</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Available</span> <span class="n">types</span><span class="p">:</span> <span class="n">ALL</span><span class="p">,</span> <span class="n">SELECT</span><span class="p">,</span> <span class="n">INDIRECT</span><span class="p">,</span> <span class="n">FAST_FAILURE</span>
</pre></div>
</div>
</li>
<li><p class="first">Service-Function-Group:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Service</span><span class="o">-</span><span class="n">Function</span><span class="o">-</span><span class="n">Groups</span> <span class="p">{</span>
    <span class="n">Service</span><span class="o">-</span><span class="n">Function</span><span class="o">-</span><span class="n">Group</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">name</span>
        <span class="n">String</span> <span class="n">serviceFunctionGroupAlgorithmName</span>
        <span class="n">String</span> <span class="nb">type</span>
        <span class="n">String</span> <span class="n">groupId</span>
        <span class="n">Service</span><span class="o">-</span><span class="n">Function</span><span class="o">-</span><span class="n">Group</span><span class="o">-</span><span class="n">Element</span> <span class="p">{</span>
            <span class="n">String</span> <span class="n">service</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">name</span>
            <span class="nb">int</span> <span class="n">index</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">ServiceFunctionHop: holds a reference to a name of SFG (or SF)</p>
</li>
</ol>
</div>
<div class="section" id="id112">
<h4>Tutorials<a class="headerlink" href="#id112" title="Permalink to this headline">¶</a></h4>
<p>This tutorial will explain how to create a simple SFC configuration,
with SFG instead of SF. In this example, the SFG will include two
existing SF.</p>
<div class="section" id="setup-sfc">
<h5>Setup SFC<a class="headerlink" href="#setup-sfc" title="Permalink to this headline">¶</a></h5>
<p>For general SFC setup and scenarios, please see the SFC wiki page:
<a class="reference external" href="https://wiki.opendaylight.org/view/Service_Function_Chaining:Main#SFC_101">https://wiki.opendaylight.org/view/Service_Function_Chaining:Main#SFC_101</a></p>
</div>
<div class="section" id="create-an-algorithm">
<h5>Create an algorithm<a class="headerlink" href="#create-an-algorithm" title="Permalink to this headline">¶</a></h5>
<p>POST -
<a class="reference external" href="http://127.0.0.1:8181/restconf/config/service-function-group-algorithm:service-function-group-algorithms">http://127.0.0.1:8181/restconf/config/service-function-group-algorithm:service-function-group-algorithms</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;service-function-group-algorithm&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;alg1&quot;</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ALL&quot;</span>
      <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>(Header &#8220;content-type&#8221;: application/json)</p>
</div>
<div class="section" id="verify-get-all-algorithms">
<h5>Verify: get all algorithms<a class="headerlink" href="#verify-get-all-algorithms" title="Permalink to this headline">¶</a></h5>
<p>GET -
<a class="reference external" href="http://127.0.0.1:8181/restconf/config/service-function-group-algorithm:service-function-group-algorithms">http://127.0.0.1:8181/restconf/config/service-function-group-algorithm:service-function-group-algorithms</a></p>
<p>In order to delete all algorithms: DELETE -
<a class="reference external" href="http://127.0.0.1:8181/restconf/config/service-function-group-algorithm:service-function-group-algorithms">http://127.0.0.1:8181/restconf/config/service-function-group-algorithm:service-function-group-algorithms</a></p>
</div>
<div class="section" id="create-a-group">
<h5>Create a group<a class="headerlink" href="#create-a-group" title="Permalink to this headline">¶</a></h5>
<p>POST -
<a class="reference external" href="http://127.0.0.1:8181/restconf/config/service-function-group:service-function-groups">http://127.0.0.1:8181/restconf/config/service-function-group:service-function-groups</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;service-function-group&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;rest-uri&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost:10002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip-mgmt-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.1.103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;alg1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SFG1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service-function-type:napt44&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sfc-service-function&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;napt44-104&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;napt44-103-1&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="verify-get-all-sfgs">
<h5>Verify: get all SFG’s<a class="headerlink" href="#verify-get-all-sfgs" title="Permalink to this headline">¶</a></h5>
<p>GET -
<a class="reference external" href="http://127.0.0.1:8181/restconf/config/service-function-group:service-function-groups">http://127.0.0.1:8181/restconf/config/service-function-group:service-function-groups</a></p>
</div>
</div>
</div>
</div>
<div class="section" id="snmp-plugin-user-guide">
<h2>SNMP Plugin User Guide<a class="headerlink" href="#snmp-plugin-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installing-feature">
<h3>Installing Feature<a class="headerlink" href="#installing-feature" title="Permalink to this headline">¶</a></h3>
<p>The SNMP Plugin can be installed using a single karaf feature:
<strong>odl-snmp-plugin</strong></p>
<p>After starting Karaf:</p>
<ul class="simple">
<li>Install the feature: <strong>feature:install odl-snmp-plugin</strong></li>
<li>Expose the northbound API: <strong>feature:install odl-restconf</strong></li>
</ul>
</div>
<div class="section" id="northbound-apis">
<h3>Northbound APIs<a class="headerlink" href="#northbound-apis" title="Permalink to this headline">¶</a></h3>
<p>There are two exposed northbound APIs: snmp-get &amp; snmp-set</p>
<div class="section" id="snmp-get">
<h4>SNMP GET<a class="headerlink" href="#snmp-get" title="Permalink to this headline">¶</a></h4>
<p>Default URL: <a class="reference external" href="http://localhost:8181/restconf/operations/snmp:snmp-get">http://localhost:8181/restconf/operations/snmp:snmp-get</a></p>
<div class="section" id="post-input">
<h5>POST Input<a class="headerlink" href="#post-input" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field Name</th>
<th class="head">Type</th>
<th class="head">Description</th>
<th class="head">Example</th>
<th class="head">Required?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ip-address</td>
<td>Ipv4 Address</td>
<td>The IPv4
Address of the
desired
network node</td>
<td>10.86.3.13</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>oid</td>
<td>String</td>
<td>The Object
Identifier of
the desired
MIB
table/object</td>
<td>1.3.6.1.2.1.1.
1</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>get-type</td>
<td>ENUM (GET,
GET-NEXT,
GET-BULK,
GET-WALK)</td>
<td>The type of
get request to
send</td>
<td>GET-BULK</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>community</td>
<td>String</td>
<td>The community
string to use
for the SNMP
request</td>
<td>private</td>
<td>No. (Default:
public)</td>
</tr>
</tbody>
</table>
<p><strong>Example.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ip-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.86.3.13&quot;</span><span class="p">,</span>
        <span class="s2">&quot;oid&quot;</span> <span class="p">:</span> <span class="s2">&quot;1.3.6.1.2.1.1.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get-type&quot;</span> <span class="p">:</span> <span class="s2">&quot;GET-BULK&quot;</span><span class="p">,</span>
        <span class="s2">&quot;community&quot;</span> <span class="p">:</span> <span class="s2">&quot;private&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="post-output">
<h5>POST Output<a class="headerlink" href="#post-output" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field Name</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>results</td>
<td>List of { &#8220;value&#8221; :
String } pairs</td>
<td>The results of the SNMP
query</td>
</tr>
</tbody>
</table>
<p><strong>Example.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;snmp:results&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Ethernet0/0/0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;oid&quot;</span><span class="p">:</span> <span class="s2">&quot;1.3.6.1.2.1.2.2.1.2.1&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;FastEthernet0/0/0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;oid&quot;</span><span class="p">:</span> <span class="s2">&quot;1.3.6.1.2.1.2.2.1.2.2&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;GigabitEthernet0/0/0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;oid&quot;</span><span class="p">:</span> <span class="s2">&quot;1.3.6.1.2.1.2.2.1.2.3&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="snmp-set">
<h4>SNMP SET<a class="headerlink" href="#snmp-set" title="Permalink to this headline">¶</a></h4>
<p>Default URL: <a class="reference external" href="http://localhost:8181/restconf/operations/snmp:snmp-set">http://localhost:8181/restconf/operations/snmp:snmp-set</a></p>
<div class="section" id="id113">
<h5>POST Input<a class="headerlink" href="#id113" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Field Name</th>
<th class="head">Type</th>
<th class="head">Description</th>
<th class="head">Example</th>
<th class="head">Required?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ip-address</td>
<td>Ipv4 Address</td>
<td>The Ipv4
address of the
desired
network node</td>
<td>10.86.3.13</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>oid</td>
<td>String</td>
<td>The Object
Identifier of
the desired
MIB object</td>
<td>1.3.6.2.1.1.1</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>value</td>
<td>String</td>
<td>The value to
set on the
network device</td>
<td>&#8220;Hello World&#8221;</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>community</td>
<td>String</td>
<td>The community
string to use
for the SNMP
request</td>
<td>private</td>
<td>No. (Default:
public)</td>
</tr>
</tbody>
</table>
<p><strong>Example.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ip-address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.86.3.13&quot;</span><span class="p">,</span>
        <span class="s2">&quot;oid&quot;</span> <span class="p">:</span> <span class="s2">&quot;1.3.6.1.2.1.1.1.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;Sample description&quot;</span><span class="p">,</span>
        <span class="s2">&quot;community&quot;</span> <span class="p">:</span> <span class="s2">&quot;private&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id114">
<h5>POST Output<a class="headerlink" href="#id114" title="Permalink to this headline">¶</a></h5>
<p>On a successful SNMP-SET, no output is presented, just a HTTP status of
200.</p>
</div>
<div class="section" id="errors">
<h5>Errors<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h5>
<p>If any errors happen in the set request, you will be presented with an
error message in the output.</p>
<p>For example, on a failed set request you may see an error like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;error-type&quot;</span><span class="p">:</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span>
                <span class="s2">&quot;error-tag&quot;</span><span class="p">:</span> <span class="s2">&quot;operation-failed&quot;</span><span class="p">,</span>
                <span class="s2">&quot;error-message&quot;</span><span class="p">:</span> <span class="s2">&quot;SnmpSET failed with error status: 17, error index: 1. StatusText: Not writable&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>which corresponds to Error status 17 in the SNMPv2 RFC:
<a class="reference external" href="https://tools.ietf.org/html/rfc1905">https://tools.ietf.org/html/rfc1905</a>.</p>
</div>
</div>
</div>
</div>
<div class="section" id="sxp-user-guide">
<h2>SXP User Guide<a class="headerlink" href="#sxp-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id115">
<h3>Overview<a class="headerlink" href="#id115" title="Permalink to this headline">¶</a></h3>
<p>SXP (Source-Group Tag eXchange Protocol) project is an effort to enhance
OpenDaylight platform with IP-SGT (IP Address to Source Group Tag)
bindings that can be learned from connected SXP-aware network nodes. The
current implementation supports SXP protocol version 4 according to the
Smith, Kandula - SXP <a class="reference external" href="https://tools.ietf.org/html/draft-smith-kandula-sxp-04">IETF
draft</a> and
grouping of peers and creating filters based on ACL/Prefix-list syntax
for filtering outbound and inbound IP-SGT bindings. All protocol legacy
versions 1-3 are supported as well. Additionally, version 4 adds
bidirectional connection type as an extension of a unidirectional one.</p>
</div>
<div class="section" id="sxp-architecture">
<h3>SXP Architecture<a class="headerlink" href="#sxp-architecture" title="Permalink to this headline">¶</a></h3>
<p>The SXP Server manages all connected clients in separate threads and a
common SXP protocol agreement is used between connected peers. Each SXP
network peer is modelled with its pertaining class, e.g., SXP Server
represents the SXP Speaker, SXP Listener the Client. The server program
creates the ServerSocket object on a specified port and waits until a
client starts up and requests connect on the IP address and port of the
server. The client program opens a Socket that is connected to the
server running on the specified host IP address and port.</p>
<p>The SXP Listener maintains connection with its speaker peer. From an
opened channel pipeline, all incoming SXP messages are processed by
various handlers. Message must be decoded, parsed and validated.</p>
<p>The SXP Speaker is a counterpart to the SXP Listener. It maintains a
connection with its listener peer and sends composed messages.</p>
<p>The SXP Binding Handler extracts the IP-SGT binding from a message and
pulls it into the SXP-Database. If an error is detected during the
IP-SGT extraction, an appropriate error code and sub-code is selected
and an error message is sent back to the connected peer. All transitive
messages are routed directly to the output queue of SXP Binding
Dispatcher.</p>
<p>The IP-SGT Manager handles bindings from multiple connections. If a new
data has been added into or deleted from the SXP-Database, or binding’s
contributor change is detected, the manager performs an arbitration
process above the SXP-Database to resolve the binding duplicity and
prevent possible information loops. Finally, it updates the
IP-SGT-Master database that consists only of valid and unique bindings,
i.e., a single binding per IP address.</p>
<p>The IP-SGT Manager also contains RPCs that can be used by other
OpenDaylight plugins, or by making REST calls, to add, update or to
delete bindings in or from the SXP-database.</p>
<p>The SXP Binding Dispatcher represents a selector that will decides how
many data from the SXP-database will be sent and when. It is responsible
for message content composition based on maximum message length.</p>
<p>The SXP Binding Filters handles filtering of outcoming and incoming
IP-SGT bindings according to BGP filtering using ACL and Prefix List
syntax for specifiing filter.</p>
</div>
<div class="section" id="configuring-sxp">
<h3>Configuring SXP<a class="headerlink" href="#configuring-sxp" title="Permalink to this headline">¶</a></h3>
<p>The OpenDaylight Karaf distribution comes pre-configured with baseline
SXP configuration.</p>
<ul class="simple">
<li><strong>22-sxp-controller-one-node.xml</strong> (defines the basic parameters)</li>
</ul>
</div>
<div class="section" id="administering-or-managing-sxp">
<h3>Administering or Managing SXP<a class="headerlink" href="#administering-or-managing-sxp" title="Permalink to this headline">¶</a></h3>
<p>By RPC (response is XML document containing requested data or operation
status):</p>
<ul class="simple">
<li>Get Connections POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:get-connections">http://127.0.0.1:8181/restconf/operations/sxp-controller:get-connections</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">requested</span><span class="o">-</span><span class="n">node</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.100</span><span class="o">&lt;/</span><span class="n">requested</span><span class="o">-</span><span class="n">node</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>Add Connection POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:add-connection">http://127.0.0.1:8181/restconf/operations/sxp-controller:add-connection</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;input xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
 &lt;connections&gt;
  &lt;connection&gt;
   &lt;!--vpn&gt;vpn1&lt;/vpn--&gt;
   &lt;peer-address&gt;172.20.161.50&lt;/peer-address&gt;
   &lt;!--source-ip&gt;&lt;/source-ip--&gt;
   &lt;tcp-port&gt;64999&lt;/tcp-port&gt;
   &lt;!-- Password setup: default | none --&gt;
   &lt;password&gt;default&lt;/password&gt;
   &lt;!-- Mode: speaker/listener/both --&gt;
   &lt;mode&gt;speaker&lt;/mode&gt;
   &lt;version&gt;version4&lt;/version&gt;
   &lt;description&gt;Connection to ASR1K&lt;/description&gt;
   &lt;!-- Timers setup: 0 to disable specific timer usability, the default value will be used --&gt;
   &lt;connection-timers&gt;
    &lt;!-- Speaker --&gt;
    &lt;hold-time-min-acceptable&gt;45&lt;/hold-time-min-acceptable&gt;
    &lt;keep-alive-time&gt;30&lt;/keep-alive-time&gt;
   &lt;/connection-timers&gt;
  &lt;/connection&gt;
  &lt;connection&gt;
   &lt;!--vpn&gt;vpn1&lt;/vpn--&gt;
   &lt;peer-address&gt;172.20.161.178&lt;/peer-address&gt;
   &lt;!--source-ip&gt;&lt;/source-ip--&gt;
   &lt;tcp-port&gt;64999&lt;/tcp-port&gt;
   &lt;!-- Password setup: default | none --&gt;
   &lt;password&gt;default&lt;/password&gt;
   &lt;!-- Mode: speaker/listener/both --&gt;
   &lt;mode&gt;listener&lt;/mode&gt;
   &lt;version&gt;version4&lt;/version&gt;
   &lt;description&gt;Connection to ISR&lt;/description&gt;
   &lt;!-- Timers setup: 0 to disable specific timer usability, the default value will be used --&gt;
   &lt;connection-timers&gt;
    &lt;!-- Listener --&gt;
    &lt;!-- NON-CONFIGURABLE delete-hold-down-time --&gt;
    &lt;reconciliation-time&gt;120&lt;/reconciliation-time&gt;
    &lt;hold-time&gt;90&lt;/hold-time&gt;
    &lt;hold-time-min&gt;90&lt;/hold-time-min&gt;
    &lt;hold-time-max&gt;180&lt;/hold-time-max&gt;
   &lt;/connection-timers&gt;
  &lt;/connection&gt;
 &lt;/connections&gt;
&lt;/input&gt;
</pre></div>
</div>
<ul class="simple">
<li>Delete Connection POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:delete-connection">http://127.0.0.1:8181/restconf/operations/sxp-controller:delete-connection</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">peer</span><span class="o">-</span><span class="n">address</span><span class="o">&gt;</span><span class="mf">172.20</span><span class="o">.</span><span class="mf">161.50</span><span class="o">&lt;/</span><span class="n">peer</span><span class="o">-</span><span class="n">address</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>Add Binding Entry POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:add-entry">http://127.0.0.1:8181/restconf/operations/sxp-controller:add-entry</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">2.1</span><span class="o">/</span><span class="mi">32</span><span class="o">&lt;/</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">sgt</span><span class="o">&gt;</span><span class="mi">20</span><span class="o">&lt;/</span><span class="n">sgt</span> <span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>Update Binding Entry POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:update-entry">http://127.0.0.1:8181/restconf/operations/sxp-controller:update-entry</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">original</span><span class="o">-</span><span class="n">binding</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">2.1</span><span class="o">/</span><span class="mi">32</span><span class="o">&lt;/</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">sgt</span><span class="o">&gt;</span><span class="mi">20</span><span class="o">&lt;/</span><span class="n">sgt</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">original</span><span class="o">-</span><span class="n">binding</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">new</span><span class="o">-</span><span class="n">binding</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">3.1</span><span class="o">/</span><span class="mi">32</span><span class="o">&lt;/</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">sgt</span><span class="o">&gt;</span><span class="mi">30</span><span class="o">&lt;/</span><span class="n">sgt</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">new</span><span class="o">-</span><span class="n">binding</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>Delete Binding Entry POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:delete-entry">http://127.0.0.1:8181/restconf/operations/sxp-controller:delete-entry</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">3.1</span><span class="o">/</span><span class="mi">32</span><span class="o">&lt;/</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">sgt</span><span class="o">&gt;</span><span class="mi">30</span><span class="o">&lt;/</span><span class="n">sgt</span> <span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul>
<li><p class="first">Get Node Bindings</p>
<p>This RPC gets particular device bindings. An SXP-aware node is
identified with a unique Node-ID. If a user requests bindings for a
Speaker 20.0.0.2, the RPC will search for an appropriate path, which
contains 20.0.0.2 Node-ID, within locally learnt SXP data in the SXP
database and replies with associated bindings. POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:get-node-bindings">http://127.0.0.1:8181/restconf/operations/sxp-controller:get-node-bindings</a></p>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">requested</span><span class="o">-</span><span class="n">node</span><span class="o">&gt;</span><span class="mf">20.0</span><span class="o">.</span><span class="mf">0.2</span><span class="o">&lt;/</span><span class="n">requested</span><span class="o">-</span><span class="n">node</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li>Get Binding SGTs POST
<a class="reference external" href="http://127.0.0.1:8181/restconf/operations/sxp-controller:get-binding-sgts">http://127.0.0.1:8181/restconf/operations/sxp-controller:get-binding-sgts</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">12.2</span><span class="o">/</span><span class="mi">32</span><span class="o">&lt;/</span><span class="n">ip</span><span class="o">-</span><span class="n">prefix</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="use-cases-for-sxp">
<h4>Use cases for SXP<a class="headerlink" href="#use-cases-for-sxp" title="Permalink to this headline">¶</a></h4>
<p>Cisco has a wide installed base of network devices supporting SXP. By
including SXP in OpenDaylight, the binding of policy groups to IP
addresses can be made available for possible further processing to a
wide range of devices, and applications running on OpenDaylight. The
range of applications that would be enabled is extensive. Here are just
a few of them:</p>
<p>OpenDaylight based applications can take advantage of the IP-SGT binding
information. For example, access control can be defined by an operator
in terms of policy groups, while OpenDaylight can configure access
control lists on network elements using IP addresses, e.g., existing
technology.</p>
<p>Interoperability between different vendors. Vendors have different
policy systems. Knowing the IP-SGT binding for Cisco makes it possible
to maintain policy groups between Cisco and other vendors.</p>
<p>OpenDaylight can aggregate the binding information from many devices and
communicate it to a network element. For example, a firewall can use the
IP-SGT binding information to know how to handle IPs based on the
group-based ACLs it has set. But to do this with SXP alone, the firewall
has to maintain a large number of network connections to get the binding
information. This incurs heavy overhead costs to maintain all of the SXP
peering and protocol information. OpenDaylight can aggregate the
IP-group information so that the firewall need only connect to
OpenDaylight. By moving the information flow outside of the network
elements to a centralized position, we reduce the overhead of the CPU
consumption on the enforcement element. This is a huge savings - it
allows the enforcement point to only have to make one connection rather
than thousands, so it can concentrate on its primary job of forwarding
and enforcing.</p>
<p>OpenDaylight can relay the binding information from one network element
to others. Changes in group membership can be propagated more readily
through a centralized model. For example, in a security application a
particular host (e.g., user or IP Address) may be found to be acting
suspiciously or violating established security policies. The defined
response is to put the host into a different source group for
remediation actions such as a lower quality of service, restricted
access to critical servers, or special routing conditions to ensure
deeper security enforcement (e.g., redirecting the host’s traffic
through an IPS with very restrictive policies). Updated group membership
for this host needs to be communicated to multiple network elements as
soon as possible; a very efficient and effective method of propagation
can be performed using OpenDaylight as a centralized point for relaying
the information.</p>
<p>OpenDayLight can create filters for exporting and recieving IP-SGTT
bindings used on specific peer groups, thus can provide more complex
maintaining of policy groups.</p>
<p>Although the IP-SGT binding is only one specific piece of information,
and although SXP is implemented widely in a single vendor’s equipment,
bringing the ability of OpenDaylight to process and distribute the
bindings, is a very specific immediate useful implementation of policy
groups. It would go a long way to develop both the usefulness of
OpenDaylight and of policy groups.</p>
</div>
</div>
</div>
<div class="section" id="tcpmd5-user-guide">
<h2>TCPMD5 User Guide<a class="headerlink" href="#tcpmd5-user-guide" title="Permalink to this headline">¶</a></h2>
<p>This user guide describes the configuration for Border Gateway Protocol
(BGP) and Path Computation Element Protocol (PCEP) using MD5
authentication. It is destined for users who build applications using
MD5 library.</p>
<div class="section" id="id116">
<h3>Overview<a class="headerlink" href="#id116" title="Permalink to this headline">¶</a></h3>
<p>The TCPMD5 library provides access to
<a class="reference external" href="http://tools.ietf.org/html/rfc2385">RFC-2385</a> MD5 Signature Option
on operating systems which support it in their TCP stack. This option
has been historically used to protect BGP sessions, but is equally
useful for protecting PCEP sessions.</p>
<blockquote>
<div><p><strong>Important</strong></p>
<p><strong>Before you continue with steps in this user guide, make sure BGP
and/or PCEP is configured properly.</strong></p>
</div></blockquote>
<p>TCPMD5 authentication is <strong>disabled</strong> by default. To enable it (for both
protocols), uncomment the contents of <em>20-tcpmd5.xml</em>. You can find this
configuration file in your OpenDaylight directory
<em>etc/opendaylight/karaf</em> .</p>
<blockquote>
<div><p><strong>Caution</strong></p>
<p><strong>If the connection can not be established, there are no warnings or
errors, so be sure to double check your configuration and
passwords.</strong></p>
</div></blockquote>
</div>
<div class="section" id="configuring-tcpmd5-manually">
<h3>Configuring TCPMD5 manually<a class="headerlink" href="#configuring-tcpmd5-manually" title="Permalink to this headline">¶</a></h3>
<div class="section" id="bgp">
<h4>BGP<a class="headerlink" href="#bgp" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p><strong>Important</strong></p>
<p><strong>Make sure your *20-tcpmd5.xml* has its content uncommented.</strong></p>
</div></blockquote>
<p>To enable TCPMD5 for the BGP protocol, perform the following steps:</p>
<ol class="arabic">
<li><p class="first">In <em>31-bgp.xml</em> uncomment the TCP MD5 section:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;!--
 Uncomment this block to enable TCPMD5 Signature support
--&gt;
&lt;md5-channel-factory&gt;
 &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;&gt;prefix:md5-channel-factory&lt;/type&gt;
 &lt;name&gt;md5-client-channel-factory&lt;/name&gt;
&lt;/md5-channel-factory&gt;
&lt;md5-server-channel-factory&gt;
 &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;&gt;prefix:md5-server-channel-factory&lt;/type&gt;
 &lt;name&gt;md5-server-channel-factory&lt;/name&gt;
&lt;/md5-server-channel-factory&gt;
</pre></div>
</div>
</li>
<li><p class="first">In <em>41-bgp-example.xml</em> add &lt;password&gt; tag to module
example-bgp-peer.</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>   &lt;!--
    For TCPMD5 support, make sure the dispatcher associated with the rib has
    &quot;md5-channel-factory&quot; attribute set and then add a &quot;password&quot; attribute here.
    Note that the peer has to have the same password configured, otherwise the
    connection will not be established.
   --&gt;
   &lt;module&gt;
    &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;prefix:bgp-peer&lt;/type&gt;
    &lt;name&gt;example-bgp-peer&lt;/name&gt;
    &lt;host&gt;10.25.2.27&lt;/host&gt;
    &lt;holdtimer&gt;180&lt;/holdtimer&gt;
    &lt;rib&gt;
     &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:cfg&quot;&gt;prefix:rib&lt;/type&gt;
     &lt;name&gt;example-bgp-rib&lt;/name&gt;
    &lt;/rib&gt;
    &lt;advertized-table&gt;
     &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;prefix:bgp-table-type&lt;/type&gt;
     &lt;name&gt;ipv4-unicast&lt;/name&gt;
    &lt;/advertized-table&gt;
    &lt;advertized-table&gt;
     &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;prefix:bgp-table-type&lt;/type&gt;
     &lt;name&gt;ipv6-unicast&lt;/name&gt;
    &lt;/advertized-table&gt;
    &lt;advertized-table&gt;
     &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;&gt;prefix:bgp-table-type&lt;/type&gt;
     &lt;name&gt;linkstate&lt;/name&gt;
    &lt;/advertized-table&gt;
    &lt;password&gt;changeme&lt;/password&gt;
   &lt;/module&gt;

**Note**

Setting a password on other BGP devices is out of scope for this
document.
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="pcep">
<h4>PCEP<a class="headerlink" href="#pcep" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p><strong>Important</strong></p>
<p><strong>Make sure your *20-tcpmd5.xml* has its content uncommented.</strong></p>
</div></blockquote>
<p>To enable TCPMD5 for PCE protocol, perform the following steps:</p>
<ol class="arabic">
<li><p class="first">In <em>32-pcep.xml</em> uncomment the TCPMD5 section:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;!--
 Uncomment this block to enable TCPMD5 Signature support
--&gt;
&lt;md5-channel-factory&gt;
 &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;&gt;prefix:md5-channel-factory&lt;/type&gt;
  &lt;name&gt;md5-client-channel-factory&lt;/name&gt;
&lt;/md5-channel-factory&gt;
&lt;md5-server-channel-factory&gt;
 &lt;type xmlns:prefix=&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;&gt;prefix:md5-server-channel-factory&lt;/type&gt;
  &lt;name&gt;md5-server-channel-factory&lt;/name&gt;
&lt;/md5-server-channel-factory&gt;
</pre></div>
</div>
</li>
<li><p class="first">In <em>39-pcep-provider.xml</em> uncomment following section:</p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>   &lt;!--
    For TCPMD5 support make sure the dispatcher has the &quot;md5-server-channel-factory&quot;
    attribute set and then set the appropriate client entries here. Note that if this
    option is configured, the PCCs connecting here must have the same password,
    otherwise they will not be able to connect.
    --&gt;
    &lt;client&gt;
     &lt;address&gt;192.0.2.2&lt;/address&gt;
     &lt;password&gt;changeme&lt;/password&gt;
    &lt;/client&gt;

**Important**

**Change the &lt;address&gt; value to the address of PCC, the one that is
advertized to PCE and provide password matching the one set on
PCC.**

**Note**

Setting a password on PCC is out of scope for this document.
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="configuring-tcpmd5-through-restconf">
<h3>Configuring TCPMD5 through RESTCONF<a class="headerlink" href="#configuring-tcpmd5-through-restconf" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p><strong>Important</strong></p>
<p>Before you start, make sure, you have installed features for BGP
and/or PCEP. Install another feature, that will provide you the
access to <em>restconf/config/</em> URLs.</p>
</div></blockquote>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="nb">all</span>
</pre></div>
</div>
<p>This log message indicates successful start of netconf-connector:
<em>Netconf connector initialized successfully</em></p>
<ul class="simple">
<li>To check what modules you have currently configured, check following
link:
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/</a></li>
<li>To check what services you have currently configured, check following
link:
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:services/">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:services/</a></li>
</ul>
<p>These URLs are also used to POST new configuration. If you want to
change any other configuration that is listed here, make sure you
include the correct namespaces. The correct namespace for &lt;module&gt; is
always <em>urn:opendaylight:params:xml:ns:yang:controller:config</em>. The
namespace for any other fields can be found by finding given module in
configuration yang files.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>RESTCONF will tell you if some namespace is wrong.</p>
</div></blockquote>
<p>To enable TCPMD5 for either one of the protocols, enable TCPMD5 modules
and services:</p>
<blockquote>
<div><p><strong>Caution</strong></p>
<p>You have to make <strong>separate</strong> POST requests for each module/service!</p>
</div></blockquote>
<p>*URL:
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/</a></p>
<p><strong>POST:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:jni:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">native</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">-</span><span class="n">impl</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">server</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">server</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>URL:</strong>
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:services/">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:services/</a></p>
<p><strong>POST:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">service</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">instance</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">key</span><span class="o">-</span><span class="n">access</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">provider</span><span class="o">&gt;/</span><span class="n">modules</span><span class="o">/</span><span class="n">module</span><span class="p">[</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;native-key-access-factory&#39;</span><span class="p">][</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;global-key-access-factory&#39;</span><span class="p">]</span><span class="o">&lt;/</span><span class="n">provider</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">instance</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">service</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">service</span>  <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">instance</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">provider</span><span class="o">&gt;/</span><span class="n">modules</span><span class="o">/</span><span class="n">module</span><span class="p">[</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;md5-client-channel-factory&#39;</span><span class="p">][</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;md5-client-channel-factory&#39;</span><span class="p">]</span><span class="o">&lt;/</span><span class="n">provider</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">instance</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">service</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">service</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">instance</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">provider</span><span class="o">&gt;/</span><span class="n">modules</span><span class="o">/</span><span class="n">module</span><span class="p">[</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;md5-server-channel-factory-impl&#39;</span><span class="p">][</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;md5-server-channel-factory&#39;</span><span class="p">]</span><span class="o">&lt;/</span><span class="n">provider</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">instance</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">service</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="id117">
<h4>BGP<a class="headerlink" href="#id117" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p><strong>Caution</strong></p>
<p>You have to introduce modules and services mentioned in the previous
section. Your BGP client needs to be <strong>ALREADY</strong> configured. Check
User Guide for BGP.</p>
<p><strong>Caution</strong></p>
<p>You need to copy and paste FULL module in order to replace it. This
guide shows you part you need to change.</p>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Enabling TCPMD5 in BGP configuration:</p>
<p><strong>URL:</strong>
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-bgp-rib-impl-cfg:bgp-dispatcher-impl/global-bgp-dispatcher">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-bgp-rib-impl-cfg:bgp-dispatcher-impl/global-bgp-dispatcher</a></p>
</li>
</ol>
<p><strong>PUT:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">-</span><span class="n">impl</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
 <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>

<span class="o">**</span><span class="n">Caution</span><span class="o">**</span>

<span class="n">You</span> <span class="n">need</span> <span class="n">to</span> <span class="n">copy</span> <span class="ow">and</span> <span class="n">paste</span> <span class="n">FULL</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">replace</span> <span class="n">it</span><span class="o">.</span> <span class="n">This</span>
<span class="n">guide</span> <span class="n">shows</span> <span class="n">you</span> <span class="n">part</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">change</span><span class="o">.</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">Set password:</p>
<p><strong>URL:</strong>
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-bgp-rib-impl-cfg:bgp-peer/example-bgp-peer">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-bgp-rib-impl-cfg:bgp-peer/example-bgp-peer</a></p>
</li>
</ol>
<p><strong>PUT:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">example</span><span class="o">-</span><span class="n">bgp</span><span class="o">-</span><span class="n">peer</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">password</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:bgp:rib:impl&quot;</span><span class="o">&gt;</span><span class="n">changeme</span><span class="o">&lt;/</span><span class="n">password</span><span class="o">&gt;</span>
 <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="id118">
<h4>PCEP<a class="headerlink" href="#id118" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p><strong>Caution</strong></p>
<p>You have to introduce modules and services mentioned in the previous
section.</p>
<p><strong>Caution</strong></p>
<p>You need to copy and paste FULL module in order to replace it. This
guide shows you part you need to change.</p>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Enable TCPMD5 in PCEP configuration:</p>
<p><strong>URL:</strong>
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-pcep-impl-cfg:pcep-dispatcher-impl/global-pcep-dispatcher">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-pcep-impl-cfg:pcep-dispatcher-impl/global-pcep-dispatcher</a></p>
</li>
</ol>
<p><strong>PUT:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:impl&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">pcep</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">-</span><span class="n">impl</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">pcep</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">md5</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:impl&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:tcpmd5:netty:cfg&quot;</span><span class="o">&gt;</span><span class="n">x</span><span class="p">:</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">md5</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">channel</span><span class="o">-</span><span class="n">factory</span><span class="o">&gt;</span>
 <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>

<span class="o">**</span><span class="n">Caution</span><span class="o">**</span>

<span class="n">You</span> <span class="n">need</span> <span class="n">to</span> <span class="n">copy</span> <span class="ow">and</span> <span class="n">paste</span> <span class="n">FULL</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">replace</span> <span class="n">it</span><span class="o">.</span> <span class="n">This</span>
<span class="n">guide</span> <span class="n">shows</span> <span class="n">you</span> <span class="n">part</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">change</span><span class="o">.</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">Set password:</p>
<p><strong>URL:</strong>
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-pcep-impl-cfg:pcep-topology-provider/pcep-topology">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/odl-pcep-impl-cfg:pcep-topology-provider/pcep-topology</a></p>
</li>
</ol>
<p><strong>PUT:</strong></p>
<div class="code xml highlight-default"><div class="highlight"><pre><span></span>&lt;module xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;&gt;
 &lt;type xmlns:x=&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:topology:provider&quot;&gt;x:pcep-topology-provider&lt;/type&gt;
 &lt;name&gt;pcep-topology&lt;/name&gt;
 &lt;client xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:topology:provider&quot;&gt;
  &lt;address xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:pcep:topology:provider&quot;&gt;192.0.2.2&lt;/address&gt; &lt;!--CHANGE THE VALUE --&gt;
  &lt;password&gt;changeme&lt;/password&gt; &lt;!--CHANGE THE VALUE --&gt;
 &lt;/client&gt;
 ...
&lt;/module&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tsdr-user-guide">
<h2>TSDR User Guide<a class="headerlink" href="#tsdr-user-guide" title="Permalink to this headline">¶</a></h2>
<p>This document describes how to use HSQLDB, HBase, and Cassandra data
stores to capture time series data using Time Series Data Repository
(TSDR) features in OpenDaylight. This document contains configuration,
administration, management, usage, and troubleshooting sections for the
features.</p>
<div class="section" id="id119">
<h3>Overview<a class="headerlink" href="#id119" title="Permalink to this headline">¶</a></h3>
<p>The Time Series Data Repository (TSDR) project in OpenDaylight (ODL)
creates a framework for collecting, storing, querying, and maintaining
time series data. TSDR provides the framework for plugging in proper
data collectors to collect various time series data and store the data
into TSDR Data Stores. With a common data model and generic TSDR data
persistence APIs, the user can choose various data stores to be plugged
into the TSDR persistence framework. Currently, three types of data
stores are supported: HSQLDB relational database, HBase NoSQL database,
and Cassandra NoSQL database.</p>
<p>With the capabilities of data collection, storage, query, aggregation,
and purging provided by TSDR, network administrators can leverage
various data driven appliations built on top of TSDR for security risk
detection, performance analysis, operational configuration optimization,
traffic engineering, and network analytics with automated intelligence.</p>
</div>
<div class="section" id="tsdr-architecture">
<h3>TSDR Architecture<a class="headerlink" href="#tsdr-architecture" title="Permalink to this headline">¶</a></h3>
<p>TSDR has the following major components:</p>
<ul class="simple">
<li>Data Collection Service</li>
<li>Data Storage Service</li>
<li>TSDR Persistence Layer with data stores as plugins</li>
<li>TSDR Data Stores</li>
<li>Data Query Service</li>
<li>Grafana integration for time series data visualization</li>
<li>Data Aggregation Service</li>
<li>Data Purging Service</li>
</ul>
<p>The Data Collection Service handles the collection of time series data
into TSDR and hands it over to the Data Storage Service. The Data
Storage Service stores the data into TSDR through the TSDR Persistence
Layer. The TSDR Persistence Layer provides generic Service APIs allowing
various data stores to be plugged in. The Data Aggregation Service
aggregates time series fine-grained raw data into course-grained roll-up
data to control the size of the data. The Data Purging Service
periodically purges both fine-grained raw data and course-granined
aggregated data according to user-defined schedules.</p>
<p>We have implemented The Data Collection Service, Data Storage Service,
TSDR Persistence Layer, TSDR HSQLDB Data Store, TSDR HBase Data Store,
and TSDR Cassandra Datastore. Among these services and components, time
series data is communicated using a common TSDR data model, which is
designed and implemented for the abstraction of time series data
commonalities. With these functions, TSDR is able to collect the data
from the data sources and store them into one of the TSDR data stores:
HSQLDB Data Store, HBase Data Store or Cassandra Data Store. Besides a
simple query command from Karaf console to retrieve data from the TSDR
data stores, we also provided a Data Query Service for the user to use
REST API to query the data from the data stores. Moreover, the user can
use Grafana, which is a time series visualization tool to view the data
stored in TSDR in various charting formats.</p>
</div>
<div class="section" id="configuring-tsdr-data-stores">
<h3>Configuring TSDR Data Stores<a class="headerlink" href="#configuring-tsdr-data-stores" title="Permalink to this headline">¶</a></h3>
<div class="section" id="to-configure-hsqldb-data-store">
<h4>To Configure HSQLDB Data Store<a class="headerlink" href="#to-configure-hsqldb-data-store" title="Permalink to this headline">¶</a></h4>
<p>The HSQLDB based storage files get stored automatically in &lt;karaf
install folder&gt;/tsdr/ directory. If you want to change the default
storage location, the configuration file to change can be found in
&lt;karaf install folder&gt;/etc directory. The filename is
org.ops4j.datasource-metric.cfg. Change the last portion of the
url=jdbc:hsqldb:./tsdr/metric to point to different directory.</p>
</div>
<div class="section" id="to-configure-hbase-data-store">
<h4>To Configure HBase Data Store<a class="headerlink" href="#to-configure-hbase-data-store" title="Permalink to this headline">¶</a></h4>
<p>After installing HBase Server on the same machine as OpenDaylight, if
the user accepts the default configuration of the HBase Data Store, the
user can directly proceed with the installation of HBase Data Store from
Karaf console.</p>
<p>Optionally, the user can configure TSDR HBase Data Store following HBase
Data Store Configuration Procedure.</p>
<ul class="simple">
<li>HBase Data Store Configuration Steps<ul>
<li>Open the file etc/tsdr-persistence-hbase.peroperties under karaf
distribution directory.</li>
<li>Edit the following parameters:<ul>
<li>HBase server name</li>
<li>HBase server port</li>
<li>HBase client connection pool size</li>
<li>HBase client write buffer size</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>After the configuration of HBase Data Store is complete, proceed with
the installation of HBase Data Store from Karaf console.</p>
<ul class="simple">
<li>HBase Data Store Installation Steps<ul>
<li>Start Karaf Console</li>
<li>Run the following commands from Karaf Console: feature:install
odl-tsdr-hbase</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="to-configure-cassandra-data-store">
<h4>To Configure Cassandra Data Store<a class="headerlink" href="#to-configure-cassandra-data-store" title="Permalink to this headline">¶</a></h4>
<p>Currently, there’s no configuration needed for Cassandra Data Store. The
user can use Cassandra data store directly after installing the feature
from Karaf console.</p>
<p>Additionally separate commands have been implemented to install various
data collectors.</p>
</div>
</div>
<div class="section" id="administering-or-managing-tsdr-data-stores">
<h3>Administering or Managing TSDR Data Stores<a class="headerlink" href="#administering-or-managing-tsdr-data-stores" title="Permalink to this headline">¶</a></h3>
<div class="section" id="to-administer-hsqldb-data-store">
<h4>To Administer HSQLDB Data Store<a class="headerlink" href="#to-administer-hsqldb-data-store" title="Permalink to this headline">¶</a></h4>
<p>Once the TSDR default datastore feature (odl-tsdr-hsqldb-all) is
enabled, the TSDR captured OpenFlow statistics metrics can be accessed
from Karaf Console by executing the command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tsdr</span><span class="p">:</span><span class="nb">list</span> <span class="o">&lt;</span><span class="n">metric</span><span class="o">-</span><span class="n">category</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">starttimestamp</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">endtimestamp</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>wherein</p>
<ul class="simple">
<li>&lt;metric-category&gt; = any one of the following categories
FlowGroupStats, FlowMeterStats, FlowStats, FlowTableStats, PortStats,
QueueStats</li>
<li>&lt;starttimestamp&gt; = to filter the list of metrics starting this
timestamp</li>
<li>&lt;endtimestamp&gt; = to filter the list of metrics ending this timestamp</li>
<li>&lt;starttimestamp&gt; and &lt;endtimestamp&gt; are optional.</li>
<li>Maximum 1000 records will be displayed.</li>
</ul>
</div>
<div class="section" id="to-administer-hbase-data-store">
<h4>To Administer HBase Data Store<a class="headerlink" href="#to-administer-hbase-data-store" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Using Karaf Command to retrieve data from HBase Data Store</li>
</ul>
<p>The user first need to install hbase data store from karaf console:</p>
<p>feature:install odl-tsdr-hbase</p>
<p>The user can retrieve the data from HBase data store using the following
commands from Karaf console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tsdr</span><span class="p">:</span><span class="nb">list</span>
<span class="n">tsdr</span><span class="p">:</span><span class="nb">list</span> <span class="o">&lt;</span><span class="n">CategoryName</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">StartTime</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">EndTime</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Typing tab will get the context prompt of the arguments when typeing the
command in Karaf console.</p>
</div>
<div class="section" id="to-administer-cassandra-data-store">
<h4>To Administer Cassandra Data Store<a class="headerlink" href="#to-administer-cassandra-data-store" title="Permalink to this headline">¶</a></h4>
<p>The user first needs to install Cassandra data store from Karaf console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">tsdr</span><span class="o">-</span><span class="n">cassandra</span>
</pre></div>
</div>
<p>Then the user can retrieve the data from Cassandra data store using the
following commands from Karaf console:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tsdr</span><span class="p">:</span><span class="nb">list</span>
<span class="n">tsdr</span><span class="p">:</span><span class="nb">list</span> <span class="o">&lt;</span><span class="n">CategoryName</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">StartTime</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">EndTime</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Typing tab will get the context prompt of the arguments when typeing the
command in Karaf console.</p>
</div>
</div>
<div class="section" id="installing-tsdr-data-collectors">
<h3>Installing TSDR Data Collectors<a class="headerlink" href="#installing-tsdr-data-collectors" title="Permalink to this headline">¶</a></h3>
<p>When the user uses HSQLDB data store and installed &#8220;odl-tsdr-hsqldb-all&#8221;
feature from Karaf console, besides the HSQLDB data store, OpenFlow data
collector is also installed with this command. However, if the user
needs to use other collectors, such as NetFlow Collector, Syslog
Collector, SNMP Collector, and Controller Metrics Collector, the user
needs to install them with separate commands. If the user uses HBase or
Cassandra data store, no collectors will be installed when the data
store is installed. Instead, the user needs to install each collector
separately using feature install command from Karaf console.</p>
<p>The following is the list of supported TSDR data collectors with the
associated feature install commands:</p>
<ul>
<li><p class="first">OpenFlow Data Collector</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">tsdr</span><span class="o">-</span><span class="n">openflow</span><span class="o">-</span><span class="n">statistics</span><span class="o">-</span><span class="n">collector</span>
</pre></div>
</div>
</li>
<li><p class="first">SNMP Data Collector</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">tsdr</span><span class="o">-</span><span class="n">snmp</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">collector</span>
</pre></div>
</div>
</li>
<li><p class="first">NetFlow Data Collector</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">tsdr</span><span class="o">-</span><span class="n">netflow</span><span class="o">-</span><span class="n">statistics</span><span class="o">-</span><span class="n">collector</span>
</pre></div>
</div>
</li>
<li><p class="first">Syslog Data Collector</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">tsdr</span><span class="o">-</span><span class="n">syslog</span><span class="o">-</span><span class="n">collector</span>
</pre></div>
</div>
</li>
<li><p class="first">Controller Metrics Collector</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">feature</span><span class="p">:</span><span class="n">install</span> <span class="n">odl</span><span class="o">-</span><span class="n">tsdr</span><span class="o">-</span><span class="n">controller</span><span class="o">-</span><span class="n">metrics</span><span class="o">-</span><span class="n">collector</span>
</pre></div>
</div>
</li>
</ul>
<p>In order to use controller metrics collector, the user needs to install
Sigar library.</p>
<p>The following is the instructions for installing Sigar library on
Ubuntu:</p>
<ul class="simple">
<li>Install back end library by &#8220;sudo apt-get install
libhyperic-sigar-java&#8221;</li>
<li>Execute &#8220;export
LD_LIBRARY_PATH=/usr/lib/jni/:/usr/lib:/usr/local/lib&#8221; to set the
path of the JNI (you can add this to the &#8221;.bashrc&#8221; in your home
directory)</li>
<li>Download the file &#8220;sigar-1.6.4.jar&#8221;. It might be also in your &#8221;.m2&#8221;
directory under &#8220;~/.m2/resources/org/fusesource/sigar/1.6.4&#8221;</li>
<li>Create the directory &#8220;org/fusesource/sigar/1.6.4&#8221; under the &#8220;system&#8221;
directory in your controller home directory and place the
&#8220;sigar-1.6.4.jar&#8221; there</li>
</ul>
</div>
<div class="section" id="configuring-tsdr-data-collectors">
<h3>Configuring TSDR Data Collectors<a class="headerlink" href="#configuring-tsdr-data-collectors" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>SNMP Data Collector Device Credential Configuration</li>
</ul>
<p>After installing SNMP Data Collector, a configuration file under etc/
directory of ODL distribution is generated: etc/tsdr.snmp.cfg is
created.</p>
<p>The following is a sample tsdr.snmp.cfg file:</p>
<p>credentials=[192.168.0.2,public],[192.168.0.3,public]</p>
<p>The above credentials indicate that TSDR SNMP Collector is going to
connect to two devices. The IPAddress and Read community string of these
two devices are (192.168.0.2, public), and (192.168.0.3) respectively.</p>
<p>The user can make changes to this configuration file any time during
runtime. The configuration will be picked up by TSDR in the next cycle
of data collection.</p>
<div class="section" id="polling-interval-configuration-for-snmp-collector-and-openflow-stats-collector">
<h4>Polling interval configuration for SNMP Collector and OpenFlow Stats Collector<a class="headerlink" href="#polling-interval-configuration-for-snmp-collector-and-openflow-stats-collector" title="Permalink to this headline">¶</a></h4>
<p>The default polling interval of SNMP Collector and OpenFlow Stats
Collector is 30 seconds and 15 seconds respectively. The user can change
the polling interval through restconf APIs at any time. The new polling
interval will be picked up by TSDR in the next collection cycle.</p>
<ul>
<li><p class="first">Retrieve Polling Interval API for SNMP Collector</p>
<ul class="simple">
<li>URL:
<a class="reference external" href="http://localhost:8181/restconf/config/tsdr-snmp-data-collector:TSDRSnmpDataCollectorConfig">http://localhost:8181/restconf/config/tsdr-snmp-data-collector:TSDRSnmpDataCollectorConfig</a></li>
<li>Verb: GET</li>
</ul>
</li>
<li><p class="first">Update Polling Interval API for SNMP Collector</p>
<ul>
<li><p class="first">URL:
<a class="reference external" href="http://localhost:8181/restconf/operations/tsdr-snmp-data-collector:setPollingInterval">http://localhost:8181/restconf/operations/tsdr-snmp-data-collector:setPollingInterval</a></p>
</li>
<li><p class="first">Verb: POST</p>
</li>
<li><p class="first">Content Type: application/json</p>
</li>
<li><p class="first">Input Payload:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;15000&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Retrieve Polling Interval API for OpenFlowStats Collector</p>
<ul class="simple">
<li>URL:
<a class="reference external" href="http://localhost:8181/restconf/config/tsdr-openflow-statistics-collector:TSDROSCConfig">http://localhost:8181/restconf/config/tsdr-openflow-statistics-collector:TSDROSCConfig</a></li>
<li>Verb: GET</li>
</ul>
</li>
<li><p class="first">Update Polling Interval API for OpenFlowStats Collector</p>
<ul>
<li><p class="first">URL:
<a class="reference external" href="http://localhost:8181/restconf/operations/tsdr-openflow-statistics-collector:setPollingInterval">http://localhost:8181/restconf/operations/tsdr-openflow-statistics-collector:setPollingInterval</a></p>
</li>
<li><p class="first">Verb: POST</p>
</li>
<li><p class="first">Content Type: application/json</p>
</li>
<li><p class="first">Input Payload:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;15000&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="querying-tsdr-from-rest-apis">
<h3>Querying TSDR from REST APIs<a class="headerlink" href="#querying-tsdr-from-rest-apis" title="Permalink to this headline">¶</a></h3>
<p>TSDR provides two REST APIs for querying data stored in TSDR data
stores.</p>
<ul>
<li><p class="first">Query of TSDR Metrics</p>
<ul>
<li><p class="first">URL: <a class="reference external" href="http://localhost:8181/tsdr/metrics/query">http://localhost:8181/tsdr/metrics/query</a></p>
</li>
<li><p class="first">Verb: GET</p>
</li>
<li><p class="first">Parameters:</p>
<ul>
<li><p class="first">tsdrkey=[NID=][DC=][MN=][RK=]</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">TSDRKey</span> <span class="nb">format</span> <span class="n">indicates</span> <span class="n">the</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">NID</span><span class="p">),</span> <span class="n">DataCategory</span><span class="p">(</span><span class="n">DC</span><span class="p">),</span> <span class="n">MetricName</span><span class="p">(</span><span class="n">MN</span><span class="p">),</span> <span class="ow">and</span> <span class="n">RecordKey</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">monitored</span> <span class="n">objects</span><span class="o">.</span>
<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">the</span> <span class="n">following</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">tsdrkey</span><span class="p">:</span>
<span class="p">[</span><span class="n">NID</span><span class="o">=</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="p">][</span><span class="n">DC</span><span class="o">=</span><span class="n">FLOWSTATS</span><span class="p">][</span><span class="n">MN</span><span class="o">=</span><span class="n">PacketCount</span><span class="p">][</span><span class="n">RK</span><span class="o">=</span><span class="n">Node</span><span class="p">:</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">Table</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">Flow</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">The</span> <span class="n">following</span> <span class="ow">is</span> <span class="n">also</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">tsdrkey</span><span class="p">:</span>
<span class="n">tsdrkey</span><span class="o">=</span><span class="p">[</span><span class="n">NID</span><span class="o">=</span><span class="p">][</span><span class="n">DC</span><span class="o">=</span><span class="n">FLOWSTATS</span><span class="p">][</span><span class="n">MN</span><span class="o">=</span><span class="p">][</span><span class="n">RK</span><span class="o">=</span><span class="p">]</span>
<span class="n">In</span> <span class="n">the</span> <span class="n">case</span> <span class="n">when</span> <span class="n">the</span> <span class="n">sections</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">tsdrkey</span> <span class="ow">is</span> <span class="n">empty</span><span class="p">,</span> <span class="n">the</span> <span class="n">query</span> <span class="n">will</span> <span class="k">return</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">records</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">TSDR</span> <span class="n">data</span> <span class="n">store</span> <span class="n">that</span> <span class="n">matches</span> <span class="n">the</span> <span class="n">filled</span> <span class="n">tsdrkey</span><span class="o">.</span> <span class="n">In</span> <span class="n">the</span> <span class="n">above</span> <span class="n">example</span><span class="p">,</span> <span class="n">the</span> <span class="n">query</span> <span class="n">will</span> <span class="k">return</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">FLOWSTATS</span> <span class="n">data</span> <span class="n">category</span><span class="o">.</span>
<span class="n">The</span> <span class="n">query</span> <span class="n">will</span> <span class="k">return</span> <span class="n">only</span> <span class="n">the</span> <span class="n">first</span> <span class="mi">1000</span> <span class="n">records</span> <span class="n">that</span> <span class="n">match</span> <span class="n">the</span> <span class="n">query</span> <span class="n">criteria</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">from=&lt;time_in_seconds&gt;</p>
</li>
<li><p class="first">until=&lt;time_in_seconds&gt;</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The following is an example curl command for querying metric data from
TSDR data store:</p>
<p>curl -G -v -H &#8220;Accept: application/json&#8221; -H &#8220;Content-Type:
application/json&#8221; &#8220;<a class="reference external" href="http://localhost:8181/tsdr/metrics/query">http://localhost:8181/tsdr/metrics/query</a>&#8221;
&#8211;data-urlencode &#8220;tsdrkey=[NID=][DC=FLOWSTATS][MN=][RK=]&#8221;
&#8211;data-urlencode &#8220;from=0&#8221; &#8211;data-urlencode &#8220;until=240000000&#8221;|more</p>
<ul>
<li><p class="first">Query of TSDR Log type of data</p>
<ul>
<li><p class="first">URL:http://localhost:8181/tsdr/logs/query</p>
</li>
<li><p class="first">Verb: GET</p>
</li>
<li><p class="first">Parameters:</p>
<ul>
<li><p class="first">tsdrkey=tsdrkey=[NID=][DC=][RK=]</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">TSDRKey</span> <span class="nb">format</span> <span class="n">indicates</span> <span class="n">the</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">NID</span><span class="p">),</span> <span class="n">DataCategory</span><span class="p">(</span><span class="n">DC</span><span class="p">),</span> <span class="ow">and</span> <span class="n">RecordKey</span><span class="p">(</span><span class="n">RK</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">monitored</span> <span class="n">objects</span><span class="o">.</span>
<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">the</span> <span class="n">following</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">tsdrkey</span><span class="p">:</span>
<span class="p">[</span><span class="n">NID</span><span class="o">=</span><span class="n">openflow</span><span class="p">:</span><span class="mi">1</span><span class="p">][</span><span class="n">DC</span><span class="o">=</span><span class="n">NETFLOW</span><span class="p">][</span><span class="n">RK</span><span class="p">]</span>
<span class="n">The</span> <span class="n">query</span> <span class="n">will</span> <span class="k">return</span> <span class="n">only</span> <span class="n">the</span> <span class="n">first</span> <span class="mi">1000</span> <span class="n">records</span> <span class="n">that</span> <span class="n">match</span> <span class="n">the</span> <span class="n">query</span> <span class="n">criteria</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">from=&lt;time_in_seconds&gt;</p>
</li>
<li><p class="first">until=&lt;time_in_seconds&gt;</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The following is an example curl command for querying log type of data
from TSDR data store:</p>
<p>curl -G -v -H &#8220;Accept: application/json&#8221; -H &#8220;Content-Type:
application/json&#8221; &#8220;<a class="reference external" href="http://localhost:8181/tsdr/logs/query">http://localhost:8181/tsdr/logs/query</a>&#8221;
&#8211;data-urlencode &#8220;tsdrkey=[NID=][DC=NETFLOW][RK=]&#8221; &#8211;data-urlencode
&#8220;from=0&#8221; &#8211;data-urlencode &#8220;until=240000000&#8221;|more</p>
</div>
<div class="section" id="grafana-integration-with-tsdr">
<h3>Grafana integration with TSDR<a class="headerlink" href="#grafana-integration-with-tsdr" title="Permalink to this headline">¶</a></h3>
<p>TSDR provides northbound integration with Grafana time series data
visualization tool. All the metric type of data stored in TSDR data
store can be visualized using Grafana.</p>
<p>For the detailed instruction about how to install and configure Grafana
to work with TSDR, please refer to the following link:</p>
<p><a class="reference external" href="https://wiki.opendaylight.org/view/Grafana_Integration_with_TSDR_Step-by-Step">https://wiki.opendaylight.org/view/Grafana_Integration_with_TSDR_Step-by-Step</a></p>
</div>
<div class="section" id="purging-service-configuration">
<h3>Purging Service configuration<a class="headerlink" href="#purging-service-configuration" title="Permalink to this headline">¶</a></h3>
<p>After the data stores are installed from Karaf console, the purging
service will be installed as well. A configuration file called
tsdr.data.purge.cfg will be generated under etc/ directory of ODL
distribution.</p>
<p>The following is the sample default content of the tsdr.data.purge.cfg
file:</p>
<p>host=127.0.0.1 data_purge_enabled=true data_purge_time=23:59:59
data_purge_interval_in_minutes=1440 retention_time_in_hours=168</p>
<p>The host indicates the IPAddress of the data store. In the case when the
data store is together with ODL controller, 127.0.0.1 should be the
right value for the host IP. The other attributes are self-explained.
The user can change those attributes at any time. The configuration
change will be picked up right away by TSDR Purging service at runtime.</p>
</div>
<div class="section" id="how-to-use-tsdr-to-collect-store-and-view-openflow-interface-statistics">
<h3>How to use TSDR to collect, store, and view OpenFlow Interface Statistics<a class="headerlink" href="#how-to-use-tsdr-to-collect-store-and-view-openflow-interface-statistics" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id120">
<h4>Overview<a class="headerlink" href="#id120" title="Permalink to this headline">¶</a></h4>
<p>This tutorial describes an example of using TSDR to collect, store, and
view one type of time series data in OpenDaylight environment.</p>
</div>
<div class="section" id="id121">
<h4>Prerequisites<a class="headerlink" href="#id121" title="Permalink to this headline">¶</a></h4>
<p>You would need to have the following as prerequisits:</p>
<ul class="simple">
<li>One or multiple OpenFlow enabled switches. Alternatively, you can use
mininet to simulate such a switch.</li>
<li>Successfully installed OpenDaylight Controller.</li>
<li>Successfully installed HBase Data Store following TSDR HBase Data
Store Installation Guide.</li>
<li>Connect the OpenFlow enabled switch(es) to OpenDaylight Controller.</li>
</ul>
</div>
<div class="section" id="id122">
<h4>Target Environment<a class="headerlink" href="#id122" title="Permalink to this headline">¶</a></h4>
<p>HBase data store is only supported in Linux operation system.</p>
</div>
<div class="section" id="id123">
<h4>Instructions<a class="headerlink" href="#id123" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Start OpenDaylight.</li>
<li>Connect OpenFlow enabled switch(es) to the controller.<ul>
<li>If using mininet, run the following commands from mininet command
line:<ul>
<li>mn &#8211;topo single,3 &#8211;controller
<em>remote,ip=172.17.252.210,port=6653</em> &#8211;switch
ovsk,protocols=OpenFlow13</li>
</ul>
</li>
</ul>
</li>
<li>Install tsdr hbase feature from Karaf:<ul>
<li>feature:install odl-tsdr-hbase</li>
</ul>
</li>
<li>Install OpenFlow Statistics Collector from Karaf:<ul>
<li>feature:install odl-tsdr-openflow-statistics-collector</li>
</ul>
</li>
<li>run the following command from Karaf console:<ul>
<li>tsdr:list PORTSTATS</li>
</ul>
</li>
</ul>
<p>You should be able to see the interface statistics of the switch(es)
from the HBase Data Store. If there are too many rows, you can use
&#8220;tsdr:list InterfaceStats|more&#8221; to view it page by page.</p>
<p>By tabbing after &#8220;tsdr:list&#8221;, you will see all the supported data
categories. For example, &#8220;tsdr:list FlowStats&#8221; will output the Flow
statistics data collected from the switch(es).</p>
</div>
</div>
<div class="section" id="id124">
<h3>Troubleshooting<a class="headerlink" href="#id124" title="Permalink to this headline">¶</a></h3>
<div class="section" id="karaf-logs">
<h4>Karaf logs<a class="headerlink" href="#karaf-logs" title="Permalink to this headline">¶</a></h4>
<p>All TSDR features and components write logging information including
information messages, warnings, errors and debug messages into
karaf.log.</p>
</div>
<div class="section" id="hbase-and-cassandra-logs">
<h4>HBase and Cassandra logs<a class="headerlink" href="#hbase-and-cassandra-logs" title="Permalink to this headline">¶</a></h4>
<p>For HBase and Cassandra data stores, the database level logs are written
into HBase log and Cassandra logs.</p>
<ul class="simple">
<li>HBase log<ul>
<li>HBase log is under &lt;HBase-installation-directory&gt;/logs/.</li>
</ul>
</li>
<li>Cassandra log<ul>
<li>Cassandra log is under {cassandra.logdir}/system.log. The default
{cassandra.logdir} is /var/log/cassandra/.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="ttp-cli-tools-user-guide">
<h2>TTP CLI Tools User Guide<a class="headerlink" href="#ttp-cli-tools-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id125">
<h3>Overview<a class="headerlink" href="#id125" title="Permalink to this headline">¶</a></h3>
<p>Table Type Patterns are a specification developed by the <a class="reference external" href="https://www.opennetworking.org/">Open
Networking Foundation</a> to enable the
description and negotiation of subsets of the OpenFlow protocol. This is
particularly useful for hardware switches that support OpenFlow as it
enables the to describe what features they do (and thus also what
features they do not) support. More details can be found in the full
specification listed on the <a class="reference external" href="https://www.opennetworking.org/sdn-resources/onf-specifications/openflow">OpenFlow specifications
page</a>.</p>
</div>
<div class="section" id="ttp-cli-tools-architecture">
<h3>TTP CLI Tools Architecture<a class="headerlink" href="#ttp-cli-tools-architecture" title="Permalink to this headline">¶</a></h3>
<p>The TTP CLI Tools use the TTP Model and the YANG Tools/RESTCONF codecs
to translate between the Data Transfer Objects (DTOs) and JSON/XML.</p>
</div>
</div>
<div class="section" id="unified-secure-channel">
<h2>Unified Secure Channel<a class="headerlink" href="#unified-secure-channel" title="Permalink to this headline">¶</a></h2>
<p>This document describes how to use the Unified Secure Channel (USC)
feature in OpenDaylight. This document contains configuration,
administration, and management sections for the feature.</p>
<div class="section" id="id126">
<h3>Overview<a class="headerlink" href="#id126" title="Permalink to this headline">¶</a></h3>
<p>In enterprise networks, more and more controller and network management
systems are being deployed remotely, such as in the cloud. Additionally,
enterprise networks are becoming more heterogeneous - branch, IoT,
wireless (including cloud access control). Enterprise customers want a
converged network controller and management system solution. This
feature is intended for device and network administrators looking to use
unified secure channels for their systems.</p>
</div>
<div class="section" id="usc-channel-architecture">
<h3>USC Channel Architecture<a class="headerlink" href="#usc-channel-architecture" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>USC Agent<ul>
<li>The USC Agent provides proxy and agent functionality on top of all
standard protocols supported by the device. It initiates call-home
with the controller, maintains live connections with with the
controller, acts as a demuxer/muxer for packets with the USC
header, and authenticates the controller.</li>
</ul>
</li>
<li>USC Plugin<ul>
<li>The USC Plugin is responsible for communication between the
controller and the USC agent . It responds to call-home with the
controller, maintains live connections with the devices, acts as a
muxer/demuxer for packets with the USC header, and provides
support for TLS/DTLS.</li>
</ul>
</li>
<li>USC Manager<ul>
<li>The USC Manager handles configurations, high availability,
security, monitoring, and clustering support for USC.</li>
</ul>
</li>
<li>USC UI<ul>
<li>The USC UI is responsible for displaying a graphical user
interface representing the state of USC in the OpenDaylight DLUX
UI.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installing-usc-channel">
<h3>Installing USC Channel<a class="headerlink" href="#installing-usc-channel" title="Permalink to this headline">¶</a></h3>
<p>To install USC, download OpenDaylight and use the Karaf console to
install the following feature:</p>
<p>odl-usc-channel-ui</p>
</div>
<div class="section" id="configuring-usc-channel">
<h3>Configuring USC Channel<a class="headerlink" href="#configuring-usc-channel" title="Permalink to this headline">¶</a></h3>
<p>This section gives details about the configuration settings for various
components in USC.</p>
<p>The USC configuration files for the Karaf distribution are located in
distribution/karaf/target/assembly/etc/usc</p>
<ul class="simple">
<li>certificates<ul>
<li>The certificates folder contains the client key, pem, and rootca
files as is necessary for security.</li>
</ul>
</li>
<li>akka.conf<ul>
<li>This file contains configuration related to clustering. Potential
configuration properties can be found on the akka website at
<a class="reference external" href="http://doc.akka.io">http://doc.akka.io</a></li>
</ul>
</li>
<li>usc.properties<ul>
<li>This file contains configuration related to USC. Use this file to
set the location of certificates, define the source of additional
akka configurations, and assign default settings to the USC
behavior.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="administering-or-managing-usc-channel">
<h3>Administering or Managing USC Channel<a class="headerlink" href="#administering-or-managing-usc-channel" title="Permalink to this headline">¶</a></h3>
<p>After installing the odl-usc-channel-ui feature from the Karaf console,
users can administer and manage USC channels from the the UI or APIDOCS
explorer.</p>
<p>Go to
<a class="reference external" href="http://${ipaddress}:8181/index.html">http://${ipaddress}:8181/index.html</a>,
sign in, and click on the USC side menu tab. From there, users can view
the state of USC channels.</p>
<p>Go to
<a class="reference external" href="http://${ipaddress}:8181/apidoc/explorer/index.html">http://${ipaddress}:8181/apidoc/explorer/index.html</a>,
sign in, and expand the usc-channel panel. From there, users can execute
various API calls to test their USC deployment such as add-channel,
delete-channel, and view-channel.</p>
</div>
<div class="section" id="id127">
<h3>Tutorials<a class="headerlink" href="#id127" title="Permalink to this headline">¶</a></h3>
<p>Below are tutorials for USC Channel</p>
<div class="section" id="viewing-usc-channel">
<h4>Viewing USC Channel<a class="headerlink" href="#viewing-usc-channel" title="Permalink to this headline">¶</a></h4>
<p>The purpose of this tutorial is to view USC Channel</p>
<div class="section" id="id128">
<h5>Overview<a class="headerlink" href="#id128" title="Permalink to this headline">¶</a></h5>
<p>This tutorial walks users through the process of viewing the USC Channel
environment topology including established channels connecting the
controllers and devices in the USC topology.</p>
</div>
<div class="section" id="id129">
<h5>Prerequisites<a class="headerlink" href="#id129" title="Permalink to this headline">¶</a></h5>
<p>For this tutorial, we assume that a device running a USC agent is
already installed.</p>
</div>
<div class="section" id="id130">
<h5>Instructions<a class="headerlink" href="#id130" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Run the OpenDaylight distribution and install odl-usc-channel-ui from
the Karaf console.</li>
<li>Go to
<a class="reference external" href="http://${ipaddress}:8181/apidoc/explorer/index.html">http://${ipaddress}:8181/apidoc/explorer/index.html</a></li>
<li>Execute add-channel with the following json data:<ul>
<li>{&#8220;input&#8221;:{&#8220;channel&#8221;:{&#8220;hostname&#8221;:&#8221;127.0.0.1&#8221;,&#8221;port&#8221;:1068,&#8221;remote&#8221;:false}}}</li>
</ul>
</li>
<li>Go to
<a class="reference external" href="http://${ipaddress}:8181/index.html">http://${ipaddress}:8181/index.html</a></li>
<li>Click on the USC side menu tab.</li>
<li>The UI should display a table including the added channel from step
3.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="virtual-tenant-network-vtn">
<h2>Virtual Tenant Network (VTN)<a class="headerlink" href="#virtual-tenant-network-vtn" title="Permalink to this headline">¶</a></h2>
<div class="section" id="vtn-overview">
<h3>VTN Overview<a class="headerlink" href="#vtn-overview" title="Permalink to this headline">¶</a></h3>
<p>OpenDaylight Virtual Tenant Network (VTN) is an application that
provides multi-tenant virtual network on an SDN controller.</p>
<p>Conventionally, huge investment in the network systems and operating
expenses are needed because the network is configured as a silo for each
department and system. So, various network appliances must be installed
for each tenant and those boxes cannot be shared with others. It is a
heavy work to design, implement and operate the entire complex network.</p>
<p>The uniqueness of VTN is a logical abstraction plane. This enables the
complete separation of logical plane from physical plane. Users can
design and deploy any desired network without knowing the physical
network topology or bandwidth restrictions.</p>
<p>VTN allows the users to define the network with a look and feel of
conventional L2/L3 network. Once the network is designed on VTN, it will
automatically be mapped into underlying physical network, and then
configured on the individual switch leveraging SDN control protocol. The
definition of logical plane makes it possible not only to hide the
complexity of the underlying network but also to better manage network
resources. It achieves reducing reconfiguration time of network services
and minimizing network configuration errors.</p>
<div class="figure" id="id236">
<img alt="VTN Overview" src="../_images/VTN_Overview.jpg" />
<p class="caption"><span class="caption-text">VTN Overview</span></p>
</div>
<p>It is implemented as two major components</p>
<ul class="simple">
<li><a class="reference external" href="#_vtn_manager">VTN Manager</a></li>
<li><a class="reference external" href="#_vtn_coordinator">VTN Coordinator</a></li>
</ul>
<div class="section" id="vtn-manager">
<h4>VTN Manager<a class="headerlink" href="#vtn-manager" title="Permalink to this headline">¶</a></h4>
<p>An OpenDaylight Controller Plugin that interacts with other modules to
implement the components of the VTN model. It also provides a REST
interface to configure VTN components in ODL controller. VTN Manager is
implemented as one plugin to the OpenDaylight controller. This provides
a REST interface to create/update/delete VTN components. The user
command in VTN Coordinator is translated as REST API to VTN Manager by
the ODC Driver component. In addition to the above mentioned role, it
also provides an implementation to the OpenStack L2 Network Functions
API.</p>
<div class="section" id="features-overview">
<h5>Features Overview<a class="headerlink" href="#features-overview" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><strong>odl-vtn-manager</strong> provides VTN Manager’s JAVA API.</li>
<li><strong>odl-vtn-manager-rest</strong> provides VTN Manager’s REST API.</li>
<li><strong>odl-vtn-manager-neutron</strong> provides the integration with Neutron
interface.</li>
</ul>
</div>
<div class="section" id="rest-api">
<h5>REST API<a class="headerlink" href="#rest-api" title="Permalink to this headline">¶</a></h5>
<p>VTN Manager provides REST API for virtual network functions.</p>
<p>Here is an example of how to create a virtual tenant network.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> \
<span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8282</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="n">nb</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">Tenant1</span> \
<span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;description&quot;: &quot;My First Virtual Tenant Network&quot;}&#39;</span>
</pre></div>
</div>
<p>You can check the list of all tenants by executing the following
command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="s2">&quot;admin&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/json&quot;</span> <span class="o">-</span><span class="n">H</span> \
<span class="s2">&quot;Content-type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> \
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8282</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="n">nb</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">vtns</span>
</pre></div>
</div>
<p>REST API documentation for VTN Manager, please refer:
<a class="reference external" href="https://jenkins.opendaylight.org/releng/view/vtn/job/vtn-merge-master/lastSuccessfulBuild/artifact/manager/northbound/target/site/wsdocs/rest.html">https://jenkins.opendaylight.org/releng/view/vtn/job/vtn-merge-master/lastSuccessfulBuild/artifact/manager/northbound/target/site/wsdocs/rest.html</a></p>
</div>
</div>
<div class="section" id="vtn-coordinator">
<h4>VTN Coordinator<a class="headerlink" href="#vtn-coordinator" title="Permalink to this headline">¶</a></h4>
<p>The VTN Coordinator is an external application that provides a REST
interface for a user to use the VTN Virtualization. It interacts with
VTN Manager plugin to implement the user configuration. It is also
capable of multiple controller orchestration. It realizes Virtual Tenant
Network (VTN) provisioning in OpenDaylight Controllers (ODC). In the
OpenDaylight architecture VTN Coordinator is part of the network
application, orchestration and services layer. VTN Coordinator has been
implemented as an external application to the OpenDaylight controller.
This component is responsible for the VTN virtualization. VTN
Coordinator will use the REST interface exposed by the VTN Manger to
realize the virtual network using the OpenDaylight controller. It uses
OpenDaylight APIs (REST) to construct the virtual network in ODCs. It
provides REST APIs for northbound VTN applications and supports virtual
networks spanning across multiple ODCs by coordinating across ODCs.</p>
<p>For VTN Coordinator REST API, please refer:
<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_%28VTN%29:VTN_Coordinator:RestApi">https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_%28VTN%29:VTN_Coordinator:RestApi</a></p>
</div>
<div class="section" id="network-virtualization-function">
<h4>Network Virtualization Function<a class="headerlink" href="#network-virtualization-function" title="Permalink to this headline">¶</a></h4>
<p>The user first defines a VTN. Then, the user maps the VTN to a physical
network, which enables communication to take place according to the VTN
definition. With the VTN definition, L2 and L3 transfer functions and
flow-based traffic control functions (filtering and redirect) are
possible.</p>
</div>
<div class="section" id="virtual-network-construction">
<h4>Virtual Network Construction<a class="headerlink" href="#virtual-network-construction" title="Permalink to this headline">¶</a></h4>
<p>The following table shows the elements which make up the VTN. In the
VTN, a virtual network is constructed using virtual nodes (vBridge,
vRouter) and virtual interfaces and links. It is possible to configure a
network which has L2 and L3 transfer function, by connecting the virtual
intrefaces made on virtual nodes via virtual links.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>vBridge</td>
<td>The logical representation of L2
switch function.</td>
</tr>
<tr class="row-even"><td>vRouter</td>
<td>The logical representation of router
function.</td>
</tr>
<tr class="row-odd"><td>vTep</td>
<td>The logical representation of Tunnel
End Point - TEP.</td>
</tr>
<tr class="row-even"><td>vTunnel</td>
<td>The logical representation of
Tunnel.</td>
</tr>
<tr class="row-odd"><td>vBypass</td>
<td>The logical representation of
connectivity between controlled
networks.</td>
</tr>
<tr class="row-even"><td>Virtual interface</td>
<td>The representation of end point on
the virtual node.</td>
</tr>
<tr class="row-odd"><td>Virtual Linkv(vLink)</td>
<td>The logical representation of L1
connectivity between virtual
interfaces.</td>
</tr>
</tbody>
</table>
<p>The following figure shows an example of a constructed virtual network.
VRT is defined as the vRouter, BR1 and BR2 are defined as vBridges.
interfaces of the vRouter and vBridges are connected using vLinks.</p>
<div class="figure" id="id237">
<img alt="VTN Construction" src="../_images/VTN_Construction.jpg" />
<p class="caption"><span class="caption-text">VTN Construction</span></p>
</div>
</div>
<div class="section" id="mapping-of-physical-network-resources">
<h4>Mapping of Physical Network Resources<a class="headerlink" href="#mapping-of-physical-network-resources" title="Permalink to this headline">¶</a></h4>
<p>Map physical network resources to the constructed virtual network.
Mapping identifies which virtual network each packet transmitted or
received by an OpenFlow switch belongs to, as well as which interface in
the OpenFlow switch transmits or receives that packet. There are two
mapping methods. When a packet is received from the OFS, port mapping is
first searched for the corresponding mapping definition, then VLAN
mapping is searched, and the packet is mapped to the relevant vBridge
according to the first matching mapping.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Port mapping</td>
<td>Maps physical network resources to
an interface of vBridge using Switch
ID, Port ID and VLAN ID of the
incoming L2 frame. Untagged frame
mapping is also supported.</td>
</tr>
<tr class="row-even"><td>VLAN mapping</td>
<td>Maps physical network resources to a
vBridge using VLAN ID of the
incoming L2 frame.Maps physical
resources of a particular switch to
a vBridge using switch ID and VLAN
ID of the incoming L2 frame.</td>
</tr>
<tr class="row-odd"><td>MAC mapping</td>
<td>Maps physical resources to an
interface of vBridge using MAC
address of the incoming L2 frame(The
initial contribution does not
include this method).</td>
</tr>
</tbody>
</table>
<p>VTN can learn the terminal information from a terminal that is connected
to a switch which is mapped to VTN. Further, it is possible to refer
that terminal information on the VTN.</p>
<ul class="simple">
<li>Learning terminal information VTN learns the information of a
terminal that belongs to VTN. It will store the MAC address and VLAN
ID of the terminal in relation to the port of the switch.</li>
<li>Aging of terminal information Terminal information, learned by the
VTN, will be maintained until the packets from terminal keep flowing
in VTN. If the terminal gets disconnected from the VTN, then the
aging timer will start clicking and the terminal information will be
maintained till timeout.</li>
</ul>
<p>The following figure shows an example of mapping. An interface of BR1 is
mapped to port GBE0/1 of OFS1 using port mapping. Packets received from
GBE0/1 of OFS1 are regarded as those from the corresponding interface of
BR1. BR2 is mapped to VLAN 200 using VLAN mapping. Packets with VLAN tag
200 received from any ports of any OFSs are regarded as those from an
interface of BR2.</p>
<div class="figure" id="id238">
<img alt="VTN Mapping" src="../_images/VTN_Mapping.jpg" />
<p class="caption"><span class="caption-text">VTN Mapping</span></p>
</div>
</div>
<div class="section" id="vbridge-functions">
<h4>vBridge Functions<a class="headerlink" href="#vbridge-functions" title="Permalink to this headline">¶</a></h4>
<p>The vBridge provides the bridge function that transfers a packet to the
intended virtual port according to the destination MAC address. The
vBridge looks up the MAC address table and transmits the packet to the
corresponding virtual interface when the destination MAC address has
been learned. When the destination MAC address has not been learned, it
transmits the packet to all virtual interfaces other than the receiving
port (flooding). MAC addresses are learned as follows.</p>
<ul class="simple">
<li>MAC address learning The vBridge learns the MAC address of the
connected host. The source MAC address of each received frame is
mapped to the receiving virtual interface, and this MAC address is
stored in the MAC address table created on a per-vBridge basis.</li>
<li>MAC address aging The MAC address stored in the MAC address table is
retained as long as the host returns the ARP reply. After the host is
disconnected, the address is retained until the aging timer times
out. To have the vBridge learn MAC addresses statically, you can
register MAC addresses manually.</li>
</ul>
</div>
<div class="section" id="vrouter-functions">
<h4>vRouter Functions<a class="headerlink" href="#vrouter-functions" title="Permalink to this headline">¶</a></h4>
<p>The vRouter transfers IPv4 packets between vBridges. The vRouter
supports routing, ARP learning, and ARP aging functions. The following
outlines the functions.</p>
<ul class="simple">
<li>Routing function When an IP address is registered with a virtual
interface of the vRouter, the default routing information for that
interface is registered. It is also possible to statically register
routing information for a virtual interface.</li>
<li>ARP learning function The vRouter associates a destination IP
address, MAC address and a virtual interface, based on an ARP request
to its host or a reply packet for an ARP request, and maintains this
information in an ARP table prepared for each routing domain. The
registered ARP entry is retained until the aging timer, described
later, times out. The vRouter transmits an ARP request on an
individual aging timer basis and deletes the associated entry from
the ARP table if no reply is returned. For static ARP learning, you
can register ARP entry information manually. *DHCP relay agent
function The vRouter also provides the DHCP relay agent function.</li>
</ul>
</div>
<div class="section" id="flow-filter-functions">
<h4>Flow Filter Functions<a class="headerlink" href="#flow-filter-functions" title="Permalink to this headline">¶</a></h4>
<p>Flow Filter function is similar to ACL. It is possible to allow or
prohibit communication with only certain kind of packets that meet a
particular condition. Also, it can perform a processing called
Redirection - WayPoint routing, which is different from the existing
ACL. Flow Filter can be applied to any interface of a vNode within VTN,
and it is possible to the control the packets that pass interface. The
match conditions that could be specified in Flow Filter are as follows.
It is also possible to specify a combination of multiple conditions.</p>
<ul class="simple">
<li>Source MAC address</li>
<li>Destination MAC address</li>
<li>MAC ether type</li>
<li>VLAN Priority</li>
<li>Source IP address</li>
<li>Destination IP address</li>
<li>DSCP</li>
<li>IP Protocol</li>
<li>TCP/UDP source port</li>
<li>TCP/UDP destination port</li>
<li>ICMP type</li>
<li>ICMP code</li>
</ul>
<p>The types of Action that can be applied on packets that match the Flow
Filter conditions are given in the following table. It is possible to
make only those packets, which match a particular condition, to pass
through a particular server by specifying Redirection in Action. E.g.,
path of flow can be changed for each packet sent from a particular
terminal, depending upon the destination IP address. VLAN priority
control and DSCP marking are also supported.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Pass</td>
<td>Pass particular packets matching the
specified conditions.</td>
</tr>
<tr class="row-even"><td>Drop</td>
<td>Discards particular packets matching
the specified conditions.</td>
</tr>
<tr class="row-odd"><td>Redirection</td>
<td>Redirects the packet to a desired
virtual interface. Both Transparent
Redirection (not changing MAC
address) and Router Redirection
(changing MAC address) are
supported.</td>
</tr>
</tbody>
</table>
<p>The following figure shows an example of how the flow filter function
works.</p>
<p>If there is any matching condition specified by flow filter when a
packet being transferred within a virtual network goes through a virtual
interface, the function evaluates the matching condition to see whether
the packet matches it. If the packet matches the condition, the function
applies the matching action specified by flow filter. In the example
shown in the figure, the function evaluates the matching condition at
BR1 and discards the packet if it matches the condition.</p>
<div class="figure" id="id239">
<img alt="VTN FlowFilter" src="../_images/VTN_Flow_Filter.jpg" />
<p class="caption"><span class="caption-text">VTN FlowFilter</span></p>
</div>
</div>
<div class="section" id="multiple-sdn-controller-coordination">
<h4>Multiple SDN Controller Coordination<a class="headerlink" href="#multiple-sdn-controller-coordination" title="Permalink to this headline">¶</a></h4>
<p>With the network abstractions, VTN enables to configure virtual network
across multiple SDN controllers. This provides highly scalable network
system.</p>
<p>VTN can be created on each SDN controller. If users would like to manage
those multiple VTNs with one policy, those VTNs can be integrated to a
single VTN.</p>
<p>As a use case, this feature is deployed to multi data center
environment. Even if those data centers are geographically separated and
controlled with different controllers, a single policy virtual network
can be realized with VTN.</p>
<p>Also, one can easily add a new SDN Controller to an existing VTN or
delete a particular SDN Controller from VTN.</p>
<p>In addition to this, one can define a VTN which covers both OpenFlow
network and Overlay network at the same time.</p>
<p>Flow Filter, which is set on the VTN, will be automatically applied on
the newly added SDN Controller.</p>
</div>
<div class="section" id="coordination-between-openflow-network-and-l2-l3-network">
<h4>Coordination between OpenFlow Network and L2/L3 Network<a class="headerlink" href="#coordination-between-openflow-network-and-l2-l3-network" title="Permalink to this headline">¶</a></h4>
<p>It is possible to configure VTN on an environment where there is mix of
L2/L3 switches as well. L2/L3 switch will be shown on VTN as vBypass.
Flow Filter or policing cannot be configured for a vBypass. However, it
is possible to treat it as a virtual node inside VTN.</p>
</div>
<div class="section" id="virtual-tenant-network-vtn-api">
<h4>Virtual Tenant Network (VTN) API<a class="headerlink" href="#virtual-tenant-network-vtn-api" title="Permalink to this headline">¶</a></h4>
<p>VTN provides Web APIs. They are implemented by REST architecture and
provide the access to resources within VTN that are identified by URI.
User can perform the operations like GET/PUT/POST/DELETE against the
virtual network resources (e.g. vBridge or vRouter) by sending a message
to VTN through HTTPS communication in XML or JSON format.</p>
<div class="figure" id="id240">
<img alt="VTN API" src="../_images/VTN_API.jpg" />
<p class="caption"><span class="caption-text">VTN API</span></p>
</div>
<div class="section" id="function-outline">
<h5>Function Outline<a class="headerlink" href="#function-outline" title="Permalink to this headline">¶</a></h5>
<p>VTN provides following operations for various network resources.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Resources</td>
<td>GET</td>
<td>POST</td>
<td>PUT</td>
<td>DELETE</td>
</tr>
<tr class="row-even"><td>VTN</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>vBridge</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>vRouter</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>vTep</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>vTunnel</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>vBypass</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>vLink</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Interface</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Port map</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Vlan map</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Flowfilter
(ACL/redirect)</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Controller
information</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>Physical
topology
information</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>Alarm
information</td>
<td>Yes</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example-usage">
<h5>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h5>
<p>The following is an example of the usage to construct a virtual network.</p>
<ul class="simple">
<li>Create VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  \
<span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot;:{&quot;vtn_name&quot;:&quot;VTN1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.1</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create Controller Information</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  \
<span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;:&quot;CONTROLLER1&quot;,&quot;ipaddr&quot;:&quot;172.1.0.1&quot;,&quot;type&quot;:&quot;odc&quot;,&quot;username&quot;:&quot;admin&quot;, </span><span class="se">\</span>
<span class="s1">&quot;password&quot;:&quot;admin&quot;,&quot;version&quot;:&quot;1.0&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.1</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create vBridge under VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> \
<span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot;:{&quot;vbr_name&quot;:&quot;VBR1&quot;,&quot;controller_id&quot;: &quot;CONTROLLER1&quot;,&quot;domain_id&quot;: &quot;(DEFAULT)&quot;}}&#39;</span> \
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.1</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">VTN1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create the interface under vBridge</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> \
<span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;:{&quot;if_name&quot;:&quot;IF1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.1</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">VTN1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">VBR1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vtn-openstack-configuration">
<h3>VTN OpenStack Configuration<a class="headerlink" href="#vtn-openstack-configuration" title="Permalink to this headline">¶</a></h3>
<p>This guide describes how to set up OpenStack for integration with
OpenDaylight Controller.</p>
<p>While OpenDaylight Controller provides several ways to integrate with
OpenStack, this guide focus on the way which uses VTN features available
on OpenDaylight controller.In the integration, VTN Manager work as
network service provider for OpenStack.</p>
<p>VTN Manager features, enable OpenStack to work in pure OpenFlow
environment in which all switches in data plane are OpenFlow switch.</p>
<div class="section" id="requirements">
<h4>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h4>
<p>To use OpenDaylight as Network Service Provider for OpenStack.</p>
</div>
<div class="section" id="id131">
<h4>Components<a class="headerlink" href="#id131" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>OpenDaylight Controller.</li>
<li>OpenStack Control Node.</li>
<li>OpenStack Compute Node.</li>
<li>OpenFlow Switch like mininet(Not Mandatory).</li>
</ul>
<p>The VTN features support multiple OpenStack nodes. You can deploy
multiple OpenStack Compute Nodes. In management plane, OpenDaylight
Controller, OpenStack nodes and OpenFlow switches should communicate
with each other. In data plane, Open vSwitches running in OpenStack
nodes should communicate with each other through a physical or logical
OpenFlow switches. The core OpenFlow switches are not mandatory.
Therefore, you can directly connect to the Open vSwitch’s.</p>
<div class="figure" id="id241">
<img alt="LAB Setup" src="../_images/vtn_devstack_setup.png" />
<p class="caption"><span class="caption-text">LAB Setup</span></p>
<div class="legend">
<blockquote>
<div><p><strong>Note</strong></p>
<p>Ubuntu 14.04 was used in both the nodes and Vsphere was used for
this howto.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="id132">
<h4>Configuration<a class="headerlink" href="#id132" title="Permalink to this headline">¶</a></h4>
<p><strong>Server Preparation</strong></p>
<ul class="simple">
<li>Install Ubuntu 14.04 LTS in two servers (OpenStack Control node and
Compute node respectively)</li>
<li>While installing, Ubuntu mandates creation of a User, we created the
user &#8220;stack&#8221;(We will use the same user for running devstack) NOTE:
You can also have multiple Compute nodes. TIP: Please do minimal
Install to avoid any issues in devstack bringup</li>
</ul>
<p><strong>User Settings</strong> - Login to both servers - Disable Ubuntu Firewall</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ufw</span> <span class="n">disable</span>
</pre></div>
</div>
<ul>
<li><p class="first">Optionally install these packages</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">net</span><span class="o">-</span><span class="n">tools</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit sudo vim /etc/sudoers and add an entry as follows</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">stack</span> <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">ALL</span><span class="p">)</span> <span class="n">NOPASSWD</span><span class="p">:</span> <span class="n">ALL</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>Network Settings</strong> - Checked the output of ifconfig -a, two interfaces
were listed eth0 and eth1 as indicated in the image above. - We had
connected eth0 interface to the Network where OpenDaylight is reachable.
- eth1 interface in both servers were connected to a different network
to act as data plane for the VM’s created using the OpenStack. -
Manually edited the file : sudo vim /etc/network/interfaces and made
entries as follows</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> stack@ubuntu-devstack:~/devstack$ cat /etc/network/interfaces
 # This file describes the network interfaces available on your system
 # and how to activate them. For more information, see interfaces(5).
 # The loop-back network interface
 auto lo
 iface lo inet loopback
 # The primary network interface
 auto eth0
 iface eth0 inet static
      address &lt;IP_ADDRESS_TO_REACH_ODL&gt;
      netmask &lt;NET_MASK&gt;
      broadcast &lt;BROADCAST_IP_ADDRESS&gt;
      gateway &lt;GATEWAY_IP_ADDRESS&gt;
auto eth1
iface eth1 inet static
     address &lt;IP_ADDRESS_UNIQ&gt;
     netmask &lt;NETMASK&gt;

**Note**

Please ensure that the eth0 interface is the default route and it is
able to reach the ODL\_IP\_ADDRESS NOTE: The entries for eth1 are
not mandatory, If not set, we may have to manually do &quot;ifup eth1&quot;
after the stacking is complete to activate the interface
</pre></div>
</div>
<p><strong>Finalize</strong> - reboot both nodes after the user and network settings to
have the network settings applied to the network - Login again and check
the output of ifconfig to ensure that both interfaces are listed</p>
</div>
<div class="section" id="opendaylight-settings-and-execution">
<h4>OpenDaylight Settings and Execution<a class="headerlink" href="#opendaylight-settings-and-execution" title="Permalink to this headline">¶</a></h4>
<div class="section" id="vtn-ini">
<h5>vtn.ini<a class="headerlink" href="#vtn-ini" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>VTN uses the configuration parameters from <em>vtn.ini</em> file for the
OpenStack integration.</li>
<li>These values will be set for the OpenvSwitch, in all the
participating OpenStack nodes.</li>
<li>A configuration file <em>vtn.ini</em>&#8216;*&#8217; needs to be created manually in the
&#8216;configuration* directory.</li>
<li>The contents of <em>vtn.ini</em> should be as follows:</li>
</ul>
<p>bridgename=br-int portname=eth1 protocols=OpenFlow13 failmode=secure</p>
<ul class="simple">
<li>The values of the configuration parameters must be changed based on
the user environment.</li>
<li>Especially, &#8220;portname&#8221; should be carefully configured, because if the
value is wrong, OpenDaylight controller fails to forward packets.</li>
<li>Other parameters works fine as is for general use cases.<ul>
<li>bridgename<ul>
<li>The name of the bridge in Open vSwitch, that will be created by
OpenDaylight Controller.</li>
<li>It must be &#8220;br-int&#8221;.</li>
</ul>
</li>
<li>portname<ul>
<li>The name of the port that will be created in the vbridge in
Open vSwitch.</li>
<li>This must be the same name of the interface of OpenStack Nodes
which is used for interconnecting OpenStack Nodes in data
plane.(in our case:eth1)</li>
<li>By default, if vtn.ini is not created, VTN uses ens33 as
portname.</li>
</ul>
</li>
<li>protocols<ul>
<li>OpenFlow protocol through which OpenFlow Switch and Controller
communicate.</li>
<li>The values can be OpenFlow13 or OpenFlow10.</li>
</ul>
</li>
<li>failmode<ul>
<li>The value can be &#8220;standalone&#8221; or &#8220;secure&#8221;.</li>
<li>Please use &#8220;secure&#8221; for general use cases.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="start-opendaylight">
<h4>Start OpenDaylight<a class="headerlink" href="#start-opendaylight" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Please install the feature <strong>odl-vtn-manager-neutron</strong> that provides
the integration with Neutron interface.</li>
</ul>
<p>feature:install odl-vtn-manager-neutron</p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>After running OpenDaylight, please ensure OpenDaylight listens to
the ports:6633,6653, 6640 and 8080</p>
<p><strong>Tip</strong></p>
<p>Please allow the ports in firewall for the devstack to be able to
communicate with OpenDaylight.</p>
<p><strong>Note</strong></p>
<p>* 6633/6653 - OpenFlow Ports * 6640 - Open vSwitch Manager Port *
8282 - Port for REST API</p>
</div></blockquote>
</div>
<div class="section" id="devstack-setup">
<h4>Devstack Setup<a class="headerlink" href="#devstack-setup" title="Permalink to this headline">¶</a></h4>
<div class="section" id="vtn-devstack-script">
<h5>VTN Devstack Script<a class="headerlink" href="#vtn-devstack-script" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>The local.conf is a user-maintained settings file. This allows all
custom settings for DevStack to be contained in a single file. This
file is processed strictly in sequence. The following datas are
needed to be set in the local.conf file:</li>
<li>Set the Host_IP as the detection is unreliable.</li>
<li>Set FLOATING_RANGE to a range not used on the local network, i.e.
192.168.1.224/27. This configures IP addresses ending in 225-254 to
be used as floating IPs.</li>
<li>Set FLAT_INTERFACE to the Ethernet interface that connects the host
to your local network. This is the interface that should be
configured with the static IP address mentioned above.</li>
<li>If the *_PASSWORD variables are not set, we will be prompted to
enter values during the execution of stack.sh.</li>
<li>Set ADMIN_PASSWORD . This password is used for the admin and demo
accounts set up as OpenStack users. We can login to the OpenStack GUI
with this credentials only.</li>
<li>Set the MYSQL_PASSWORD. The default here is a random hex string
which is inconvenient if you need to look at the database directly
for anything.</li>
<li>Set the RABBIT_PASSWORD. This is used by messaging services used by
both the nodes.</li>
<li>Set the service password. This is used by the OpenStack services
(Nova, Glance, etc) to authenticate with Keystone.</li>
</ul>
<div class="section" id="devstack-control">
<h6>DevStack Control<a class="headerlink" href="#devstack-control" title="Permalink to this headline">¶</a></h6>
<p>local.conf(control)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#IP Details
HOST_IP=&lt;CONTROL_NODE_MANAGEMENT_IF_IP_ADDRESS&gt;#Please Add The Control Node IP Address in this line
FLAT_INTERFACE=&lt;FLAT_INTERFACE_NAME&gt;
SERVICE_HOST=$HOST_IP
#Instance Details
MULTI_HOST=1
#config Details
RECLONE=yes #Make it &quot;no&quot; after stacking successfully the first time
VERBOSE=True
LOG_COLOR=True
LOGFILE=/opt/stack/logs/stack.sh.log
SCREEN_LOGDIR=/opt/stack/logs
#OFFLINE=True #Uncomment this after stacking successfully the first time
#Passwords
ADMIN_PASSWORD=labstack
MYSQL_PASSWORD=supersecret
RABBIT_PASSWORD=supersecret
SERVICE_PASSWORD=supersecret
SERVICE_TOKEN=supersecrettoken
ENABLE_TENANT_TUNNELS=false
#Services
disable_service rabbit
enable_service qpid
enable_service quantum
enable_service n-cpu
enable_service n-cond
disable_service n-net
enable_service q-svc
enable_service q-dhcp
enable_service q-meta
enable_service horizon
enable_service quantum
enable_service tempest
ENABLED_SERVICES+=,n-api,n-crt,n-obj,n-cpu,n-cond,n-sch,n-novnc,n-cauth,n-cauth,nova
ENABLED_SERVICES+=,cinder,c-api,c-vol,c-sch,c-bak
#ML2 Details
Q_PLUGIN=ml2
Q_ML2_PLUGIN_MECHANISM_DRIVERS=opendaylight
Q_ML2_TENANT_NETWORK_TYPE=local
Q_ML2_PLUGIN_TYPE_DRIVERS=local
disable_service n-net
enable_service q-svc
enable_service q-dhcp
enable_service q-meta
enable_service neutron
enable_service odl-compute
ODL_MGR_IP=&lt;ODL_IP_ADDRESS&gt; #Please Add the ODL IP Address in this line
OVS_PHYSICAL_BRIDGE=br-int
Q_OVS_USE_VETH=True
url=http://&lt;ODL_IP_ADDRESS&gt;:8080/controller/nb/v2/neutron #Please Add the ODL IP Address in this line
username=admin
password=admin
</pre></div>
</div>
</div>
<div class="section" id="devstack-compute">
<h6>DevStack Compute<a class="headerlink" href="#devstack-compute" title="Permalink to this headline">¶</a></h6>
<p>local.conf(compute)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#IP Details
HOST_IP=&lt;COMPUTE_NODE_MANAGEMENT_IP_ADDRESS&gt; #Add the Compute node Management IP Address
SERVICE_HOST=&lt;CONTROLLEr_NODE_MANAGEMENT_IP_ADDRESS&gt; #Add the cotnrol Node Management IP Address here
#Instance Details
MULTI_HOST=1
#config Details
RECLONE=yes #Make thgis &quot;no&quot; after stacking successfully once
#OFFLINE=True #Uncomment this line after stacking successfuly first time.
VERBOSE=True
LOG_COLOR=True
LOGFILE=/opt/stack/logs/stack.sh.log
SCREEN_LOGDIR=/opt/stack/logs
#Passwords
ADMIN_PASSWORD=labstack
MYSQL_PASSWORD=supersecret
RABBIT_PASSWORD=supersecret
SERVICE_PASSWORD=supersecret
SERVICE_TOKEN=supersecrettoken
#Services
ENABLED_SERVICES=n-cpu,rabbit,neutron
#ML2 Details
Q_PLUGIN=ml2
Q_ML2_PLUGIN_MECHANISM_DRIVERS=opendaylight
Q_ML2_TENANT_NETWORK_TYPE=local
Q_ML2_PLUGIN_TYPE_DRIVERS=local
enable_service odl-compute
ODL_MGR_IP=&lt;ODL_IP_ADDRESS&gt; #ADD ODL IP address here
OVS_PHYSICAL_BRIDGE=br-int
ENABLE_TENANT_TUNNELS=false
Q_OVS_USE_VETH=True
#Details of the Control node for various services
[[post-config|/etc/neutron/plugins/ml2/ml2_conf.ini]]
Q_HOST=$SERVICE_HOST
MYSQL_HOST=$SERVICE_HOST
RABBIT_HOST=$SERVICE_HOST
GLANCE_HOSTPORT=$SERVICE_HOST:9292
KEYSTONE_AUTH_HOST=$SERVICE_HOST
KEYSTONE_SERVICE_HOST=$SERVICE_HOST
NOVA_VNC_ENABLED=True
NOVNCPROXY_URL=&quot;http://&lt;CONTROLLER_NODE_IP_ADDRESS&gt;:6080/vnc_auto.html&quot; #Add Controller Node IP address
VNCSERVER_LISTEN=$HOST_IP
VNCSERVER_PROXYCLIENT_ADDRESS=$VNCSERVER_LISTEN
</pre></div>
</div>
</div>
<div class="section" id="devstack-kilo-liberty-control-node">
<h6>Devstack Kilo_Liberty Control Node<a class="headerlink" href="#devstack-kilo-liberty-control-node" title="Permalink to this headline">¶</a></h6>
<div class="highlight-default"><div class="highlight"><pre><span></span>#IP Details
HOST_IP=&lt;CONTROL_NODE_MANAGEMENT_IF_IP_ADDRESS&gt; #Please Add The Control Node IP Address in this line
SERVICE_HOST=$HOST_IP
LOGFILE=stack.sh.log
SCREEN_LOGDIR=/opt/stack/data/log
LOG_COLOR=False
disable_service n-net
enable_service q-svc
enable_service q-agt
enable_service q-meta
disable_service q-l3
enable_service n-cpu
enable_service q-dhcp
enable_service n-cauth
enable_service neutron
enable_service tempest
ADMIN_PASSWORD=labstack
MYSQL_PASSWORD=supersecret
RABBIT_PASSWORD=supersecret
SERVICE_PASSWORD=supersecret
SERVICE_TOKEN=supersecrettoken
ENABLE_TENANT_TUNNELS=True
NEUTRON_CREATE_INITIAL_NETWORKS=False
#enable_plugin networking-odl http://git.openstack.org/openstack/networking-odl stable/kilo # Please uncomment this line if you
want to use stable/kilo branch
#enable_plugin networking-odl http://git.openstack.org/openstack/networking-odl stable/liberty # Please uncomment this line if you
want to use stable/liberty branch
ODL_MODE=externalodl
ODL_MGR_IP=&lt;ODL_IP_ADDRESS&gt; # Please Add the ODL IP Address in this line
ODL_PORT=8080
ODL_USERNAME=admin
ODL_PASSWORD=admin
OVS_PHYSICAL_BRIDGE=br-int
Q_OVS_USE_VETH=True
Q_ML2_TENANT_NETWORK_TYPE=local
VNCSERVER_PROXYCLIENT_ADDRESS=$SERVICE_HOST
VNCSERVER_LISTEN=0.0.0.0
MYSQL_HOST=$SERVICE_HOST
RABBIT_HOST=$SERVICE_HOST
GLANCE_HOSTPORT=$SERVICE_HOST:9292
KEYSTONE_AUTH_HOST=$SERVICE_HOST
KEYSTONE_SERVICE_HOST=$SERVICE_HOST
[[post-config|/etc/neutron/plugins/ml2/ml2_conf.ini]]
[agent]
minimize_polling=True
</pre></div>
</div>
</div>
<div class="section" id="devstack-kilo-liberty-compute-node">
<h6>Devstack Kilo_Liberty Compute Node<a class="headerlink" href="#devstack-kilo-liberty-compute-node" title="Permalink to this headline">¶</a></h6>
<div class="highlight-default"><div class="highlight"><pre><span></span>#IP Details
HOST_IP=&lt;COMPUTE_NODE_IP_ADDRESS&gt;
SERVICE_HOST=&lt;CONTROL_NODE_IP_ADDRESS&gt;
LOGFILE=stack.sh.log
SCREEN_LOGDIR=/opt/stack/data/log
LOG_COLOR=False
RECLONE=yes # Make it &quot;no&quot; after stacking successfully the first time
#OFFLINE=True # Uncomment this after stacking successfully the first time
disable_all_services
enable_service n-cpu
NOVA_VNC_ENABLED=True
ADMIN_PASSWORD=labstack
MYSQL_PASSWORD=supersecret
RABBIT_PASSWORD=supersecret
SERVICE_PASSWORD=supersecret
SERVICE_TOKEN=supersecrettoken
ENABLE_TENANT_TUNNELS=True
NEUTRON_CREATE_INITIAL_NETWORKS=False
#enable_plugin networking-odl http://git.openstack.org/openstack/networking-odl stable/kilo # Please uncomment this line if you
want to use stable/kilo branch
#enable_plugin networking-odl http://git.openstack.org/openstack/networking-odl stable/liberty # Please uncomment this line if you
want to use stable/liberty branch
ODL_MODE=compute
ODL_MGR_IP=&lt;ODL_IP_ADDRESS&gt; # Please Add the ODL IP Address in this line
ODL_PORT=8080
ODL_USERNAME=admin
ODL_PASSWORD=admin
OVS_PHYSICAL_BRIDGE=br-int
VNCSERVER_PROXYCLIENT_ADDRESS=$HOST_IP
VNCSERVER_LISTEN=0.0.0.0
MYSQL_HOST=$SERVICE_HOST
RABBIT_HOST=$SERVICE_HOST
GLANCE_HOSTPORT=$SERVICE_HOST:9292
KEYSTONE_AUTH_HOST=$SERVICE_HOST
KEYSTONE_SERVICE_HOST=$SERVICE_HOST
[[post-config|/etc/neutron/plugins/ml2/ml2_conf.ini]]
[agent]
minimize_polling=True

**Note**

We have to comment OFFLINE=TRUE in local.conf files, this will make
all the installations to happen automatically. RECLONE=yes only when
we set up the DevStack environment from scratch.
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-devstack-all-nodes">
<h5>Get Devstack (All nodes)<a class="headerlink" href="#get-devstack-all-nodes" title="Permalink to this headline">¶</a></h5>
<ul>
<li><p class="first">Install git application using</p>
<ul class="simple">
<li>sudo apt-get install git</li>
</ul>
</li>
<li><p class="first">Get devstack</p>
<ul class="simple">
<li>git clone <a class="reference external" href="https://git.openstack.org/openstack-dev/devstack">https://git.openstack.org/openstack-dev/devstack</a>;</li>
</ul>
</li>
<li><p class="first">Switch to stable/Juno Version branch</p>
<ul class="simple">
<li>cd devstack</li>
<li>git checkout stable/juno</li>
</ul>
<blockquote>
<div><p><strong>Note</strong></p>
<p>If you want to use stable/kilo Version branch, Please execute the
below command in devstack folder</p>
</div></blockquote>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">stable</span><span class="o">/</span><span class="n">kilo</span>

<span class="o">**</span><span class="n">Note</span><span class="o">**</span>

<span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">stable</span><span class="o">/</span><span class="n">liberty</span> <span class="n">Version</span> <span class="n">branch</span><span class="p">,</span> <span class="n">Please</span> <span class="n">execute</span> <span class="n">the</span>
<span class="n">below</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">devstack</span> <span class="n">folder</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">stable</span><span class="o">/</span><span class="n">liberty</span>
</pre></div>
</div>
</div>
<div class="section" id="stack-control-node">
<h5>Stack Control Node<a class="headerlink" href="#stack-control-node" title="Permalink to this headline">¶</a></h5>
<p><strong>local.conf: `DevStack Control &lt;#_devstack_control&gt;`__.</strong></p>
<p>cd devstack in the controller node</p>
<ul>
<li><p class="first">Copy the contents of local.conf for juno (devstack control node) from
<a class="reference external" href="#_devstack_control">DevStack Control</a> and save it as &#8220;local.conf&#8221;
in the &#8220;devstack&#8221;.</p>
</li>
<li><p class="first">Copy the contents of local.conf for kilo and liberty (devstack
control node) from <a class="reference external" href="#_devstack_kilo_liberty_control_node">Devstack Kilo_Liberty Control
Node</a> and save it as
&#8220;local.conf&#8221; in the &#8220;devstack&#8221;.</p>
</li>
<li><p class="first">Please modify the IP Address values as required.</p>
</li>
<li><p class="first">Stack the node</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">stack</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
</ul>
<div class="section" id="verify-control-node-stacking">
<h6>Verify Control Node stacking<a class="headerlink" href="#verify-control-node-stacking" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>stack.sh prints out Horizon is now available at
<a href="#id260"><span class="problematic" id="id266">`http://&lt;CONTROL\_NODE\_IP\_ADDRESS&gt;:8080/ &lt;http://&lt;CONTROL_NODE_IP_ADDRESS&gt;:8080/&gt;`__</span></a></li>
<li>Execute the command <em>sudo ovs-vsctl show</em> in the control node
terminal and verify if the bridge <em>br-int</em> is created.</li>
</ul>
</div>
</div>
<div class="section" id="stack-compute-node">
<h5>Stack Compute Node<a class="headerlink" href="#stack-compute-node" title="Permalink to this headline">¶</a></h5>
<p><strong>local.conf: `DevStack Compute &lt;#_devstack_compute&gt;`__.</strong></p>
<p>cd devstack in the controller node</p>
<ul>
<li><p class="first">Copy the contents of local.conf for juno (devstack compute node) from
<a class="reference external" href="#_devstack_compute">DevStack Compute</a> and save it as &#8220;local.conf&#8221;
in the &#8220;devstack&#8221;.</p>
</li>
<li><p class="first">Copy the contents of local.conf file for kilo and liberty (devstack
compute node) from <a class="reference external" href="#_devstack_kilo_liberty_compute_node">Devstack Kilo_Liberty Compute
Node</a> and save it as
&#8220;local.conf&#8221; in the &#8220;devstack&#8221;.</p>
</li>
<li><p class="first">Please modify the IP Address values as required.</p>
</li>
<li><p class="first">Stack the node</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">stack</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
</ul>
<div class="section" id="verify-compute-node-stacking">
<h6>Verify Compute Node Stacking<a class="headerlink" href="#verify-compute-node-stacking" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>stack.sh prints out This is your host ip:
&lt;COMPUTE_NODE_IP_ADDRESS&gt;</li>
<li>Execute the command <em>sudo ovs-vsctl show</em> in the control node
terminal and verify if the bridge <em>br-int</em> is created.</li>
<li>The output of the ovs-vsctl show will be similar to the one seen in
control node.</li>
</ul>
</div>
</div>
<div class="section" id="additional-verifications">
<h5>Additional Verifications<a class="headerlink" href="#additional-verifications" title="Permalink to this headline">¶</a></h5>
<ul>
<li><p class="first">Please visit the OpenDaylight DLUX GUI after stacking all the nodes,
<a href="#id260"><span class="problematic" id="id267">`http://&lt;ODL\_IP\_ADDRESS&gt;:8181/dlux/index.html &lt;http://&lt;ODL_IP_ADDRESS&gt;:8181/dlux/index.html&gt;`__</span></a>.
The switches, topology and the ports that are currently read can be
validated.</p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>If the interconnected between the Open vSwitch is not seen, Please
bring up the interface for the dataplane manually using the below
comamnd</p>
</div></blockquote>
</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ifup</span> <span class="o">&lt;</span><span class="n">interface_name</span><span class="o">&gt;</span>

<span class="o">**</span><span class="n">Tip</span><span class="o">**</span>

<span class="n">Some</span> <span class="n">versions</span> <span class="n">of</span> <span class="n">Open</span> <span class="n">vSwitch</span><span class="p">,</span> <span class="n">drop</span> <span class="n">packets</span> <span class="n">when</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">a</span>
<span class="n">table</span><span class="o">-</span><span class="n">miss</span><span class="p">,</span> <span class="n">So</span> <span class="n">please</span> <span class="n">add</span> <span class="n">the</span> <span class="n">below</span> <span class="n">flow</span> <span class="n">to</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">nodes</span> <span class="k">with</span> <span class="n">Open</span>
<span class="n">vSwitch</span> <span class="n">version</span> <span class="p">(</span><span class="o">&gt;=</span><span class="mf">2.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ovs</span><span class="o">-</span><span class="n">ofctl</span> <span class="o">--</span><span class="n">protocols</span><span class="o">=</span><span class="n">OpenFlow13</span> <span class="n">add</span><span class="o">-</span><span class="n">flow</span> <span class="n">br</span><span class="o">-</span><span class="nb">int</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">actions</span><span class="o">=</span><span class="n">output</span><span class="p">:</span><span class="n">CONTROLLER</span>

<span class="o">**</span><span class="n">Tip</span><span class="o">**</span>

<span class="n">Please</span> <span class="n">Accept</span> <span class="n">Promiscuous</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">networks</span> <span class="n">involving</span> <span class="n">the</span>
<span class="n">interconnect</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="create-vm-from-devstack-horizon-gui">
<h5>Create VM from Devstack Horizon GUI<a class="headerlink" href="#create-vm-from-devstack-horizon-gui" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Login to
<a href="#id260"><span class="problematic" id="id268">`http://&lt;CONTROL\_NODE\_IP&gt;:8080/ &lt;http://&lt;CONTROL_NODE_IP&gt;:8080/&gt;`__</span></a>
to check the horizon GUI.</li>
</ul>
<div class="figure" id="id242">
<img alt="Horizon GUI" src="../_images/OpenStackGui.png" />
<p class="caption"><span class="caption-text">Horizon GUI</span></p>
</div>
<p>Enter the value for User Name as admin and enter the value for Password
as labstack.</p>
<ul class="simple">
<li>We should first ensure both the hypervisors(control node and compute
node) are mapped under hypervisors by clicking on Hpervisors tab.</li>
</ul>
<div class="figure" id="id243">
<img alt="Hypervisors" src="../_images/Hypervisors.png" />
<p class="caption"><span class="caption-text">Hypervisors</span></p>
</div>
<ul class="simple">
<li>Create a new Network from Horizon GUI.</li>
<li>Click on Networks Tab.</li>
<li>click on the Create Network button.</li>
</ul>
<div class="figure" id="id244">
<img alt="Create Network" src="../_images/Create_Network.png" />
<p class="caption"><span class="caption-text">Create Network</span></p>
</div>
<ul class="simple">
<li>A popup screen will appear.</li>
<li>Enter network name and click Next button.</li>
</ul>
<div class="figure" id="id245">
<img alt="Step 1" src="../_images/Creare_Network_Step_1.png" />
<p class="caption"><span class="caption-text">Step 1</span></p>
</div>
<ul class="simple">
<li>Create a sub network by giving Network Address and click Next button
.</li>
</ul>
<div class="figure" id="id246">
<img alt="Step 2" src="../_images/Create_Network_Step_2.png" />
<p class="caption"><span class="caption-text">Step 2</span></p>
</div>
<ul class="simple">
<li>Specify the additional details for subnetwork (please refer the image
for your reference).</li>
</ul>
<div class="figure" id="id247">
<img alt="Step 3" src="../_images/Create_Network_Step_3.png" />
<p class="caption"><span class="caption-text">Step 3</span></p>
</div>
<ul class="simple">
<li>Click Create button</li>
<li>Create VM Instance</li>
<li>Navigate to Instances tab in the GUI.</li>
</ul>
<div class="figure" id="id248">
<img alt="Instance Creation" src="../_images/Instance_Creation.png" />
<p class="caption"><span class="caption-text">Instance Creation</span></p>
</div>
<ul class="simple">
<li>Click on Launch Instances button.</li>
</ul>
<div class="figure" id="id249">
<img alt="Launch Instance" src="../_images/Launch_Instance.png" />
<p class="caption"><span class="caption-text">Launch Instance</span></p>
</div>
<ul class="simple">
<li>Click on Details tab to enter the VM details.For this demo we are
creating Ten VM’s(instances).</li>
<li>In the Networking tab, we must select the network,for this we need to
drag and drop the Available networks to Selected Networks (i.e.,)
Drag vtn1 we created from Available networks to Selected Networks and
click Launch to create the instances.</li>
</ul>
<div class="figure" id="id250">
<img alt="Launch Network" src="../_images/Launch_Instance_network.png" />
<p class="caption"><span class="caption-text">Launch Network</span></p>
</div>
<ul class="simple">
<li>Ten VM’s will be created.</li>
</ul>
<div class="figure" id="id251">
<img alt="Load All Instances" src="../_images/Load_All_Instances.png" />
<p class="caption"><span class="caption-text">Load All Instances</span></p>
</div>
<ul class="simple">
<li>Click on any VM displayed in the Instances tab and click the Console
tab.</li>
</ul>
<div class="figure" id="id252">
<img alt="Instance Console" src="../_images/Instance_Console.png" />
<p class="caption"><span class="caption-text">Instance Console</span></p>
</div>
<ul class="simple">
<li>Login to the VM console and verify with a ping command.</li>
</ul>
<div class="figure" id="id253">
<img alt="Ping" src="../_images/Instance_ping.png" />
<p class="caption"><span class="caption-text">Ping</span></p>
</div>
</div>
<div class="section" id="verification-of-control-and-compute-node-after-vm-creation">
<h5>Verification of Control and Compute Node after VM creation<a class="headerlink" href="#verification-of-control-and-compute-node-after-vm-creation" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Every time a new VM is created, more interfaces are added to the
br-int bridge in Open vSwitch.</li>
<li>Use <strong>sudo ovs-vsctl show</strong> to list the number of interfaces added.</li>
<li>Please visit the DLUX GUI to list the new nodes in every switch.</li>
</ul>
</div>
</div>
<div class="section" id="using-the-dlux-gui">
<h4>Using the DLUX GUI<a class="headerlink" href="#using-the-dlux-gui" title="Permalink to this headline">¶</a></h4>
<p>For more information see <a class="reference external" href="#_using_the_opendaylight_user_interface_dlux">the chapter on
DLUX</a> above.</p>
<div class="section" id="references">
<h5>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference external" href="http://devstack.org/guides/multinode-lab.html">http://devstack.org/guides/multinode-lab.html</a></li>
<li><a class="reference external" href="https://wiki.opendaylight.org/view/File:Vtn_demo_hackfest_2014_march.pdf">https://wiki.opendaylight.org/view/File:Vtn_demo_hackfest_2014_march.pdf</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="vtn-usage-examples">
<h3>VTN Usage Examples<a class="headerlink" href="#vtn-usage-examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="how-to-configure-l2-network-with-single-controller">
<h4>How to configure L2 Network with Single Controller<a class="headerlink" href="#how-to-configure-l2-network-with-single-controller" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id133">
<h5>Overview<a class="headerlink" href="#id133" title="Permalink to this headline">¶</a></h5>
<p>This example provides the procedure to demonstrate configuration of VTN
Coordinator with L2 network using VTN Virtualization(single controller).
Here is the Example for vBridge Interface Mapping with Single Controller
using mininet. mininet details and set-up can be referred at below URL:
<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Installation#Using_Mininet">https://wiki.opendaylight.org/view/OpenDaylight_Controller:Installation#Using_Mininet</a></p>
<div class="figure" id="id254">
<img alt="EXAMPLE DEMONSTRATING SINGLE CONTROLLER" src="../_images/vtn-single-controller-topology-example.png" />
<p class="caption"><span class="caption-text">EXAMPLE DEMONSTRATING SINGLE CONTROLLER</span></p>
</div>
</div>
<div class="section" id="id134">
<h5>Requirements<a class="headerlink" href="#id134" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Configure mininet and create a topology:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>mininet@mininet-vm:~$ sudo mn --controller=remote,ip=&lt;controller-ip&gt; --topo tree,2
</pre></div>
</div>
<ul class="simple">
<li>mininet&gt; net</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s1</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">h1</span><span class="o">-</span><span class="n">eth0</span> <span class="n">s1</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">s2</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s2</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth2</span> <span class="n">s2</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">h2</span><span class="o">-</span><span class="n">eth0</span>
<span class="n">h1</span> <span class="n">h1</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">h2</span> <span class="n">h2</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth2</span>
</pre></div>
</div>
</div>
<div class="section" id="id135">
<h5>Configuration<a class="headerlink" href="#id135" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Create a Controller</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;controllerone&quot;, &quot;ipaddr&quot;:&quot;10.0.0.2&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot; : {&quot;vtn_name&quot;:&quot;vtn1&quot;,&quot;description&quot;:&quot;test VTN&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a vBridge in the VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vBridge1&quot;,&quot;controller_id&quot;:&quot;controllerone&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create two Interfaces into the vBridge</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;,&quot;description&quot;: &quot;if_desc1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if2&quot;,&quot;description&quot;: &quot;if_desc2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Get the list of logical ports configured</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">/</span><span class="n">controllerone</span><span class="o">/</span><span class="n">domains</span><span class="o">/</span>\<span class="p">(</span><span class="n">DEFAULT</span>\<span class="p">)</span><span class="o">/</span><span class="n">logical_ports</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Configure two mappings on the interfaces</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:03-s3-eth1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:02-s2-eth1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if2</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="id136">
<h5>Verification<a class="headerlink" href="#id136" title="Permalink to this headline">¶</a></h5>
<p>Please verify whether the Host1 and Host3 are pinging. * Send packets
from Host1 to Host3</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h1</span> <span class="n">ping</span> <span class="n">h3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-configure-l2-network-with-multiple-controllers">
<h4>How to configure L2 Network with Multiple Controllers<a class="headerlink" href="#how-to-configure-l2-network-with-multiple-controllers" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>This example provides the procedure to demonstrate configuration of
VTN Coordinator with L2 network using VTN Virtualization Here is the
Example for vBridge Interface Mapping with Multi-controller using
mininet.</li>
</ul>
<div class="figure" id="id255">
<img alt="EXAMPLE DEMONSTRATING MULTIPLE CONTROLLERS" src="../_images/MutiController_Example_diagram.png" />
<p class="caption"><span class="caption-text">EXAMPLE DEMONSTRATING MULTIPLE CONTROLLERS</span></p>
</div>
<div class="section" id="id137">
<h5>Requirements<a class="headerlink" href="#id137" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Configure multiple controllers using the mininet script given below:
<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_%28VTN%29:Scripts:Mininet#Network_with_Multiple_Paths_for_delivering_packets">https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_%28VTN%29:Scripts:Mininet#Network_with_Multiple_Paths_for_delivering_packets</a></li>
</ul>
</div>
<div class="section" id="id138">
<h5>Configuration<a class="headerlink" href="#id138" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Create a VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot; : {&quot;vtn_name&quot;:&quot;vtn3&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create two Controllers</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;odc1&quot;, &quot;ipaddr&quot;:&quot;10.100.9.52&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;odc2&quot;, &quot;ipaddr&quot;:&quot;10.100.9.61&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create two vBridges in the VTN like, vBridge1 in Controller1 and
vBridge2 in Controller2</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vbr1&quot;,&quot;controller_id&quot;:&quot;odc1&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vbr2&quot;,&quot;controller_id&quot;:&quot;odc2&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create vBridge Interfaces</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr2</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr2</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Get the list of logical ports configured</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">/</span><span class="n">odc1</span><span class="o">/</span><span class="n">domains</span><span class="o">/</span>\<span class="p">(</span><span class="n">DEFAULT</span>\<span class="p">)</span><span class="o">/</span><span class="n">logical_ports</span><span class="o">/</span><span class="n">detail</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create boundary and vLink</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>   <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;boundary&quot;: {&quot;boundary_id&quot;: &quot;b1&quot;, &quot;link&quot;: {&quot;controller1_id&quot;: &quot;odc1&quot;, &quot;domain1_id&quot;: &quot;(DEFAULT)&quot;, &quot;logical_port1_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:01-s1-eth3&quot;, &quot;controller2_id&quot;: &quot;odc2&quot;, &quot;domain2_id&quot;: &quot;(DEFAULT)&quot;, &quot;logical_port2_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:04-s4-eth3&quot;}}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">boundaries</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vlink&quot;: {&quot;vlk_name&quot;: &quot;vlink1&quot; , &quot;vnode1_name&quot;: &quot;vbr1&quot;, &quot;if1_name&quot;:&quot;if2&quot;, &quot;vnode2_name&quot;: &quot;vbr2&quot;, &quot;if2_name&quot;: &quot;if2&quot;, &quot;boundary_map&quot;: {&quot;boundary_id&quot;:&quot;b1&quot;,&quot;vlan_id&quot;: &quot;50&quot;}}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vlinks</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Configure port-map on the interfaces</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:02-s2-eth2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:05-s5-eth2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn3</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr2</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="id139">
<h5>Verification<a class="headerlink" href="#id139" title="Permalink to this headline">¶</a></h5>
<p>Please verify whether Host h2 and Host h6 are pinging. * Send packets
from h2 to h6</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h2</span> <span class="n">ping</span> <span class="n">h6</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-test-vlan-map-in-mininet-environment">
<h4>How To Test Vlan-Map In Mininet Environment<a class="headerlink" href="#how-to-test-vlan-map-in-mininet-environment" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id140">
<h5>Overview<a class="headerlink" href="#id140" title="Permalink to this headline">¶</a></h5>
<p>This example explains how to test vlan-map in a multi host scenario.</p>
</div>
<div class="section" id="id141">
<h5>Requirements<a class="headerlink" href="#id141" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Save the mininet script given below as vlan_vtn_test.py and run the
mininet script in the mininet environment where Mininet is installed.</li>
</ul>
</div>
<div class="section" id="mininet-script">
<h5>Mininet Script<a class="headerlink" href="#mininet-script" title="Permalink to this headline">¶</a></h5>
<p><a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_(VTN):Scripts:Mininet#Network_with_hosts_in_different_vlan">https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_(VTN):Scripts:Mininet#Network_with_hosts_in_different_vlan</a></p>
<ul class="simple">
<li>Run the mininet script</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mn</span> <span class="o">--</span><span class="n">controller</span><span class="o">=</span><span class="n">remote</span><span class="p">,</span><span class="n">ip</span><span class="o">=</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">64.13</span> <span class="o">--</span><span class="n">custom</span> <span class="n">vlan_vtn_test</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">topo</span> <span class="n">mytopo</span>
</pre></div>
</div>
</div>
<div class="section" id="id142">
<h5>Configuration<a class="headerlink" href="#id142" title="Permalink to this headline">¶</a></h5>
<p>Please follow the below steps to test a vlan map using mininet: *
Create a controller</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;controllerone&quot;, &quot;ipaddr&quot;:&quot;10.0.0.2&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot; : {&quot;vtn_name&quot;:&quot;vtn1&quot;,&quot;description&quot;:&quot;test VTN&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a vBridge(vBridge1)</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vBridge1&quot;,&quot;controller_id&quot;:&quot;controllerone&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a vlan map with vlanid 200 for vBridge vBridge1</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vlanmap&quot; : {&quot;vlan_id&quot;: 200 }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">vlanmaps</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a vBridge (vBridge2)</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vBridge2&quot;,&quot;controller_id&quot;:&quot;controllerone&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a vlan map with vlanid 300 for vBridge vBridge2</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vlanmap&quot; : {&quot;vlan_id&quot;: 300 }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge2</span><span class="o">/</span><span class="n">vlanmaps</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="id143">
<h5>Verification<a class="headerlink" href="#id143" title="Permalink to this headline">¶</a></h5>
<p>Ping all in mininet environment to view the host reachability.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">pingall</span>
<span class="n">Ping</span><span class="p">:</span> <span class="n">testing</span> <span class="n">ping</span> <span class="n">reachability</span>
<span class="n">h1</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">h3</span> <span class="n">X</span> <span class="n">h5</span> <span class="n">X</span>
<span class="n">h2</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">X</span> <span class="n">h4</span> <span class="n">X</span> <span class="n">h6</span>
<span class="n">h3</span> <span class="o">-&gt;</span> <span class="n">h1</span> <span class="n">X</span> <span class="n">X</span> <span class="n">h5</span> <span class="n">X</span>
<span class="n">h4</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">h2</span> <span class="n">X</span> <span class="n">X</span> <span class="n">h6</span>
<span class="n">h5</span> <span class="o">-&gt;</span> <span class="n">h1</span> <span class="n">X</span> <span class="n">h3</span> <span class="n">X</span> <span class="n">X</span>
<span class="n">h6</span> <span class="o">-&gt;</span> <span class="n">X</span> <span class="n">h2</span> <span class="n">X</span> <span class="n">h4</span> <span class="n">X</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-view-specific-vtn-station-information">
<h4>How To View Specific VTN Station Information.<a class="headerlink" href="#how-to-view-specific-vtn-station-information" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates on how to view a specific VTN Station
information.</p>
<div class="figure" id="id256">
<img alt="EXAMPLE DEMONSTRATING VTN STATIONS" src="../_images/vtn_stations.png" />
<p class="caption"><span class="caption-text">EXAMPLE DEMONSTRATING VTN STATIONS</span></p>
</div>
<div class="section" id="id144">
<h5>Requirement<a class="headerlink" href="#id144" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Configure mininet and create a topology:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span> $ sudo mn --custom /home/mininet/mininet/custom/topo-2sw-2host.py --controller=remote,ip=10.100.9.61 --topo mytopo
mininet&gt; net

 s1 lo:  s1-eth1:h1-eth0 s1-eth2:s2-eth1
 s2 lo:  s2-eth1:s1-eth2 s2-eth2:h2-eth0
 h1 h1-eth0:s1-eth1
 h2 h2-eth0:s2-eth2
</pre></div>
</div>
<ul class="simple">
<li>Generate traffic by pinging between hosts h1 and h2 after configuring
the portmaps respectively</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h1</span> <span class="n">ping</span> <span class="n">h2</span>
<span class="n">PING</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span> <span class="p">(</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="o">.</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">1</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">16.7</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">2</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">13.2</span> <span class="n">ms</span>
</pre></div>
</div>
</div>
<div class="section" id="id145">
<h5>Configuration<a class="headerlink" href="#id145" title="Permalink to this headline">¶</a></h5>
<p><strong>Create Controller.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;controllerone&quot;, &quot;ipaddr&quot;:&quot;10.100.9.61&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p><strong>Create a VTN.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot; : {&quot;vtn_name&quot;:&quot;vtn1&quot;,&quot;description&quot;:&quot;test VTN&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p><strong>Create a vBridge in the VTN.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vBridge1&quot;,&quot;controller_id&quot;:&quot;controllerone&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p><strong>Create two Interfaces into the vBridge.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;,&quot;description&quot;: &quot;if_desc1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if2&quot;,&quot;description&quot;: &quot;if_desc2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p><strong>Configure two mappings on the interfaces.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:01-s1-eth1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:02-s2-eth2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">17.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if2</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p><strong>Get the VTN stations information.</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="s2">&quot;http://127.0.0.1:8083/vtn-webapi/vtnstations?controller_id=controllerone&amp;vtn_name=vtn1&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id146">
<h5>Verification<a class="headerlink" href="#id146" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username: admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password: adminpass&#39;</span> <span class="s2">&quot;http://127.0.0.1:8083/vtn-webapi/vtnstations?controller_id=controllerone&amp;vtn_name=vtn1&quot;</span>
<span class="p">{</span>
   <span class="s2">&quot;vtnstations&quot;</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;domain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;(DEFAULT)&quot;</span><span class="p">,</span>
           <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="p">{},</span>
           <span class="s2">&quot;ipaddrs&quot;</span><span class="p">:</span> <span class="p">[</span>
               <span class="s2">&quot;10.0.0.2&quot;</span>
           <span class="p">],</span>
           <span class="s2">&quot;macaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;b2c3.06b8.2dac&quot;</span><span class="p">,</span>
           <span class="s2">&quot;no_vlan_id&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
           <span class="s2">&quot;port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s2-eth2&quot;</span><span class="p">,</span>
           <span class="s2">&quot;station_id&quot;</span><span class="p">:</span> <span class="s2">&quot;178195618445172&quot;</span><span class="p">,</span>
           <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:02&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vnode_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vBridge1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vnode_type&quot;</span><span class="p">:</span> <span class="s2">&quot;vbridge&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vtn_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vtn1&quot;</span>
       <span class="p">},</span>
       <span class="p">{</span>
           <span class="s2">&quot;domain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;(DEFAULT)&quot;</span><span class="p">,</span>
           <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="p">{},</span>
           <span class="s2">&quot;ipaddrs&quot;</span><span class="p">:</span> <span class="p">[</span>
               <span class="s2">&quot;10.0.0.1&quot;</span>
           <span class="p">],</span>
           <span class="s2">&quot;macaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;ce82.1b08.90cf&quot;</span><span class="p">,</span>
           <span class="s2">&quot;no_vlan_id&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
           <span class="s2">&quot;port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;station_id&quot;</span><span class="p">:</span> <span class="s2">&quot;206130278144207&quot;</span><span class="p">,</span>
           <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:01&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vnode_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vBridge1&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vnode_type&quot;</span><span class="p">:</span> <span class="s2">&quot;vbridge&quot;</span><span class="p">,</span>
           <span class="s2">&quot;vtn_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vtn1&quot;</span>
       <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-view-dataflows-in-vtn">
<h4>How To View Dataflows in VTN<a class="headerlink" href="#how-to-view-dataflows-in-vtn" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates on how to view a specific VTN Dataflow
information.</p>
<div class="section" id="id147">
<h5>Configuration<a class="headerlink" href="#id147" title="Permalink to this headline">¶</a></h5>
<p>The same Configuration as Vlan Mapping
Example(<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_(VTN):VTN_Coordinator:RestApi:How_to_test_vlan-map_in_Mininet_environment">https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_(VTN):VTN_Coordinator:RestApi:How_to_test_vlan-map_in_Mininet_environment</a>)</p>
</div>
<div class="section" id="id148">
<h5>Verification<a class="headerlink" href="#id148" title="Permalink to this headline">¶</a></h5>
<p>Get the VTN Dataflows information</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">--</span><span class="n">user</span> <span class="s1">&#39;admin:adminpass&#39;</span> <span class="s2">&quot;http://127.0.0.1:8083/vtn-webapi/dataflows?controller_id=controllerone&amp;srcmacaddr=924c.e4a3.a743&amp;vlan_id=300&amp;switch_id=00:00:00:00:00:00:00:02&amp;port_name=s2-eth1&quot;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;dataflows&quot;</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span>
           <span class="s2">&quot;controller_dataflows&quot;</span><span class="p">:</span> <span class="p">[</span>
               <span class="p">{</span>
                   <span class="s2">&quot;controller_id&quot;</span><span class="p">:</span> <span class="s2">&quot;controllerone&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;controller_type&quot;</span><span class="p">:</span> <span class="s2">&quot;odc&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;egress_domain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;(DEFAULT)&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;egress_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth3&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;egress_station_id&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;egress_switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:03&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="s2">&quot;29&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ingress_domain_id&quot;</span><span class="p">:</span> <span class="s2">&quot;(DEFAULT)&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ingress_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s2-eth2&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ingress_station_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;ingress_switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:02&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;match&quot;</span><span class="p">:</span> <span class="p">{</span>
                       <span class="s2">&quot;macdstaddr&quot;</span><span class="p">:</span> <span class="p">[</span>
                           <span class="s2">&quot;4298.0959.0e0b&quot;</span>
                       <span class="p">],</span>
                       <span class="s2">&quot;macsrcaddr&quot;</span><span class="p">:</span> <span class="p">[</span>
                           <span class="s2">&quot;924c.e4a3.a743&quot;</span>
                       <span class="p">],</span>
                       <span class="s2">&quot;vlan_id&quot;</span><span class="p">:</span> <span class="p">[</span>
                           <span class="s2">&quot;300&quot;</span>
                       <span class="p">]</span>
                   <span class="p">},</span>
                   <span class="s2">&quot;pathinfos&quot;</span><span class="p">:</span> <span class="p">[</span>
                       <span class="p">{</span>
                           <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s2-eth2&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s2-eth1&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:02&quot;</span>
                       <span class="p">},</span>
                       <span class="p">{</span>
                           <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth2&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth3&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:01&quot;</span>
                       <span class="p">},</span>
                       <span class="p">{</span>
                           <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth1&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth3&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:03&quot;</span>
                       <span class="p">}</span>
                   <span class="p">]</span>
               <span class="p">}</span>
           <span class="p">],</span>
           <span class="s2">&quot;reason&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span>
       <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-configure-flow-filters-using-vtn">
<h4>How To Configure Flow Filters Using VTN<a class="headerlink" href="#how-to-configure-flow-filters-using-vtn" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id149">
<h5>Overview<a class="headerlink" href="#id149" title="Permalink to this headline">¶</a></h5>
<p>The flow-filter function discards, permits, or redirects packets of the
traffic within a VTN, according to specified flow conditions The table
below lists the actions to be applied when a packet matches the
condition:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Action</td>
<td>Function</td>
</tr>
<tr class="row-even"><td>Pass</td>
<td>Permits the packet to pass. As
options, packet transfer priority
(set priority) and DSCP change (se t
ip-dscp) is specified.</td>
</tr>
<tr class="row-odd"><td>Drop</td>
<td>Discards the packet.</td>
</tr>
<tr class="row-even"><td>Redirect</td>
<td>Redirects the packet to a desired
virtual interface. As an option, it
is possible to change the MAC
address when the packet is
transferred.</td>
</tr>
</tbody>
</table>
<div class="figure" id="id257">
<img alt="Flow Filter" src="../_images/flow_filter_example.png" />
<p class="caption"><span class="caption-text">Flow Filter</span></p>
</div>
<p>Following steps explain flow-filter function:</p>
<ul class="simple">
<li>When a packet is transferred to an interface within a virtual
network, the flow-filter function evaluates whether the transferred
packet matches the condition specified in the flow-list.</li>
<li>If the packet matches the condition, the flow-filter applies the
flow-list matching action specified in the flow-filter.</li>
</ul>
</div>
<div class="section" id="id150">
<h5>Requirements<a class="headerlink" href="#id150" title="Permalink to this headline">¶</a></h5>
<p>To apply the packet filter, configure the following:</p>
<ul class="simple">
<li>Create a flow-list and flow-listentry.</li>
<li>Specify where to apply the flow-filter, for example VTN, vBridge, or
interface of vBridge.</li>
</ul>
<p>Configure mininet and create a topology:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$  mininet@mininet-vm:~$ sudo mn --controller=remote,ip=&lt;controller-ip&gt; --topo tree
</pre></div>
</div>
<p>Please generate the following topology</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$  mininet@mininet-vm:~$ sudo mn --controller=remote,ip=&lt;controller-ip&gt; --topo tree,2
mininet&gt; net
c0
s1 lo:  s1-eth1:s2-eth3 s1-eth2:s3-eth3
s2 lo:  s2-eth1:h1-eth0 s2-eth2:h2-eth0 s2-eth3:s1-eth1
s3 lo:  s3-eth1:h3-eth0 s3-eth2:h4-eth0 s3-eth3:s1-eth2
h1 h1-eth0:s2-eth1
h2 h2-eth0:s2-eth2
h3 h3-eth0:s3-eth1
h4 h4-eth0:s3-eth2
</pre></div>
</div>
</div>
<div class="section" id="id151">
<h5>Configuration<a class="headerlink" href="#id151" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>.Create a controller</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;controller1&quot;, &quot;ipaddr&quot;:&quot;10.100.9.61&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot; : {&quot;vtn_name&quot;:&quot;vtn_one&quot;,&quot;description&quot;:&quot;test VTN&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create two vBridges</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vbr_one^C&quot;controller_id&quot;:&quot;controller1&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; :</span>
<span class="p">{</span><span class="s2">&quot;vbr_name&quot;</span><span class="p">:</span><span class="s2">&quot;vbr_two&quot;</span><span class="p">,</span><span class="s2">&quot;controller_id&quot;</span><span class="p">:</span><span class="s2">&quot;controller1&quot;</span><span class="p">,</span><span class="s2">&quot;domain_id&quot;</span><span class="p">:</span><span class="s2">&quot;(DEFAULT)&quot;</span> <span class="p">}}</span><span class="s1">&#39; http://127.0.0.1:8083/vtn-webapi/vtns/vtn_one/vbridges.json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create vBridge interfaces</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;,&quot;description&quot;: &quot;if_desc1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;,&quot;description&quot;: &quot;if_desc1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Configure two mappings on the interfaces</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:03-s3-eth1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:02-s2-eth1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if2</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create Flowlist</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;flowlist&quot;: {&quot;fl_name&quot;: &quot;flowlist1&quot;, &quot;ip_version&quot;:&quot;IP&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">flowlists</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create Flowlistentry</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;flowlistentry&quot;: {&quot;seqnum&quot;: &quot;233&quot;,&quot;macethertype&quot;: &quot;0x8000&quot;,&quot;ipdstaddr&quot;: &quot;10.0.0.3&quot;,&quot;ipdstaddrprefix&quot;: &quot;2&quot;,&quot;ipsrcaddr&quot;: &quot;10.0.0.2&quot;,&quot;ipsrcaddrprefix&quot;: &quot;2&quot;,&quot;ipproto&quot;: &quot;17&quot;,&quot;ipdscp&quot;: &quot;55&quot;,&quot;icmptypenum&quot;:&quot;232&quot;,&quot;icmpcodenum&quot;: &quot;232&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">flowlists</span><span class="o">/</span><span class="n">flowlist1</span><span class="o">/</span><span class="n">flowlistentries</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create vBridge Interface Flowfilter</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;flowfilter&quot; : {&quot;ff_type&quot;: &quot;in&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">flowfilters</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="flow-filter-demonstration-with-drop-action-type">
<h5>Flow filter demonstration with DROP action-type<a class="headerlink" href="#flow-filter-demonstration-with-drop-action-type" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;flowfilterentry&quot;: {&quot;seqnum&quot;: &quot;233&quot;, &quot;fl_name&quot;: &quot;flowlist1&quot;, &quot;action_type&quot;:&quot;drop&quot;, &quot;priority&quot;:&quot;3&quot;, &quot;dscp&quot;:&quot;55&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">flowfilters</span><span class="o">/</span><span class="ow">in</span><span class="o">/</span><span class="n">flowfilterentries</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="id152">
<h5>Verification<a class="headerlink" href="#id152" title="Permalink to this headline">¶</a></h5>
<p>As we have applied the action type &#8220;drop&#8221; , ping should fail.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h1</span> <span class="n">ping</span> <span class="n">h3</span>
<span class="n">PING</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span> <span class="p">(</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="o">.</span>
<span class="n">From</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">Destination</span> <span class="n">Host</span> <span class="n">Unreachable</span>
<span class="n">From</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="n">Destination</span> <span class="n">Host</span> <span class="n">Unreachable</span>
</pre></div>
</div>
<p>In controller you can see the DROP action type information as below,
here action as DROP. osgi&gt; readflows 0000000000000003</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">FlowOnNode</span><span class="p">[</span><span class="n">flow</span> <span class="o">=</span><span class="n">Flow</span><span class="p">[</span><span class="n">match</span> <span class="o">=</span> <span class="n">Match</span> <span class="p">[</span><span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="n">DL_VLAN</span><span class="o">=</span><span class="n">DL_VLAN</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">IN_PORT</span><span class="o">=</span><span class="n">IN_PORT</span><span class="p">(</span><span class="n">OF</span><span class="o">|</span><span class="mi">1</span><span class="nd">@OF</span><span class="o">|</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">03</span><span class="p">),</span> <span class="n">DL_DST</span><span class="o">=</span><span class="n">DL_DST</span><span class="p">(</span><span class="mi">4</span><span class="n">e</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">1</span><span class="n">d</span><span class="p">:</span><span class="n">a6</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">08</span><span class="p">),</span> <span class="n">DL_SRC</span><span class="o">=</span><span class="n">DL_SRC</span><span class="p">(</span><span class="n">be</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="n">a4</span><span class="p">:</span><span class="mi">96</span><span class="p">:</span><span class="mi">13</span><span class="p">)},</span> <span class="n">matches</span><span class="o">=</span><span class="mi">15</span><span class="p">],</span> <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">DROP</span><span class="p">],</span> <span class="n">priority</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idleTimeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hardTimeout</span> <span class="o">=</span> <span class="mi">300</span><span class="p">],</span> <span class="n">tableId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sec</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">nsec</span> <span class="o">=</span> <span class="mi">475000000</span><span class="p">,</span> <span class="n">pkt</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">byte</span> <span class="o">=</span> <span class="mi">1232</span><span class="p">],</span> <span class="n">FlowOnNode</span><span class="p">[</span><span class="n">flow</span> <span class="o">=</span><span class="n">Flow</span><span class="p">[</span><span class="n">match</span> <span class="o">=</span> <span class="n">Match</span> <span class="p">[</span><span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="n">DL_VLAN</span><span class="o">=</span><span class="n">DL_VLAN</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">IN_PORT</span><span class="o">=</span><span class="n">IN_PORT</span><span class="p">(</span><span class="n">OF</span><span class="o">|</span><span class="mi">3</span><span class="nd">@OF</span><span class="o">|</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">03</span><span class="p">),</span> <span class="n">DL_DST</span><span class="o">=</span><span class="n">DL_DST</span><span class="p">(</span><span class="n">be</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="n">a4</span><span class="p">:</span><span class="mi">96</span><span class="p">:</span><span class="mi">13</span><span class="p">),</span> <span class="n">DL_SRC</span><span class="o">=</span><span class="n">DL_SRC</span><span class="p">(</span><span class="mi">4</span><span class="n">e</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">1</span><span class="n">d</span><span class="p">:</span><span class="n">a6</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">08</span><span class="p">)},</span> <span class="n">matches</span><span class="o">=</span><span class="mi">15</span><span class="p">],</span> <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">OUTPUT</span><span class="p">[</span><span class="n">OF</span><span class="o">|</span><span class="mi">1</span><span class="nd">@OF</span><span class="o">|</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">03</span><span class="p">]],</span> <span class="n">priority</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idleTimeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hardTimeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">],</span> <span class="n">tableId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sec</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">nsec</span> <span class="o">=</span> <span class="mi">489000000</span><span class="p">,</span> <span class="n">pkt</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">byte</span> <span class="o">=</span> <span class="mi">812</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="flow-filter-demonstration-with-pass-action-type">
<h5>Flow filter demonstration with PASS action-type<a class="headerlink" href="#flow-filter-demonstration-with-pass-action-type" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;flowfilterentry&quot;: {&quot;seqnum&quot;: &quot;233&quot;, &quot;fl_name&quot;: &quot;flowlist1&quot;, &quot;action_type&quot;:&quot;pass&quot;, &quot;priority&quot;:&quot;3&quot;, &quot;dscp&quot;:&quot;55&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn_one</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vbr_two</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">flowfilters</span><span class="o">/</span><span class="ow">in</span><span class="o">/</span><span class="n">flowfilterentries</span><span class="o">/</span><span class="mf">233.</span><span class="n">json</span>
</pre></div>
</div>
</div>
<div class="section" id="id153">
<h5>Verification<a class="headerlink" href="#id153" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h1</span> <span class="n">ping</span> <span class="n">h3</span>
<span class="n">PING</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.3</span> <span class="p">(</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.3</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="o">.</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.3</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">1</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.984</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.3</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">2</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.110</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.3</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">3</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.098</span> <span class="n">ms</span>
</pre></div>
</div>
<p>In controller you can see the PASS action type information by executing
the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">osgi</span><span class="o">&gt;</span> <span class="n">readflows</span> <span class="mi">0000000000000003</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-to-use-vtn-to-make-packets-take-different-paths">
<h4>How To Use VTN To Make Packets Take Different Paths<a class="headerlink" href="#how-to-use-vtn-to-make-packets-take-different-paths" title="Permalink to this headline">¶</a></h4>
<p>This example demonstrates on how to create a specific VTN Path Map
information.</p>
<div class="figure" id="id258">
<img alt="PathMap" src="../_images/Pathmap.png" />
<p class="caption"><span class="caption-text">PathMap</span></p>
</div>
<div class="section" id="id154">
<h5>Requirement<a class="headerlink" href="#id154" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Save the mininet script given below as pathmap_test.py and run the
mininet script in the mininet environment where Mininet is installed.</li>
<li>Create topology using the below mininet script:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mininet.topo</span> <span class="k">import</span> <span class="n">Topo</span>
  <span class="k">class</span> <span class="nc">MyTopo</span><span class="p">(</span> <span class="n">Topo</span> <span class="p">):</span>
    <span class="s2">&quot;Simple topology example.&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="s2">&quot;Create custom topo.&quot;</span>
        <span class="c1"># Initialize topology</span>
        <span class="n">Topo</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
        <span class="c1"># Add hosts and switches</span>
        <span class="n">leftHost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addHost</span><span class="p">(</span> <span class="s1">&#39;h1&#39;</span> <span class="p">)</span>
        <span class="n">rightHost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addHost</span><span class="p">(</span> <span class="s1">&#39;h2&#39;</span> <span class="p">)</span>
        <span class="n">leftSwitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addSwitch</span><span class="p">(</span> <span class="s1">&#39;s1&#39;</span> <span class="p">)</span>
        <span class="n">middleSwitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addSwitch</span><span class="p">(</span> <span class="s1">&#39;s2&#39;</span> <span class="p">)</span>
        <span class="n">middleSwitch2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addSwitch</span><span class="p">(</span> <span class="s1">&#39;s4&#39;</span> <span class="p">)</span>
        <span class="n">rightSwitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addSwitch</span><span class="p">(</span> <span class="s1">&#39;s3&#39;</span> <span class="p">)</span>
        <span class="c1"># Add links</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span> <span class="n">leftHost</span><span class="p">,</span> <span class="n">leftSwitch</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span> <span class="n">leftSwitch</span><span class="p">,</span> <span class="n">middleSwitch</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span> <span class="n">leftSwitch</span><span class="p">,</span> <span class="n">middleSwitch2</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span> <span class="n">middleSwitch</span><span class="p">,</span> <span class="n">rightSwitch</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span> <span class="n">middleSwitch2</span><span class="p">,</span> <span class="n">rightSwitch</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addLink</span><span class="p">(</span> <span class="n">rightSwitch</span><span class="p">,</span> <span class="n">rightHost</span> <span class="p">)</span>
 <span class="n">topos</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;mytopo&#39;</span><span class="p">:</span> <span class="p">(</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">MyTopo</span><span class="p">()</span> <span class="p">)</span> <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">net</span>
<span class="n">c0</span>
<span class="n">s1</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s1</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">h1</span><span class="o">-</span><span class="n">eth0</span> <span class="n">s1</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth1</span> <span class="n">s1</span><span class="o">-</span><span class="n">eth3</span><span class="p">:</span><span class="n">s4</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">s2</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s2</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth2</span> <span class="n">s2</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">s3</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">s3</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s3</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">s2</span><span class="o">-</span><span class="n">eth2</span> <span class="n">s3</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">s4</span><span class="o">-</span><span class="n">eth2</span> <span class="n">s3</span><span class="o">-</span><span class="n">eth3</span><span class="p">:</span><span class="n">h2</span><span class="o">-</span><span class="n">eth0</span>
<span class="n">s4</span> <span class="n">lo</span><span class="p">:</span>  <span class="n">s4</span><span class="o">-</span><span class="n">eth1</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth3</span> <span class="n">s4</span><span class="o">-</span><span class="n">eth2</span><span class="p">:</span><span class="n">s3</span><span class="o">-</span><span class="n">eth2</span>
<span class="n">h1</span> <span class="n">h1</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s1</span><span class="o">-</span><span class="n">eth1</span>
<span class="n">h2</span> <span class="n">h2</span><span class="o">-</span><span class="n">eth0</span><span class="p">:</span><span class="n">s3</span><span class="o">-</span><span class="n">eth3</span>
</pre></div>
</div>
<ul class="simple">
<li>Generate traffic by pinging between hosts h1 and h2 before creating
the portmaps respectively</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h1</span> <span class="n">ping</span> <span class="n">h2</span>
<span class="n">PING</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span> <span class="p">(</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="o">.</span>
<span class="n">From</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span> <span class="n">Destination</span> <span class="n">Host</span> <span class="n">Unreachable</span>
<span class="n">From</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span> <span class="n">Destination</span> <span class="n">Host</span> <span class="n">Unreachable</span>
<span class="n">From</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">3</span> <span class="n">Destination</span> <span class="n">Host</span> <span class="n">Unreachable</span>
<span class="n">From</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">icmp_seq</span><span class="o">=</span><span class="mi">4</span> <span class="n">Destination</span> <span class="n">Host</span> <span class="n">Unreachable</span>
</pre></div>
</div>
</div>
<div class="section" id="id155">
<h5>Configuration<a class="headerlink" href="#id155" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Create Controller</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;controller&quot;: {&quot;controller_id&quot;: &quot;odc&quot;, &quot;ipaddr&quot;:&quot;10.100.9.42&quot;, &quot;type&quot;: &quot;odc&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;auditstatus&quot;:&quot;enable&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">controllers</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vtn&quot; : {&quot;vtn_name&quot;:&quot;vtn1&quot;,&quot;description&quot;:&quot;test VTN&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a vBridge in the VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;vbridge&quot; : {&quot;vbr_name&quot;:&quot;vBridge1&quot;,&quot;controller_id&quot;:&quot;odc&quot;,&quot;domain_id&quot;:&quot;(DEFAULT)&quot; }}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Create two Interfaces into the vBridge</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if1&quot;,&quot;description&quot;: &quot;if_desc1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;interface&quot;: {&quot;if_name&quot;: &quot;if2&quot;,&quot;description&quot;: &quot;if_desc2&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Configure two mappings on the interfaces</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:01-s1-eth1&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if1</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
<span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">adminpass</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span>  <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;portmap&quot;:{&quot;logical_port_id&quot;: &quot;PP-OF:00:00:00:00:00:00:00:03-s3-eth3&quot;}}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">vtns</span><span class="o">/</span><span class="n">vtn1</span><span class="o">/</span><span class="n">vbridges</span><span class="o">/</span><span class="n">vBridge1</span><span class="o">/</span><span class="n">interfaces</span><span class="o">/</span><span class="n">if2</span><span class="o">/</span><span class="n">portmap</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<ul class="simple">
<li>Generate traffic by pinging between hosts h1 and h2 after creating
the portmaps respectively</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mininet</span><span class="o">&gt;</span> <span class="n">h1</span> <span class="n">ping</span> <span class="n">h2</span>
<span class="n">PING</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span> <span class="p">(</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">)</span> <span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">data</span><span class="o">.</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">1</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">36.4</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">2</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.880</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">3</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.073</span> <span class="n">ms</span>
<span class="mi">64</span> <span class="nb">bytes</span> <span class="kn">from</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span><span class="p">:</span> <span class="n">icmp_req</span><span class="o">=</span><span class="mi">4</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">64</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.081</span> <span class="n">ms</span>
</pre></div>
</div>
<ul class="simple">
<li>Get the VTN Dataflows information</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">--</span><span class="n">user</span> <span class="s1">&#39;admin:adminpass&#39;</span> <span class="s2">&quot;http://127.0.0.1:8083/vtn-webapi/dataflows?&amp;switch_id=00:00:00:00:00:00:00:01&amp;port_name=s1-eth1&amp;controller_id=odc&amp;srcmacaddr=de3d.7dec.e4d2&amp;no_vlan_id=true&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a Flowcondition in the VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;name&quot;: &quot;flowcond_1&quot;,&quot;match&quot;: [{&quot;index&quot;: 1,&quot;ethernet&quot;: {&quot;src&quot;: &quot;ca:9e:58:0c:1e:f0&quot;,&quot;dst&quot;: &quot;ba:bd:0f:e3:a8:c8&quot;,&quot;type&quot;: 2048},&quot;inetMatch&quot;: {&quot;inet4&quot;: {&quot;src&quot;: &quot;10.0.0.1&quot;,&quot;dst&quot;: &quot;10.0.0.2&quot;,&quot;protocol&quot;: 1}}}]}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.100</span><span class="o">.</span><span class="mf">9.42</span><span class="p">:</span><span class="mi">8282</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="n">nb</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">flowconditions</span><span class="o">/</span><span class="n">flowcond_1</span>
</pre></div>
</div>
<ul class="simple">
<li>Create a Pathmap in the VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;index&quot;: 10, &quot;condition&quot;:&quot;flowcond_1&quot;, &quot;policy&quot;:1, &quot;idleTimeout&quot;: 300, &quot;hardTimeout&quot;: 0}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.100</span><span class="o">.</span><span class="mf">9.42</span><span class="p">:</span><span class="mi">8282</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="n">nb</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">pathmaps</span><span class="o">/</span><span class="mi">1</span>
</pre></div>
</div>
<ul class="simple">
<li>Get the Path policy information</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">user</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;content-type: application/json&#39;</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;id&quot;: 1,&quot;default&quot;: 100000,&quot;cost&quot;: [{&quot;location&quot;: {&quot;node&quot;: {&quot;type&quot;: &quot;OF&quot;,&quot;id&quot;: &quot;00:00:00:00:00:00:00:01&quot;},&quot;port&quot;: {&quot;type&quot;: &quot;OF&quot;,&quot;id&quot;: &quot;3&quot;,&quot;name&quot;: &quot;s1-eth3&quot;}},&quot;cost&quot;: 1000},{&quot;location&quot;: {&quot;node&quot;: {&quot;type&quot;: &quot;OF&quot;,&quot;id&quot;: &quot;00:00:00:00:00:00:00:04&quot;},&quot;port&quot;: {&quot;type&quot;: &quot;OF&quot;,&quot;id&quot;: &quot;2&quot;,&quot;name&quot;: &quot;s4-eth2&quot;}},&quot;cost&quot;: 1000},{&quot;location&quot;: {&quot;node&quot;: {&quot;type&quot;: &quot;OF&quot;, &quot;id&quot;: &quot;00:00:00:00:00:00:00:03&quot;},&quot;port&quot;: {&quot;type&quot;: &quot;OF&quot;,&quot;id&quot;: &quot;3&quot;,&quot;name&quot;: &quot;s3-eth3&quot;}},&quot;cost&quot;: 100000}]}&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.100</span><span class="o">.</span><span class="mf">9.42</span><span class="p">:</span><span class="mi">8282</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="n">nb</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">default</span><span class="o">/</span><span class="n">pathpolicies</span><span class="o">/</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="id156">
<h5>Verification<a class="headerlink" href="#id156" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Before applying Path policy information in the VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
        <span class="s2">&quot;pathinfos&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth2&quot;</span><span class="p">,</span>
              <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:01&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s2-eth1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s2-eth2&quot;</span><span class="p">,</span>
              <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:02&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
               <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth1&quot;</span><span class="p">,</span>
               <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth3&quot;</span><span class="p">,</span>
               <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:03&quot;</span>
            <span class="p">}</span>
                     <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>After applying Path policy information in the VTN</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;pathinfos&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s1-eth3&quot;</span><span class="p">,</span>
              <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:01&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s4-eth1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s4-eth2&quot;</span><span class="p">,</span>
              <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:04&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
               <span class="s2">&quot;in_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth2&quot;</span><span class="p">,</span>
               <span class="s2">&quot;out_port_name&quot;</span><span class="p">:</span> <span class="s2">&quot;s3-eth3&quot;</span><span class="p">,</span>
               <span class="s2">&quot;switch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00:00:00:00:00:00:03&quot;</span>
            <span class="p">}</span>
                     <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="vtn-coordinator-troubleshooting-howto">
<h4>VTN Coordinator(Troubleshooting HowTo)<a class="headerlink" href="#vtn-coordinator-troubleshooting-howto" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id157">
<h5>Overview<a class="headerlink" href="#id157" title="Permalink to this headline">¶</a></h5>
<p>This page demonstrates Installation troubleshooting steps of VTN
Coordinator. OpenDaylight VTN provides multi-tenant virtual network
functions on OpenDaylight controllers. OpenDaylight VTN consists of two
parts:</p>
<ul class="simple">
<li>VTN Coordinator.</li>
<li>VTN Manager.</li>
</ul>
<p>VTN Coordinator orchestrates multiple VTN Managers running in
OpenDaylight Controllers, and provides VTN Applications with VTN API.
VTN Manager is OSGi bundles running in OpenDaylight Controller. Current
VTN Manager supports only OpenFlow switches. It handles PACKET_IN
messages, sends PACKET_OUT messages, manages host information, and
installs flow entries into OpenFlow switches to provide VTN Coordinator
with virtual network functions. The requirements for installing these
two are different.Therefore, we recommend that you install VTN Manager
and VTN Coordinator in different machines.</p>
</div>
<div class="section" id="list-of-installation-troubleshooting-how-tos">
<h5>List of installation Troubleshooting How to’s<a class="headerlink" href="#list-of-installation-troubleshooting-how-tos" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_(VTN):Installation:VTN_Coordinator">https://wiki.opendaylight.org/view/OpenDaylight_Virtual_Tenant_Network_(VTN):Installation:VTN_Coordinator</a></li>
</ul>
<p><strong>After executing db_setup, you have encountered the error &#8220;Failed to
setup database&#8221;?</strong></p>
<p>The error could be due to the below reasons * Access Restriction</p>
<p>The user who owns /usr/local/vtn/ directory and installs VTN
Coordinator, can only start db_setup. Example :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">directory</span> <span class="n">should</span> <span class="n">appear</span> <span class="k">as</span> <span class="n">below</span> <span class="p">(</span><span class="n">assuming</span> <span class="n">the</span> <span class="n">user</span> <span class="k">as</span> <span class="s2">&quot;vtn&quot;</span><span class="p">):</span>
<span class="c1"># ls -l /usr/local/</span>
  <span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span> <span class="mi">12</span> <span class="n">vtn</span>  <span class="n">vtn</span>  <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">14</span> <span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="n">vtn</span>
<span class="n">If</span> <span class="n">the</span> <span class="n">user</span> <span class="n">doesnot</span> <span class="n">own</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span> <span class="n">then</span><span class="p">,</span> <span class="n">please</span> <span class="n">run</span> <span class="n">the</span> <span class="n">below</span> <span class="n">command</span> <span class="p">(</span><span class="n">assuming</span> <span class="n">the</span> <span class="n">username</span> <span class="k">as</span> <span class="n">vtn</span><span class="p">),</span>
            <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">vtn</span><span class="p">:</span><span class="n">vtn</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span>
</pre></div>
</div>
<ul class="simple">
<li>Postgres not Present</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">In</span> <span class="n">case</span> <span class="n">of</span> <span class="n">Fedora</span><span class="o">/</span><span class="n">CentOS</span><span class="o">/</span><span class="n">RHEL</span><span class="p">,</span> <span class="n">please</span> <span class="n">check</span> <span class="k">if</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">pgsql</span><span class="o">/&lt;</span><span class="n">version</span><span class="o">&gt;</span> <span class="n">directory</span> <span class="ow">is</span> <span class="n">present</span> <span class="ow">and</span> <span class="n">also</span> <span class="n">ensure</span> <span class="n">the</span> <span class="n">commands</span> <span class="n">initdb</span><span class="p">,</span> <span class="n">createdb</span><span class="p">,</span><span class="n">pg_ctl</span><span class="p">,</span><span class="n">psql</span> <span class="n">are</span> <span class="n">working</span><span class="o">.</span> <span class="n">If</span><span class="p">,</span> <span class="ow">not</span> <span class="n">please</span> <span class="n">re</span><span class="o">-</span><span class="n">install</span> <span class="n">postgres</span> <span class="n">packages</span>
<span class="mf">2.</span> <span class="n">In</span> <span class="n">case</span> <span class="n">of</span> <span class="n">Ubuntu</span><span class="p">,</span> <span class="n">check</span> <span class="k">if</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgres</span><span class="o">/&lt;</span><span class="n">version</span><span class="o">&gt;</span> <span class="n">directory</span> <span class="ow">is</span> <span class="n">present</span> <span class="ow">and</span> <span class="n">check</span> <span class="k">for</span> <span class="n">the</span> <span class="n">commands</span> <span class="k">as</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">previous</span> <span class="n">step</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li>Not enough space to create tables</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Please</span> <span class="n">check</span> <span class="n">df</span> <span class="o">-</span><span class="n">k</span> <span class="ow">and</span> <span class="n">ensure</span> <span class="n">enough</span> <span class="n">free</span> <span class="n">space</span> <span class="ow">is</span> <span class="n">available</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li>If the above steps do not solve the problem, please refer to the log
file for the exact problem</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">dbm</span><span class="o">/</span><span class="n">unc_setup_db</span><span class="o">.</span><span class="n">log</span> <span class="k">for</span> <span class="n">the</span> <span class="n">exact</span> <span class="n">error</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li>list of VTN Coordinator processes</li>
<li>Run the below command ensure the Coordinator daemons are running.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">Command</span><span class="p">:</span>     <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">unc_dmctl</span> <span class="n">status</span>
   <span class="n">Name</span>              <span class="n">Type</span>           <span class="n">IPC</span> <span class="n">Channel</span>       <span class="n">PID</span>
<span class="o">-----------</span>       <span class="o">-----------</span>      <span class="o">--------------</span>     <span class="o">------</span>
    <span class="n">drvodcd</span>         <span class="n">DRIVER</span>           <span class="n">drvodcd</span>           <span class="mi">15972</span>
    <span class="n">lgcnwd</span>         <span class="n">LOGICAL</span>           <span class="n">lgcnwd</span>            <span class="mi">16010</span>
    <span class="n">phynwd</span>         <span class="n">PHYSICAL</span>          <span class="n">phynwd</span>            <span class="mi">15996</span>
</pre></div>
</div>
<ul class="simple">
<li>Issue the curl command to fetch version and ensure the process is
able to respond.</li>
</ul>
<p><strong>How to debug a startup failure?.</strong></p>
<p>The following activities take place in order during startup</p>
<ul class="simple">
<li>Database server is started after setting virtual memory to required
value,Any database startup errors will be reflected in any of the
below logs.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">dbm</span><span class="o">/</span><span class="n">unc_db_script</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">db</span><span class="o">/</span><span class="n">pg_log</span><span class="o">/</span><span class="n">postgresql</span><span class="o">-*.</span><span class="n">log</span> <span class="p">(</span><span class="n">the</span> <span class="n">pattern</span> <span class="n">will</span> <span class="n">have</span> <span class="n">the</span> <span class="n">date</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>uncd daemon is kicked off, The daemon in turn kicks off the rest of
the daemons.</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Any</span>  <span class="n">uncd</span> <span class="n">startup</span> <span class="n">failures</span> <span class="n">will</span> <span class="n">be</span> <span class="n">reflected</span> <span class="ow">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">uncd</span><span class="o">/</span><span class="n">uncd_start</span><span class="o">.</span><span class="n">err</span><span class="o">.</span>
</pre></div>
</div>
<div class="section" id="after-setting-up-the-apache-tomcat-server-what-are-the-aspects-that-should-be-checked">
<h6>After setting up the apache tomcat server, what are the aspects that should be checked.<a class="headerlink" href="#after-setting-up-the-apache-tomcat-server-what-are-the-aspects-that-should-be-checked" title="Permalink to this headline">¶</a></h6>
<p><strong>Please check if catalina is running..</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">command</span> <span class="n">ps</span> <span class="o">-</span><span class="n">ef</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">catalina</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">v</span> <span class="n">grep</span> <span class="n">should</span> <span class="nb">list</span> <span class="n">a</span> <span class="n">catalina</span> <span class="n">process</span>
</pre></div>
</div>
<p><strong>If you encounter an erroneous situation where the REST API is always
failing..</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Please</span> <span class="n">ensure</span> <span class="n">the</span> <span class="n">firewall</span> <span class="n">settings</span> <span class="k">for</span> <span class="n">port</span><span class="p">:</span><span class="mi">8282</span><span class="p">(</span><span class="n">Lithium</span> <span class="n">release</span><span class="p">)</span> <span class="ow">or</span> <span class="n">port</span><span class="p">:</span><span class="mi">8083</span><span class="p">(</span><span class="n">Post</span> <span class="n">Lithium</span> <span class="n">release</span><span class="p">)</span> <span class="ow">and</span> <span class="n">enable</span> <span class="n">the</span> <span class="n">same</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>How to debug a REST API returning a failure message?.</strong></p>
<p>Please check the /usr/share/java/apache-tomcat-7.0.39/logs/core/core.log
for failure details.</p>
<p><strong>REST API for VTN configuration fails, how to debug?.</strong></p>
<p>The default log level for all daemons is &#8220;INFO&#8221;, to debug the situation
TRACE or DEBUG logs may be needed. To increase the log level for
individual daemons, please use the commands suggested below</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">lgcnw_control</span> <span class="n">loglevel</span> <span class="n">trace</span> <span class="o">--</span> <span class="n">upll</span> <span class="n">daemon</span> <span class="n">log</span>
 <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">phynw_control</span> <span class="n">loglevel</span> <span class="n">trace</span> <span class="o">--</span> <span class="n">uppl</span> <span class="n">daemon</span> <span class="n">log</span>
 <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">unc_control</span> <span class="n">loglevel</span> <span class="n">trace</span> <span class="o">--</span> <span class="n">uncd</span> <span class="n">daemon</span> <span class="n">log</span>
 <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">drvodc_control</span> <span class="n">loglevel</span> <span class="n">trace</span> <span class="o">--</span> <span class="n">Driver</span> <span class="n">daemon</span> <span class="n">log</span>
</pre></div>
</div>
<p>After setting the log levels, the operation can be repeated and the log
files can be referred for debugging.</p>
<p><strong>Problems while Installing PostgreSQL due to openssl.</strong></p>
<p>Errors may occur when trying to install postgreSQL rpms. Recently
PostgreSQL has upgraded all their binaries to use the latest openssl
versions with fix for <a class="reference external" href="http://en.wikipedia.org/wiki/Heartbleed">http://en.wikipedia.org/wiki/Heartbleed</a> Please
upgrade the openssl package to the latest version and re-install. For
RHEL 6.1/6.4 : If you have subscription, Please use the same and update
the rpms. The details are available in the following link
<a class="reference external" href="https://access.redhat.com/site/solutions/781793">https://access.redhat.com/site/solutions/781793</a> ACCESS-REDHAT</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rpm</span> <span class="o">-</span><span class="n">Uvh</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">centos</span><span class="o">/</span><span class="mi">6</span><span class="o">/</span><span class="n">os</span><span class="o">/</span><span class="n">x86_64</span><span class="o">/</span><span class="n">Packages</span><span class="o">/</span><span class="n">openssl</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mf">15.</span><span class="n">el6</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
<span class="n">rpm</span> <span class="o">-</span><span class="n">ivh</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">centos</span><span class="o">/</span><span class="mi">6</span><span class="o">/</span><span class="n">os</span><span class="o">/</span><span class="n">x86_64</span><span class="o">/</span><span class="n">Packages</span><span class="o">/</span><span class="n">openssl</span><span class="o">-</span><span class="n">devel</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mf">15.</span><span class="n">el6</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span>
</pre></div>
</div>
<p>For other linux platforms, Please do yum update, the public respositroes
will have the latest openssl, please install the same.</p>
</div>
</div>
</div>
<div class="section" id="support-for-microsoft-scvmm-2012-r2-with-odl-vtn">
<h4>Support for Microsoft SCVMM 2012 R2 with ODL VTN<a class="headerlink" href="#support-for-microsoft-scvmm-2012-r2-with-odl-vtn" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id158">
<h5>Introduction<a class="headerlink" href="#id158" title="Permalink to this headline">¶</a></h5>
<p>System Center Virtual Machine Manager (SCVMM) is Microsoft’s virtual
machine support center for window’s based emulations. SCVMM is a
management solution for the virtualized data center. You can use it to
configure and manage your virtualization host, networking, and storage
resources in order to create and deploy virtual machines and services to
private clouds that you have created.</p>
<p>The VSEM Provider is a plug-in to bridge between SCVMM and OpenDaylight.</p>
<p>Microsoft Hyper-V is a server virtualization developed by Microsoft,
which provides virtualization services through hypervisor-based
emulations.</p>
<div class="figure" id="id259">
<img alt="Set-Up Diagram" src="../_images/setup_diagram_SCVMM.png" />
<p class="caption"><span class="caption-text">Set-Up Diagram</span></p>
</div>
<p><strong>The topology used in this set-up is:</strong></p>
<ul class="simple">
<li>A SCVMM with VSEM Provider installed and a running VTN Coordinator
and OpenDaylight with VTN Feature installed.</li>
<li>PF1000 virtual switch extension has been installed in the two Hyper-V
servers as it implements the OpenFlow capability in Hyper-V.</li>
<li>Three OpenFlow switches simulated using mininet and connected to
Hyper-V.</li>
<li>Four VM’s hosted using SCVMM.</li>
</ul>
<p><strong>It is implemented as two major components:</strong></p>
<ul class="simple">
<li>SCVMM</li>
<li>OpenDaylight (VTN Feature)<ul>
<li>VTN Coordinator</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id159">
<h5>VTN Coordinator<a class="headerlink" href="#id159" title="Permalink to this headline">¶</a></h5>
<p>OpenDaylight VTN as Network Service provider for SCVMM where VSEM
provider is added in the Network Service which will handle all requests
from SCVMM and communicate with the VTN Coordinator. It is used to
manage the network virtualization provided by OpenDaylight.</p>
<div class="section" id="installing-https-in-vtn-coordinator">
<h6>Installing HTTPS in VTN Coordinator<a class="headerlink" href="#installing-https-in-vtn-coordinator" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>System Center Virtual Machine Manager (SCVMM) supports only https
protocol.</li>
</ul>
<p><strong>Apache Portable Runtime (APR) Installation Steps</strong></p>
<ul>
<li><p class="first">Enter the command &#8220;yum install <strong>apr</strong>&#8221; in VTN Coordinator installed
machine.</p>
</li>
<li><p class="first">In /usr/bin, create a soft link as &#8220;ln –s /usr/bin/apr-1-config
/usr/bin/apr-config&#8221;.</p>
</li>
<li><p class="first">Extract tomcat under &#8220;/usr/share/java&#8221; by using the below command
&#8220;tar -xvf apache-tomcat-7.0.56.tar.gz –C /usr/share/java&#8221;.</p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>Please go through the bleow link to download
apache-tomcat-7.0.56.tar.gz file,
<a class="reference external" href="https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.56/bin/">https://archive.apache.org/dist/tomcat/tomcat-7/v7.0.56/bin/</a></p>
</div></blockquote>
</li>
<li><p class="first">Please go to the directory &#8220;cd
/usr/share/java/apache-tomcat-7.0.56/bin and unzip tomcat-native.gz
using this command &#8220;tar -xvf tomcat-native.gz&#8221;.</p>
</li>
<li><p class="first">Go to the directory &#8220;cd
/usr/share/java/apache-tomcat-7.0.56/bin/tomcat-native-1.1.27-src/jni/native&#8221;.</p>
</li>
<li><p class="first">Enter the command &#8221;./configure &#8211;with-apr=/usr/bin/apr-config&#8221;.</p>
</li>
<li><p class="first">Enter the command &#8220;make&#8221; and &#8220;make install&#8221;.</p>
</li>
<li><p class="first">Apr libraries are successfully installed in &#8220;/usr/local/apr/lib&#8221;.</p>
</li>
</ul>
<p><strong>Enable HTTP/HTTPS in VTN Coordinator</strong></p>
<p>Enter the command &#8220;system-config-firewall-tui&#8221; to enable firewall
settings in server.</p>
<p><strong>Create a CA’s private key and a self-signed certificate in server</strong></p>
<ul class="simple">
<li>Execute the following command &#8220;openssl req -x509 -days 365
-extensions v3_ca -newkey rsa:2048 –out /etc/pki/CA/cacert.pem
–keyout /etc/pki/CA/private/cakey.pem&#8221; in a single line.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Country Name</td>
<td><div class="first last line-block">
<div class="line">Specify the country code.</div>
<div class="line">For example, JP</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>State or Province
Name</td>
<td><div class="first last line-block">
<div class="line">Specify the state or province.</div>
<div class="line">For example, Tokyo</div>
</div>
</td>
</tr>
<tr class="row-even"><td>Locality Name</td>
<td><div class="first last line-block">
<div class="line">Locality Name</div>
<div class="line">For example, Chuo-Ku</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>Organization Name</td>
<td>Specify the company.</td>
</tr>
<tr class="row-even"><td>Organizational Unit
Name</td>
<td>Specify the department, division, or the like.</td>
</tr>
<tr class="row-odd"><td>Common Name</td>
<td>Specify the host name.</td>
</tr>
<tr class="row-even"><td>Email Address</td>
<td>Specify the e-mail address.</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Execute the following commands: &#8220;touch /etc/pki/CA/index.txt&#8221; and
&#8220;echo 00 &gt; /etc/pki/CA/serial&#8221; in server after setting your CA’s
private key.</li>
</ul>
<p><strong>Create a private key and a CSR for web server</strong></p>
<ul class="simple">
<li>Execute the following command &#8220;openssl req -new -newkey rsa:2048 -out
csr.pem –keyout /usr/local/vtn/tomcat/conf/key.pem&#8221; in a single line.</li>
<li>Enter the PEM pass phrase: Same password you have given in CA’s
private key PEM pass phrase.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Country Name</td>
<td><div class="first last line-block">
<div class="line">Specify the country code.</div>
<div class="line">For example, JP</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>State or Province
Name</td>
<td><div class="first last line-block">
<div class="line">Specify the state or province.</div>
<div class="line">For example, Tokyo</div>
</div>
</td>
</tr>
<tr class="row-even"><td>Locality Name</td>
<td><div class="first last line-block">
<div class="line">Locality Name</div>
<div class="line">For example, Chuo-Ku</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>Organization Name</td>
<td>Specify the company.</td>
</tr>
<tr class="row-even"><td>Organizational Unit
Name</td>
<td>Specify the department, division, or the like.</td>
</tr>
<tr class="row-odd"><td>Common Name</td>
<td>Specify the host name.</td>
</tr>
<tr class="row-even"><td>Email Address</td>
<td>Specify the e-mail address.</td>
</tr>
<tr class="row-odd"><td>A challenge password</td>
<td>Specify the challenge password.</td>
</tr>
<tr class="row-even"><td>An optional company
name</td>
<td>Specify an optional company name.</td>
</tr>
</tbody>
</table>
<p><strong>Create a certificate for web server</strong></p>
<ul class="simple">
<li>Execute the following command &#8220;openssl ca –in csr.pem –out
/usr/local/vtn/tomcat/conf/cert.pem –days 365 –batch&#8221; in a single
line.</li>
<li>Enter pass phrase for /etc/pki/CA/private/cakey.pem: Same password
you have given in CA’s private key PEM pass phrase.</li>
<li>Open the tomcat file using &#8220;vim /usr/local/vtn/tomcat/bin/tomcat&#8221;.</li>
<li>Include the line &#8221; TOMCAT_PROPS=&#8221;$TOMCAT_PROPS
-Djava.library.path=\&#8221;/usr/local/apr/lib\&#8221;&#8221; &#8221; in 131th line and
save the file.</li>
</ul>
<p><strong>Edit server.xml file and restart the server</strong></p>
<ul>
<li><p class="first">Open the server.xml file using &#8220;vim
/usr/local/vtn/tomcat/conf/server.xml&#8221; and add the below lines.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Connector</span> <span class="n">port</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vtn.port}</span><span class="s2">&quot;</span> <span class="n">protocol</span><span class="o">=</span><span class="s2">&quot;HTTP/1.1&quot;</span> <span class="n">SSLEnabled</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<span class="n">maxThreads</span><span class="o">=</span><span class="s2">&quot;150&quot;</span> <span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;https&quot;</span> <span class="n">secure</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
<span class="n">SSLCertificateFile</span><span class="o">=</span><span class="s2">&quot;/usr/local/vtn/tomcat/conf/cert.pem&quot;</span>
<span class="n">SSLCertificateKeyFile</span><span class="o">=</span><span class="s2">&quot;/usr/local/vtn/tomcat/conf/key.pem&quot;</span>
<span class="n">SSLPassword</span><span class="o">=</span><span class="n">same</span> <span class="n">password</span> <span class="n">you</span> <span class="n">have</span> <span class="n">given</span> <span class="ow">in</span> <span class="n">CA</span><span class="s1">&#39;s private key PEM pass phrase</span>
<span class="n">connectionTimeout</span><span class="o">=</span><span class="s2">&quot;20000&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Save the file and restart the server.</p>
</li>
<li><p class="first">To stop vtn use the following command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vtn_stop</span>
</pre></div>
</div>
</li>
<li><p class="first">To start vtn use the following command.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">vtn</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">vtn_start</span>
</pre></div>
</div>
</li>
<li><p class="first">Copy the created CA certificate from cacert.pem to cacert.crt by
using the following command,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>openssl x509 –in /etc/pki/CA/cacert.pem –out cacert.crt
</pre></div>
</div>
<p><strong>Checking the HTTP and HTTPS connection from client</strong></p>
</li>
<li><p class="first">You can check the HTTP connection by using the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;contenttype:application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username:admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password:adminpass&#39;</span> <span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">server</span> <span class="n">IP</span> <span class="n">address</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">api_version</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</li>
<li><p class="first">You can check the HTTPS connection by using the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;contenttype:application/json&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;username:admin&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="s1">&#39;password:adminpass&#39;</span> <span class="n">https</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">server</span> <span class="n">IP</span> <span class="n">address</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">8083</span><span class="o">/</span><span class="n">vtn</span><span class="o">-</span><span class="n">webapi</span><span class="o">/</span><span class="n">api_version</span><span class="o">.</span><span class="n">json</span> <span class="o">--</span><span class="n">cacert</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">CA</span><span class="o">/</span><span class="n">cacert</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
</li>
<li><p class="first">The response should be like this for both HTTP and HTTPS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;api_version&quot;</span><span class="p">:{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="s2">&quot;V1.2&quot;</span><span class="p">}}</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="prerequisites-to-create-network-service-in-scvmm-machine-please-follow-the-below-steps">
<h5>Prerequisites to create Network Service in SCVMM machine, Please follow the below steps<a class="headerlink" href="#prerequisites-to-create-network-service-in-scvmm-machine-please-follow-the-below-steps" title="Permalink to this headline">¶</a></h5>
<ol class="arabic simple">
<li>Please go through the below link to download VSEM Provider zip file,
<a class="reference external" href="https://nexus.opendaylight.org/content/groups/public/org/opendaylight/vtn/application/vtnmanager-vsemprovider/1.0.0-Lithium/vtnmanager-vsemprovider-1.0.0-Lithium-bin.zip">https://nexus.opendaylight.org/content/groups/public/org/opendaylight/vtn/application/vtnmanager-vsemprovider/1.0.0-Lithium/vtnmanager-vsemprovider-1.0.0-Lithium-bin.zip</a></li>
<li>Unzip the vtnmanager-vsemprovider-1.0.0-Lithium-bin.zip file
anywhere in your SCVMM machine.</li>
<li>Stop SCVMM service from <strong>&#8220;service manager→tools→servers→select
system center virtual machine manager&#8221;</strong> and click stop.</li>
<li>Go to <strong>&#8220;C:/Program Files&#8221;</strong> in your SCVMM machine. Inside
<strong>&#8220;C:/Program Files&#8221;</strong>, create a folder named as *&#8221;ODLProvider&#8221;.</li>
<li>Inside <strong>&#8220;C:/Program Files/ODLProvider&#8221;</strong>, create a folder named as
&#8220;Module&#8221; in your SCVMM machine.</li>
<li>Inside &#8220;C:/Program Files/ODLProvider/Module&#8221;, Create two folders
named as <strong>&#8220;Odl.VSEMProvider&#8221;</strong> and <strong>&#8220;VSEMOdlUI&#8221;</strong> in your SCVMM
machine.</li>
<li>Copy the <strong>&#8220;VSEMOdl.dll&#8221;</strong> file from
<strong>&#8220;ODL_SCVMM_PROVIDER/ODL_VSEM_PROVIDER&#8221;</strong> to <strong>&#8220;C:/Program
Files/ODLProvider/Module/Odl.VSEMProvider&#8221;</strong> in your SCVMM machine.</li>
<li>Copy the <strong>&#8220;VSEMOdlProvider.psd1&#8221;</strong> file from
<strong>&#8220;application/vsemprovider/VSEMOdlProvider/VSEMOdlProvider.psd1&#8221;</strong>
to <strong>&#8220;C:/Program Files/ODLProvider/Module/Odl.VSEMProvider&#8221;</strong> in
your SCVMM machine.</li>
<li>Copy the <strong>&#8220;VSEMOdlUI.dll&#8221;</strong> file from
<strong>&#8220;ODL_SCVMM_PROVIDER/ODL_VSEM_PROVIDER_UI&#8221;</strong> to <strong>&#8220;C:/Program
Files/ODLProvider/Module/VSEMOdlUI&#8221;</strong> in your SCVMM machine.</li>
<li>Copy the <strong>&#8220;VSEMOdlUI.psd1&#8221;</strong> file from
<strong>&#8220;application/vsemprovider/VSEMOdlUI&#8221;</strong> to <strong>&#8220;C:/Program
Files/ODLProvider/Module/VSEMOdlUI&#8221;</strong> in your SCVMM machine.</li>
<li>Copy the <strong>&#8220;reg_entry.reg&#8221;</strong> file from
<strong>&#8220;ODL_SCVMM_PROVIDER/Register_settings&#8221;</strong> to your SCVMM desktop
and double click the <strong>&#8220;reg_entry.reg&#8221;</strong> file to install registry
entry in your SCVMM machine.</li>
<li>Download <strong>&#8220;PF1000.msi&#8221;</strong> from this link,
<a class="reference external" href="https://www.pf-info.com/License/en/index.php?url=index/index_non_buyer">https://www.pf-info.com/License/en/index.php?url=index/index_non_buyer</a>
and place into <strong>&#8220;C:/Program Files/Switch Extension Drivers&#8221;</strong> in
your SCVMM machine.</li>
<li>Start SCVMM service from <strong>&#8220;service manager→tools→servers→select
system center virtual machine manager&#8221;</strong> and click start.</li>
</ol>
</div>
<div class="section" id="system-center-virtual-machine-manager-scvmm">
<h5>System Center Virtual Machine Manager (SCVMM)<a class="headerlink" href="#system-center-virtual-machine-manager-scvmm" title="Permalink to this headline">¶</a></h5>
<p>It supports two major features:</p>
<ul class="simple">
<li>Failover Clustering</li>
<li>Live Migration</li>
</ul>
<div class="section" id="failover-clustering">
<h6>Failover Clustering<a class="headerlink" href="#failover-clustering" title="Permalink to this headline">¶</a></h6>
<p>A single Hyper-V can host a number of virtual machines. If the host were
to fail then all of the virtual machines that are running on it will
also fail, thereby resulting in a major outage. Failover clustering
treats individual virtual machines as clustered resources. If a host
were to fail then clustered virtual machines are able to fail over to a
different Hyper-V server where they can continue to run.</p>
</div>
<div class="section" id="live-migration">
<h6>Live Migration<a class="headerlink" href="#live-migration" title="Permalink to this headline">¶</a></h6>
<p>Live Migration is used to migrate the running virtual machines from one
Hyper-V server to another Hyper-V server without any interruptions.
Please go through the below video for more details,</p>
<ul class="simple">
<li><a class="reference external" href="https://youtu.be/34YMOTzbNJM">https://youtu.be/34YMOTzbNJM</a></li>
</ul>
</div>
</div>
<div class="section" id="scvmm-user-guide">
<h5>SCVMM User Guide<a class="headerlink" href="#scvmm-user-guide" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>Please go through the below link for SCVMM user guide:
<a class="reference external" href="https://wiki.opendaylight.org/images/c/ca/ODL_SCVMM_USER_GUIDE_final.pdf">https://wiki.opendaylight.org/images/c/ca/ODL_SCVMM_USER_GUIDE_final.pdf</a></li>
<li>Please go through the below links for more details<ul>
<li>OpenDaylight SCVMM VTN Integration: <a class="reference external" href="https://youtu.be/iRt4dxtiz94">https://youtu.be/iRt4dxtiz94</a></li>
<li>OpenDaylight Congestion Control with SCVMM VTN:
<a class="reference external" href="https://youtu.be/34YMOTzbNJM">https://youtu.be/34YMOTzbNJM</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="netconf-user-guide">
<h2>NETCONF User Guide<a class="headerlink" href="#netconf-user-guide" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id160">
<h3>Overview<a class="headerlink" href="#id160" title="Permalink to this headline">¶</a></h3>
<p>NETCONF is an XML based protocol used for configuration and monitoring
of devices in the network. The base NETCONF protocol is described in
<a class="reference external" href="http://tools.ietf.org/html/rfc6241">RFC-6241</a>.</p>
<p><strong>NETCONF in OpenDaylight:.</strong></p>
<p>OpenDaylight controller supports NETCONF protocol as a northbound server
as well as a southbound plugin.</p>
</div>
<div class="section" id="southbound-netconf-connector">
<h3>Southbound (netconf-connector)<a class="headerlink" href="#southbound-netconf-connector" title="Permalink to this headline">¶</a></h3>
<p>NETCONF southbound plugin is capable of connecting to remote NETCONF
devices and expose their configuration/operational datastores, rpcs and
notifications as MD-SAL mount points. These mount points allow
applications and remote users (over RESTCONF) to interact with the
mounted devices.</p>
<p>In terms of RFCs, the connector supports:</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6241">RFC-6241</a>,</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc5277">RFC-5277</a>,</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc6022">RFC-6022</a>,</li>
</ul>
<p><strong>Netconf-connector is fully model driven (utilising YANG modeling
language) so in addition to the above RFCs, it supports any
data/RPC/notifications described by a YANG model that is implemented by
the device.</strong></p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>NETCONF southbound can be activated by installing
<code class="docutils literal"><span class="pre">odl-netconf-connector-all</span></code> Karaf feature.</p>
</div></blockquote>
<div class="section" id="netconf-connector-configuration">
<h4>Netconf-connector configuration<a class="headerlink" href="#netconf-connector-configuration" title="Permalink to this headline">¶</a></h4>
<p>There are 2 ways for configuring netconf-connector (as is for any other
module) NETCONF or RESTCONF. This guide focuses on using RESTCONF.</p>
<div class="section" id="default-configuration">
<h5>Default configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">¶</a></h5>
<p>The default configuration contains all the necessary dependencies (file:
01-netconf.xml) and a single instance of netconf-connector (file:
99-netconf-connector.xml) called <strong>controller-config</strong> which connects
itself to the NETCONF northbound in OpenDaylight in a loopback fashion.
The connector mounts the NETCONF server for config-subsystem in order to
enable RESTCONF protocol for config-subsystem. This RESTCONF still goes
via NETCONF, but using RESTCONF is much more user friendly than using
NETCONF.</p>
</div>
<div class="section" id="spawning-additional-netconf-connectors-while-the-controller-is-running">
<h5>Spawning additional netconf-connectors while the controller is running<a class="headerlink" href="#spawning-additional-netconf-connectors-while-the-controller-is-running" title="Permalink to this headline">¶</a></h5>
<p>Preconditions:</p>
<ol class="arabic simple">
<li>OpenDaylight is running</li>
<li>In Karaf, you must have the netconf-connector installed (at the Karaf
prompt, type: feature:install odl-netconf-connector-all); the
loopback NETCONF mountpoint will be automatically configured and
activated</li>
<li>Wait until log displays following entry:
RemoteDevice{controller-config}: NETCONF connector initialized
successfully</li>
</ol>
<p>To configure a new netconf-connector you need to send following request
to RESTCONF:</p>
<p>POST
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules</a></p>
<p><strong>Headers</strong>: Accept application/xml Content-Type application/xml</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">sal</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">connector</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">new</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">device</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">address</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">&lt;/</span><span class="n">address</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">port</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="mi">830</span><span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">username</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">admin</span><span class="o">&lt;/</span><span class="n">username</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">password</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">admin</span><span class="o">&lt;/</span><span class="n">password</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">tcp</span><span class="o">-</span><span class="n">only</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">false</span><span class="o">&lt;/</span><span class="n">tcp</span><span class="o">-</span><span class="n">only</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:netty&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">netty</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">binding</span><span class="o">-</span><span class="n">registry</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:binding&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">binding</span><span class="o">-</span><span class="n">broker</span><span class="o">-</span><span class="n">osgi</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">binding</span><span class="o">-</span><span class="n">osgi</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">binding</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">dom</span><span class="o">-</span><span class="n">registry</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:dom&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">dom</span><span class="o">-</span><span class="n">broker</span><span class="o">-</span><span class="n">osgi</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dom</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">dom</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">client</span><span class="o">-</span><span class="n">dispatcher</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config:netconf&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">netconf</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">client</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">processing</span><span class="o">-</span><span class="n">executor</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:threadpool&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">threadpool</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">processing</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">processing</span><span class="o">-</span><span class="n">executor</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">keepalive</span><span class="o">-</span><span class="n">executor</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:threadpool&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">scheduled</span><span class="o">-</span><span class="n">threadpool</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">ssh</span><span class="o">-</span><span class="n">scheduled</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">keepalive</span><span class="o">-</span><span class="n">executor</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This spawns a new netconf-connector which tries to connect to (or mount)
a NETCONF device at 127.0.0.1 and port 830. You can check the
configuration of config-subsystem’s configuration datastore. The new
netconf-connector will now be present there. Just invoke:</p>
<p>GET
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules</a></p>
<p>The response will contain the module for new-netconf-device.</p>
<p>Right after the new netconf-connector is created, it writes some useful
metadata into the datastore of MD-SAL under the network-topology
subtree. This metadata can be found at:</p>
<p>GET
<a class="reference external" href="http://localhost:8181/restconf/operational/network-topology:network-topology/">http://localhost:8181/restconf/operational/network-topology:network-topology/</a></p>
<p>Information about connection status, device capabilities etc. can be
found there.</p>
</div>
<div class="section" id="connecting-to-a-device-not-supporting-netconf-monitoring">
<h5>Connecting to a device not supporting NETCONF monitoring<a class="headerlink" href="#connecting-to-a-device-not-supporting-netconf-monitoring" title="Permalink to this headline">¶</a></h5>
<p>The netconf-connector in OpenDaylight relies on ietf-netconf-monitoring
support when connecting to remote NETCONF device. The
ietf-netconf-monitoring support allows netconf-connector to list and
download all YANG schemas that are used by the device. NETCONF connector
can only communicate with a device if it knows the set of used schemas
(or at least a subset). However, some devices use YANG models internally
but do not support NETCONF monitoring. Netconf-connector can also
communicate with these devices, but you have to side load the necessary
yang models into OpenDaylight’s YANG model cache for netconf-connector.
In general there are 2 situations you might encounter:</p>
<p><strong>1. NETCONF device does not support ietf-netconf-monitoring but it does
list all its YANG models as capabilities in HELLO message</strong></p>
<p>This could be a device that internally uses only ietf-inet-types YANG
model with revision 2010-09-24. In the HELLO message that is sent from
this device there is this capability reported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>urn:ietf:params:xml:ns:yang:ietf-inet-types?module=ietf-inet-types&amp;revision=2010-09-24
</pre></div>
</div>
<p><strong>For such devices you only need to put the schema into folder
cache/schema inside your Karaf distribution.</strong></p>
<blockquote>
<div><p><strong>Important</strong></p>
<p>The file with YANG schema for ietf-inet-types has to be called
<a class="reference external" href="mailto:ietf-inet-types&#37;&#52;&#48;2010-09-24&#46;yang">ietf-inet-types<span>&#64;</span>2010-09-24<span>&#46;</span>yang</a>. It is the required naming format of
the cache.</p>
</div></blockquote>
<p><strong>2. NETCONF device does not support ietf-netconf-monitoring and it does
NOT list its YANG models as capabilities in HELLO message</strong></p>
<p>Compared to device that lists its YANG models in HELLO message, in this
case there would be no capability with ietf-inet-types in the HELLO
message. This type of device basically provides no information about the
YANG schemas it uses so its up to the user of OpenDaylight to properly
configure netconf-connector for this device.</p>
<p>Netconf-connector has an optional configuration attribute called
yang-module-capabilities and this attribute can contain a list of &#8220;YANG
module based&#8221; capabilities. So by setting this configuration attribute,
it is possible to override the &#8220;yang-module-based&#8221; capabilities reported
in HELLO message of the device. To do this, we need to modify the
configuration of netconf-connector by adding this xml (It needs to be
added next to the address, port, username etc. configuration elements):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;yang-module-capabilities xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;&gt;
  &lt;capability xmlns=&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;&gt;
    urn:ietf:params:xml:ns:yang:ietf-inet-types?module=ietf-inet-types&amp;amp;revision=2010-09-24
  &lt;/capability&gt;
&lt;/yang-module-capabilities&gt;
</pre></div>
</div>
<p><strong>Remember to also put the YANG schemas into the cache folder.</strong></p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>For putting multiple capabilities, you just need to replicate the
capability xml element inside yang-module-capability element.
Capability element is modeled as a leaf-list. With this
configuration, we would make the remote device report usage of
ietf-inet-types in the eyes of netconf-connector.</p>
</div></blockquote>
</div>
<div class="section" id="reconfiguring-netconf-connector-while-the-controller-is-running">
<h5>Reconfiguring Netconf-Connector While the Controller is Running<a class="headerlink" href="#reconfiguring-netconf-connector-while-the-controller-is-running" title="Permalink to this headline">¶</a></h5>
<p>It is possible to change the configuration of a running module while the
whole controller is running. This example will continue where the last
left off and will change the configuration for the brand new
netconf-connector after it was spawned. Using one RESTCONF request, we
will change both username and password for the netconf-connector.</p>
<p>To update an existing netconf-connector you need to send following
request to RESTCONF:</p>
<p>PUT
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-sal-netconf-connector-cfg:sal-netconf-connector/new-netconf-device">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-sal-netconf-connector-cfg:sal-netconf-connector/new-netconf-device</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">module</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">sal</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">connector</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">new</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">device</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">username</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">bob</span><span class="o">&lt;/</span><span class="n">username</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">password</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">passwd</span><span class="o">&lt;/</span><span class="n">password</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">tcp</span><span class="o">-</span><span class="n">only</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span><span class="n">false</span><span class="o">&lt;/</span><span class="n">tcp</span><span class="o">-</span><span class="n">only</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:netty&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">netty</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">event</span><span class="o">-</span><span class="n">executor</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">binding</span><span class="o">-</span><span class="n">registry</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:binding&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">binding</span><span class="o">-</span><span class="n">broker</span><span class="o">-</span><span class="n">osgi</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">binding</span><span class="o">-</span><span class="n">osgi</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">binding</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">dom</span><span class="o">-</span><span class="n">registry</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:dom&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">dom</span><span class="o">-</span><span class="n">broker</span><span class="o">-</span><span class="n">osgi</span><span class="o">-</span><span class="n">registry</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dom</span><span class="o">-</span><span class="n">broker</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">dom</span><span class="o">-</span><span class="n">registry</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">client</span><span class="o">-</span><span class="n">dispatcher</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:config:netconf&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">netconf</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">client</span><span class="o">-</span><span class="n">dispatcher</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">processing</span><span class="o">-</span><span class="n">executor</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:threadpool&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">threadpool</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">processing</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">processing</span><span class="o">-</span><span class="n">executor</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">keepalive</span><span class="o">-</span><span class="n">executor</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:md:sal:connector:netconf&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;urn:opendaylight:params:xml:ns:yang:controller:threadpool&quot;</span><span class="o">&gt;</span><span class="n">prefix</span><span class="p">:</span><span class="n">scheduled</span><span class="o">-</span><span class="n">threadpool</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="k">global</span><span class="o">-</span><span class="n">netconf</span><span class="o">-</span><span class="n">ssh</span><span class="o">-</span><span class="n">scheduled</span><span class="o">-</span><span class="n">executor</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">keepalive</span><span class="o">-</span><span class="n">executor</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Since a PUT is a replace operation, the whole configuration must be
specified along with the new values for username and password. This
should result in a 2xx response and the instance of netconf-connector
called new-netconf-device will be reconfigured to use username bob and
password passwd. New configuration can be verified by executing:</p>
<p>GET
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-sal-netconf-connector-cfg:sal-netconf-connector/new-netconf-device">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-sal-netconf-connector-cfg:sal-netconf-connector/new-netconf-device</a></p>
<p>With new configuration, the old connection will be closed and a new one
established.</p>
</div>
<div class="section" id="destroying-netconf-connector-while-the-controller-is-running">
<h5>Destroying Netconf-Connector While the Controller is Running<a class="headerlink" href="#destroying-netconf-connector-while-the-controller-is-running" title="Permalink to this headline">¶</a></h5>
<p>Using RESTCONF one can also destroy an instance of a module. In case of
netconf-connector, the module will be destroyed, NETCONF connection
dropped and all resources will be cleaned. To do this, simply issue a
request to following URL:</p>
<p>DELETE
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-sal-netconf-connector-cfg:sal-netconf-connector/new-netconf-device">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/controller-config/yang-ext:mount/config:modules/module/odl-sal-netconf-connector-cfg:sal-netconf-connector/new-netconf-device</a></p>
<p>The last element of the URL is the name of the instance and its
predecessor is the type of that module (In our case the type is
<strong>sal-netconf-connector</strong> and name <strong>new-netconf-device</strong>). The type and
name are actually the keys of the module list.</p>
</div>
</div>
<div class="section" id="netconf-connector-utilisation">
<h4>Netconf-connector utilisation<a class="headerlink" href="#netconf-connector-utilisation" title="Permalink to this headline">¶</a></h4>
<p>Once the connector is up and running, users can utilize the new Mount
point instance. By using RESTCONF or from their application code. This
chapter deals with using RESTCONF and more information for app
developers can be found in the developers guide or in the official
tutorial application <strong>ncmount</strong> that can be found in the coretutorials
project:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/opendaylight/coretutorials/tree/stable/lithium/ncmount">https://github.com/opendaylight/coretutorials/tree/stable/lithium/ncmount</a></li>
</ul>
<div class="section" id="reading-data-from-the-device">
<h5>Reading data from the device<a class="headerlink" href="#reading-data-from-the-device" title="Permalink to this headline">¶</a></h5>
<p>Just invoke (no body needed):</p>
<p>GET
<a class="reference external" href="http://localhost:8080/restconf/operational/network-topology:network-topology/topology/topology-netconf/node/new-netconf-device/yang-ext:mount/">http://localhost:8080/restconf/operational/network-topology:network-topology/topology/topology-netconf/node/new-netconf-device/yang-ext:mount/</a></p>
<p>This will return the entire content of operation datastore from the
device. To view just the configuration datastore, change <strong>operational</strong>
in this URL to <strong>config</strong>.</p>
</div>
<div class="section" id="writing-configuration-data-to-the-device">
<h5>Writing configuration data to the device<a class="headerlink" href="#writing-configuration-data-to-the-device" title="Permalink to this headline">¶</a></h5>
<p>In general, you cannot simply write any data you want to the device. The
data have to conform to the YANG models implemented by the device. In
this example we are adding a new interface-configuration to the mounted
device (assuming the device supports Cisco-IOS-XR-ifmgr-cfg YANG model).
In fact this request comes from the tutorial dedicated to the
<strong>ncmount</strong> tutorial app.</p>
<p>POST
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/new-netconf-device/yang-ext:mount/Cisco-IOS-XR-ifmgr-cfg:interface-configurations">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/new-netconf-device/yang-ext:mount/Cisco-IOS-XR-ifmgr-cfg:interface-configurations</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">interface</span><span class="o">-</span><span class="n">configuration</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;http://cisco.com/ns/yang/Cisco-IOS-XR-ifmgr-cfg&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">active</span><span class="o">&gt;</span><span class="n">act</span><span class="o">&lt;/</span><span class="n">active</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">interface</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="n">mpls</span><span class="o">&lt;/</span><span class="n">interface</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Interface</span> <span class="n">description</span><span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">bandwidth</span><span class="o">&gt;</span><span class="mi">32</span><span class="o">&lt;/</span><span class="n">bandwidth</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">link</span><span class="o">-</span><span class="n">status</span><span class="o">&gt;&lt;/</span><span class="n">link</span><span class="o">-</span><span class="n">status</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">interface</span><span class="o">-</span><span class="n">configuration</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Should return 200 response code with no body.</p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>This call is transformed into a couple of NETCONF RPCs. Resulting
NETCONF RPCs that go directly to the device can be found in the
OpenDaylight logs after invoking <code class="docutils literal"><span class="pre">log:set</span> <span class="pre">TRACE</span>
<span class="pre">org.opendaylight.controller.sal.connect.netconf</span></code> in the Karaf
shell. Seeing the NETCONF RPCs might help with debugging.</p>
</div></blockquote>
<p>This request is very similar to the one where we spawned a new netconf
device. That’s because we used the loopback netconf-connector to write
configuration data into config-subsystem datastore and config-subsystem
picked it up from there.</p>
</div>
<div class="section" id="invoking-custom-rpc">
<h5>Invoking custom RPC<a class="headerlink" href="#invoking-custom-rpc" title="Permalink to this headline">¶</a></h5>
<p>Devices can implement any additional RPC and as long as it provides YANG
models for it, it can be invoked from OpenDaylight. Following example
shows how to invoke the get-schema RPC (get-schema is quite common among
netconf devices). Invoke:</p>
<p>POST
<a class="reference external" href="http://localhost:8181/restconf/operations/network-topology:network-topology/topology/topology-netconf/node/new-netconf-device/yang-ext:mount/ietf-netconf-monitoring:get-schema">http://localhost:8181/restconf/operations/network-topology:network-topology/topology/topology-netconf/node/new-netconf-device/yang-ext:mount/ietf-netconf-monitoring:get-schema</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;urn:ietf:params:xml:ns:yang:ietf-netconf-monitoring&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span><span class="n">ietf</span><span class="o">-</span><span class="n">yang</span><span class="o">-</span><span class="n">types</span><span class="o">&lt;/</span><span class="n">identifier</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mi">2013</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">15</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">input</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This call should fetch the source for ietf-yang-types YANG model from
the mounted device.</p>
</div>
</div>
<div class="section" id="netconf-connector-netopeer">
<h4>Netconf-connector + Netopeer<a class="headerlink" href="#netconf-connector-netopeer" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://github.com/cesnet/netopeer">Netopeer</a> (an open-source
NETCONF server) can be used for testing/exploring NETCONF southbound in
OpenDaylight.</p>
<div class="section" id="netopeer-installation">
<h5>Netopeer installation<a class="headerlink" href="#netopeer-installation" title="Permalink to this headline">¶</a></h5>
<p><a class="reference external" href="https://www.docker.com/">Docker</a> container with netopeer will be
used in this guid. To install docker and start the <a class="reference external" href="https://index.docker.io/u/dockeruser/netopeer/">netopeer
image</a> perform
following steps:</p>
<ol class="arabic">
<li><p class="first">Install docker <a class="reference external" href="http://docs.docker.com/linux/step_one/">http://docs.docker.com/linux/step_one/</a></p>
</li>
<li><p class="first">Start the netopeer image:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">rm</span> <span class="o">-</span><span class="n">t</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1831</span><span class="p">:</span><span class="mi">830</span> <span class="n">dockeruser</span><span class="o">/</span><span class="n">netopeer</span>
</pre></div>
</div>
</li>
<li><p class="first">Verify netopeer is running by invoking (netopeer should send its
HELLO message right away:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">root</span><span class="nd">@localhost</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1831</span> <span class="o">-</span><span class="n">s</span> <span class="n">netconf</span>
<span class="p">(</span><span class="n">password</span> <span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="mounting-netopeer-netconf-server">
<h5>Mounting netopeer NETCONF server<a class="headerlink" href="#mounting-netopeer-netconf-server" title="Permalink to this headline">¶</a></h5>
<p>Preconditions:</p>
<ul class="simple">
<li>OpenDaylight is started with features <code class="docutils literal"><span class="pre">odl-restconf-all</span></code> and
<code class="docutils literal"><span class="pre">odl-netconf-connector-all</span></code>.</li>
<li>Netopeer is up and running in docker</li>
</ul>
<p>Now just follow the chapter: <a class="reference external" href="#_spawning_additional_netconf_connectors_while_the_controller_is_running">Spawning
netconf-connector</a>.
In the payload change the:</p>
<ul class="simple">
<li>name to e.g. netopeer</li>
<li>usernam/password to your system credentials</li>
<li>ip to localhost</li>
<li>port to 1831.</li>
</ul>
<p>After netopeer is mounted successfully, its configuration can be read
using RESTCONF by invoking:</p>
<p>GET
<a class="reference external" href="http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/netopeer/yang-ext:mount/">http://localhost:8181/restconf/config/network-topology:network-topology/topology/topology-netconf/node/netopeer/yang-ext:mount/</a></p>
</div>
</div>
</div>
<div class="section" id="northbound-netconf-servers">
<h3>Northbound (NETCONF servers)<a class="headerlink" href="#northbound-netconf-servers" title="Permalink to this headline">¶</a></h3>
<p>OpenDaylight provides 2 types of NETCONF servers:</p>
<ul>
<li><p class="first"><strong>NETCONF server for config-subsystem(listening by default on port
1830)</strong></p>
<ul class="simple">
<li>Serves as a default interface for config-subsystem and allows
users to spawn/reconfigure/destroy modules(or applications) in
OpenDaylight</li>
</ul>
</li>
<li><p class="first"><strong>NETCONF server for MD-SAL(listening by default on port 2830)</strong></p>
<ul class="simple">
<li>Serves as an alternative interface for MD-SAL (besides RESTCONF)
and allows users to read/write data from MD-SAL’s datastore and to
invoke its rpcs (NETCONF notifications are not available in the
Lithium release of OpenDaylight)</li>
</ul>
<blockquote>
<div><p><strong>Note</strong></p>
<p>The reason for having 2 NETCONF servers is that config-subsystem and
MD-SAL are 2 different components of OpenDaylight and require
different approach for NETCONF message handling and data
translation. These 2 components will probably merge in the future.</p>
</div></blockquote>
</li>
</ul>
<div class="section" id="netconf-server-for-config-subsystem">
<h4>NETCONF server for config-subsystem<a class="headerlink" href="#netconf-server-for-config-subsystem" title="Permalink to this headline">¶</a></h4>
<p>This NETCONF server is the primary interface for config-subsystem. It
allows the users to interact with config-subsystem in a standardized
NETCONF manner.</p>
<p>In terms of RFCs, these are supported:</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6241">RFC-6241</a>,</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc5277">RFC-5277</a>,</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc6470">RFC-6470</a><ul>
<li>(partially, only the schema-change notification is available in
Lithium release)</li>
</ul>
</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc6022">RFC-6022</a>,</li>
</ul>
<p>For regular users it is recommended to use RESTCONF + the
controller-config loopback mountpoint instead of using pure NETCONF. How
to do that is spesific for each component/module/application in
OpenDaylight and can be found in their dedicated user guides</p>
</div>
<div class="section" id="netconf-server-for-md-sal">
<h4>NETCONF server for MD-SAL<a class="headerlink" href="#netconf-server-for-md-sal" title="Permalink to this headline">¶</a></h4>
<p>This NETCONF server is just a generic interface to MD-SAL in
OpenDaylight. It uses the stadard MD-SAL APIs and serves as an
alternative to RESTCONF. It is fully model driven and supports any data
and rpcs that are supported by MD-SAL.</p>
<p>In terms of RFCs, these are supported:</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/rfc6241">RFC-6241</a>,</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc6022">RFC-6022</a>,</li>
</ul>
<p>Notifications over NETCONF are not supported in the Lithium release.</p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>Install NETCONF northbound for MD-SAL by installing feature:
<code class="docutils literal"><span class="pre">odl-netconf-mdsal</span></code> in karaf. Default binding port is <strong>2830</strong>.</p>
</div></blockquote>
<div class="section" id="id161">
<h5>Configuration<a class="headerlink" href="#id161" title="Permalink to this headline">¶</a></h5>
<p>The default configuration can be found in file: <em>08-netconf-mdsal.xml</em>.
The file contains the configuration for all necessary dependencies and a
single SSH endpoint starting on port 2830. There is also a (by default
disabled) TCP endpoint. It is possible to start multiple endpoints at
the same time either in the initial configuration file or while
OpenDaylight is running.</p>
<p>The credentials for SSH endpoint can also be configured here, the
defaults are admin/admin. Credentials in the SSH endpoint are not yet
managed by the centralized AAA component and have to be configured
separately.</p>
</div>
<div class="section" id="verifying-md-sals-netconf-server">
<h5>Verifying MD-SAL’s NETCONF server<a class="headerlink" href="#verifying-md-sals-netconf-server" title="Permalink to this headline">¶</a></h5>
<p>After the NETCONF server is available it can be examined by e.g. a
command line ssh tool:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">admin</span><span class="nd">@localhost</span> <span class="o">-</span><span class="n">p</span> <span class="mi">2830</span> <span class="o">-</span><span class="n">s</span> <span class="n">netconf</span>
</pre></div>
</div>
<p>The server will respond by sending its HELLO message and can be used as
a regular NETCONF server from now on.</p>
</div>
<div class="section" id="mounting-the-md-sals-netconf-server">
<h5>Mounting the MD-SAL’s NETCONF server<a class="headerlink" href="#mounting-the-md-sals-netconf-server" title="Permalink to this headline">¶</a></h5>
<p>To perform this operation, just spawn a new netconf-connector as
described in <a class="reference external" href="#_spawning_additional_netconf_connectors_while_the_controller_is_running">Spawning
netconf-connector</a>.
Just change the ip to &#8220;127.0.0.1&#8221; port to &#8220;2830&#8221; and its name to
&#8220;controller-mdsal&#8221;.</p>
<p>Now the MD-SAL’s datastore can be read over RESTCONF via NETCONF by
invoking:</p>
<p>GET
<a class="reference external" href="http://localhost:8181/restconf/operational/network-topology:network-topology/topology/topology-netconf/node/controller-mdsal/yang-ext:mount">http://localhost:8181/restconf/operational/network-topology:network-topology/topology/topology-netconf/node/controller-mdsal/yang-ext:mount</a></p>
<blockquote>
<div><p><strong>Note</strong></p>
<p>This might not seem very useful, since MD-SAL can be accessed
directly from RESTCONF or from Application code, but the same method
can be used to mount and control other OpenDaylight instances by the
&#8220;master OpenDaylight&#8221;.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="netconf-testtool">
<h3>NETCONF testtool<a class="headerlink" href="#netconf-testtool" title="Permalink to this headline">¶</a></h3>
<p><strong>NETCONF testtool is a set of standalone runnable jars that can:</strong></p>
<ul class="simple">
<li>Simulate NETCONF devices(suitable for scale testing)</li>
<li>Stress/Performance test NETCONF devices</li>
<li>Stress/Performance test RESTCONF devices</li>
</ul>
<p>These jars are part of OpenDaylight’s controller project and are built
from the NETCONF codebase in OpenDaylight.</p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>Download testtool from OpenDaylight Nexus at:
<a class="reference external" href="http://nexus.opendaylight.org/#nexus-search;quick~netconf-testtool">http://nexus.opendaylight.org/#nexus-search;quick~netconf-testtool</a></p>
</div></blockquote>
<p><strong>Nexus contains 3 executable tools:</strong></p>
<ul>
<li><p class="first">executable.jar - device simulator</p>
</li>
<li><p class="first">stress.client.tar.gz - NETCONF stress/performance measuring tool</p>
</li>
<li><p class="first">perf-client.jar - RESTCONF stress/performance measuring tool</p>
<blockquote>
<div><p><strong>Tip</strong></p>
<p>Each executable tool provides help. Just invoke <code class="docutils literal"><span class="pre">java</span> <span class="pre">-jar</span>
<span class="pre">&lt;name-of-the-tool.jar&gt;</span> <span class="pre">--help</span></code></p>
</div></blockquote>
</li>
</ul>
<div class="section" id="netconf-device-simulator">
<h4>NETCONF device simulator<a class="headerlink" href="#netconf-device-simulator" title="Permalink to this headline">¶</a></h4>
<p>Detailed information for NETCONF device simulator can be found at:
<a class="reference external" href="https://wiki.opendaylight.org/view/OpenDaylight_Controller:Netconf:Testtool">https://wiki.opendaylight.org/view/OpenDaylight_Controller:Netconf:Testtool</a></p>
</div>
<div class="section" id="netconf-stress-performance-measuring-tool">
<h4>NETCONF stress/performance measuring tool<a class="headerlink" href="#netconf-stress-performance-measuring-tool" title="Permalink to this headline">¶</a></h4>
<p>This is basically a NETCONF client that puts NETCONF servers under heavy
load of NETCONF RPCs and measures the time until a configurable amount
of them is processed.</p>
</div>
<div class="section" id="restconf-stress-performance-measuring-tool">
<h4>RESTCONF stress-performance measuring tool<a class="headerlink" href="#restconf-stress-performance-measuring-tool" title="Permalink to this headline">¶</a></h4>
<p>Very similar to NETCONF stress tool with the difference of using
RESTCONF protocol instead of NETCONF.</p>
</div>
</div>
</div>
<div class="section" id="yang-push">
<h2>YANG-PUSH<a class="headerlink" href="#yang-push" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to use the YANG-PUSH feature in OpenDaylight
and contains contains configuration, administration, and management
sections for the feature.</p>
<div class="section" id="id162">
<h3>Overview<a class="headerlink" href="#id162" title="Permalink to this headline">¶</a></h3>
<p>YANG PUBSUB project allows applications to place subscriptions upon
targeted subtrees of YANG datastores residing on remote devices. Changes
in YANG objects within the remote subtree can be pushed to an
OpenDaylight MD-SAL and to the application as specified without a
requiring the controller to make a continuous set of fetch requests.</p>
<div class="section" id="yang-push-capabilities-available">
<h4>YANG-PUSH capabilities available<a class="headerlink" href="#yang-push-capabilities-available" title="Permalink to this headline">¶</a></h4>
<p>This module contains the base code which embodies the intent of
YANG-PUSH requirements for subscription as defined in
{i2rs-pub-sub-requirements}
[<a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-i2rs-pub-sub-requirements/">https://datatracker.ietf.org/doc/draft-ietf-i2rs-pub-sub-requirements/</a>].
The mechanism for delivering on these YANG-PUSH requirements over
Netconf transport is defined in {netconf-yang-push} [netconf-yang-push:
<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-netconf-yang-push-00">https://tools.ietf.org/html/draft-ietf-netconf-yang-push-00</a>].</p>
<p>Note that in the current release, not all capabilities of
draft-ietf-netconf-yang-push are realized. Currently only implemented is
<strong>create-subscription</strong> RPC support from
<a class="reference external" href="mailto:ietf-datastore-push&#37;&#52;&#48;2015-10-15&#46;yang">ietf-datastore-push<span>&#64;</span>2015-10-15<span>&#46;</span>yang</a>; and this will be for periodic
subscriptions only. There of course is intent to provide much additional
functionality in future OpenDaylight releases.</p>
</div>
<div class="section" id="future-yang-push-capabilities">
<h4>Future YANG-PUSH capabilities<a class="headerlink" href="#future-yang-push-capabilities" title="Permalink to this headline">¶</a></h4>
<p>Over time, the intent is to flesh out more robust capabilities which
will allow OpenDaylight applications to subscribe to YANG-PUSH compliant
devices. Capabilities for future releases will include:</p>
<p>Support for subscription change/delete: <strong>modify-subscription</strong> rpc
support for all mountpoint devices or particular mountpoint device
<strong>delete-subscription</strong> rpc support for all mountpoint devices or
particular mountpoint device</p>
<p>Support for static subscriptions: This will enable the receipt of
subscription updates pushed from publishing devices where no signaling
from the controller has been used to establish the subscriptions.</p>
<p>Support for additional transports: NETCONF is not the only transport of
interest to OpenDaylight or the subscribed devices. Over time this code
will support Restconf and HTTP/2 transport requirements defined in
{netconf-restconf-yang-push}
[<a class="reference external" href="https://tools.ietf.org/html/draft-voit-netconf-restconf-yang-push-01">https://tools.ietf.org/html/draft-voit-netconf-restconf-yang-push-01</a>]</p>
</div>
</div>
<div class="section" id="yang-push-architecture">
<h3>YANG-PUSH Architecture<a class="headerlink" href="#yang-push-architecture" title="Permalink to this headline">¶</a></h3>
<p>The code architecture of Yang push consists of two main elements</p>
<p>YANGPUSH Provider YANGPUSH Listener</p>
<p>YANGPUSH Provider receives create-subscription requests from
applications and then establishes/registers the corresponding listener
which will receive information pushed by a publisher. In addition,
YANGPUSH Provider also invokes an augmented OpenDaylight
create-subscription RPC which enables applications to register for
notification as per rfc5277. This augmentation adds periodic time period
(duration) and subscription-id values to the existing RPC parameters.
The Java package supporting this capability is
“org.opendaylight.yangpush.impl”. YangpushDomProvider is the class which
supports this YANGPUSH Provider capability.</p>
<p>The YANGPUSH Listener accepts update notifications from a device after
they have been de-encapsulated from the NETCONF transport. The YANGPUSH
Listener then passes these updates to MD-SAL. This function is
implemented via the YangpushDOMNotificationListener class within the
“org.opendaylight.yangpush.listner” Java package. Applications should
monitor MD-SAL for the availability of newly pushed subscription
updates.</p>
</div>
<div class="section" id="yang-push-catalog">
<h3>YANG-PUSH Catalog<a class="headerlink" href="#yang-push-catalog" title="Permalink to this headline">¶</a></h3>
<p>The NF Catalog contains metadata describing a NF.</p>
<div class="section" id="configuring-yang-push-catalog">
<h4>Configuring YANG-PUSH Catalog<a class="headerlink" href="#configuring-yang-push-catalog" title="Permalink to this headline">¶</a></h4>
<p>TBD: Describe how to configure YANG-PUSH Catalog after installation.</p>
</div>
<div class="section" id="administering-yang-push-catalog">
<h4>Administering YANG-PUSH Catalog<a class="headerlink" href="#administering-yang-push-catalog" title="Permalink to this headline">¶</a></h4>
<p>TBD: Include related command reference or operations for using YANG-PUSH
Catalog.</p>
</div>
</div>
<div class="section" id="yang-push-workload-manager">
<h3>YANG-PUSH Workload Manager<a class="headerlink" href="#yang-push-workload-manager" title="Permalink to this headline">¶</a></h3>
<p>The Workload Manager defines RPCs to manage instances.</p>
</div>
<div class="section" id="configuring-yang-push-workload-manager">
<h3>Configuring YANG-PUSH Workload Manager<a class="headerlink" href="#configuring-yang-push-workload-manager" title="Permalink to this headline">¶</a></h3>
<p>TBD: Describe how to configure YANG-PUSH Workload Manager after
installation.</p>
</div>
<div class="section" id="administering-yang-push-workload-manager">
<h3>Administering YANG-PUSH Workload Manager<a class="headerlink" href="#administering-yang-push-workload-manager" title="Permalink to this headline">¶</a></h3>
<p>TBD: Include related command reference or operations for using YANG-PUSH
Workload Manager.</p>
</div>
<div class="section" id="id163">
<h3>Tutorials<a class="headerlink" href="#id163" title="Permalink to this headline">¶</a></h3>
<p>Below are tutorials for YANG-PUSH.</p>
<div class="section" id="using-yang-push-catalog">
<h4>Using YANG-PUSH Catalog<a class="headerlink" href="#using-yang-push-catalog" title="Permalink to this headline">¶</a></h4>
<p>TBD: State the purpose of tutorial</p>
<div class="section" id="id164">
<h5>Overview<a class="headerlink" href="#id164" title="Permalink to this headline">¶</a></h5>
<p>TBD: An overview of the YANG-PUSH Catalog tutorial</p>
</div>
<div class="section" id="id165">
<h5>Prerequisites<a class="headerlink" href="#id165" title="Permalink to this headline">¶</a></h5>
<p>TBD: Provide any prerequisite information, assumed knowledge, or
environment required to execute the use case.</p>
</div>
<div class="section" id="id166">
<h5>Target Environment<a class="headerlink" href="#id166" title="Permalink to this headline">¶</a></h5>
<p>There are no topology requirement for using YANG-PUSH. A single node
able interact as per
<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-netconf-yang-push-00">https://tools.ietf.org/html/draft-ietf-netconf-yang-push-00</a> is
sufficient to use this capability.</p>
</div>
<div class="section" id="id167">
<h5>Instructions<a class="headerlink" href="#id167" title="Permalink to this headline">¶</a></h5>
<p>TBD: Step by step procedure for using YANG-PUSH Catalog.</p>
</div>
</div>
<div class="section" id="using-yang-push-workload-manager">
<h4>Using YANG-PUSH Workload Manager<a class="headerlink" href="#using-yang-push-workload-manager" title="Permalink to this headline">¶</a></h4>
<p>TBD: State the purpose of tutorial</p>
<div class="section" id="id168">
<h5>Overview<a class="headerlink" href="#id168" title="Permalink to this headline">¶</a></h5>
<p>TBD: An overview of the YANG-PUSH Workload Manager tutorial</p>
</div>
<div class="section" id="id169">
<h5>Prerequisites<a class="headerlink" href="#id169" title="Permalink to this headline">¶</a></h5>
<p>TBD: Provide any prerequisite information, assumed knowledge, or
environment required to execute the use case.</p>
</div>
<div class="section" id="id170">
<h5>Target Environment<a class="headerlink" href="#id170" title="Permalink to this headline">¶</a></h5>
<p>TBD: Include any topology requirement for the use case.</p>
</div>
<div class="section" id="id171">
<h5>Instructions<a class="headerlink" href="#id171" title="Permalink to this headline">¶</a></h5>
<p>TBD: Step by step procedure for using YANG-PUSH Workload Manager.</p>
</div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, OpenDaylight Project.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>